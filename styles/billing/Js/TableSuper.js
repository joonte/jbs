//------------------------------------------------------------------------------
/** @author Бреславский А.В. (Joonte Ltd.) */
//------------------------------------------------------------------------------
function TableSuperSort($SortOn,$IsDesc){
	//------------------------------------------------------------------------------
	var $Form = document.forms['TableSuperForm'];
	//------------------------------------------------------------------------------
	with($Form){
		//------------------------------------------------------------------------------
		SortOn.value = $SortOn;
		//------------------------------------------------------------------------------
		IsDesc.value = $IsDesc
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
	TableSuperReload();
	//------------------------------------------------------------------------------
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function TableSuperSetIndex($Index){
	//------------------------------------------------------------------------------
	var $Form = document.forms['TableSuperForm'];
	//------------------------------------------------------------------------------
	$Form.Index.value = $Index;
	//------------------------------------------------------------------------------
	TableSuperReload();
	//------------------------------------------------------------------------------
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function TableSuperFlush(){
	//------------------------------------------------------------------------------
	var $Form = document.forms['TableSuperForm'];
	//------------------------------------------------------------------------------
	$Form.IsFlush.value = 1;
	//------------------------------------------------------------------------------
	TableSuperReload();
	//------------------------------------------------------------------------------
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function TableSuperSearch(){
	//------------------------------------------------------------------------------
	var $Form = document.forms['TableSuperForm'];
	//------------------------------------------------------------------------------
	if($Form.PatternOutID)
		$Form.PatternOutID.value = 'Default';
	//------------------------------------------------------------------------------
	TableSuperReload();
	//------------------------------------------------------------------------------
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function TableSuperMode($DataModeID){
	//------------------------------------------------------------------------------
	var $Form = document.forms['TableSuperForm'];
	//------------------------------------------------------------------------------
	if($Form.DataModeID)
		$Form.DataModeID.value = $DataModeID;
	//------------------------------------------------------------------------------
	TableSuperReload();
	//------------------------------------------------------------------------------
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function TableSuperReload(){
	//------------------------------------------------------------------------------
	ShowProgress('Обновление данных таблицы');
	//------------------------------------------------------------------------------
	var $Form = document.forms['TableSuperForm'];
	//------------------------------------------------------------------------------
	$Form.submit();
	//------------------------------------------------------------------------------
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function Delete(){
	//------------------------------------------------------------------------------
	var $Form = document.forms['TableSuperForm'];
	//------------------------------------------------------------------------------
	$HTTP = new HTTP();
	//------------------------------------------------------------------------------
	if(!$HTTP.Resource){
		//------------------------------------------------------------------------------
		alert('Не удалось создать HTTP соединение');
		//------------------------------------------------------------------------------
		return false;
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
	$HTTP.onLoaded = function(){
		//------------------------------------------------------------------------------
		HideProgress();
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
	$HTTP.onAnswer = function($Answer){
		//------------------------------------------------------------------------------
		switch($Answer.Status){
		case 'Error':
			ShowAlert($Answer.Error.String,'Warning');
			break;
		case 'Exception':
			ShowAlert(ExceptionsStack($Answer.Exception),'Warning');
			break;
		case 'Ok':
			TableSuperReload();
			break;
		default:
			alert('Не известный ответ');
		}
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
	var $Args = FormGet($Form);
	//------------------------------------------------------------------------------
	if(!$HTTP.Send('/API/Delete',$Args)){
		//------------------------------------------------------------------------------
		alert('Не удалось отправить запрос на сервер');
		//------------------------------------------------------------------------------
		return false;
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
	ShowProgress('Удаление записей');
	//------------------------------------------------------------------------------
}

