//------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function ListMenuOver(){
	//------------------------------------------------------------------------------
	document.body.onclick = ListMenuHide;
	//------------------------------------------------------------------------------
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function ListMenuShow($event,$Menu){
	//------------------------------------------------------------------------------
	var $ListMenu = document.getElementById('ListMenu');
	//------------------------------------------------------------------------------
	$ListMenu.onmouseover = ListMenuOver;
	//------------------------------------------------------------------------------
	var $Rows = $ListMenu.rows;
	//------------------------------------------------------------------------------
	while($Rows.length != 0)
		$ListMenu.deleteRow($Rows.length - 1);
	//------------------------------------------------------------------------------
	var $Tr = $ListMenu.insertRow(0);
	//------------------------------------------------------------------------------
	for(var $i=0;$i<$Menu.length;$i++){
		//------------------------------------------------------------------------------
		var $Item = $Menu[$i];
		//------------------------------------------------------------------------------
		var $Tr = $ListMenu.insertRow($i+1);
		//------------------------------------------------------------------------------
		var $Td = $Tr.insertCell(0);
		//------------------------------------------------------------------------------
		var $Img = document.createElement('IMG');
		$Img.width	= 22;
		$Img.height	= 22;
		$Img.src	= $Item.Icon;
		//------------------------------------------------------------------------------
		$Td.appendChild($Img);
		//------------------------------------------------------------------------------
		var $Td = $Tr.insertCell(1);
		$Td.style.padding = 5;
		//------------------------------------------------------------------------------
		var $A = document.createElement('A');
		$A.href		= $Item.Href;
		$A.innerHTML	= $Item.Text;
		$A.onclick	= ListMenuHide;
		//------------------------------------------------------------------------------
		$Td.appendChild($A);
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
	with($ListMenu.style){
		//------------------------------------------------------------------------------
		display		= 'block';
		zIndex		= GetMaxZIndex() + 1;
		transition	= "opacity 0.1s";
		opacity		= 1;
		//------------------------------------------------------------------------------
		var $Body = document.body;
		//------------------------------------------------------------------------------
		var $OffsetX = $Body.clientWidth  - ($event.clientX + $ListMenu.offsetWidth);
		var $OffsetY = $Body.clientHeight - ($event.clientY + $ListMenu.offsetHeight);
		//------------------------------------------------------------------------------
		left = $Body.scrollLeft + $event.clientX + ($OffsetX < 0?$OffsetX:0);
		top  = $Body.scrollTop  + $event.clientY + ($OffsetY-30 < 0?$OffsetY-30:0);
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function ListMenuHide(){
	//------------------------------------------------------------------------------
	$ListMenu = document.getElementById('ListMenu');
	//------------------------------------------------------------------------------
        $ListMenu.style.opacity = 0;
	//------------------------------------------------------------------------------
        setTimeout("$ListMenu.style.display='none';",100);
	//document.getElementById('ListMenu').style.display = 'none';
	//------------------------------------------------------------------------------
	document.body.onclick = null;
	//------------------------------------------------------------------------------
}

