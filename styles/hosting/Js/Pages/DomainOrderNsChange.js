//------------------------------------------------------------------------------
/** @author Бреславский А.В. (Joonte Ltd.) */
//------------------------------------------------------------------------------
function IsNewNs($Domain,$IDNA_Domain){
	//------------------------------------------------------------------------------
	var $Form = document.forms['DomainOrderNsChangeForm'];
	//------------------------------------------------------------------------------
	//alert($Domain);
	//alert($IDNA_Domain);
	for(var $i=1;$i<5;$i++){
		//------------------------------------------------------------------------------
		var $DnsName = $Form[SPrintF('Ns%uName',$i)].value;
		//------------------------------------------------------------------------------
                $DnsName.replace(/ /g, '');
		//console.log("DNS = " + $DnsName + "; Domain = " + $Domain + "; result = " + $DnsName.search($Domain));
		//------------------------------------------------------------------------------
		if($DnsName.search($Domain) > -1 || $DnsName.search($IDNA_Domain) > -1){
			//------------------------------------------------------------------------------
			$Form[SPrintF('Ns%uIP',$i)].disabled = 0;
			//------------------------------------------------------------------------------
		}else{
			//------------------------------------------------------------------------------
			$Form[SPrintF('Ns%uIP',$i)].disabled = 1;
			//------------------------------------------------------------------------------
		}
		//------------------------------------------------------------------------------
	}
	//------------------------------------------------------------------------------
}
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
function DomainOrderNsChange(){
  //----------------------------------------------------------------------------
  var $Form = document.forms['DomainOrderNsChangeForm'];
  //----------------------------------------------------------------------------
  $HTTP = new HTTP();
  //----------------------------------------------------------------------------
  if(!$HTTP.Resource){
    //--------------------------------------------------------------------------
    alert('Не удалось создать HTTP соединение');
    //--------------------------------------------------------------------------
    return false;
  }
  //----------------------------------------------------------------------------
  $HTTP.onLoaded = function(){
    //--------------------------------------------------------------------------
    HideProgress();
  }
  //----------------------------------------------------------------------------
  $HTTP.onAnswer = function($Answer){
    //--------------------------------------------------------------------------
    switch($Answer.Status){
      case 'Error':
        ShowAlert($Answer.Error.String,'Warning');
      break;
      case 'Exception':
        ShowAlert(ExceptionsStack($Answer.Exception),'Warning');
      break;
      case 'Ok':
        //----------------------------------------------------------------------
        ShowTick('Заявка на изменение именных серверов успешно принята');
        //----------------------------------------------------------------------
        GetURL(document.location);
      break;
      default:
        alert('Не известный ответ');
    }
  }
  //----------------------------------------------------------------------------
  var $Args = FormGet($Form);
  //----------------------------------------------------------------------------
  if(!$HTTP.Send('/API/DomainOrderNsChange',$Args)){
    //--------------------------------------------------------------------------
    alert('Не удалось отправить запрос на сервер');
    //--------------------------------------------------------------------------
    return false;
  }
  //----------------------------------------------------------------------------
  ShowProgress('Смена именных серверов');
}
