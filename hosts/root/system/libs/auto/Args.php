<?php
#-------------------------------------------------------------------------------
/** @author Бреславский А.В. (Joonte Ltd.) */
#-------------------------------------------------------------------------------
function &Args(){
	#-------------------------------------------------------------------------------
	$Name = Md5('Args');
	#-------------------------------------------------------------------------------
	if(!IsSet($GLOBALS[$Name])){
		#-------------------------------------------------------------------------------
		$GLOBALS[$Name] = $_GET;
		#-------------------------------------------------------------------------------
		// поверх $_GET кладём $_POST
		Array_Union($GLOBALS[$Name],$_POST);
		#-------------------------------------------------------------------------------
		#-------------------------------------------------------------------------------
		// подбираем JSON
		$Data = @Json_Decode(File_Get_Contents('php://input'),TRUE);
		#-------------------------------------------------------------------------------
		if(Is_Array($Data)){
			#-------------------------------------------------------------------------------
			Debug(SPrintF('[system/libs/auto/Args.php]: Data = %s',print_r($Data,true)));
			#-------------------------------------------------------------------------------
			Array_Union($GLOBALS[$Name],$Data);
			#-------------------------------------------------------------------------------
			// сохраяем оригинальный JSON
			$GLOBALS[$Name]['input_JSON'] = $Data;
			#-------------------------------------------------------------------------------
		}
		#-------------------------------------------------------------------------------
	}
	#-------------------------------------------------------------------------------
	#-------------------------------------------------------------------------------
	if(!Defined('XML_HTTP_REQUEST'))
		if(!Define('XML_HTTP_REQUEST',IsSet($GLOBALS[$Name]['XMLHttpRequest']) || IsSet($_POST['XMLHttpRequest'])))
			return ERROR | @Trigger_Error(500);
	#-------------------------------------------------------------------------------
	#-------------------------------------------------------------------------------
	return $GLOBALS[$Name];
	#-------------------------------------------------------------------------------
	#-------------------------------------------------------------------------------
}
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
?>
