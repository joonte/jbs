<?php

#-------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
/******************************************************************************/
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
$Out = Array();
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$Profiles = DB_Select('Profiles','*',Array('SortOn'=>'StatusDate','IsDesc'=>TRUE,'Where'=>"`TemplateID` = 'Partner' AND `StatusID` = 'Checked'"));
#-------------------------------------------------------------------------------
switch(ValueOf($Profiles)){
case 'error':
	return ERROR | @Trigger_Error(500);
case 'exception':
	#-------------------------------------------------------------------------------
	break;
	#-------------------------------------------------------------------------------
case 'array':
	#-------------------------------------------------------------------------------
	foreach($Profiles as $Profile){
		#-------------------------------------------------------------------------------
		$Compile = Comp_Load('www/Administrator/API/ProfileCompile',Array('ProfileID'=>$Profile['ID']));
		#-------------------------------------------------------------------------------
		switch(ValueOf($Compile)){
		case 'error':
			return ERROR | @Trigger_Error(500);
		case 'exception':
			return ERROR | @Trigger_Error(400);
		case 'array':
			break;
		default:
			return ERROR | @Trigger_Error(101);
		}
		#-------------------------------------------------------------------------------
		$Out[$Profile['ID']] = $Compile['Attribs'];
		#-------------------------------------------------------------------------------
	}
	#-------------------------------------------------------------------------------
	break;
	#-------------------------------------------------------------------------------
default:
	return ERROR | @Trigger_Error(101);
}
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
return $Out;
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
?>
