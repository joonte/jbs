<?php

#-------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
/******************************************************************************/
/******************************************************************************/
$__args_list = Array('ExpirationDate','YearsRemainded','OnClick');
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/
if(!($ExpirationDate || $YearsRemainded))
	return ($OnClick)?new Tag('SPAN',Array('OnClick'=>$OnClick,'style'=>'width:100%;display:block;'),'-'):'-';
#-------------------------------------------------------------------------------
$ExpirationDate = Max($ExpirationDate,Time());
#-------------------------------------------------------------------------------
if($YearsRemainded){
	#-------------------------------------------------------------------------------
	$Date = Array();
	#-------------------------------------------------------------------------------
	foreach(Array('H','i','s','m','d','Y') as $Element)
		$Date[$Element] = Date($Element,$ExpirationDate);
	#-------------------------------------------------------------------------------
	$Date['Y'] += $YearsRemainded;
	#-------------------------------------------------------------------------------
	$ExpirationDate = MkTime($Date['H'],$Date['i'],$Date['s'],$Date['m'],$Date['d'],$Date['Y']);
	#-------------------------------------------------------------------------------
}
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$Attribs = Array('style'=>SPrintF('color:#%s;text-decoration:underline;',$ExpirationDate - Time() < 2592000?'FF0000':'1E2E07'));
#-------------------------------------------------------------------------------
if($OnClick)
	$Attribs['OnClick'] = $OnClick;
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
return new Tag('DIV',$Attribs,new Tag('SPAN',Date('d.m.y',$ExpirationDate)),new Tag('SPAN',SPrintF('| %u дн.',Ceil(($ExpirationDate-Time())/86400))));
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
?>
