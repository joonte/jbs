<?php

#-------------------------------------------------------------------------------
/** @author Alex Keda, for www.host-food.ru */
/******************************************************************************/
/******************************************************************************/
$__args_list = Array('Zone','Format');
/******************************************************************************/
Eval(COMP_INIT);
/******************************************************************************/
/******************************************************************************/

$CacheID1 = Md5($__FILE__);
$CacheID2 = Md5(SPrintF('%s-%s',$__FILE__,$Format));
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
$DomainZones = CacheManager::get($CacheID1);
#-------------------------------------------------------------------------------
if(!$DomainZones){
	#-------------------------------------------------------------------------------
	// достаём список доменных зон
	$DomainZones = System_XML('config/DomainZones.xml');
	if(Is_Error($DomainZones))
		return ERROR | @Trigger_Error('[comp/Formats/DomainOrder/DomainZones]: не удалось загрузить базу WhoIs серверов');
	#-------------------------------------------------------------------------------
	// кэшируем, 5 минут достаточно - главное чтоб все тыканья при првоерке домена в разных зонах отдать из кэша
	CacheManager::add($CacheID1,$DomainZones,300);
	#-------------------------------------------------------------------------------
}
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
// если не задана конкретная зона или формат - возвращаем список доменных зон
if(!$Zone && !$Format)
	return $DomainZones;
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
// запрашивают именованный список
if($Format && $Format = 'Name'){
	#-------------------------------------------------------------------------------
	$AllZones = CacheManager::get($CacheID2);
	#-------------------------------------------------------------------------------
	if(!$AllZones){
		#-------------------------------------------------------------------------------
		$AllZones = Array();
		#-------------------------------------------------------------------------------
		foreach($DomainZones as $DomainZone)
			$AllZones[$DomainZone['Name']] = $DomainZone;
		#-------------------------------------------------------------------------------
		CacheManager::add($CacheID2,$AllZones,300);
		#-------------------------------------------------------------------------------
	}
	#-------------------------------------------------------------------------------
	#Debug(SPrintF('[comp/Formats/DomainOrder/DomainZones]: AllZones = %s',print_r($AllZones,true)));
	return $AllZones;
	#-------------------------------------------------------------------------------
}


#if($Zone){
#
#}

#-------------------------------------------------------------------------------
return $DomainZones;
#-------------------------------------------------------------------------------

?>
