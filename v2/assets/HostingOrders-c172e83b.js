import{j as V,o as c,c as w,b as p,a as r,w as M,d as q,y,am as R,t as D,F as N,x as z,_ as G,f as J,e as Q,r as S,S as W,i as X,g as i}from"./index-b5b5ce3d.js";import{I as Y}from"./IconSearch-1e5f2e1f.js";import{H as T}from"./HostingItem-c0f5d110.js";import{_ as U}from"./ClausesKeeper-3a1c11ba.js";import{s as Z}from"./multiselect-4f7d14de.js";import{u as $}from"./hosting-552a9dd1.js";import{u as tt}from"./contracts-74f05bb7.js";import{B as A}from"./BlockBalanceAgreement-a016b94f.js";import{u as et}from"./testTransforms-eec373ee.js";import{u as ot}from"./globalActions-6936f67f.js";import{E as st}from"./EmptyStateBlock-cd0c2748.js";import{_ as nt}from"./FormInputSearch-23b3b5c7.js";import"./IconDots-5eb3cb0a.js";import"./IconCard-cef3f371.js";import"./StatusBadge-0649a996.js";import"./hostStatuses-94d00f20.js";import"./HelperComponent-fa301290.js";import"./ButtonDefault-0006f72a.js";import"./IconArrow-fddabae2.js";import"./useTimeFunction-8602dd60.js";import"./bootstrap-vue-next.es-37aa63ea.js";import"./OrderIDBadge-a6480cec.js";import"./IconClose-cd6d3917.js";import"./IconPlus-4ce40522.js";const rt={class:"section"},at={class:"container"},lt={class:"section-header"},ct={class:"list-form"},it={class:"list-form_col list-form_col--sm"},ut={class:"list-form_select"},mt={class:"multiselect-option"},dt={key:0};function ft(n,a,u,s,x,v){var I,l,_;const m=A,d=V("router-link"),f=U,B=V("Multiselect"),h=nt,L=T,H=st;return c(),w(N,null,[p(m),r("div",rt,[r("div",at,[r("div",lt,[r("h1",{class:"section-title",onClick:a[0]||(a[0]=o=>s.reloadNow())},"Хостинг"),p(d,{class:"btn btn--blue btn-default",to:"/HostingSchemes"},{default:M(()=>[q("Заказать")]),_:1})]),(c(),y(R,null,[p(f)],1024)),r("div",ct,[r("div",it,[r("div",ut,[p(B,{modelValue:s.select,"onUpdate:modelValue":a[1]||(a[1]=o=>s.select=o),options:s.getUsers,disabled:((I=s.getUsers)==null?void 0:I.length)<=1,label:"name"},{singlelabel:M(({value:o})=>[r("span",null,"# "+D(o.value.padStart(5,"0"))+" / "+D(o.name),1)]),option:M(({option:o})=>[r("div",mt,"# "+D(o.value.padStart(5,"0"))+" / "+D(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),p(h,{modelValue:s.search,"onUpdate:modelValue":a[2]||(a[2]=o=>s.search=o)},null,8,["modelValue"])]),s.getHostingList&&((l=s.getHostingList)==null?void 0:l.length)>0?(c(),w("div",dt,[s.filterProducts&&((_=s.filterProducts)==null?void 0:_.length)>0?(c(!0),w(N,{key:0},z(s.filterProducts,(o,P)=>{var C,k;return c(),y(L,{"item-data":o,"user-name":`${(C=s.getUser)==null?void 0:C.Name} - ${(k=s.getContracts[o==null?void 0:o.ContractID])==null?void 0:k.Customer}`,params:s.getHostingItemParam(o),"info-link":`/HostingOrders/${o==null?void 0:o.OrderID}`,"is-last":P===s.filterProducts.length-1,onDelete:s.deleteItem,onTransfer:s.transferItem,onManage:s.orderManage},null,8,["item-data","user-name","params","info-link","is-last","onDelete","onTransfer","onManage"])}),256)):(c(),y(H,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(c(),y(H,{key:1,class:"no-margin",label:"У Вас нет заказов на хостинг"}))])])],64)}const _t={components:{IconSearch:Y,Multiselect:Z,ClausesKeeper:U,HostingItem:T,BlockBalanceAgreement:A},async setup(){const n=$(),a=J(),u=tt(),s=ot(),x=Q(),{formDescriptionLine:v}=et(),m=S("*"),d=S(null),f=W("emitter");f.on("updateHostingList",()=>{n.fetchHostingOrders()}),X(()=>{l.value.length<1&&h()});function B(){x.go(0)}function h(){x.push({path:"/HostingSchemes"})}function L(e){f.emit("open-modal",{component:"DeleteItem",data:{id:e,message:"Вы действительно хотите удалить хостинг?",tableID:"HostingOrders",successEmit:"updateHostingList"}})}function H(e){f.emit("open-modal",{component:"OrdersTransfer",data:e})}function I(e){s.OrderManageHosting(e)}const l=i(()=>{var e;return(e=Object.keys(n==null?void 0:n.hostingList).map(t=>n==null?void 0:n.hostingList[t]))==null?void 0:e.reverse()}),_=i(()=>n==null?void 0:n.hostingSchemes),o=i(()=>u==null?void 0:u.contractsList),P=i(()=>{let e=[{value:"*",name:"Все договора"}];return l.value!==null?(l.value.forEach(t=>{var g;e.find(b=>b.value===t.ContractID)||e.push({value:t.ContractID,name:(g=o.value[t==null?void 0:t.ContractID])==null?void 0:g.Customer})}),e):{value:"*",name:"Все договора"}}),C=i(()=>a.userInfo),k=i(()=>j(E(l.value)));function E(e){return m.value!=="*"?e.filter(t=>(t==null?void 0:t.ContractID)===m.value):e}function j(e){return d.value!==null?e.filter(t=>t==null?void 0:t.Domain.toLowerCase().includes(d.value.toLowerCase())):e}function F(e){var g,b,O;const t=K(e==null?void 0:e.SchemeID);return[{text:t==null?void 0:t.Name},{text:v((g=t==null?void 0:t.SchemeParams)==null?void 0:g.limit_webdomains)},{text:v((b=t==null?void 0:t.SchemeParams)==null?void 0:b.limit_quota)},{text:v((O=t==null?void 0:t.SchemeParams)==null?void 0:O.limit_emails)},{text:`${t==null?void 0:t.CostMonth} ₽ в месяц`,bold:!0}]}function K(e){var t;return(t=_.value)==null?void 0:t[e]}return await n.fetchHostingOrders(),await n.fetchHostingSchemes(),await u.fetchContracts(),{getHostingList:l,getHostingSchemes:_,orderManage:I,filterProducts:k,getUsers:P,getUser:C,select:m,search:d,getContracts:o,deleteItem:L,transferItem:H,getHostingItemParam:F,navigateToHostingSchemes:h,reloadNow:B}}},Et=G(_t,[["render",ft],["__scopeId","data-v-5952ceaa"]]);export{Et as default};
