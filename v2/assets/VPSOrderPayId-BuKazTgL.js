import{_ as $}from"./EmptyStateBlock-DA3-0YDi.js";import{_ as A}from"./ButtonDefault-CMw2aBy6.js";import{_ as T}from"./TotalAmount.vue_vue_type_script_setup_true_lang-Dg-09YER.js";import{_ as K}from"./BlockOrderPayBalance-DG_N_8bZ.js";import{_ as N}from"./ClausesKeeper-iUM0yapS.js";import{_ as R}from"./BlockBalanceAgreement-v_bWuiVT.js";import{H as U,r as I,f as c,I as j,s as F,E as v,o,c as i,b as d,a as m,C as f,h as b,F as H,d as M,i as q}from"./index-Codq73aV.js";import{u as z}from"./index-BO2gwtUe.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./common-DyknwSqv.js";import"./bootstrap-vue-next-W16P-SAV.js";import"./component-DqcwA9JN.js";import"./global-CdY51QQZ.js";import"./IconCross-DYjIbZqx.js";import"./IconClose-Dia1noy8.js";const J={class:"tw-px-4 md:tw-px-8"},Q={key:0},W={class:"tw-mb-8"},X={key:1,class:"section"},Y={key:2,class:"section"},Z={class:"container"},ee={__name:"VPSOrderPayId",async setup(te){let n,r;const l=U(),y=z(),S=M(),D=q(),s=I(null),_=I(!1),B=c(()=>Object.keys(l.vpsSchemes).map(e=>l.vpsSchemes[e])),t=c(()=>Object.values(l.vpsList).find(e=>e.OrderID==D.params.id)),p=c(()=>y.contractsList[t.value?.ContractID]),u=c(()=>B.value.find(e=>e?.ID==t.value?.SchemeID)),C=c(()=>p.value?.Balance>s.value?.price?"Оплатить c баланса договора":"Добавить в корзину");function h(){_.value=!0,l.VPSOrderPay({VPSOrderID:t.value?.ID,DaysPay:s.value?.actualDays,IsChange:!0}).then(e=>{let{result:a}=e;a==="SUCCESS"?S.push("/VPSOrders"):a==="BASKET"&&S.push("/Basket"),_.value=!0})}const k=e=>{e.key==="Enter"&&e.ctrlKey&&!g.value&&h()},g=c(()=>s.value===null||t.value?.ContractID===null);return j(()=>{document.addEventListener("keyup",k)}),F(()=>{document.removeEventListener("keyup",k)}),[n,r]=v(()=>l.fetchVPSSchemes()),await n,r(),[n,r]=v(()=>y.fetchContracts()),await n,r(),[n,r]=v(()=>l.fetchVPS()),await n,r(),(e,a)=>{const w=R,O=N,E=K,x=T,L=A,V=$;return o(),i(H,null,[d(w,{"contract-id":t.value?.ContractID},null,8,["contract-id"]),m("div",J,[t.value?(o(),i("div",Q,[m("div",W,[a[2]||(a[2]=m("h1",{class:"tw-w-full tw-mb-6"},"Оплата заказа VPS/VDS сервера",-1)),d(O,{partition:"Header:/VPSSchemes"})]),p.value?(o(),f(E,{key:0,modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=P=>s.value=P),contract:p.value,scheme:u.value,"service-id":3e4,"days-remainded":t.value?.DaysRemainded,order:t.value},null,8,["modelValue","contract","scheme","days-remainded","order"])):b("",!0),u.value?.IsPayed&&u.value?.IsProlong||!u.value?.IsPayed?(o(),i("div",X,[s.value?(o(),f(x,{key:0,tariff:s.value},null,8,["tariff"])):b("",!0),d(L,{class:"btn--wide",label:C.value,disabled:s.value===null||t.value?.ContractID===null,"is-loading":_.value,onClick:a[1]||(a[1]=P=>h())},null,8,["label","disabled","is-loading"])])):(o(),i("div",Y,[m("div",Z,[d(V,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(o(),f(V,{key:1,label:"Заказ VPS/VDS сервера не найден",class:"tw-my-8"}))])],64)}}},ye=G(ee,[["__scopeId","data-v-18f9aae9"]]);export{ye as default};
