import{_ as x}from"./ProfileForm-2r21QQHo.js";import{_ as q}from"./SimpleCheckbox-Cmv9xJvR.js";import{_ as V}from"./ClausesKeeper-iUM0yapS.js";import{_ as B}from"./BlockBalanceAgreement-v_bWuiVT.js";import{ao as S,r as m,f as h,m as y,o as c,c as k,b as I,a as f,F as C,g as M,C as D,h as N,d as E,i as R,x as $}from"./index-Codq73aV.js";import{u as F}from"./index-BO2gwtUe.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ButtonDefault-CMw2aBy6.js";import"./bootstrap-vue-next-W16P-SAV.js";import"./IconClip-DAey3Lid.js";import"./IconClose-Dia1noy8.js";import"./IconFile-ZfzHpv9u.js";import"./InputSelect.vue_vue_type_script_setup_true_lang-D7E9_BoS.js";import"./IconChevronDown-DOsbTpSQ.js";import"./BasicInput-DeQAeyXe.js";import"./component-DqcwA9JN.js";import"./common-DyknwSqv.js";import"./files-B5cKv3cM.js";const j={class:"tw-px-4 md:tw-px-8 tw-mb-10"},A={class:"tw-mb-10"},L={__name:"ProfileMake",setup(U){const d=S(),i=F(),a=E(),t=R(),P=$("emitter"),n=m({}),_=m(null),v=m(null),o=m(null),p=h(()=>Object.values(d.data?.Contracts?.Types||{}).filter(e=>e?.ProfileTemplateID!==""));async function T(r){_.value=!0;const e=await i.profileEdit(r);_.value=!1,e.status==="success"?t.query.ProfileEmpty?(await i.contractMake({ProfileID:e.data?.ProfileID,TypeID:o.value})).data.Status==="Ok"&&(P.emit("open-modal",{component:"SuccessContract",data:"Профиль и договор успешно созданы!"}),t.query.Redirect?a.push(`${t.query.Redirect}`):a.push("/Contracts")):t.query.ContractNew?(await i.contractMake({ProfileID:e.data?.ProfileID,TypeID:o.value})).data.Status==="Ok"&&a.push("/Basket"):t.query.Contract?a.push(`/Balance/${t.query.Contract}`):!t.query.Contract&&t.query.TemplateID?a.push("/Basket"):a.push("/Contracts"):v.value=e.data?.Exception}return y(p,()=>{t.query.TemplateID?o.value=t.query.TemplateID:o.value=p.value[0]?.ProfileTemplateID||null},{immediate:!0}),y(o,r=>{n.value={};const e=d.data?.Profiles?.Templates?.[r]?.Template?.Attribs||{};for(const s in e){const u=e[s]?.Value;u&&(n.value[s]=u)}},{immediate:!0}),(r,e)=>{const s=B,u=V,b=q,g=x;return c(),k(C,null,[I(s),f("div",j,[e[2]||(e[2]=f("h1",{class:"tw-text-xl sm:tw-text-4xl tw-mb-4"},"Создать профиль",-1)),I(u),f("div",A,[(c(!0),k(C,null,M(p.value,l=>(c(),D(b,{key:l.ProfileTemplateID,modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=w=>o.value=w),label:l.Name,value:l.ProfileTemplateID},null,8,["modelValue","label","value"]))),128))]),o.value?(c(),D(g,{key:0,modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=l=>n.value=l),template:o.value,"error-message":v.value,onSend:T},null,8,["modelValue","template","error-message"])):N("",!0)])],64)}}},ue=O(L,[["__scopeId","data-v-b1202bf0"]]);export{ue as default};
