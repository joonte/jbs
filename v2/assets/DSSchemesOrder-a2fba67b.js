import{_ as et}from"./ButtonDefault-0006f72a.js";import{_ as lt}from"./BlockOrderPayBalance-c29bc7b2.js";import{_ as ot}from"./BlockSelectContract-03150afa.js";import{_ as at}from"./ClausesKeeper-3a1c11ba.js";import{_ as ct,a7 as nt,e as it,S as _t,r as B,g as x,i as rt,O as dt,ag as O,o as u,c as v,b as m,a as s,t as a,F as I,x as Q,k as ut,Z as W,ae as X,p as vt,l as bt}from"./index-b5b5ce3d.js";import{u as pt}from"./dedicatedServer-ac37dd46.js";import{u as mt}from"./contracts-74f05bb7.js";import{B as ht}from"./BlockBalanceAgreement-a016b94f.js";import"./bootstrap-vue-next.es-37aa63ea.js";import"./IconHelp-12aa8ba1.js";import"./globalActions-6936f67f.js";import"./BasicInput-a3395017.js";import"./component-2368399e.js";import"./multiselect-4f7d14de.js";import"./IconClose-cd6d3917.js";import"./IconArrow-fddabae2.js";const h=f=>(vt("data-v-b3767c19"),f=f(),bt(),f),ft={class:"dedicated-server-order"},kt={class:"section"},Dt={class:"container"},yt={class:"section-header"},xt={class:"section-title"},It=h(()=>s("div",{class:"section-label"},"Выделенный сервер",-1)),St={class:"section"},gt={class:"container"},wt={class:"list"},Bt={class:"list-col list-col--xl"},Ot={class:"list-item"},Ct=h(()=>s("div",{class:"list-item__row"},[s("div",{class:"list-item__title"},"Конфигурация")],-1)),Et={class:"list-item__row list-item__table"},Lt={class:"list-item__table-col"},Pt={class:"list-item__label"},Vt={class:"list-item__text"},Ft=h(()=>s("div",{class:"section"},[s("div",{class:"container"},[s("div",{class:"section-subtitle"},"Что входит в стоимость"),s("div",{class:"text"},[s("p",null,"Для подключения дополнительных услуг"),s("ul",null,[s("li",null,"Размещение в РФ, Москва"),s("li",null,"IP адрес, с возможностью расширения"),s("li",null,"Бесплатная панель управления ISPManager Lite"),s("li",null,"Круглосуточная поддержка")])])])],-1)),Nt={class:"section"},Ut={class:"container"},$t={class:"total-block"},At={class:"total-block__row divider-bottom"},Kt=h(()=>s("div",{class:"total-block__col"},"Цена тарифа",-1)),Rt={class:"total-block__col"},Tt={class:"total-block__row no-divider"},jt={class:"total-block__col"},Mt={class:"total-block__col"},Zt={class:"total-block__row total-block__row--big economy-line"},qt=h(()=>s("div",{class:"total-block__col red"},"Выгода",-1)),zt={class:"total-block__col flex-col"},Gt={class:"red"},Ht={class:"total-block__row total-block__row--big"},Jt={class:"total-block__col"},Qt={class:"total-block__col"},Wt={__name:"DSSchemesOrder",async setup(f){let i,_;const C=mt(),n=pt(),E=nt(),L=it();_t("emitter");const l=B(null),k=B(!1),c=B(null),b=x(()=>C.contractsList),r=x(()=>n==null?void 0:n.DSSchemes),S=x(()=>{var t;return(t=r==null?void 0:r.value)==null?void 0:t[E.params.id]}),P=t=>{t.key==="Enter"&&t.ctrlKey&&!Y.value&&F()},Y=x(()=>l.value===null||c.value===null);rt(()=>{document.addEventListener("keyup",P)}),dt(()=>{document.removeEventListener("keyup",P)});function tt(t){l.value=t}function V(){var o,p;let t=0;return(p=(o=l.value)==null?void 0:o.discounts)==null||p.Bonuses.map(d=>{t+=+d.Economy}),t}function D(t){return Number(t).toFixed(2)||0}function st(){var o;const t=(o=r==null?void 0:r.value)==null?void 0:o[E.params.id];return[{label:"Процессор",text:(t==null?void 0:t.CPU)||"-"},{label:"Объём оперативной памяти",text:(t==null?void 0:t.ram)||"-"},{label:"Характеристики жёстких дисков",text:(t==null?void 0:t.disks)||"-"},{label:"Предустановленная ОС",text:(t==null?void 0:t.OS)||"-"},{label:"RAID",text:(t==null?void 0:t.raid)||"-"},{label:"Месячный трафик",text:t!=null&&t.trafflimit?`${t==null?void 0:t.trafflimit} ГБ`:"-"},{label:"Скорость канала",text:t!=null&&t.chrate?`${t==null?void 0:t.chrate} Мбит/с`:"-"}]}function F(){k.value=!0,n.DSOrder({ContractID:c.value,DSSchemeID:S.value.ID}).then(({result:t,info:o,error:p})=>{var d;t==="SUCCESS"?n.DSOrderPay({DSOrderID:o==null?void 0:o.DSOrderID,DaysPay:(d=l.value)==null?void 0:d.actualDays,IsChange:!0}).then(g=>{let{result:y,error:w}=g;y==="SUCCESS"?L.push("/DSOrders"):y==="BASKET"&&L.push("/Basket"),k.value=!1}):k.value=!1})}return[i,_]=O(()=>n.fetchDSOrders()),await i,_(),[i,_]=O(()=>n.fetchDSSchemes()),await i,_(),[i,_]=O(()=>C.fetchContracts().then(()=>{var t;b.value&&(c.value=(t=Object.keys(b==null?void 0:b.value))==null?void 0:t[0])})),await i,_(),(t,o)=>{var w,N,U,$,A,K,R,T,j,M,Z,q,z,G,H,J;const p=at,d=ot,g=lt,y=et;return u(),v(I,null,[m(ht),s("div",ft,[s("div",kt,[s("div",Dt,[s("div",yt,[s("h1",xt,a((w=S.value)==null?void 0:w.Name),1),It]),m(p)])]),s("div",St,[s("div",gt,[s("div",wt,[s("div",Bt,[s("div",Ot,[Ct,s("div",Et,[(u(!0),v(I,null,Q(st(),e=>(u(),v("div",Lt,[s("div",Pt,a(e.label),1),s("div",Vt,a(e.text),1)]))),256))])])])])])]),Ft,m(d,{title:"Оформление услуги",modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=e=>c.value=e)},null,8,["modelValue"]),m(g,{contractID:c.value,scheme:S.value,serviceID:"40000",isOrderID:!1,onSelect:tt},null,8,["contractID","scheme"]),s("div",Nt,[s("div",Ut,[s("div",$t,[(($=(U=(N=l.value)==null?void 0:N.discounts)==null?void 0:U.Bonuses)==null?void 0:$.length)>0?(u(),v(I,{key:0},[s("div",At,[Kt,s("div",Rt,a(D((A=l.value)==null?void 0:A.price))+" ₽",1)]),(u(!0),v(I,null,Q((R=(K=l.value)==null?void 0:K.discounts)==null?void 0:R.Bonuses,e=>(u(),v("div",Tt,[s("div",jt,"Скидка "+a(e==null?void 0:e.Discount)+"% на "+a(e==null?void 0:e.Days)+" дней",1),s("div",Mt,"-"+a(D(e==null?void 0:e.Economy))+" ₽",1)]))),256))],64)):ut("",!0),W(s("div",Zt,[qt,s("div",zt,[s("span",null,[s("s",null,a(D((T=l.value)==null?void 0:T.price))+" ₽",1)]),s("span",Gt,"-"+a(V())+" ₽",1)])],512),[[X,((Z=(M=(j=l.value)==null?void 0:j.discounts)==null?void 0:M.Bonuses)==null?void 0:Z.length)>0]]),W(s("div",Ht,[s("div",Jt,"Итого за "+a((q=l.value)==null?void 0:q.label),1),s("div",Qt,a(D(((z=l.value)==null?void 0:z.price)-V()))+" ₽",1)],512),[[X,(G=l.value)==null?void 0:G.price]])]),m(y,{class:"btn--wide",label:((H=b.value[c.value])==null?void 0:H.Balance)>((J=l.value)==null?void 0:J.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:l.value===null||c.value===null,"is-loading":k.value,onClick:o[1]||(o[1]=e=>F())},null,8,["label","disabled","is-loading"])])])])],64)}}},bs=ct(Wt,[["__scopeId","data-v-b3767c19"]]);export{bs as default};
