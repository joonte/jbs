import{o as c,c as r,F as _,x as g,n as x,a as m,t as D,k as C,p as A,l as w,_ as j,u as b,S as F,r as k,e as L,a7 as N,g as h}from"./index-83b4b7ba.js";import{_ as O}from"./ButtonDefault-dc248ec6.js";import{u as R}from"./invoices-7828d146.js";import{u as V}from"./postings-05f51b78.js";const W=s=>(A("data-v-66596283"),s=s(),w(),s),z={class:"list-part"},E=W(()=>m("div",{class:"list-item__title"},"Выбрать платёжную систему",-1)),q={key:0,class:"list-row grid-net"},G=["onClick"],H=["src"],J={class:"list-item__image-title"},K={class:"modal__error"};function Q(s,y,v,o,I,S){return c(),r("div",z,[E,o.filterActiveSystems?(c(),r("div",q,[(c(!0),r(_,null,g(o.filterActiveSystems,p=>(c(),r(_,null,[(c(!0),r(_,null,g(p,t=>{var l;return c(),r(_,null,[t!=null&&t.IsActive?(c(),r("div",{key:0,class:x(["list-item",{"list-item_active":((l=o.paymentSystem)==null?void 0:l.id)===(t==null?void 0:t.ID)}]),onClick:f=>{o.paymentSystem={id:t==null?void 0:t.ID,type:t==null?void 0:t.Source},o.selectPaymentSystem()}},[m("img",{class:"list-item__image",src:t==null?void 0:t.Image},null,8,H),m("div",J,D(t==null?void 0:t.Description),1)],10,G)):C("",!0)],64)}),256))],64))),256))])):C("",!0),m("div",K,D(o.errorMessage),1)])}const T={components:{ButtonDefault:O},props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(s,{emit:y}){const v=b(),o=R(),I=V(),S=F("emitter"),p=k(null);L(),N();const t=h(()=>v.ConfigList),l=k(null),f=h(()=>{var d;const n=t.value,i=(d=s.data)==null?void 0:d.ContractPaymentSystems;return n!=null&&n.PaymentSystems&&i?Object.keys(n.PaymentSystems).filter(e=>i.includes(e)).map(e=>{var u;const a=n.PaymentSystems[e];return String(a==null?void 0:a.IsActive)==="1"?(u=a.Collations)==null?void 0:u.slice().sort((B,M)=>parseInt(B.SortID)-parseInt(M.SortID)):null}).filter(e=>e!==null):null});function P(){var n,i,d;console.log("Props systems",(n=s.data)==null?void 0:n.ContractPaymentSystems),l.value!==null&&o.InvoiceMake({ContractID:(i=s.data)==null?void 0:i.ItemID,PaymentSystemID:(d=l.value)==null?void 0:d.type}).then(e=>{if(e.status==="success"&&e.data&&e.data.InvoiceID){y("modalClose");const a=e.data.InvoiceID;I.InvoiceDocument({InvoiceID:a}).then(u=>{S.emit("open-modal",{component:"InvoiceDocumentBasket",data:{html:u,ID:a}})})}else y("modalClose")})}return{getConfig:t,errorMessage:p,filterActiveSystems:f,selectPaymentSystem:P,paymentSystem:l}}},tt=j(T,[["render",Q],["__scopeId","data-v-66596283"]]);export{tt as default};
