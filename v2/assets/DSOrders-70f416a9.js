import{j as A,o as u,c as h,a as c,b as l,w as f,d as g,t as V,F as U,v as N,k as R,x as P,_ as T,p as G,l as q,r as H,R as J,g as M}from"./index-4434f005.js";import{u as K}from"./dedicatedServer-a39a43a4.js";import{u as Q}from"./contracts-d017d511.js";import{I as W}from"./IconSearch-d168a9f9.js";import{_ as X}from"./HelperComponent-e4e3ffbd.js";import{S as j}from"./StatusBadge-129e5649.js";import{I as Y}from"./IconRotate-e3e90678.js";import{u as Z}from"./resetServer-d0ed57a3.js";import{z as $,k as ee,d as te}from"./bootstrap-vue-next.es-5d8af788.js";import{_ as oe}from"./IconDots-a0319d0c.js";import{_ as se}from"./IconCard-285cc6ac.js";import{_ as ne}from"./OrderIDBadge-4cc1db15.js";import{S as ae}from"./Select2-bf6aa49e.js";import{s as re}from"./multiselect-eb561fe9.js";import{_ as E}from"./FormInputSearch-29c276f6.js";import{B as F}from"./BlockBalanceAgreement-4e844242.js";import{u as le}from"./globalActions-e617f474.js";import{E as ce}from"./EmptyStateBlock-927727c9.js";import{_ as de}from"./ClausesKeeper-68df7f35.js";import"./ButtonDefault-f91c301e.js";import"./IconArrow-6847c901.js";import"./IconPlus-6c2cbbce.js";import"./IconClose-0cfbf563.js";const ie={class:"hosting-item"},_e={class:"hosting-item__row"},ue={class:"hosting-item__row"},me={class:"hosting-item__person"},fe={key:0,class:"hosting-item__row"},De={class:"hosting-item__list"},ve=["innerHTML"],pe={class:"hosting-item__controls"},Ie={key:0,class:"btn btn--md btn--border btn--rotate btn--rotate_green"},ge={class:"btn btn--dots"};function he(r,s,a,o,p,S){var C,d,O,t,e,_,B;const n=ne,i=A("router-link"),v=j,w=A("Helper"),L=se,y=oe,D=$,b=ee,k=te;return u(),h("div",ie,[c("div",_e,[l(n,{orderID:(C=a.itemData)==null?void 0:C.OrderID},null,8,["orderID"]),l(i,{class:"hosting-item__name",to:`/DSOrders/${a.itemData.OrderID}`},{default:f(()=>[g(V(a.itemData.IP),1)]),_:1},8,["to"]),l(v,{status:(d=a.itemData)==null?void 0:d.StatusID,DaysRemainded:(O=a.itemData)==null?void 0:O.DaysRemainded,"status-table":"DSOrders"},null,8,["status","DaysRemainded"])]),c("div",ue,[c("div",me,V((t=a.itemData)==null?void 0:t.Customer),1),l(w,{"user-notice":(e=a.itemData)==null?void 0:e.UserNotice,id:(_=a.itemData)==null?void 0:_.OrderID,position:a.isLast?"bottom":"top",emit:"updateDSOrdersList"},null,8,["user-notice","id","position"])]),a.params.length?(u(),h("div",fe,[c("ul",De,[(u(!0),h(U,null,N(a.params,I=>(u(),h("li",{innerHTML:I},null,8,ve))),256))])])):R("",!0),c("div",pe,[((B=a.itemData)==null?void 0:B.StatusID)==="Active"?(u(),h("div",Ie,"Включен")):R("",!0),c("div",{class:"btn btn--md btn--bold",onClick:s[0]||(s[0]=I=>{var m;return r.$router.push(`/DSOrderPay/${(m=a.itemData)==null?void 0:m.OrderID}`)})},[l(L),g("Оплатить")]),l(k,{class:"dropdown-dots",right:""},{"button-content":f(()=>[c("div",ge,[l(y)])]),default:f(()=>{var I;return[l(D,null,{default:f(()=>{var m;return[l(i,{to:`DSOrders/${(m=a.itemData)==null?void 0:m.OrderID}`},{default:f(()=>[g("Дополнительная информация")]),_:1},8,["to"])]}),_:1}),((I=a.itemData)==null?void 0:I.StatusID)==="Active"?(u(),P(D,{key:0,onClick:s[1]||(s[1]=m=>o.serverReset())},{default:f(()=>[g("Перезагрузить")]),_:1})):R("",!0),l(D,{onClick:s[2]||(s[2]=m=>o.transferAccount())},{default:f(()=>[g("Передать на другой аккаунт")]),_:1}),l(D,{onClick:s[3]||(s[3]=m=>o.orderManage())},{default:f(()=>[g("Управлять заказом")]),_:1}),l(b),l(D,{class:"color-red",onClick:s[4]||(s[4]=m=>o.deleteItem())},{default:f(()=>[g("Удалить")]),_:1})]}),_:1})])])}const Se={components:{StatusBadge:j,IconRotate:Y,Helper:X},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","manage"],setup(r,{emit:s}){function a(){var n;Z().ServerReset((n=r.itemData)==null?void 0:n.ID)}function o(){var n;s("delete",(n=r.itemData)==null?void 0:n.ID)}function p(){var n,i;s("transfer",{ServiceOrderID:(n=r.itemData)==null?void 0:n.ID,ServiceID:(i=r.itemData)==null?void 0:i.ServiceID})}function S(){var n,i,v;s("manage",{ServiceOrderID:(n=r.itemData)==null?void 0:n.ID,ServiceID:(i=r.itemData)==null?void 0:i.ServiceID,OrderID:(v=r.itemData)==null?void 0:v.OrderID})}return{deleteItem:o,serverReset:a,orderManage:S,transferAccount:p}}},z=T(Se,[["render",he],["__scopeId","data-v-0452d5e5"]]),Ce=r=>(G("data-v-6476733e"),r=r(),q(),r),be={class:"section"},ke={class:"container"},Oe={class:"section-header"},we={class:"section-title__nowrap"},Le=Ce(()=>c("h1",{class:"section-title"},"Выделенные серверы",-1)),ye={class:"list-form"},Be={class:"list-form_col list-form_col--sm"},Me={class:"list-form_select"},Pe={class:"multiselect-option"},Ae={key:0};function Ve(r,s,a,o,p,S){var b,k,C;const n=F,i=A("router-link"),v=de,w=A("Multiselect"),L=E,y=z,D=ce;return u(),h(U,null,[l(n),c("div",be,[c("div",ke,[c("div",Oe,[c("div",we,[Le,l(i,{class:"btn btn--blue btn-default",to:"DSSchemes"},{default:f(()=>[g("Заказать")]),_:1})])]),l(v,{partition:"Header:/DSOrders"}),c("div",ye,[c("div",Be,[c("div",Me,[l(w,{modelValue:o.select,"onUpdate:modelValue":s[0]||(s[0]=d=>o.select=d),options:o.getUsers,disabled:((b=o.getUsers)==null?void 0:b.length)<=1,label:"name"},{option:f(({option:d})=>[c("div",Pe,"# "+V(d.value.padStart(5,"0"))+" / "+V(d.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l(L,{modelValue:o.search,"onUpdate:modelValue":s[1]||(s[1]=d=>o.search=d)},null,8,["modelValue"])]),o.getDSList&&((k=o.getDSList)==null?void 0:k.length)>0?(u(),h("div",Ae,[o.filterProducts&&((C=o.filterProducts)==null?void 0:C.length)>0?(u(!0),h(U,{key:0},N(o.filterProducts,(d,O)=>(u(),P(y,{params:o.getDSItemParam(d),"is-last":O===o.filterProducts.length-1,"item-data":d,onDelete:o.deleteItem,onTransfer:o.transferItem,onManage:o.orderManage},null,8,["params","is-last","item-data","onDelete","onTransfer","onManage"]))),256)):(u(),P(D,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(u(),P(D,{key:1,class:"no-margin",label:"У Вас нет заказов на выделенные серверы"}))])])],64)}const Re={components:{FormInputSearch:E,IconSearch:W,Select2:ae,Multiselect:re,DSItem:z,BlockBalanceAgreement:F},async setup(){const r=H("*"),s=H(null),a=le(),o=K(),p=Q(),S=J("emitter");S.on("updateDSOrdersList",()=>{o.fetchDSOrders()});const n=M(()=>{var t;return(t=Object.keys(o==null?void 0:o.DSList).map(e=>o==null?void 0:o.DSList[e]))==null?void 0:t.reverse()}),i=M(()=>o==null?void 0:o.DSSchemes),v=M(()=>p==null?void 0:p.contractsList),w=M(()=>y(L(n.value)));function L(t){return r.value!=="*"?t.filter(e=>(e==null?void 0:e.ContractID)===r.value):t}function y(t){return s.value!==null?t.filter(e=>(e==null?void 0:e.Customer.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.OrderID.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.Scheme.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.IP.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.disks.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.CPU.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.ram.toLowerCase().includes(s.value.toLowerCase()))):t}function D(t){a.OrderManage(t)}const b=M(()=>{let t=[{value:"*",name:"Все договора"}];return n.value!==null&&v.value!==null?(Object.keys(n.value).forEach(e=>{var _,B,I;t.find(m=>{var x;return m.value===((x=n.value[e])==null?void 0:x.ContractID)})||t.push({value:(_=n.value[e])==null?void 0:_.ContractID,name:(I=v.value[(B=n.value[e])==null?void 0:B.ContractID])==null?void 0:I.Customer})}),t):{value:"*",name:"Все договора"}});function k(t){let e=C(t==null?void 0:t.SchemeID);e===void 0&&(e=t);let _=[];return t!=null&&t.Scheme&&_.push(t==null?void 0:t.Scheme),t!=null&&t.CPU&&_.push(t==null?void 0:t.CPU),e!=null&&e.ram&&_.push("RAM "+(e==null?void 0:e.ram)+" GB"),e!=null&&e.disks&&_.push(e==null?void 0:e.disks),e!=null&&e.CostMonth&&_.push("<b>"+(e==null?void 0:e.CostMonth)+"/ месяц</b>"),_}function C(t){var e;return(e=i.value)==null?void 0:e[t]}function d(t){S.emit("open-modal",{component:"DeleteItem",data:{id:t,message:"Вы действительно хотите удалить этот сервер?",tableID:"DSOrders",successEmit:"updateDSOrdersList"}})}function O(t){S.emit("open-modal",{component:"OrdersTransfer",data:t})}return await o.fetchDSOrders(),await o.fetchDSSchemes(),await p.fetchContracts(),{getDSList:n,filterProducts:w,select:r,search:s,getUsers:b,getDSSchemes:i,getDSItemParam:k,orderManage:D,deleteItem:d,transferItem:O}}},nt=T(Re,[["render",Ve],["__scopeId","data-v-6476733e"]]);export{nt as default};
