import{o as O,c as L,a as r,t as u,b as h,w as c,d as b,p as M,l as N,_ as U,r as i,g as y,h as V,a2 as F}from"./index-83b4b7ba.js";import{S as f}from"./StatusBadge-0d170ac0.js";import{P as k}from"./PaginationBlock-e9f2bc51.js";import{C as A}from"./bootstrap-vue-next.es-8f3ae81a.js";import"./multiselect-f2568231.js";const R=[{key:"StatusDate",label:"Дата изменения",headerTitle:"Дата изменения",variant:"td-gray td-order",sortable:!0},{key:"StatusID",label:"Статус",headerTitle:"Статус",variant:"td-blue",sortable:!0},{key:"Initiator",label:"Инициатор",headerTitle:"Инициатор",variant:"td-gray td-order"},{key:"Comment",label:"Комментарий",headerTitle:"Комментарий",variant:"td-gray td-order"}],I=d=>(M("data-v-9a9ca88b"),d=d(),N(),d),j={class:"modal__body"},G={class:"list-item__title"},W={class:"statuses-list"},Y=I(()=>r("span",{class:"td-mobile"},"Дата изменения",-1)),q={class:"td-column-heavy"},z={class:"table-td-gray"},J=I(()=>r("span",{class:"td-mobile"},"Статус",-1)),K=I(()=>r("span",{class:"td-mobile"},"Инициатор",-1)),Q={class:"td-column-heavy"},X={class:"table-td-gray"},Z=I(()=>r("span",{class:"td-mobile"},"Комментарий",-1)),$={class:"td-column-heavy"},tt={class:"table-td-gray"};function et(d,l,m,a,D,v){var n,_;const S=f,p=A,g=k;return O(),L("div",j,[r("div",G,"История изменений: "+u(a.renameMode((n=m.data)==null?void 0:n.modeID))+", #"+u((_=m.data)==null?void 0:_.rowID),1),r("div",W,[h(p,{class:"basic-table",items:a.STATUSES_LIST,fields:d.statusesHistoryFields,"show-empty":!0,filterable:[],"per-page":a.per_page,"sort-desc":a.sortDesc,"onUpdate:sortDesc":l[0]||(l[0]=s=>a.sortDesc=s),"sort-by":a.sortBy,"onUpdate:sortBy":l[1]||(l[1]=s=>a.sortBy=s),"sort-direction":a.sortDirection,"current-page":a.current_page,"empty-text":"У вас пока нет истории статусов.","empty-filtered-text":"Статус не найден."},{"head(StatusDate)":c(()=>[b("Дата изменения")]),"head(StatusID)":c(()=>[b("Статус")]),"head(Initiator)":c(()=>[b("Инициатор")]),"head(Comment)":c(()=>[b("Комментарий")]),"cell(StatusDate)":c(s=>{var o;return[Y,r("div",q,[r("div",z,u(a.formatDate((o=s.item)==null?void 0:o.StatusDate)),1)])]}),"cell(StatusID)":c(s=>{var o;return[J,h(S,{status:(o=s.item)==null?void 0:o.StatusID,"status-table":a.modeID},null,8,["status","status-table"])]}),"cell(Initiator)":c(s=>{var o;return[K,r("div",Q,[r("div",X,u((o=s.item)==null?void 0:o.Initiator),1)])]}),"cell(Comment)":c(s=>{var o;return[Z,r("div",$,[r("div",tt,u((o=s.item)==null?void 0:o.Comment),1)])]}),_:1},8,["items","fields","per-page","sort-desc","sort-by","sort-direction","current-page"]),h(g,{total_rows:a.FILTERED_LIST_LENGTH,onUpdatePage:a.updatePage},null,8,["total_rows","onUpdatePage"])])])}const at={components:{StatusBadge:f,statusesHistoryFields:R,PaginationBlock:k},props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(d,{emit:l}){const m=i("StatusDate"),a=i(!0),D=i("desc"),v=i(10),S=i(1),p=y(()=>d.data.modeID),g=y(()=>d.data.rowID),n=i({}),_=y(()=>n.value?Object.keys(n.value).map(e=>n.value[e]).reverse().map(e=>({StatusDate:e.StatusDate,StatusID:e.StatusID,Initiator:e.Initiator,Comment:e.Comment})):[]),s=y(()=>{var e;return(e=_.value)==null?void 0:e.length}),o=async()=>{const e=`/API/v2/StatusesHistory?ModeID=${p.value}&RowID=${g.value}`;try{const t=await F.get(e);t&&t.data?n.value=t.data:n.value={}}catch(t){console.error(t),n.value={}}};o();function T(e){let t="";switch(e){case"HostingOrders":t="Хостинг";break;case"DomainOrders":t="Домен";break;case"DSOrders":t="Выделенный сервер";break;case"VPSOrders":t="VPS/VDS Сервер";break;case"ExtraIPOrders":t="IP адрес";break;case"ISPswOrders":t="Лицензия ISPsystem";break;case"DNSmanagerOrders":t="Вторичный DNS";break;case"Contracts":t="Договор";break;case"Profiles":t="Профиль";break;case"Invoices":t="Счёт на оплату";break;case"Edesks":t="Тикет";break}return t}function w(e={}){v.value=e==null?void 0:e.per_page,S.value=e==null?void 0:e.current_page}function P(e){const t=new Date(e*1e3),C=t.getDate().toString().padStart(2,"0"),E=(t.getMonth()+1).toString().padStart(2,"0"),B=t.getFullYear().toString(),H=t.getHours().toString().padStart(2,"0"),x=t.getMinutes().toString().padStart(2,"0");return`${C}.${E}.${B} ${H}:${x}`}return V(()=>{console.log(s)}),{getStatusesHistory:o,STATUSES_LIST:_,FILTERED_LIST_LENGTH:s,sortBy:m,sortDesc:a,sortDirection:D,per_page:v,current_page:S,modeID:p,rowID:g,updatePage:w,formatDate:P,renameMode:T}}},ct=U(at,[["render",et],["__scopeId","data-v-9a9ca88b"]]);export{ct as default};
