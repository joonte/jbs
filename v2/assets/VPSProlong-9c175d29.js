import{E as X}from"./EmptyStateBlock-927727c9.js";import{_ as Z}from"./ButtonDefault-f91c301e.js";import{_ as ee}from"./BlockOrderPayBalance-7d46609b.js";import{_ as te}from"./ClausesKeeper-68df7f35.js";import{_ as oe,e as se,a7 as ae,r as k,g as f,ag as g,o as u,c as d,b as p,a as t,F as y,t as c,v as ce,k as le,Y as U,ae as Y,p as ne,l as re}from"./index-4434f005.js";import{u as _e}from"./vps-a29a78bf.js";import{u as ie}from"./contracts-d017d511.js";import{B as ue}from"./BlockBalanceAgreement-4e844242.js";import"./bootstrap-vue-next.es-5d8af788.js";import"./IconHelp-d8ebd424.js";import"./globalActions-e617f474.js";import"./BasicInput-50e80b39.js";import"./component2-53fb8201.js";import"./component-6f0e2102.js";import"./IconClose-0cfbf563.js";import"./IconArrow-6847c901.js";const V=v=>(ne("data-v-e90f75f8"),v=v(),re(),v),de={key:0,class:"vps-scheme-page"},pe={class:"section"},ve={class:"container"},me=V(()=>t("div",{class:"section-header"},[t("h1",{class:"section-title"},"Оплата заказа VPS/VDS сервера")],-1)),he={class:"section"},Se={class:"container"},fe={class:"total-block"},be={class:"total-block__row divider-bottom"},ke=V(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),ge={class:"total-block__col"},ye={class:"total-block__row no-divider"},Ve={class:"total-block__col"},De={class:"total-block__col"},Pe={class:"total-block__row total-block__row--big economy-line"},Be=V(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),Ie={class:"total-block__col flex-col"},we={class:"red"},Ce={class:"total-block__row total-block__row--big"},Ee={class:"total-block__col"},xe={class:"total-block__col"},Oe={key:1,class:"section"},Fe={class:"container"},Le={__name:"VPSProlong",async setup(v){let n,r;const l=_e(),D=ie(),P=se(),q=ae(),o=k(null),m=k(null),b=k(!1),z=f(()=>Object.keys(l.vpsSchemes).map(e=>l.vpsSchemes[e])),h=f(()=>Object.keys(l.vpsList).map(e=>l.vpsList[e]).find(e=>e.OrderID===q.params.id)),G=f(()=>D.contractsList),J=f(()=>z.value.find(e=>{var s;return(e==null?void 0:e.ID)===((s=h.value)==null?void 0:s.SchemeID)}));function S(e){return Number(e).toFixed(2)||0}function B(){var s,_;let e=0;return(_=(s=o.value)==null?void 0:s.discounts)==null||_.Bonuses.map(i=>{e+=+i.Economy}),e}function M(e){o.value=e}function Q(){var e,s;b.value=!0,l.VPSOrderPay({VPSOrderID:(e=h.value)==null?void 0:e.ID,DaysPay:(s=o.value)==null?void 0:s.actualDays,IsChange:!0}).then(_=>{let{result:i,error:I}=_;i==="SUCCESS"?P.push("/VPSOrders"):i==="BASKET"&&P.push("/Basket"),b.value=!0})}return[n,r]=g(()=>l.fetchVPSSchemes()),await n,r(),[n,r]=g(()=>D.fetchContracts()),await n,r(),[n,r]=g(()=>l.fetchVPS().then(()=>{var e;m.value=(e=h.value)==null?void 0:e.ContractID})),await n,r(),(e,s)=>{var w,C,E,x,O,F,L,N,A,T,$,j,R,H,K;const _=te,i=ee,I=Z,W=X;return u(),d(y,null,[p(ue),h.value?(u(),d("div",de,[t("div",pe,[t("div",ve,[me,p(_,{partition:"Header:/VPSSchemes"})])]),p(i,{contractID:m.value,scheme:J.value,serviceID:"30000",isOrderID:!1,onSelect:M},null,8,["contractID","scheme"]),t("div",he,[t("div",Se,[t("div",fe,[((E=(C=(w=o.value)==null?void 0:w.discounts)==null?void 0:C.Bonuses)==null?void 0:E.length)>0?(u(),d(y,{key:0},[t("div",be,[ke,t("div",ge,c(S((x=o.value)==null?void 0:x.price))+" ₽",1)]),(u(!0),d(y,null,ce((F=(O=o.value)==null?void 0:O.discounts)==null?void 0:F.Bonuses,a=>(u(),d("div",ye,[t("div",Ve,"Скидка "+c(a==null?void 0:a.Discount)+"% на "+c(a==null?void 0:a.Days)+" дней",1),t("div",De,"-"+c(S(a==null?void 0:a.Economy))+" ₽",1)]))),256))],64)):le("",!0),U(t("div",Pe,[Be,t("div",Ie,[t("span",null,[t("s",null,c(S((L=o.value)==null?void 0:L.price))+" ₽",1)]),t("span",we,"-"+c(B())+" ₽",1)])],512),[[Y,((T=(A=(N=o.value)==null?void 0:N.discounts)==null?void 0:A.Bonuses)==null?void 0:T.length)>0]]),U(t("div",Ce,[t("div",Ee,"Итого за "+c(($=o.value)==null?void 0:$.label),1),t("div",xe,c(S(((j=o.value)==null?void 0:j.price)-B()))+" ₽",1)],512),[[Y,(R=o.value)==null?void 0:R.price]])]),p(I,{class:"btn--wide",label:((H=G.value[m.value])==null?void 0:H.Balance)>((K=o.value)==null?void 0:K.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:o.value===null||m.value===null,"is-loading":b.value,onClick:s[0]||(s[0]=a=>Q())},null,8,["label","disabled","is-loading"])])])])):(u(),d("div",Oe,[t("div",Fe,[p(W,{label:"Заказ VPS/VDS сервера не найден"})])]))],64)}}},We=oe(Le,[["__scopeId","data-v-e90f75f8"]]);export{We as default};
