import{E as le}from"./EmptyStateBlock-68a1c33e.js";import{_ as ce}from"./BlockOrderPayBalance-6a44874e.js";import{_ as ne}from"./ClausesKeeper-55c14b7f.js";import{_ as ie}from"./ButtonDefault-dc248ec6.js";import{_ as re,a7 as _e,e as de,r as Y,g as D,h as ue,ag as B,o as r,c as _,b as d,a as o,t as i,F as P,x as ve,Z as ee,ae as oe,k as pe,p as me,l as he}from"./index-83b4b7ba.js";import{u as be}from"./contracts-623ec7a8.js";import{u as ke}from"./services-c044aff2.js";/* empty css                                                                             */import{B as Se}from"./BlockBalanceAgreement-c5fad736.js";import"./bootstrap-vue-next.es-8f3ae81a.js";import"./IconHelp-c62d5911.js";import"./globalActions-633eb799.js";import"./BasicInput-3f1e9fd6.js";import"./component-abb1f5a9.js";import"./IconClose-86aafc4e.js";import"./IconArrow-80c72216.js";const se=y=>(me("data-v-10b0b7b9"),y=y(),he(),y),ye={key:0,class:"hosting-sheme"},Ie={class:"section"},fe={class:"container"},ge={class:"section-header"},we={class:"section-header__wrapper"},De={class:"section-title"},Be={class:"section-label"},Pe={key:0,class:"section"},Ce={class:"container"},Oe={class:"total-block"},xe={class:"total-block__row divider-bottom"},Ne=se(()=>o("div",{class:"total-block__col"},"Цена тарифа",-1)),Ae={class:"total-block__col"},Ee={class:"total-block__row no-divider"},Fe={class:"total-block__col"},Le={class:"total-block__col"},Re={class:"total-block__row total-block__row--big economy-line"},Me=se(()=>o("div",{class:"total-block__col red"},"Выгода",-1)),Ue={class:"total-block__col flex-col"},Ve={class:"red"},$e={class:"total-block__row total-block__row--big"},je={class:"total-block__col"},Te={class:"total-block__col"},qe={key:1,class:"section"},Ze={class:"container"},ze={key:1,class:"section"},Ge={class:"container"},He={__name:"AdditionalServicesProlongCode",async setup(y){let u,v;const C=be(),a=ke(),te=_e(),O=de(),s=Y(null),I=Y(!1),c=D(()=>Object.keys(a==null?void 0:a.ISPswOrdersList).map(t=>a==null?void 0:a.ISPswOrdersList[t]).find(t=>t.OrderID===te.params.id)),m=D(()=>{var t;return(t=a==null?void 0:a.additionalServicesScheme)!=null&&t.ISPsw?Object.keys(a.additionalServicesScheme.ISPsw).map(l=>{const e=a.additionalServicesScheme.ISPsw[l];return{...e,value:e==null?void 0:e.ID,name:e==null?void 0:e.Name,cost:e==null?void 0:e.CostDay,month:e==null?void 0:e.CostMonth}}).filter(l=>{var e;return(l==null?void 0:l.ID)==((e=c.value)==null?void 0:e.SchemeID)}):[]}),w=D(()=>C.contractsList);function x(){var p,g,h,b,k;I.value=!0;const t=((p=w.value[c.ContractID])==null?void 0:p.Balance)>((g=s==null?void 0:s.value)==null?void 0:g.price)||((h=m.value[0])==null?void 0:h.cost)==="0.00"&&((b=m.value[0])==null?void 0:b.month)==="0.00",l=!t,e={ISPswOrderID:c.value.ID,DaysPay:(k=s.value)==null?void 0:k.actualDays,IsNoBasket:t,IsUseBasket:l,PayMessage:""};a.ISPswOrderPay(e).then(S=>{S==="UseBasket"?O.push("/Basket"):S==="NoBasket"?O.push("/AdditionalServices"):console.error("Ошибка оплаты заказа"),I.value=!0})}function f(t){return Number(t).toFixed(2)||0}function N(){var l,e;let t=0;return(e=(l=s.value)==null?void 0:l.discounts)==null||e.Bonuses.map(p=>{t+=+p.Economy}),t}function ae(t){s.value=t}return ue(()=>{a.fetchAdditionalServiceScheme("ISPsw"),console.log("Orders ",c),console.log("Scheme ",m[0])}),[u,v]=B(()=>a.fetchISPswOrders()),await u,v(),[u,v]=B(()=>a.fetchAdditionalServiceScheme("ISPsw")),await u,v(),[u,v]=B(()=>C.fetchContracts()),await u,v(),(t,l)=>{var b,k,S,A,E,F,L,R,M,U,V,$,j,T,q,Z,z,G,H,J,K,Q,W,X;const e=ie,p=ne,g=ce,h=le;return r(),_(P,null,[d(Se),c.value?(r(),_("div",ye,[o("div",Ie,[o("div",fe,[o("div",ge,[o("div",we,[o("h1",De,"Оплата заказа ПО ISPsystem, "+i(((b=c.value)==null?void 0:b.IP)||""),1),d(e,{class:"btn--wide",label:((k=w.value[c.value.ContractID])==null?void 0:k.Balance)>((S=s.value)==null?void 0:S.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:s.value===null||((A=s.value)==null?void 0:A.price)===null,"is-loading":I.value,onClick:l[0]||(l[0]=n=>x())},null,8,["label","disabled","is-loading"])]),o("div",Be,i((E=m.value[0])==null?void 0:E.Name),1)])]),d(p)]),d(g,{contractID:(F=c.value)==null?void 0:F.ContractID,daysRemainded:(L=c.value)==null?void 0:L.DaysRemainded,serviceID:"51000",scheme:m.value[0],orderID:(R=c.value)==null?void 0:R.OrderID,isOrderID:!0,onSelect:ae},null,8,["contractID","daysRemainded","scheme","orderID"]),c.value?(r(),_("div",Pe,[o("div",Ce,[o("div",Oe,[((V=(U=(M=s.value)==null?void 0:M.discounts)==null?void 0:U.Bonuses)==null?void 0:V.length)>0?(r(),_(P,{key:0},[o("div",xe,[Ne,o("div",Ae,i(f(($=s.value)==null?void 0:$.price))+" ₽",1)]),(r(!0),_(P,null,ve((T=(j=s.value)==null?void 0:j.discounts)==null?void 0:T.Bonuses,n=>(r(),_("div",Ee,[o("div",Fe,"Скидка "+i(n==null?void 0:n.Discount)+"% на "+i(n==null?void 0:n.Days)+" дней",1),o("div",Le,"-"+i(f(n==null?void 0:n.Economy))+" ₽",1)]))),256)),ee(o("div",Re,[Me,o("div",Ue,[o("span",null,[o("s",null,i(f((q=s.value)==null?void 0:q.price))+" ₽",1)]),o("span",Ve,"-"+i(N())+" ₽",1)])],512),[[oe,((G=(z=(Z=s.value)==null?void 0:Z.discounts)==null?void 0:z.Bonuses)==null?void 0:G.length)>0]]),ee(o("div",$e,[o("div",je,"Итого за "+i((H=s.value)==null?void 0:H.label),1),o("div",Te,i(f(((J=s.value)==null?void 0:J.price)-N()))+" ₽",1)],512),[[oe,(K=s.value)==null?void 0:K.price]])],64)):pe("",!0)]),d(e,{class:"btn--wide",label:((Q=w.value[c.value.ContractID])==null?void 0:Q.Balance)>((W=s.value)==null?void 0:W.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:s.value===null||((X=s.value)==null?void 0:X.price)===null,"is-loading":I.value,onClick:l[1]||(l[1]=n=>x())},null,8,["label","disabled","is-loading"])])])):(r(),_("div",qe,[o("div",Ze,[d(h,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(r(),_("div",ze,[o("div",Ge,[d(h,{label:"не удалось найти заказ хостинга"})])]))],64)}}},_o=re(He,[["__scopeId","data-v-10b0b7b9"]]);export{_o as default};
