import{_ as T}from"./ButtonDefault-dafa6215.js";import{_ as j}from"./BasicInput-df2ac90e.js";import{u as A,g as P,U,r as _,h as c,i as y,o as J,c as O,a as u,b,N as $}from"./index-c781268b.js";import{s as R}from"./multiselect-9a74535b.js";import"./component-d2f2a50c.js";const K={class:"modal__body"},L=u("div",{class:"list-item__title"},"Новый контакт",-1),W={class:"modal__input-row"},F={class:"profile-info__item"},H={class:"profile-info__item wrap-item"},q={class:"profile-info__item"},ee={__name:"ModalWindowCreateContact",emits:["modalClose","buttonClicked"],setup(z,{emit:M}){const g=A(),m=P();U("emitter");const p=_(""),i=_(""),V=_({}),B=_({Name:"",Sign:""}),l=c(()=>m.userInfo),v=c(()=>{var e,t;return(t=(e=g.ConfigList)==null?void 0:e.Notifies)==null?void 0:t.Methods}),E=c(()=>{var e;return Object.keys((e=l.value)==null?void 0:e.Contacts).map(t=>{var a,n,s,d,r;if(!((s=(n=(a=l.value)==null?void 0:a.Contacts)==null?void 0:n[t])!=null&&s.IsHidden))return(r=(d=l.value)==null?void 0:d.Contacts)==null?void 0:r[t]}).filter(Boolean)}),h=c(()=>Object.keys(v.value).filter(e=>v.value[e].IsActive==="1").map(e=>({name:v.value[e].Name,value:e}))),o=c(()=>{var e,t;return(t=(e=g.ConfigList)==null?void 0:e.Messages)==null?void 0:t.Prompts}),x=e=>{switch(e){case"Email":const t=o.value.Email,a=/<B>Например:<\/B>\s*([^<]+)/,n=t.match(a);return n&&n[1]?`${n[1]}`:t;case"SMS":const s=o.value.SMS,d=/<B>Например:<\/B>\s*([^<]+)/,r=s.match(d);return r&&r[1]?`${r[1]}`:s;case"Jabber":const S=o.value.Jabber,I=/<B>Например:<\/B>\s*([^<]+)/,f=S.match(I);return f&&f[1]?`${f[1]}`:S;default:return"Ссылка или id"}},N=e=>{switch(e){case"Email":return o.value.Email;case"SMS":return o.value.SMS;case"Jabber":return o.value.Jabber;case"Telegram":return o.value.Telegram;case"Viber":return o.value.Viber;case"VKontakte":return o.value.VKontakte;default:return"Ссылка или id"}};function k(){M("modalClose")}function C(){let e={};E.value.forEach((t,a)=>{e[a]={...t,oldValue:t.Address}}),V.value=e,w()}function w(){var e,t,a;B.value={Name:(e=l.value)==null?void 0:e.Name,Email:(t=l.value)==null?void 0:t.Email,Sign:(a=l.value)==null?void 0:a.Sign}}C();function D(){const e={MethodID:i.value,Address:p.value,TimeBegin:"00",TimeEnd:"00",IsActive:"yes",ContactID:"0"};m.userEditContact(e).then(t=>{t.response==="SUCCESS"&&(m.fetchUserData().then(()=>{C()}),k())})}return y(()=>{m.OAuth()}),(e,t)=>{const a=j,n=T;return J(),O("div",K,[L,u("div",W,[u("div",F,[b($(R),{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),options:h.value,disabled:h.value.length<=1,label:"name",placeholder:"Тип адреса"},null,8,["modelValue","options","disabled"])]),u("div",H,[b(a,{name:"name",placeholder:x(i.value),vertical:"",modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=s=>p.value=s),title:N(i.value)},null,8,["placeholder","modelValue","title"])]),u("div",q,[b(n,{class:"profile-info__add-button",label:"Добавить контакт",onClick:D})])])])}}};export{ee as default};
