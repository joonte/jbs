import{_ as R,R as z,j as H,o as v,c as S,a as m,b as l,w as u,d as g,t as p,k as U,F as E,v as J,x as V,p as Q,l as W,e as X,r as j,g as A,i as Y}from"./index-01c72474.js";import{u as Z}from"./domain-b4e0f5d4.js";import{u as ee}from"./contracts-b8a59bf1.js";import{f as F,s as te}from"./useTimeFunction-8602dd60.js";import{I as ne}from"./IconSearch-411bb244.js";import{S as oe}from"./Select2-626bec96.js";import{s as ae}from"./multiselect-b3bc32a2.js";import{z as se,k as re,d as ie}from"./bootstrap-vue-next.es-44eeb912.js";import{_ as le}from"./OrderIDBadge-31863a40.js";import{_ as ce}from"./IconDots-b90ab2cc.js";import{_ as me}from"./IconCard-35ff8a4a.js";import{S as de}from"./StatusBadge-1436ac85.js";import{_ as ue}from"./HelperComponent-266443ae.js";import{_ as K}from"./ClausesKeeper-39926d40.js";import{B as q}from"./BlockBalanceAgreement-89ea0555.js";import{u as _e}from"./globalActions-8f995eb9.js";import{E as fe}from"./EmptyStateBlock-453d542f.js";import{_ as De}from"./FormInputSearch-45daa112.js";import{_ as pe}from"./ButtonDefault-6f60da99.js";import"./IconArrow-669aa41b.js";import"./IconClose-6051fe98.js";import"./IconPlus-404a795f.js";const ge={class:"hosting-item"},ve={class:"hosting-item__row"},he={class:"hosting-item__date"},Ie={class:"hosting-item__row"},ke={class:"hosting-item__person"},Oe={class:"hosting-item__row"},be={class:"hosting-item__list"},we={key:0},ye={key:1,class:"bold"},Ce={class:"hosting-item__controls"},Se={class:"btn btn--dots"},Le={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","designateOwner","manage"],setup(a,{emit:o}){const c=a,s=z("emitter");function h(i){if(!i)return F(new Date);const e=new Date,d=new Date(e.getTime()+i*24*60*60*1e3);return F(d)}function w(){var i,e;console.log((i=c.itemData)==null?void 0:i.ID),o("delete",(e=c.itemData)==null?void 0:e.ID)}function O(){var i,e,d;s.emit("open-modal",{component:"SendAuthInfo",data:{DomainOrderID:(i=c.itemData)==null?void 0:i.ID,Domain:(e=c.itemData)==null?void 0:e.Domain,AuthInfo:(d=c.itemData)==null?void 0:d.AuthInfo}})}function _(){var i,e;o("transfer",{ServiceOrderID:(i=c.itemData)==null?void 0:i.ID,ServiceID:(e=c.itemData)==null?void 0:e.ServiceID})}function y(){var i;o("designateOwner",{DomainOrderID:(i=c.itemData)==null?void 0:i.ID})}function L(){var i,e,d;o("manage",{ServiceOrderID:(i=c.itemData)==null?void 0:i.ID,ServiceID:(e=c.itemData)==null?void 0:e.ServiceID,OrderID:(d=c.itemData)==null?void 0:d.OrderID})}return(i,e)=>{var b,B,N,x,T,n,r,k,P,M;const d=le,I=H("router-link"),D=se,C=re,t=ie;return v(),S("div",ge,[m("div",ve,[l(d,{orderID:(b=a.itemData)==null?void 0:b.OrderID},null,8,["orderID"]),l(I,{class:"hosting-item__name",to:a.infoLink},{default:u(()=>{var f;return[g(p((f=a.itemData)==null?void 0:f.Domain),1)]}),_:1},8,["to"]),l(de,{status:(B=a.itemData)==null?void 0:B.StatusID,"status-table":"DomainOrders"},null,8,["status"]),m("div",he,"Дата окончания "+p(h((N=a.itemData)==null?void 0:N.DaysRemainded))+" | "+p(((x=a.itemData)==null?void 0:x.DaysRemainded)||0)+" дн.",1)]),m("div",Ie,[m("div",ke,p(a.userName),1),l(ue,{"user-notice":(T=a.itemData)==null?void 0:T.UserNotice,id:(n=a.itemData)==null?void 0:n.OrderID,position:a.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),m("div",Oe,[m("ul",be,[(r=a.scheme)!=null&&r.PackageID?(v(),S("li",we,p((k=a.scheme)==null?void 0:k.PackageID),1)):U("",!0),(P=a.scheme)!=null&&P.CostProlong?(v(),S("li",ye,p((M=a.scheme)==null?void 0:M.CostProlong)+" ₽",1)):U("",!0)])]),m("div",Ce,[m("button",{class:"btn btn--md btn--bold",onClick:e[0]||(e[0]=f=>{var $;return i.$router.push(`/DomainOrderPay/${($=a.itemData)==null?void 0:$.OrderID}`)})},[l(me),g("Оплатить")]),l(t,{class:"dropdown-dots",right:""},{"button-content":u(()=>[m("div",Se,[l(ce)])]),default:u(()=>[l(D,null,{default:u(()=>[l(I,{to:a.infoLink},{default:u(()=>[g("Дополнительная информация")]),_:1},8,["to"])]),_:1}),l(D,null,{default:u(()=>{var f;return[l(I,{to:`/DomainOrderPay/${(f=a.itemData)==null?void 0:f.OrderID}`},{default:u(()=>[g("Оплатить заказ")]),_:1},8,["to"])]}),_:1}),l(D,{onClick:e[1]||(e[1]=f=>y())},{default:u(()=>[g("Определить владельца")]),_:1}),l(D,{onClick:e[2]||(e[2]=f=>_())},{default:u(()=>[g("Передать на другой аккаунт")]),_:1}),l(D,{onClick:e[3]||(e[3]=f=>L())},{default:u(()=>[g("Управлять заказом")]),_:1}),l(D,{onClick:e[4]||(e[4]=f=>O())},{default:u(()=>[g("Ввести AuthInfo")]),_:1}),l(C),l(D,{class:"color-red",onClick:e[5]||(e[5]=f=>w())},{default:u(()=>[g("Удалить")]),_:1})]),_:1})])])}}},G=R(Le,[["__scopeId","data-v-8598d0fe"]]),Be=a=>(Q("data-v-4ff1d595"),a=a(),W(),a),Pe={class:"section"},Me={class:"container"},$e={class:"section-header"},Ae=Be(()=>m("h1",{class:"section-title"},"Домены",-1)),Ne={class:"btn__group"},xe={class:"list-form"},Te={class:"list-form_col list-form_col--sm"},Ve={class:"list-form_select"},Ue={class:"multiselect-option"},Ee={key:0};function je(a,o,c,s,h,w){var I,D,C;const O=q,_=pe,y=K,L=H("Multiselect"),i=De,e=G,d=fe;return v(),S(E,null,[l(O),m("div",Pe,[m("div",Me,[m("div",$e,[Ae,m("div",Ne,[l(_,{label:"Заказать",onClick:o[0]||(o[0]=t=>s.navigateToDomainSchemes())}),l(_,{label:"Перенести домен",onClick:o[1]||(o[1]=t=>s.openTransferModal())})])]),l(y,{partition:"Header:/DomainOrders"}),m("div",xe,[m("div",Te,[m("div",Ve,[l(L,{modelValue:s.select,"onUpdate:modelValue":o[2]||(o[2]=t=>s.select=t),options:s.getUsers,label:"name",disabled:((I=s.getUsers)==null?void 0:I.length)<=1},{singlelabel:u(({value:t})=>[m("span",null,"# "+p(t.value.padStart(5,"0"))+" / "+p(t.name),1)]),option:u(({option:t})=>[m("div",Ue,"# "+p(t.value.padStart(5,"0"))+" / "+p(t.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l(i,{modelValue:s.search,"onUpdate:modelValue":o[3]||(o[3]=t=>s.search=t)},null,8,["modelValue"])]),s.getDomainsList&&((D=s.getDomainsList)==null?void 0:D.length)>0?(v(),S("div",Ee,[s.filterProducts&&((C=s.filterProducts)==null?void 0:C.length)>0?(v(!0),S(E,{key:0},J(s.filterProducts,(t,b)=>(v(),V(e,{"item-data":t,"user-name":s.getUserName(t==null?void 0:t.ContractID),scheme:s.filterDomainScheme(t==null?void 0:t.SchemeID),"info-link":`/DomainOrders/${t==null?void 0:t.OrderID}`,"is-last":b===s.filterProducts.length-1,onDelete:s.deleteItem,onTransfer:s.transferItem,onDesignateOwner:B=>s.designateOwner(t==null?void 0:t.ID),onManage:s.orderManage},null,8,["item-data","user-name","scheme","info-link","is-last","onDelete","onTransfer","onDesignateOwner","onManage"]))),256)):(v(),V(d,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(v(),V(d,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}const Fe={components:{IconSearch:ne,DomainItem:G,Select2:oe,Multiselect:ae,ClausesKeeper:K,BlockBalanceAgreement:q},async setup(){const a=_e(),o=Z(),c=ee(),s=X(),h=z("emitter");h.on("updateDomainsList",()=>{o.fetchDomains()});const w=j("*"),O=j(null),_=A(()=>{var n;return(n=Object.keys(o==null?void 0:o.domainsList).map(r=>o==null?void 0:o.domainsList[r]))==null?void 0:n.reverse()}),y=A(()=>o==null?void 0:o.domainSchemes),L=A(()=>c==null?void 0:c.contractsList),i=A(()=>I(d(_.value))),e=A(()=>{let n=[{value:"*",name:"Все договора"}];return _.value!==null?(Object.keys(_.value).forEach(r=>{var k,P,M;n.find(f=>{var $;return f.value===(($=_.value[r])==null?void 0:$.ContractID)})||n.push({value:(k=_.value[r])==null?void 0:k.ContractID,name:(M=L.value[(P=_.value[r])==null?void 0:P.ContractID])==null?void 0:M.Customer})}),n):{value:"*",name:"Все договора"}});Y(()=>{_.value.length<1&&b()});function d(n){return w.value!=="*"?n.filter(r=>(r==null?void 0:r.ContractID)===w.value):n}function I(n){return O.value!==null?n.filter(r=>r==null?void 0:r.Domain.toLowerCase().includes(O.value.toLowerCase())):n}function D(n){var r;return(r=y.value)==null?void 0:r[n]}function C(n){var r,k;return(k=(r=c==null?void 0:c.contractsList)==null?void 0:r[n])==null?void 0:k.Customer}function t(n){a.OrderManage(n)}function b(){s.push({path:"/DomainSchemes"})}function B(n){h.emit("open-modal",{component:"DeleteItem",data:{id:n,message:`Вы действительно хотите удалить домен #${n}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function N(n){h.emit("open-modal",{component:"OrdersTransfer",data:n})}function x(){h.emit("open-modal",{component:"DomainTransfer",data:{}})}function T(n){const r={DomainOrderID:n};h.emit("open-modal",{component:"DomainSelectOwner",data:r})}return await o.fetchDomains(),await o.fetchDomainSchemes(),await c.fetchContracts(),await c.fetchProfiles(),{getDomainsList:_,getDomainsSchemes:y,getUsers:e,select:w,search:O,openTransferModal:x,filterProducts:i,getUserName:C,designateOwner:T,deleteItem:B,orderManage:t,filterDomainScheme:D,navigateToDomainSchemes:b,startFunction:te,transferItem:N}}},mt=R(Fe,[["render",je],["__scopeId","data-v-4ff1d595"]]);export{mt as default};
