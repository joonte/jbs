import{_ as ee}from"./ButtonDefault-CMw2aBy6.js";import{m as te}from"./bootstrap-vue-next-W16P-SAV.js";import{_ as le}from"./IconClip-DAey3Lid.js";import{_ as oe}from"./IconClose-Dia1noy8.js";import{_ as ae}from"./IconFile-ZfzHpv9u.js";import{_ as se}from"./InputSelect.vue_vue_type_script_setup_true_lang-D7E9_BoS.js";import{N as z,r as g,f as V,m as k,o as s,c as i,a as o,e as F,t as b,h as f,K as ne,Y as re,n as P,O as E,ao as ie,F as M,g as L,C as R,b as _,w as j}from"./index-Codq73aV.js";import{f as ue,_ as ce}from"./BasicInput-DeQAeyXe.js";import{d as de}from"./common-DyknwSqv.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as me}from"./files-B5cKv3cM.js";const pe={class:"tw-w-64 tw-mr-4 tw-mb-4"},fe={key:0,class:"tw-text-red-500"},_e={class:"form-field-input__wrapper"},ve=["name","placeholder"],ge={key:0,class:"tw-text-red-500 tw-mt-1"},xe={__name:"TextareaInput",props:E({label:{type:String,default:""},vertical:{type:Boolean,default:!1},name:{type:String,default:""},placeholder:{type:String,default:""},necessarily:{type:Boolean,default:!1},regexp:{type:String,default:null},regexpErrorMessage:{type:String,default:null},formatters:{type:String,default:""}},{modelValue:{type:[String,Number]},modelModifiers:{}}),emits:E(["input","error"],["update:modelValue"]),setup(n,{emit:D}){const d=n,u=z(n,"modelValue"),S=D,m=g(null),U=V(()=>{const a=!d.disabled&&(d.necessarily&&!m.value||d.regexp&&!h.value);return a?S("error",!0):S("error",!1),a}),x=V(()=>de(d.regexp)),h=V(()=>{if(!d.regexp||!m.value||!x.value)return!0;try{return x.value.test(m.value)}catch(a){return console.error(a),!0}});function w(){let a=m.value;a=ue(a,d.formatters),u.value=a}return k(u,a=>{m.value=a},{immediate:!0}),k(m,()=>{w()}),(a,y)=>(s(),i("label",{class:P([{"form-field__column":n.vertical},"form-field"])},[o("div",pe,[F(b(n.label)+" ",1),n.necessarily?(s(),i("span",fe,"*")):f("",!0)]),o("div",_e,[ne(o("textarea",{"onUpdate:modelValue":y[0]||(y[0]=T=>m.value=T),name:n.name,placeholder:n.placeholder,class:P(["tw-text-black tw-placeholder-gray-300",{"tw-border-red-500":U.value}]),onInput:w},null,42,ve),[[re,m.value]]),n.regexpErrorMessage&&!h.value?(s(),i("div",ge,b(n.regexpErrorMessage),1)):f("",!0)])],2))}},he=K(xe,[["__scopeId","data-v-deeff7c5"]]),we={key:0,class:"section-header inputs-block"},be={class:"section-block_title"},ye={key:3,class:"tw-flex tw-flex-col sm:tw-flex-row sm:tw-items-center tw-mb-4"},Ve={class:"tw-flex-none tw-w-64 tw-mr-4 tw-mb-4 sm:tw-mb-0"},ke={key:0,class:"tw-text-red-500"},Se={class:"tw-flex-1"},Te={class:"tw-mb-10 tw-max-w-[722px]"},Ie={key:0,class:"form-field form-field--file form-field--basic"},Ce={class:"chat-files"},Me={key:1,class:"form-field form-field--file form-field--basic"},Fe={class:"chat-files"},Ee=["onClick"],De={class:"form-field form-field--file form-field--basic"},Ue={class:"form-field-input__file-wrapper"},$e={class:"form-field-input__file"},Be=["innerHTML"],Le={__name:"ProfileForm",props:E({template:String,oldFileList:{type:Object,default:()=>({})},isLoading:Boolean,errorMessage:String},{modelValue:{},modelModifiers:{}}),emits:E(["send"],["update:modelValue"]),setup(n,{emit:D}){const d=n,u=z(n,"modelValue"),S=D,m=ie(),U=me(),x=g(!1),h=g(!1),w=g({}),a=g([]),y=g(null),T={},I={},$=new Set,A=g({...u.value}),W=V(()=>!x.value||!h.value),C=V(()=>m.data?.Profiles?.Templates?.[d.template]?.Template?.Attribs);k(()=>d.template,()=>{w.value={}}),k(C,()=>{for(const l in C.value){const e=C.value[l]?.Attribs?.CopyTo;e&&(T[l]=e,I[e]=!0)}},{immediate:!0}),k(u,l=>{for(const e in l){const c=l[e],B=A.value[e];if(c===B)continue;I[e]!==void 0&&($.has(e)||(I[e]=!1),$.delete(e));const v=T[e];v&&I[v]&&l[v]!==c&&($.add(v),u.value[v]=c),A.value[e]=c}},{deep:!0,flush:"sync"});function Y(l){a.value=a.value.filter((e,c)=>c!==l)}async function q(l){let e=l.target.files?.[0]||null;if(e){y.value.value="";const c=await U.sendFile(e);a.value.push({name:e?.name,value:c.slice(c.lastIndexOf("^")+1,c.length)})}}function G(l){return Object.entries(l).map(([e,c])=>({name:c,value:e}))}function N(l){return l?"<div>"+l.String+"</div>"+N(l.Parent):""}function J(){let l=new FormData;for(const e in u.value)l.append(e,u.value[e]);l.append("TemplateID",d.template),l.append("Agree",!0),l.append("AgreeHandle",!0);for(const e of a.value)e?.value&&l.append("Document[]",e.value);S("send",l)}return(l,e)=>{const c=ce,B=he,v=se,O=ae,Q=oe,X=le,H=te,Z=ee;return s(),i(M,null,[o("form",null,[(s(!0),i(M,null,L(C.value,(t,r)=>(s(),i("div",{key:r},[t.Title?(s(),i("div",we,[o("h2",be,b(t.Title),1)])):f("",!0),t.Type==="Input"?(s(),R(c,{key:1,modelValue:u.value[r],"onUpdate:modelValue":p=>u.value[r]=p,class:"special-form-input",label:t.Comment,placeholder:t.Example,necessarily:t.IsDuty,name:r,regexp:t.Check,"regexp-error-message":t.Message,formatters:t.Attribs.Formatters,onError:p=>w.value[r]=p},null,8,["modelValue","onUpdate:modelValue","label","placeholder","necessarily","name","regexp","regexp-error-message","formatters","onError"])):f("",!0),t.Type==="TextArea"?(s(),R(B,{key:2,modelValue:u.value[r],"onUpdate:modelValue":p=>u.value[r]=p,class:"special-form-input",label:t.Comment,placeholder:t.Example,necessarily:t.IsDuty,name:r,regexp:t.Check,"regexp-error-message":t.Message,formatters:t.Attribs.Formatters,onError:p=>w.value[r]=p},null,8,["modelValue","onUpdate:modelValue","label","placeholder","necessarily","name","regexp","regexp-error-message","formatters","onError"])):f("",!0),t.Type==="Select"?(s(),i("div",ye,[o("div",Ve,[F(b(t.Comment)+" ",1),t.IsDuty?(s(),i("span",ke," * ")):f("",!0)]),o("div",Se,[_(v,{modelValue:u.value[r],"onUpdate:modelValue":p=>u.value[r]=p,options:G(t.Options),class:"sm:tw-max-w-[450px]"},null,8,["modelValue","onUpdate:modelValue","options"])])])):f("",!0)]))),128))]),o("div",Te,[n.oldFileList.length?(s(),i("div",Ie,[o("div",Ce,[(s(!0),i(M,null,L(n.oldFileList,(t,r)=>(s(),i("div",{key:"old-"+r,class:"chat-files__item"},[o("span",null,[_(O,{class:"file-icon"})]),o("span",null,b(t?.name),1)]))),128))])])):f("",!0),a.value.length?(s(),i("div",Me,[o("div",Fe,[(s(!0),i(M,null,L(a.value,(t,r)=>(s(),i("div",{key:"new-"+r,class:"chat-files__item"},[o("span",null,[_(O,{class:"file-icon"})]),o("span",null,b(t?.name),1),o("button",{class:"close",onClick:p=>Y(r)},[_(Q)],8,Ee)]))),128))])])):f("",!0),o("label",De,[o("div",Ue,[o("input",{ref_key:"fileInput",ref:y,type:"file",onChange:q},null,544),o("div",$e,[_(X),e[2]||(e[2]=o("span",null,"Прикрепить документ подтверждающий личность",-1))])])]),_(H,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=t=>x.value=t),class:"rule-checkbox",name:"checkbox",checked:""},{default:j(()=>e[3]||(e[3]=[F(" Подтверждаю свое согласие на передачу информации в электроной форме (в том числе персональных данных) по открытым каналам связи сети Интернет ",-1)])),_:1,__:[3]},8,["modelValue"]),_(H,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=t=>h.value=t),class:"rule-checkbox",name:"checkbox",checked:""},{default:j(()=>e[4]||(e[4]=[F(" Я разрешаю передачу своих персональных данных третьим лицам, для выполнения заказанных мною услуг (регистрация доменов и т.п.) ",-1)])),_:1,__:[4]},8,["modelValue"]),n.errorMessage?(s(),i("div",{key:2,class:"error-message tw-max-w-[722px]",innerHTML:N(n.errorMessage)},null,8,Be)):f("",!0),_(Z,{disabled:W.value,"is-loading":n.isLoading,label:"Зарегистрировать",class:"tw-w-full",onClick:J},null,8,["disabled","is-loading"])])],64)}}},qe=K(Le,[["__scopeId","data-v-b58daf9c"]]);export{qe as _};
