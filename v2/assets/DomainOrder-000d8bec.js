import{j as Q,o as v,c as b,b as _,a as e,t as l,w as Y,d as $,y as tt,k as U,Z as et,$ as ot,F as st,p as it,l as nt,_ as at,a7 as rt,f as lt,e as ct,S as _t,r as W,g as R,i as mt}from"./index-4466e2da.js";import{u as dt}from"./domain-0e9ce7fa.js";import{u as ut}from"./contracts-44396072.js";import{f as V,a as Dt}from"./useTimeFunction-8602dd60.js";import{_ as vt}from"./IconCard-36c54c16.js";import{I as gt}from"./IconProfile-e370206c.js";import{I as ht}from"./IconSettings-fb89af55.js";import{_ as ft,a as pt}from"./ServicesContractBalanceBlock-da58ef57.js";import{S as J}from"./StatusBadge-b68990e4.js";import{B as K}from"./BlockBalanceAgreement-762408e5.js";import{E as It}from"./EmptyStateBlock-1f67284f.js";import{_ as bt}from"./ButtonDefault-18fa1414.js";import{_ as wt}from"./ClausesKeeper-f5a8709e.js";import"./bootstrap-vue-next.es-61f2820f.js";import"./IconArrow-1085f1dc.js";import"./IconClose-96271d50.js";const St={Waiting:{id:1,label:"Ожидание оплаты",color:"#459FD1",background:"#ADC1F04C"},ClaimForRegister:{id:2,label:"Заявка на регистрацию",color:"#FFC107",background:"#FFC10733"},ForContractRegister:{id:3,label:"Для регистрации договора",color:"#FFC107",background:"#FFC10733"},OnContractRegister:{id:4,label:"На регистрации договора",color:"#FFC107",background:"#FFC10733"}},c=d=>(it("data-v-725b37a3"),d=d(),nt(),d),kt={key:0,class:"section"},Ct={class:"container"},yt={class:"section-header"},Ot={class:"section-title"},xt=["href"],Ft={class:"section-label"},Nt={class:"section-nav"},Pt={class:"list"},Et={class:"list-col list-col--md"},Bt={class:"list-item"},Rt={class:"list-item__row"},Tt={class:"list-item__title"},At={class:"list-item__status"},Ut={class:"list-item__row"},Wt={class:"list-item__ul"},Vt={key:0},Ht={class:"list-item__row list-item__row--column"},Mt={key:0,class:"list-item__text"},jt={class:"list-item__text"},Lt={class:"list-item__text"},qt={class:"list-item__row"},Xt={class:"btn btn--border btn--switch"},Zt=c(()=>e("span",{class:"btn-switch__text"},"Автопродление",-1)),zt=c(()=>e("span",{class:"btn-switch__toggle"},null,-1)),Gt={class:"list-col list-col--md"},Jt={class:"list-item"},Kt={class:"list-item__row list-item__row--nowrap"},Qt=c(()=>e("div",{class:"list-item__title"},"Именные сервера",-1)),Yt={class:"list-item__row list-item__row--table"},$t=c(()=>e("div",{class:"list-item__item"},"Первичный сервер",-1)),te={class:"list-item__item"},ee={class:"list-item__row list-item__row--table"},oe=c(()=>e("div",{class:"list-item__item"},"Вторичный сервер",-1)),se={class:"list-item__item"},ie={class:"list-col list-col--md"},ne={class:"list-item"},ae=c(()=>e("div",{class:"list-item__row"},[e("div",{class:"list-item__title"},"Контактные данные")],-1)),re={class:"list-item__row list-item__row--table"},le=c(()=>e("div",{class:"list-item__item"},"Скрыть данные в WhoIs",-1)),ce={class:"btn btn--switch"},_e=["checked"],me=c(()=>e("span",{class:"btn-switch__toggle"},null,-1)),de={class:"list-item__row list-item__row--table"},ue=c(()=>e("div",{class:"list-item__item"},"Последнее обновление адрес",-1)),De={class:"list-item__item"},ve={key:1,class:"section"},ge={class:"container"};function he(d,n,a,o,H,u){var C,i,f,y,O,x,F,N,P,E,B,t,s,r,D,p,I,M,j,L,q,X,Z,z;const g=K,w=Q("router-link"),S=wt,h=bt,T=ft,k=J,A=It;return v(),b(st,null,[_(g),(C=o.getDomain)!=null&&C.ID?(v(),b("div",kt,[e("div",Ct,[e("div",yt,[e("h1",Ot,[e("a",{href:o.fullDomainUrl,target:"_blank"},l((i=o.getDomain)==null?void 0:i.Domain),9,xt)]),e("div",Ft,"Домен # "+l((f=o.getDomain)==null?void 0:f.OrderID),1),e("div",Nt,[_(w,{class:"section-nav__item",to:`/DomainOrders/${(y=o.getDomain)==null?void 0:y.OrderID}`},{default:Y(()=>[$("Домен")]),_:1},8,["to"])])]),_(S),((O=o.getDomain)==null?void 0:O.StatusID)==="Waiting"||((x=o.getDomain)==null?void 0:x.StatusID)==="ClaimForRegister"||((F=o.getDomain)==null?void 0:F.StatusID)==="ForContractRegister"||((N=o.getDomain)==null?void 0:N.StatusID)==="ForRegister"||((P=o.getDomain)==null?void 0:P.StatusID)==="ForTransfer"?(v(),tt(h,{key:0,class:"btn-mn__bot",label:"Определить владельца",onClick:n[0]||(n[0]=m=>o.designateOwner())})):U("",!0),e("div",Pt,[_(T,{"contract-id":(E=o.getDomain)==null?void 0:E.ContractID,onTransfer:n[1]||(n[1]=m=>o.transferItem())},null,8,["contract-id"]),e("div",Et,[e("div",Bt,[e("div",Rt,[e("div",Tt,l((B=o.getDomain)==null?void 0:B.Domain),1),e("div",At,[_(k,{status:(t=o.getDomain)==null?void 0:t.StatusID,"status-table":"DomainOrders",onClick:n[2]||(n[2]=m=>{var G;return o.openHistoryStatuses((G=o.getDomain)==null?void 0:G.ID)})},null,8,["status"])])]),e("div",Ut,[e("ul",Wt,[(s=o.getDomainScheme)!=null&&s.PackageID?(v(),b("li",Vt,l((r=o.getDomainScheme)==null?void 0:r.PackageID),1)):U("",!0)])]),e("div",Ht,[(D=o.getDomainScheme)!=null&&D.CostProlong?(v(),b("div",Mt,l((p=o.getDomainScheme)==null?void 0:p.CostProlong)+" ₽ продлить на 12 месяцев",1)):U("",!0),e("div",jt,"Дней осталось "+l(((I=o.getDomain)==null?void 0:I.DaysRemainded)||0),1),e("div",Lt,"Дата окончания "+l(o.calculateExpirationDate((M=o.getDomain)==null?void 0:M.DaysRemainded)),1)]),e("div",qt,[_(h,{label:((j=o.getDomain)==null?void 0:j.StatusID)==="ClaimForRegister"||((L=o.getDomain)==null?void 0:L.StatusID)==="Waiting"?"Оплатить":"Продлить",onClick:n[3]||(n[3]=m=>o.navigateToProlong())},null,8,["label"]),e("label",Xt,[et(e("input",{type:"checkbox","onUpdate:modelValue":n[4]||(n[4]=m=>o.isAutoProlong=m),onInput:n[5]||(n[5]=m=>o.setProlongValue())},null,544),[[ot,o.isAutoProlong]]),Zt,zt])])])]),e("div",Gt,[e("div",Jt,[e("div",Kt,[Qt,_(h,{class:"ml-auto",label:"Редактировать",onClick:n[6]||(n[6]=m=>o.toggleDomainsEdit())})]),e("div",Yt,[$t,e("div",te,l((q=o.getDomain)==null?void 0:q.Ns1Name),1)]),e("div",ee,[oe,e("div",se,l((X=o.getDomain)==null?void 0:X.Ns2Name),1)])])]),e("div",ie,[e("div",ne,[ae,e("div",re,[le,e("label",ce,[e("input",{type:"checkbox",checked:(Z=o.getDomain)==null?void 0:Z.IsPrivateWhoIs,disabled:""},null,8,_e),me])]),e("div",de,[ue,e("div",De,l(o.lastUpdate((z=o.getDomain)==null?void 0:z.StatusDate)),1)])])])])])])):(v(),b("div",ve,[e("div",ge,[_(A,{label:"Заказ не найден"})])]))],64)}const fe={components:{IconCard:vt,IconProfile:gt,IconSettings:ht,IconEye:pt,StatusBadge:J,BlockBalanceAgreement:K},async setup(){const d=rt(),n=lt(),a=dt(),o=ut(),H=ct(),u=_t("emitter"),g=W(null),w=W(!1),S=W({});function h(){u.emit("open-modal",{component:"DomainsEdit",data:i.value})}function T(){var r;if(!((r=i.value)!=null&&r.ExpirationDate))return!1;const t=parseInt(i.value.ExpirationDate,10);return Math.floor(Date.now()/1e3)>=t}function k(){var D,p,I;const t=T(),s=Number((D=f.value)==null?void 0:D.DaysBeforeTransfer)??0;return(Number((p=i.value)==null?void 0:p.DaysRemainded)??0)>s||t&&((I=i.value)==null?void 0:I.IsPayed)}function A(){var t;a.DomainOrderNsChange({DomainOrderID:Number((t=i.value)==null?void 0:t.ID),XMLHttpRequest:"yes"}).then(s=>{let{result:r,error:D}=s;r==="SUCCESS"&&(w.value=!1,a.fetchDomains())})}function C(t){u.emit("open-modal",{component:"StatusHistory",data:{modeID:"DomainOrders",rowID:t}})}const i=R(()=>Object.keys(a==null?void 0:a.domainsList).map(t=>a==null?void 0:a.domainsList[t]).find(t=>t.OrderID===d.params.id)),f=R(()=>{var t,s;return(s=a==null?void 0:a.domainSchemes)==null?void 0:s[(t=i.value)==null?void 0:t.SchemeID]}),y=R(()=>{var t,s;return(s=n==null?void 0:n.userOrders)==null?void 0:s[(t=i.value)==null?void 0:t.OrderID]}),O=R(()=>{var s;if(!((s=i.value)!=null&&s.Domain))return"";const t=i.value.Domain;return t.startsWith("http://")||t.startsWith("https://")?t:`https://${t}`});function x(t){if(!t)return V(new Date);const s=new Date,r=new Date(s.getTime()+t*24*60*60*1e3);return V(r)}function F(t){return t?V(Dt(t)):""}function N(){try{const t={DomainOrderID:i==null?void 0:i.value.ID,Domain:i==null?void 0:i.value.Domain};u.emit("open-modal",{component:"DomainSelectOwner",data:t})}catch(t){console.error(t)}}function P(){var t,s;u.emit("open-modal",{component:"OrdersTransfer",data:{ServiceOrderID:(t=i.value)==null?void 0:t.ID,ServiceID:(s=i.value)==null?void 0:s.ServiceID}})}function E(){var t;n.prolongOrder({IsAutoProlong:g.value?0:1,OrderID:(t=i.value)==null?void 0:t.OrderID})}function B(){var s;k()===!0?u.emit("open-modal",{component:"ExclusionWindow",data:{msg:"Заказ домена не может быть оплачен"}}):H.push(`/DomainOrderPay/${(s=i.value)==null?void 0:s.OrderID}`)}return mt(()=>{var t,s;S.value={Ns1Name:(t=i.value)==null?void 0:t.Ns1Name,Ns2Name:(s=i.value)==null?void 0:s.Ns2Name}}),await a.fetchDomains(),await a.fetchDomainSchemes(),await o.fetchProfiles(),await n.fetchUserOrders().then(()=>{var t;g.value=(t=y.value)==null?void 0:t.IsAutoProlong}),{getDomain:i,getDomainScheme:f,isAutoProlong:g,setProlongValue:E,navigateToProlong:B,domainStatuses:St,transferItem:P,lastUpdate:F,designateOwner:N,calculateExpirationDate:x,domainsEdit:w,domainNames:S,saveDomains:A,toggleDomainsEdit:h,fullDomainUrl:O,openHistoryStatuses:C,isProlong:k}}},Te=at(fe,[["render",he],["__scopeId","data-v-725b37a3"]]);export{Te as default};
