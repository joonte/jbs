import{_ as A}from"./EmptyStateBlock-DA3-0YDi.js";import{_ as C}from"./ButtonDefault-CMw2aBy6.js";import{_ as L}from"./TotalAmount.vue_vue_type_script_setup_true_lang-Dg-09YER.js";import{_ as U}from"./BlockOrderPayBalance-DG_N_8bZ.js";import{_ as R}from"./ClausesKeeper-iUM0yapS.js";import{_ as T}from"./BlockBalanceAgreement-v_bWuiVT.js";import{r as D,f as u,E as y,o as d,c as g,b as p,a as c,F as w,t as j,C as h,h as N,v as F,i as M,d as q}from"./index-Codq73aV.js";import{u as z}from"./index-BO2gwtUe.js";import{u as G}from"./services-DyPBvbVy.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./common-DyknwSqv.js";import"./bootstrap-vue-next-W16P-SAV.js";import"./component-DqcwA9JN.js";import"./global-CdY51QQZ.js";import"./IconCross-DYjIbZqx.js";import"./IconClose-Dia1noy8.js";const J={class:"tw-px-4 md:tw-px-8"},K={class:"section-header"},Q={class:"section-header__wrapper"},W={class:"section-label"},X={class:"tw-my-6"},Y={__name:"ExtraIPOrderPayId",async setup(Z){let r,n;const k=z(),s=G(),B=M(),P=q(),t=D(null),i=D(!1),o=u(()=>Object.values(s.ExtraIPOrdersList).find(a=>a.OrderID==B.params.id)),m=u(()=>k.contractsList[o.value.ContractID]),S=u(()=>Number(m.value?.Balance)>=t.value?.price-E.value?"Оплатить c баланса договора":"Добавить в корзину"),_=u(()=>s?.additionalServicesScheme?.ExtraIP?Object.keys(s.additionalServicesScheme.ExtraIP).map(a=>{const e=s.additionalServicesScheme.ExtraIP[a];return{...e,value:e?.ID,name:e?.Name,cost:e?.CostDay,month:e?.CostMonth}}).filter(a=>a?.ID==o.value?.SchemeID):[]);function x(){i.value=!0;const a=Number(m.value?.Balance)>=t.value?.price-E.value,e=_.value[0]?.cost==="0.00"&&_.value[0]?.month==="0.00",v=a||e,f=!v,I={ExtraIPOrderID:o.value.ID,DaysPay:t.value?.actualDays,IsNoBasket:v,IsUseBasket:f,PayMessage:""};s.ExtraIPOrderPay(I).then(l=>{l==="UseBasket"?P.push("/Basket"):l==="NoBasket"?P.push("/AdditionalServices"):console.error("Ошибка оплаты заказа"),i.value=!1}).catch(l=>{console.error("ExtraIPOrderPay error:",l),i.value=!1})}const E=u(()=>{let a=0;return t.value?.discounts?.Bonuses.map(e=>{a+=Number(e.Economy)}),a});return[r,n]=y(()=>s.fetchExtraIPOrders()),await r,n(),[r,n]=y(()=>s.fetchAdditionalServiceScheme("ExtraIP")),await r,n(),[r,n]=y(()=>k.fetchContracts()),await r,n(),(a,e)=>{const v=T,f=C,I=R,l=U,O=L,$=C,V=A;return d(),g(w,null,[p(v,{"contract-id":o.value?.ContractID},null,8,["contract-id"]),c("div",J,[o.value?(d(),g(w,{key:0},[c("div",K,[c("div",Q,[e[3]||(e[3]=c("h1",{class:"section-title"},"Оплата заказа IP адреса",-1)),p(f,{class:"btn--wide",label:S.value,disabled:t.value===null||t.value?.price===null,"is-loading":i.value,onClick:e[0]||(e[0]=b=>x())},null,8,["label","disabled","is-loading"])]),c("div",W,j(_.value[0]?.Name),1)]),p(I),m.value?(d(),h(l,{key:0,modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=b=>t.value=b),contract:m.value,"days-remainded":o.value?.DaysRemainded,"service-id":5e4,scheme:_.value[0],order:o.value},null,8,["modelValue","contract","days-remainded","scheme","order"])):N("",!0),c("div",X,[t.value?(d(),h(O,{key:0,tariff:t.value},null,8,["tariff"])):N("",!0),p($,{class:"btn--wide",label:S.value,disabled:t.value===null||t.value?.price===null,"is-loading":i.value,onClick:e[2]||(e[2]=b=>x())},null,8,["label","disabled","is-loading"])])],64)):(d(),h(V,{key:1,label:`Заказ #${F(B).params.id} не найден`},null,8,["label"]))])],64)}}},fe=H(Y,[["__scopeId","data-v-1fb9b4eb"]]);export{fe as default};
