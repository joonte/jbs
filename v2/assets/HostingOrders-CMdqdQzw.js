import{_ as ie}from"./EmptyStateBlock-CV1Zaaf7.js";import{_ as ue}from"./HostingItem-C0M9g60b.js";import{_ as ce}from"./FormInputSearch-DhLeThyA.js";import{_ as me}from"./ClausesKeeper-DEgaQ2N3.js";import{m as de}from"./bootstrap-vue-next-CxxkTytZ.js";import{_ as _e,a as pe}from"./IconButtonBack-BwlFfJZM.js";import{_ as ve}from"./ButtonDefault-eJbeaBtE.js";import{_ as fe}from"./BlockBalanceAgreement-DjWMZ940.js";import{u as ge,r as d,E as H,x as he,h as Se,f as _,d as be,c as O,b as a,a as s,D as b,n as ke,I as w,t as p,J as x,w as k,G as Ce,N as Ie,v as De,F as N,j as ye,o as r,e as M}from"./index-XtiBO-PZ.js";import{s as He}from"./multiselect-eqvbz1NV.js";import{u as Oe}from"./hosting-B5Wk2kbD.js";import{u as we}from"./contracts-BdlSA9YT.js";import{u as xe}from"./testTransforms-CtLjUrql.js";import{u as Be}from"./globalActions-Tf2FwXht.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IconDots-DWUcOOJk.js";import"./Helper-yVNH7dvZ.js";import"./IconCard-cFowCC2T.js";import"./StatusBadge-DoJSzeeo.js";import"./OrderIDBadge-Kd0drmnW.js";import"./hostStatuses-wR2mZwFf.js";import"./time-DenPiOX5.js";import"./IconPlus-DYth91EZ.js";import"./IconClose-s_NQ_Q4c.js";const $e={class:"container"},Pe={class:"title__icon"},Le={class:"btn__group"},Ue={class:"group__several"},Ne={class:"list-form"},Me={class:"list-form_col list-form_col--sm"},Ae={class:"list-form_select"},Te={class:"multiselect-option"},je={key:0},Ee={__name:"HostingOrders",async setup(Re){let i,u;const c=Oe(),A=ge(),B=we(),V=Be(),C=be(),{formDescriptionLine:I}=xe(),v=d("*"),f=d(null),l=d(!1),g=d([]),D=d(null),y=d(!1),h=he("emitter");[i,u]=H(()=>c.fetchHostingOrders()),await i,u(),[i,u]=H(()=>c.fetchHostingSchemes()),await i,u(),[i,u]=H(()=>B.fetchContracts()),await i,u(),h.on("updateHostingList",()=>{c.fetchHostingOrders()});const T=t=>{g.value=t};async function j(){const t=Object.keys(g.value).filter(n=>g.value[n]),e={ServiceID:"10000",ItemsPay:D.value,OrdersIDs:t,...y.value&&{UseBalance:"yes"}};await V.OrdersPay(e).then(n=>{n==="Basket"?(console.log("Success"),C.push("/Basket")):n?.Status==="Ok"&&(l.value=!1,h.emit("open-modal",{component:"BalanceProlong",data:{Message:n?.Message,Count:n?.Count}}))})}function E(){l.value=!0}function R(){l.value=!1}Se(()=>{m.value.length<1&&q()});function F(){C.go(0)}function q(){C.push({path:"/HostingSchemes"})}function z(t,e){h.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить хостинг #${e}?`,tableID:"HostingOrders",successEmit:"updateHostingList"}})}function G(t){h.emit("open-modal",{component:"OrdersTransfer",data:t})}function J(t){V.OrderManageHosting(t)}const m=_(()=>Object.keys(c?.hostingList).map(t=>c?.hostingList[t])?.reverse()),K=_(()=>c?.hostingSchemes),$=_(()=>B?.contractsList),P=_(()=>{let t=[{value:"*",name:"Все договора"}];return m.value!==null?(m.value.forEach(e=>{t.find(n=>n.value===e.ContractID)||t.push({value:e.ContractID,name:$.value[e?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}}),Q=_(()=>A.userInfo),S=_(()=>X(W(m.value)));function W(t){return v.value!=="*"?t.filter(e=>e?.ContractID===v.value):t}function X(t){return f.value!==null?t.filter(e=>e?.Domain.toLowerCase().includes(f.value.toLowerCase())):t}function Y(t){const e=Z(t?.SchemeID);return[{text:e?.Name},{text:I(e?.SchemeParams?.limit_webdomains)},{text:I(e?.SchemeParams?.limit_quota)},{text:I(e?.SchemeParams?.limit_emails)},{text:`${e?.CostMonth} ₽ в месяц`,bold:!0}]}function Z(t){return K.value?.[t]}return(t,e)=>{const n=fe,ee=_e,L=ve,te=Ce("router-link"),oe=pe,se=de,ne=me,ae=ce,le=ue,U=ie;return r(),O(N,null,[a(n),s("div",$e,[s("div",{class:ke(["section-header",l.value?"column":""])},[s("div",Pe,[s("h1",{class:"section-title",onClick:e[0]||(e[0]=o=>F())},p(l.value?"Продление услуг Хостинга":"Хостинг"),1),w(a(ee,{onClick:e[1]||(e[1]=o=>R())},null,512),[[x,l.value]])]),w(s("div",Le,[a(L,{class:"btn-several",label:"Продлить несколько заказов",onClick:e[2]||(e[2]=o=>E())}),a(te,{class:"btn btn--blue btn-default",to:"/HostingSchemes"},{default:k(()=>e[8]||(e[8]=[M("Заказать",-1)])),_:1,__:[8]})],512),[[x,!l.value]]),w(s("div",Ue,[a(oe,{class:"contr period",modelValue:D.value,"onUpdate:modelValue":e[3]||(e[3]=o=>D.value=o)},null,8,["modelValue"]),a(se,{id:"checkbox-balance",modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=o=>y.value=o),name:"checkbox-balance"},{default:k(()=>e[9]||(e[9]=[M(" Использовать средства с баланса ",-1)])),_:1,__:[9]},8,["modelValue"]),a(L,{label:"Продлить",onClick:e[5]||(e[5]=o=>j())})],512),[[x,l.value]])],2),(r(),b(Ie,null,[a(ne)],1024)),s("div",Ne,[s("div",Me,[s("div",Ae,[a(De(He),{modelValue:v.value,"onUpdate:modelValue":e[6]||(e[6]=o=>v.value=o),options:P.value,disabled:P.value?.length<=1,label:"name"},{singlelabel:k(({value:o})=>[s("span",null,"# "+p(o.value.padStart(5,"0"))+" / "+p(o.name),1)]),option:k(({option:o})=>[s("span",Te,"# "+p(o.value.padStart(5,"0"))+" / "+p(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),a(ae,{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=o=>f.value=o)},null,8,["modelValue"])]),m.value&&m.value?.length>0?(r(),O("div",je,[S.value&&S.value?.length>0?(r(!0),O(N,{key:0},ye(S.value,(o,re)=>(r(),b(le,{key:o.OrderID,"item-data":o,"user-name":`${Q.value?.Name} - ${$.value[o?.ContractID]?.Customer}`,params:Y(o),"info-link":`/HostingOrders/${o?.OrderID}`,"is-last":re===S.value.length-1,isSeveral:l.value,"selected-rows":g.value,onUpdateSelectedRows:T,onDelete:z,onTransfer:G,onManage:J},null,8,["item-data","user-name","params","info-link","is-last","isSeveral","selected-rows"]))),128)):(r(),b(U,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(r(),b(U,{key:1,class:"no-margin",label:"У Вас нет заказов на хостинг"}))])],64)}}},_t=Ve(Ee,[["__scopeId","data-v-7a918a6e"]]);export{_t as default};
