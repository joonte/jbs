import{k as Y,o as u,c as j,b as i,a as l,n as ce,t as b,$ as D,aa as U,w as x,d as Z,F as $,y as ie,z,_ as de,e as me,r as _,U as ue,h as P,i as _e}from"./index-918fd9be.js";import{I as fe}from"./IconSearch-65d02983.js";import{V as ee}from"./VpsItem-991b0c92.js";import{S as ve}from"./Select2-4b2b7a7d.js";import{s as pe}from"./multiselect-aa389ce5.js";import{_ as oe}from"./ClausesKeeper-a5c1abc1.js";import{u as ge}from"./vps-98438e5b.js";import{u as Se}from"./contracts-580f94dc.js";import{B as te}from"./BlockBalanceAgreement-e7f96bc6.js";import{u as Ve}from"./globalActions-9f26afd1.js";import{_ as be,B as ae}from"./IconButtonBack-dfaea6d7.js";import{E as Pe}from"./EmptyStateBlock-531c1077.js";import{_ as he}from"./FormInputSearch-9831216a.js";import{f as ke}from"./bootstrap-vue-next.es-1529a2a7.js";import{_ as Ce}from"./ButtonDefault-2f55d117.js";import"./HelperComponent-4db256a5.js";import"./StatusBadge-fee09aa1.js";import"./IconRotate-939f5f86.js";import"./useTimeFunction-8602dd60.js";import"./vpsStatuses-32ffaaf5.js";import"./IconDots-6103eb35.js";import"./IconCard-c8682fa1.js";import"./OrderIDBadge-6d749519.js";import"./IconClose-6ceae682.js";import"./IconArrow-f2d41a4e.js";import"./IconPlus-35121e22.js";const Ie={class:"section"},Be={class:"container"},we={class:"title__icon"},Oe={class:"btn__group"},ye={class:"group__several"},De={class:"list-form"},Ue={class:"list-form_col list-form_col--sm"},xe={class:"list-form_select"},Me={class:"multiselect-option"},Le={key:0};function Ne(r,s,M,o,h,k){var B,p,w;const m=te,d=be,f=Ce,C=Y("router-link"),v=ae,L=ke,N=oe,R=Y("Multiselect"),A=he,c=ee,I=Pe;return u(),j($,null,[i(m),l("div",Ie,[l("div",Be,[l("div",{class:ce(["section-header",o.isSeveral?"column":""])},[l("div",we,[l("h1",{class:"section-title",onClick:s[0]||(s[0]=t=>o.reloadNow())},b(o.isSeveral?"Продление услуг виртуальных серверов":"VPS/VDS серверы"),1),D(i(d,{onClick:s[1]||(s[1]=t=>o.outSeveralOrders())},null,512),[[U,o.isSeveral]])]),D(l("div",Oe,[D(i(f,{class:"btn-several",label:"Продлить несколько заказов",onClick:s[2]||(s[2]=t=>o.prolongSeveralOrders())},null,512),[[U,o.getVpsOrders.length>1]]),i(C,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:x(()=>[Z("Заказать")]),_:1})],512),[[U,!o.isSeveral]]),D(l("div",ye,[i(v,{class:"contr period",modelValue:o.selectPeriod,"onUpdate:modelValue":s[3]||(s[3]=t=>o.selectPeriod=t)},null,8,["modelValue"]),i(L,{id:"checkbox-balance",modelValue:o.useBalance,"onUpdate:modelValue":s[4]||(s[4]=t=>o.useBalance=t),name:"checkbox-balance"},{default:x(()=>[Z("Использовать средства с баланса")]),_:1},8,["modelValue"]),i(f,{label:"Продлить",onClick:s[5]||(s[5]=t=>o.prolongOrders())})],512),[[U,o.isSeveral]])],2),i(N),l("div",De,[l("div",Ue,[l("div",xe,[i(R,{modelValue:o.select,"onUpdate:modelValue":s[6]||(s[6]=t=>o.select=t),options:o.getUsers,disabled:((B=o.getUsers)==null?void 0:B.length)<=1,label:"name"},{singlelabel:x(({value:t})=>[l("span",null,"# "+b(t.value.padStart(5,"0"))+" / "+b(t.name),1)]),option:x(({option:t})=>[l("div",Me,"# "+b(t.value.padStart(5,"0"))+" / "+b(t.name),1)]),_:1},8,["modelValue","options","disabled"])])]),i(A,{modelValue:o.search,"onUpdate:modelValue":s[7]||(s[7]=t=>o.search=t)},null,8,["modelValue"])]),o.getVpsOrders&&((p=o.getVpsOrders)==null?void 0:p.length)>0?(u(),j("div",Le,[o.filterProducts&&((w=o.filterProducts)==null?void 0:w.length)>0?(u(!0),j($,{key:0},ie(o.filterProducts,(t,E)=>{var O;return u(),z(c,{"item-data":t,"is-last":E===o.filterProducts.length-1,"user-name":(O=o.getContracts[t==null?void 0:t.ContractID])==null?void 0:O.Customer,params:o.formItemParamList(t),isSeveral:o.isSeveral,"selected-rows":o.selectedRows,onUpdateSelectedRows:o.handleSelectedRowsUpdate,onDelete:o.deleteItem,onManage:o.orderManage},null,8,["item-data","is-last","user-name","params","isSeveral","selected-rows","onUpdateSelectedRows","onDelete","onManage"])}),256)):(u(),z(I,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(u(),z(I,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])],64)}const Re={components:{IconSearch:fe,Select2:ve,ClausesKeeper:oe,Multiselect:pe,VpsItem:ee,BlockBalanceAgreement:te,BlockSelectPeriod:ae},async setup(){const r=ge(),s=Se(),M=Ve(),o=me(),h=_(null),k=_("*"),m=_(!1),d=_([]),f=_(null),C=_(!1),v=ue("emitter");v.on("updateVPSList",()=>{r.fetchVPS()});const L=a=>{d.value=a};async function N(){console.log(d.value);const a=Object.keys(d.value).filter(n=>d.value[n]),e={ServiceID:"30000",ItemsPay:f.value,OrdersIDs:a,...C.value&&{UseBalance:"yes"}};await M.OrdersPay(e).then(n=>{n==="Basket"?(console.log("Success"),o.push("/Basket")):(n==null?void 0:n.Status)==="Ok"&&(m.value=!1,v.emit("open-modal",{component:"BalanceProlong",data:{Message:n==null?void 0:n.Message,Count:n==null?void 0:n.Count}}))})}function R(){m.value=!0}function A(){m.value=!1}const c=P(()=>{var a;return(a=Object.keys(r==null?void 0:r.vpsList).map(e=>r==null?void 0:r.vpsList[e]))==null?void 0:a.reverse()}),I=P(()=>r.vpsSchemes),B=P(()=>ne(E(c.value))),p=P(()=>s==null?void 0:s.contractsList);_e(()=>{c.value.length<1&&t()});function w(){o.go(0)}function t(){o.push({path:"/VPSSchemes"})}function E(a){return k.value!=="*"?a.filter(e=>(e==null?void 0:e.ContractID)===k.value):a}function O(a){M.OrderManage(a)}function se(a){v.emit("open-modal",{component:"DeleteItem",data:{id:a,message:`Вы действительно хотите удалить виртуальный сервер #${a}?`,tableID:"VPSOrders",successEmit:"updateVPSList"}})}function ne(a){return h.value!==null?a.filter(e=>e==null?void 0:e.IP.toLowerCase().includes(h.value.toLowerCase())):a}const le=P(()=>{let a=[{value:"*",name:"Все договора"}];return c.value!==null?(Object.keys(c.value).forEach(e=>{var n,g,S;a.find(y=>{var V;return y.value===((V=c.value[e])==null?void 0:V.ContractID)})||a.push({value:(n=c.value[e])==null?void 0:n.ContractID,name:(S=p.value[(g=c.value[e])==null?void 0:g.ContractID])==null?void 0:S.Customer})}),a):{value:"*",name:"Все договора"}});function re(a){var n,g,S,y,V,F,T,K,q,G,H,J,Q,W,X;const e=(n=I.value)==null?void 0:n[a.SchemeID];return[{text:`${e==null?void 0:e.Name}`},{text:`${(S=(g=e==null?void 0:e.SchemeParams)==null?void 0:g.hdd_mib)==null?void 0:S.InternalName} ${(V=(y=e==null?void 0:e.SchemeParams)==null?void 0:y.hdd_mib)==null?void 0:V.Value} ${(T=(F=e==null?void 0:e.SchemeParams)==null?void 0:F.hdd_mib)==null?void 0:T.Unit}`},{text:`RAM ${(q=(K=e==null?void 0:e.SchemeParams)==null?void 0:K.ram_mib)==null?void 0:q.Value} ${(H=(G=e==null?void 0:e.SchemeParams)==null?void 0:G.ram_mib)==null?void 0:H.Unit}`},{text:`Канал ${(Q=(J=e==null?void 0:e.SchemeParams)==null?void 0:J.net_bandwidth_mbitps)==null?void 0:Q.Value} ${(X=(W=e==null?void 0:e.SchemeParams)==null?void 0:W.net_bandwidth_mbitps)==null?void 0:X.Unit}`}]}return await r.fetchVPS(),await r.fetchVPSSchemes(),await s.fetchContracts(),{getVpsOrders:c,search:h,getContracts:p,select:k,orderManage:O,formItemParamList:re,getUsers:le,filterProducts:B,navigateToVPSSchemes:t,deleteItem:se,reloadNow:w,prolongSeveralOrders:R,isSeveral:m,selectedRows:d,selectPeriod:f,prolongOrders:N,outSeveralOrders:A,useBalance:C,handleSelectedRowsUpdate:L}}},io=de(Re,[["render",Ne],["__scopeId","data-v-3dbccff2"]]);export{io as default};
