import{j as V,o as a,c as O,b as g,a as r,w,d as j,x as y,am as F,t as D,F as S,v as K,p as q,l as R,_ as z,f as G,r as U,R as J,g as i}from"./index-b105c350.js";import{I as Q}from"./IconSearch-3b738ce1.js";import{H as A}from"./HostingItem-0cb57ed4.js";import{_ as N}from"./ClausesKeeper-d7dcbabd.js";import{s as W}from"./multiselect-34394f38.js";import{u as X}from"./hosting-31da32d7.js";import{u as Y}from"./contracts-b62777f8.js";import{B as T}from"./BlockBalanceAgreement-19657f3d.js";import{u as Z}from"./testTransforms-eec373ee.js";import{u as $}from"./globalActions-38f815a9.js";import{E as tt}from"./EmptyStateBlock-197e75e2.js";import{_ as et}from"./FormInputSearch-15711181.js";import"./IconDots-71cfee45.js";import"./IconCard-f1b3f450.js";import"./StatusBadge-137b1c8f.js";import"./hostStatuses-94d00f20.js";import"./HelperComponent-4c4a503a.js";import"./ButtonDefault-d83beda7.js";import"./IconArrow-27665727.js";import"./useTimeFunction-8602dd60.js";import"./bootstrap-vue-next.es-31cfcab6.js";import"./OrderIDBadge-87b3acf9.js";import"./IconClose-0ba84d64.js";import"./IconPlus-745c2bd0.js";const ot=n=>(q("data-v-e658f8f2"),n=n(),R(),n),st={class:"section"},nt={class:"container"},rt={class:"section-header"},at=ot(()=>r("h1",{class:"section-title"},"Хостинг",-1)),lt={class:"list-form"},ct={class:"list-form_col list-form_col--sm"},it={class:"list-form_select"},dt={class:"multiselect-option"},ut={key:0};function mt(n,l,d,o,v,h){var f,I,H;const u=T,m=V("router-link"),x=N,B=V("Multiselect"),L=et,c=A,_=tt;return a(),O(S,null,[g(u),r("div",st,[r("div",nt,[r("div",rt,[at,g(m,{class:"btn btn--blue btn-default",to:"/HostingSchemes"},{default:w(()=>[j("Заказать")]),_:1})]),(a(),y(F,null,[g(x)],1024)),r("div",lt,[r("div",ct,[r("div",it,[g(B,{modelValue:o.select,"onUpdate:modelValue":l[0]||(l[0]=s=>o.select=s),options:o.getUsers,disabled:((f=o.getUsers)==null?void 0:f.length)<=1,label:"name"},{singlelabel:w(({value:s})=>[r("span",null,"# "+D(s.value.padStart(5,"0"))+" / "+D(s.name),1)]),option:w(({option:s})=>[r("div",dt,"# "+D(s.value.padStart(5,"0"))+" / "+D(s.name),1)]),_:1},8,["modelValue","options","disabled"])])]),g(L,{modelValue:o.search,"onUpdate:modelValue":l[1]||(l[1]=s=>o.search=s)},null,8,["modelValue"])]),o.getHostingList&&((I=o.getHostingList)==null?void 0:I.length)>0?(a(),O("div",ut,[o.filterProducts&&((H=o.filterProducts)==null?void 0:H.length)>0?(a(!0),O(S,{key:0},K(o.filterProducts,(s,P)=>{var C,b;return a(),y(c,{"item-data":s,"user-name":`${(C=o.getUser)==null?void 0:C.Name} - ${(b=o.getContracts[s==null?void 0:s.ContractID])==null?void 0:b.Customer}`,params:o.getHostingItemParam(s),"info-link":`/HostingOrders/${s==null?void 0:s.OrderID}`,"is-last":P===o.filterProducts.length-1,onDelete:o.deleteItem,onTransfer:o.transferItem,onManage:o.orderManage},null,8,["item-data","user-name","params","info-link","is-last","onDelete","onTransfer","onManage"])}),256)):(a(),y(_,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(a(),y(_,{key:1,class:"no-margin",label:"У Вас нет заказов на хостинг"}))])])],64)}const _t={components:{IconSearch:Q,Multiselect:W,ClausesKeeper:N,HostingItem:A,BlockBalanceAgreement:T},async setup(){const n=X(),l=G(),d=Y(),o=$(),{formDescriptionLine:v}=Z(),h=U("*"),u=U(null),m=J("emitter");m.on("updateHostingList",()=>{n.fetchHostingOrders()});function x(e){m.emit("open-modal",{component:"DeleteItem",data:{id:e,message:"Вы действительно хотите удалить хостинг?",tableID:"HostingOrders",successEmit:"updateHostingList"}})}function B(e){m.emit("open-modal",{component:"OrdersTransfer",data:e})}function L(e){o.OrderManage(e)}const c=i(()=>{var e;return(e=Object.keys(n==null?void 0:n.hostingList).map(t=>n==null?void 0:n.hostingList[t]))==null?void 0:e.reverse()}),_=i(()=>n==null?void 0:n.hostingSchemes),f=i(()=>d==null?void 0:d.contractsList),I=i(()=>{let e=[{value:"*",name:"Все договора"}];return c.value!==null?(c.value.forEach(t=>{var p;e.find(k=>k.value===t.ContractID)||e.push({value:t.ContractID,name:(p=f.value[t==null?void 0:t.ContractID])==null?void 0:p.Customer})}),e):{value:"*",name:"Все договора"}}),H=i(()=>l.userInfo),s=i(()=>C(P(c.value)));function P(e){return h.value!=="*"?e.filter(t=>(t==null?void 0:t.ContractID)===h.value):e}function C(e){return u.value!==null?e.filter(t=>t==null?void 0:t.Domain.toLowerCase().includes(u.value.toLowerCase())):e}function b(e){var p,k,M;const t=E(e==null?void 0:e.SchemeID);return[{text:t==null?void 0:t.Name},{text:v((p=t==null?void 0:t.SchemeParams)==null?void 0:p.limit_webdomains)},{text:v((k=t==null?void 0:t.SchemeParams)==null?void 0:k.limit_quota)},{text:v((M=t==null?void 0:t.SchemeParams)==null?void 0:M.limit_emails)},{text:`${t==null?void 0:t.CostMonth} ₽ в месяц`,bold:!0}]}function E(e){var t;return(t=_.value)==null?void 0:t[e]}return await n.fetchHostingOrders(),await n.fetchHostingSchemes(),await d.fetchContracts(),{getHostingList:c,getHostingSchemes:_,orderManage:L,filterProducts:s,getUsers:I,getUser:H,select:h,search:u,getContracts:f,deleteItem:x,transferItem:B,getHostingItemParam:b}}},Tt=z(_t,[["render",mt],["__scopeId","data-v-e658f8f2"]]);export{Tt as default};
