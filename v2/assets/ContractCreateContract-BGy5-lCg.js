import{_ as w}from"./ButtonDefault-CgQ13ecW.js";import{_ as R}from"./BlockSelectProfile-DId7tOBI.js";import{_ as F}from"./SimpleCheckbox-DmHcob3H.js";import{_ as j}from"./ClausesKeeper-Cjjq7JUL.js";import{_ as M}from"./BlockBalanceAgreement-BNU6bIWW.js";import{u as O}from"./contracts-C-xJvA56.js";import{an as U,r as d,f as c,h as y,v as A,p as K,d as G,g as J,E as q,c as f,b as r,a as n,w as z,G as H,F as v,j as Q,y as W,o as i,e as X,D as Y,i as Z}from"./index-DakgQwZZ.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./multiselect-BdMqqcHq.js";import"./IconClose-Camrw-uN.js";const te={class:"section"},oe={class:"container"},ae={class:"tw-mb-4"},ne={class:"form"},le={class:"container-limited"},se={__name:"ContractCreateContract",async setup(re){let k,g;const D=U(),m=O(),s=G(),h=J(),P=W("emitter"),p=d(!1),u=d("Natural"),o=d(null),T=c(()=>D.data),a=c(()=>m?.profileList),_=c(()=>Object.keys(a.value).map(e=>{if(a.value[e].TemplateID==="Natural"||a.value[e].TemplateID==="Juridical"||a.value[e].TemplateID==="Individual"||a.value[e].TemplateID==="NaturalPartner")return{value:a.value[e].ID,name:a.value[e].Name,contractID:a.value[e].ContractID}}).filter(e=>e.contractID===0)),I=e=>{e.key==="Enter"&&e.ctrlKey&&!V.value&&C()},V=c(()=>o.value===null||o.value===void 0);y(()=>{document.addEventListener("keyup",I)}),A(()=>{document.removeEventListener("keyup",I)});function C(){p.value=!0,m.contractMake({ProfileID:o.value,TypeID:u.value}).then(e=>{console.log(e),e.status==="success"&&(P.emit("open-modal",{component:"SuccessContract",data:"Договор успешно создан!"}),s.push("/Contracts")),p.value=!1})}function b(){o.value=_.value?.[0]?.value||null}return K(u,()=>{b()}),y(()=>{_.value.length<1&&s.push(`/ProfileMake?ProfileEmpty=true&Redirect=${s.options.history.state.back}`),console.log(h,"route contracts"),console.log(s.options,"options"),console.log(s.options.history.state.back,"full path"),b()}),[k,g]=q(()=>m.fetchProfiles()),await k,g(),(e,t)=>{const E=M,S=H("router-link"),L=j,N=F,$=R,B=w;return i(),f(v,null,[r(E),n("section",te,[n("div",oe,[n("div",ae,[r(S,{to:"/Contracts",class:"section-label"},{default:z(()=>t[2]||(t[2]=[X("Мои договора",-1)])),_:1,__:[2]}),t[3]||(t[3]=n("h1",{class:"section-title"},"Создать договор",-1))]),r(L),t[4]||(t[4]=n("div",{class:"section-header"},[n("h2",{class:"section-block_title"},"Шаблон")],-1)),n("form",ne,[(i(!0),f(v,null,Q(T.value?.Contracts?.Types,l=>(i(),f(v,{key:l?.ProfileTemplateID},[l?.ProfileTemplateID!==""?(i(),Y(N,{key:0,label:l?.Name,value:l?.ProfileTemplateID,modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=x=>u.value=x)},null,8,["label","value","modelValue"])):Z("",!0)],64))),128))]),n("div",le,[r($,{title:"Использовать профиль",items:_.value,modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=l=>o.value=l)},null,8,["items","modelValue"]),r(B,{onClick:C,disabled:o.value===null||o.value===void 0,"is-loading":p.value,label:"Зарегистрировать"},null,8,["disabled","is-loading"])])])])],64)}}},ge=ee(se,[["__scopeId","data-v-dad36a39"]]);export{ge as default};
