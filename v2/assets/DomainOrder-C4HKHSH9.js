import{_ as W}from"./EmptyStateBlock-CV1Zaaf7.js";import{_ as V}from"./StatusBadge-DoJSzeeo.js";import{_ as H}from"./ServicesContractBalanceBlock-DSORAI4R.js";import{_ as M}from"./ButtonDefault-eJbeaBtE.js";import{_ as L}from"./ClausesKeeper-DEgaQ2N3.js";import{_ as j}from"./BlockBalanceAgreement-DjWMZ940.js";import{c as g,b as r,a as t,D as q,i as w,t as n,w as x,G,I as K,K as X,F as z,u as J,O as Q,r as S,f as h,g as Y,h as Z,x as $,d as tt,o as _,e as F}from"./index-XtiBO-PZ.js";import{u as et}from"./contracts-BdlSA9YT.js";import{f as k,s as ot}from"./time-DenPiOX5.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IconProfile-twpez_2K.js";import"./IconCard-cFowCC2T.js";import"./IconClose-s_NQ_Q4c.js";const it={Waiting:{id:1,label:"Ожидание оплаты",color:"#459FD1",background:"#ADC1F04C"},ClaimForRegister:{id:2,label:"Заявка на регистрацию",color:"#FFC107",background:"#FFC10733"},ForContractRegister:{id:3,label:"Для регистрации договора",color:"#FFC107",background:"#FFC10733"},OnContractRegister:{id:4,label:"На регистрации договора",color:"#FFC107",background:"#FFC10733"}},nt={async setup(){const C=Y(),e=J(),l=Q(),o=et(),O=tt(),m=$("emitter"),d=S(null),u=S(!1),v=S({});function D(){m.emit("open-modal",{component:"DomainsEdit",data:i.value})}function p(){if(!i.value?.ExpirationDate)return!1;const s=parseInt(i.value.ExpirationDate,10);return Math.floor(Date.now()/1e3)>=s}function f(){const s=p(),c=Number(y.value?.DaysBeforeTransfer)??0;return(Number(i.value?.DaysRemainded)??0)>c||s&&i.value?.IsPayed}function b(){l.DomainOrderNsChange({DomainOrderID:Number(i.value?.ID),XMLHttpRequest:"yes"}).then(s=>{let{result:c,error:I}=s;c==="SUCCESS"&&(u.value=!1,l.fetchDomains())})}function a(s){m.emit("open-modal",{component:"StatusHistory",data:{modeID:"DomainOrders",rowID:s}})}const i=h(()=>Object.keys(l?.domainsList).map(s=>l?.domainsList[s]).find(s=>s.OrderID===C.params.id)),y=h(()=>l?.domainSchemes?.[i.value?.SchemeID]),N=h(()=>e?.userOrders?.[i.value?.OrderID]),P=h(()=>{if(!i.value?.Domain)return"";const s=i.value.Domain;return s.startsWith("http://")||s.startsWith("https://")?s:`https://${s}`});function R(s){if(!s)return k(new Date);const c=new Date,I=new Date(c.getTime()+s*24*60*60*1e3);return k(I)}function E(s){return s?k(ot(s)):""}function T(){try{const s={DomainOrderID:i?.value.ID,Domain:i?.value.Domain};m.emit("open-modal",{component:"DomainSelectOwner",data:s})}catch(s){console.error(s)}}function B(){m.emit("open-modal",{component:"OrdersTransfer",data:{ServiceOrderID:i.value?.ID,ServiceID:i.value?.ServiceID}})}function A(){e.prolongOrder({IsAutoProlong:d.value?0:1,OrderID:i.value?.OrderID})}function U(){f()===!0?m.emit("open-modal",{component:"ExclusionWindow",data:{msg:"Заказ домена не может быть оплачен"}}):O.push(`/DomainOrderPay/${i.value?.OrderID}`)}return Z(()=>{v.value={Ns1Name:i.value?.Ns1Name,Ns2Name:i.value?.Ns2Name}}),await l.fetchDomains(),await l.fetchDomainSchemes(),await o.fetchProfiles(),await e.fetchUserOrders().then(()=>{d.value=N.value?.IsAutoProlong}),{getDomain:i,getDomainScheme:y,isAutoProlong:d,setProlongValue:A,navigateToProlong:U,domainStatuses:it,transferItem:B,lastUpdate:E,designateOwner:T,calculateExpirationDate:R,domainsEdit:u,domainNames:v,saveDomains:b,toggleDomainsEdit:D,fullDomainUrl:P,openHistoryStatuses:a,isProlong:f}}},at={key:0},rt={class:"container"},lt={class:"section-header"},mt={class:"section-title"},ct=["href"],_t={class:"section-label"},dt={class:"section-nav"},ut={class:"list"},Dt={class:"list-col list-col--md"},gt={class:"list-item"},vt={class:"list-item__row"},ft={class:"list-item__title"},ht={class:"list-item__status"},pt={class:"list-item__row"},bt={class:"list-item__ul"},It={key:0},wt={class:"list-item__row list-item__row--column"},St={key:0,class:"list-item__text"},kt={class:"list-item__text"},Ct={class:"list-item__text"},Ot={class:"list-item__row"},yt={class:"btn btn--border btn--switch"},xt={class:"list-col list-col--md"},Ft={class:"list-item"},Nt={class:"list-item__row list-item__row--nowrap"},Pt={class:"list-item__row list-item__row--table"},Rt={class:"list-item__item"},Et={class:"list-item__row list-item__row--table"},Tt={class:"list-item__item"},Bt={class:"list-col list-col--md"},At={class:"list-item"},Ut={class:"list-item__row list-item__row--table"},Wt={class:"btn btn--switch"},Vt=["checked"],Ht={class:"list-item__row list-item__row--table"},Mt={class:"list-item__item"},Lt={key:1},jt={class:"container"};function qt(C,e,l,o,O,m){const d=j,u=G("router-link"),v=L,D=M,p=H,f=V,b=W;return _(),g(z,null,[r(d),o.getDomain?.ID?(_(),g("section",at,[t("div",rt,[t("div",lt,[t("h1",mt,[t("a",{href:o.fullDomainUrl,target:"_blank"},n(o.getDomain?.Domain),9,ct)]),t("div",_t,"Домен # "+n(o.getDomain?.OrderID),1),t("div",dt,[r(u,{class:"section-nav__item",to:`/DomainOrders/${o.getDomain?.OrderID}`},{default:x(()=>e[7]||(e[7]=[F("Домен",-1)])),_:1,__:[7]},8,["to"]),r(u,{class:"section-nav__item",to:`/DomainServices/${o.getDomain?.OrderID}`},{default:x(()=>e[8]||(e[8]=[F("Услуги",-1)])),_:1,__:[8]},8,["to"])])]),r(v),o.getDomain?.StatusID==="Waiting"||o.getDomain?.StatusID==="ClaimForRegister"||o.getDomain?.StatusID==="ForContractRegister"||o.getDomain?.StatusID==="ForRegister"||o.getDomain?.StatusID==="ForTransfer"?(_(),q(D,{key:0,class:"btn-mn__bot",label:"Определить владельца",onClick:e[0]||(e[0]=a=>o.designateOwner())})):w("",!0),t("div",ut,[r(p,{"contract-id":o.getDomain?.ContractID,onTransfer:e[1]||(e[1]=a=>o.transferItem())},null,8,["contract-id"]),t("div",Dt,[t("div",gt,[t("div",vt,[t("div",ft,n(o.getDomain?.Domain),1),t("div",ht,[r(f,{status:o.getDomain?.StatusID,"status-table":"DomainOrders",onClick:e[2]||(e[2]=a=>o.openHistoryStatuses(o.getDomain?.ID))},null,8,["status"])])]),t("div",pt,[t("ul",bt,[o.getDomainScheme?.PackageID?(_(),g("li",It,n(o.getDomainScheme?.PackageID),1)):w("",!0)])]),t("div",wt,[o.getDomainScheme?.CostProlong?(_(),g("div",St,n(o.getDomainScheme?.CostProlong)+" ₽ продлить на 12 месяцев ",1)):w("",!0),t("div",kt,"Дней осталось "+n(o.getDomain?.DaysRemainded||0),1),t("div",Ct,"Дата окончания "+n(o.calculateExpirationDate(o.getDomain?.DaysRemainded)),1)]),t("div",Ot,[r(D,{label:o.getDomain?.StatusID==="ClaimForRegister"||o.getDomain?.StatusID==="Waiting"?"Оплатить":"Продлить",onClick:e[3]||(e[3]=a=>o.navigateToProlong())},null,8,["label"]),t("label",yt,[K(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=a=>o.isAutoProlong=a),onInput:e[5]||(e[5]=a=>o.setProlongValue())},null,544),[[X,o.isAutoProlong]]),e[9]||(e[9]=t("span",{class:"btn-switch__text"},"Автопродление",-1)),e[10]||(e[10]=t("span",{class:"btn-switch__toggle"},null,-1))])])])]),t("div",xt,[t("div",Ft,[t("div",Nt,[e[11]||(e[11]=t("div",{class:"list-item__title"},"Именные сервера",-1)),r(D,{class:"ml-auto",label:"Редактировать",onClick:e[6]||(e[6]=a=>o.toggleDomainsEdit())})]),t("div",Pt,[e[12]||(e[12]=t("div",{class:"list-item__item"},"Первичный сервер",-1)),t("div",Rt,n(o.getDomain?.Ns1Name),1)]),t("div",Et,[e[13]||(e[13]=t("div",{class:"list-item__item"},"Вторичный сервер",-1)),t("div",Tt,n(o.getDomain?.Ns2Name),1)])])]),t("div",Bt,[t("div",At,[e[17]||(e[17]=t("div",{class:"list-item__row"},[t("div",{class:"list-item__title"},"Контактные данные")],-1)),t("div",Ut,[e[15]||(e[15]=t("div",{class:"list-item__item"},"Скрыть данные в WhoIs",-1)),t("label",Wt,[t("input",{type:"checkbox",checked:o.getDomain?.IsPrivateWhoIs,disabled:""},null,8,Vt),e[14]||(e[14]=t("span",{class:"btn-switch__toggle"},null,-1))])]),t("div",Ht,[e[16]||(e[16]=t("div",{class:"list-item__item"},"Последнее обновление адрес",-1)),t("div",Mt,n(o.lastUpdate(o.getDomain?.StatusDate)),1)])])])])])])):(_(),g("section",Lt,[t("div",jt,[r(b,{label:"Заказ не найден"})])]))],64)}const ie=st(nt,[["render",qt],["__scopeId","data-v-e7a90a19"]]);export{ie as default};
