import{k as H,o as B,c as O,b as p,a as o,w as r,d as Q,t as c,F as R,a7 as X,z as Y,p as Z,m as $,_ as ee,u as te,U as oe,e as se,r as i,h as w,j}from"./index-777dc609.js";import{u as ae}from"./edesks-9036f9cd.js";import{_ as L}from"./ClausesKeeper-4fcca336.js";import{s as ne}from"./multiselect-146af8a5.js";import{E as z}from"./EmptyStateBlock-1f3845f9.js";import{B as K}from"./BlockBalanceAgreement-d9b1b07a.js";import{a as le,f as re}from"./useTimeFunction-8602dd60.js";import{C as ce,F as ie}from"./bootstrap-vue-next.es-8d4e1458.js";import{S as de}from"./StatusBadge-f0ac8f52.js";import{_ as ue}from"./FormInputSearch-7dd006f7.js";import"./IconClose-166e70a9.js";import"./IconArrow-1d7911e1.js";import"./ButtonDefault-7f62b822.js";import"./IconPlus-2dcd804b.js";import"./IconSearch-7594ec6c.js";const pe=[{key:"ID",label:"Номер"},{key:"UpdateDate",label:"Дата и время",sortable:!0,variant:"td-gray td-order"},{key:"PriorityID",label:"Приоритет",sortable:!0,variant:"td-gray td-order"},{key:"Theme",label:"Тема"},{key:"MessageID",label:"Количество сообщений"},{key:"StatusID",label:"Статус",sortable:!0,variant:"td-gray td-order"}],_e={Newest:{color:"#459FD1",background:"#ADC1F04C"},Opened:{color:"#FFC107",background:"#FFC10733"},Working:{color:"#28A745",background:"#EAF7ED"},Closed:{color:"#838383",background:"#57699B19"}},me={Low:{background:"#8FD658"},Middle:{background:"#FFC700"},Hight:{background:"#DF5747"}},d=u=>(Z("data-v-9da8eaaa"),u=u(),$(),u),ge={class:"section"},ke={class:"container"},be={class:"section-header"},fe={class:"btn__group"},ve={class:"list-form"},De={class:"list-form_col list-form_col--sm"},ye={class:"list-form_select"},he={class:"multiselect-option"},Ie=d(()=>o("span",{class:"td-mobile"},"Номер",-1)),Fe={class:"d-block"},Ce=d(()=>o("span",{class:"td-mobile"},"Дата и время",-1)),Se=d(()=>o("span",{class:"td-mobile"},"Приоритет",-1)),Te=d(()=>o("span",{class:"td-mobile"},"Тема",-1)),Ee={class:"cell__theme"},Be=d(()=>o("span",{class:"td-mobile"},"Количество сообщений",-1)),we=d(()=>o("span",{class:"td-mobile"},"Статус",-1)),Pe=d(()=>o("span",null,"Ничего не найдено",-1)),Ve=d(()=>o("span",null,"Ничего не найдено",-1)),xe={class:"table-controls"},Ne=d(()=>o("span",{class:"text-success"},"First",-1)),Ue=d(()=>o("span",{class:"text-info"},"Last",-1)),Me={class:"multiselect-multiple-label"},Ae={class:"multiselect-option"};function He(u,n,P,t,m,f){const v=K,C=H("router-link"),D=L,h=H("Multiselect"),b=ue,S=de,T=ce,E=ie,y=z;return B(),O(R,null,[p(v),o("div",ge,[o("div",ke,[o("div",be,[o("h1",{class:"section-title",onClick:n[0]||(n[0]=e=>t.reloadNow())},"Служба поддержки"),o("div",fe,[p(C,{class:"btn btn--blue btn-default",to:"/NewTicket"},{default:r(()=>[Q("Создать тикет")]),_:1})])]),p(D,{partition:"Header:/Tickets"}),o("div",ve,[o("div",De,[o("div",ye,[p(h,{options:t.options,label:"name",modelValue:t.select,"onUpdate:modelValue":n[1]||(n[1]=e=>t.select=e)},{option:r(({option:e})=>[o("div",he,c(e.name),1)]),_:1},8,["options","modelValue"])])]),p(b,{modelValue:t.filter,"onUpdate:modelValue":n[2]||(n[2]=e=>t.filter=e)},null,8,["modelValue"])]),t.getEDeskItems&&t.getEDeskItems.length?(B(),O(R,{key:0},[p(T,{class:"basic-table",items:t.onFiltered(t.filterTableItems(t.getEDeskItems)),"per-page":t.perPage,"current-page":t.currentPage,fields:t.ticketsTable,"show-empty":"","sort-by":t.sortBy,"onUpdate:sortBy":n[3]||(n[3]=e=>t.sortBy=e),"sort-desc":t.sortDesc,"onUpdate:sortDesc":n[4]||(n[4]=e=>t.sortDesc=e),"sort-direction":t.sortDirection,onRowClicked:t.navigateToTicket},{"cell(ID)":r(e=>[Ie,o("span",Fe,c(e.value),1)]),"cell(UpdateDate)":r(e=>[Ce,o("span",null,c(t.formNormalDate(t.secondToDate(e.value))),1)]),"cell(PriorityID)":r(e=>{var g,k,I,F;return[Se,o("span",{class:"status-tag",style:X(`color: #FFF; background-color: ${(k=(g=t.priorities)==null?void 0:g[e.value])==null?void 0:k.background}; border-color: ${(F=(I=t.priorities)==null?void 0:I[e.value])==null?void 0:F.background}`)},c(t.findPriority(e.value)),5)]}),"cell(Theme)":r(e=>[Te,o("span",Ee,c(e.value),1)]),"cell(MessageID)":r(e=>[Be,o("span",null,c(e.value),1)]),"cell(StatusID)":r(e=>[we,p(S,{class:"clickable-element",status:e.value,"status-table":"Edesks",onClick:g=>{var k;return t.openHistoryStatuses((k=e.item)==null?void 0:k.ID)}},null,8,["status","onClick"])]),empty:r(e=>[Pe]),emptyfiltered:r(e=>[Ve]),_:1},8,["items","per-page","current-page","fields","sort-by","sort-desc","sort-direction","onRowClicked"]),o("div",xe,[p(E,{modelValue:t.currentPage,"onUpdate:modelValue":n[5]||(n[5]=e=>t.currentPage=e),"total-rows":t.totalRows,"per-page":t.perPage,"first-number":"","last-number":""},{"first-text":r(()=>[Ne]),"last-text":r(()=>[Ue]),page:r(({page:e,active:g})=>[o("span",null,c((e-1)*t.perPage+1)+"-"+c(e*t.perPage),1)]),_:1},8,["modelValue","total-rows","per-page"]),p(h,{class:"multiselect--white",modelValue:t.perPage,"onUpdate:modelValue":n[6]||(n[6]=e=>t.perPage=e),options:t.pageOptions,label:"name",openDirection:"top"},{singlelabel:r(({value:e})=>[o("div",Me,[o("span",null,"Отображать "+c(e.value)+" строк",1)])]),option:r(({option:e})=>[o("div",Ae,"Отображать "+c(e.name)+" строк",1)]),_:1},8,["modelValue","options"])])],64)):(B(),Y(y,{key:1,class:"no-margin",label:"Вы пока не обращались в тех. поддержку "}))])])],64)}const Oe={components:{ClausesKeeper:L,Multiselect:ne,EmptyStateBlock:z,BlockBalanceAgreement:K},async setup(){const u=ae(),n=te(),P=oe("emitter"),t=se(),m=i("*"),f=i(""),v=i(1),C=i(10),D=i(0),h=i([10,25,50,100]),b=i([]),S=i("UpdateDate"),T=i(!0),E=i("desc"),y=w(()=>u==null?void 0:u.eDesksList),e=w(()=>n==null?void 0:n.ConfigList),g=w(()=>{var a,l;return(l=(a=Object.keys(y.value))==null?void 0:a.map(s=>{var _;return(_=y.value)==null?void 0:_[s]}))==null?void 0:l.reverse()});await u.fetchEDesks().then(()=>{var a,l,s,_,V;D.value=g.value.length,(l=(a=e.value)==null?void 0:a.Statuses)!=null&&l.Edesks&&(b.value=(V=Object.keys((_=(s=e.value)==null?void 0:s.Statuses)==null?void 0:_.Edesks))==null?void 0:V.map(x=>{var N,U,M,A;return{value:x,name:(A=(M=(U=(N=e.value)==null?void 0:N.Statuses)==null?void 0:U.Edesks)==null?void 0:M[x])==null?void 0:A.Name}})),b.value.push({value:"*",name:"Все тикеты"})});function k(){t.go(0)}function I(a){P.emit("open-modal",{component:"StatusHistory",data:{modeID:"Edesks",rowID:a}})}function F(a){var l;return(l=a==null?void 0:a.filter(s=>m.value==="*"?!0:(s==null?void 0:s.StatusID)===(m==null?void 0:m.value)))==null?void 0:l.filter(s=>(s==null?void 0:s.ID.includes(f.value))||(s==null?void 0:s.Theme.includes(f.value)))}function W(a){return D.value=a.length>0?a.length:1,a}function q(a){var l;return(l=b.value.find(s=>(s==null?void 0:s.value)===a))==null?void 0:l.name}function G(a){var l,s,_;return(_=(s=(l=e.value)==null?void 0:l.Edesks)==null?void 0:s.Priorities)==null?void 0:_[a]}function J(a,l,s){s.target.closest("button, a, .clickable-element")||t.push({path:`Ticket/${a==null?void 0:a.ID}`})}return j(f,()=>{v.value=1}),j(m,()=>{v.value=1}),{getEDesks:y,getEDeskItems:g,select:m,filter:f,currentPage:v,perPage:C,options:b,totalRows:D,pageOptions:h,sortBy:S,sortDesc:T,sortDirection:E,ticketsTable:pe,statuses:_e,priorities:me,findStatus:q,findPriority:G,onFiltered:W,filterTableItems:F,secondToDate:le,formNormalDate:re,navigateToTicket:J,openHistoryStatuses:I,reloadNow:k}}},tt=ee(Oe,[["render",He],["__scopeId","data-v-9da8eaaa"]]);export{tt as default};
