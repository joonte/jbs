import{E as ae}from"./EmptyStateBlock-b9aefc49.js";import{_ as le}from"./ButtonDefault-626291b9.js";import{_ as ce}from"./BlockOrderPayBalance-22bf5d16.js";import{_ as ne}from"./ClausesKeeper-e7acf2fb.js";import{_ as ie,a7 as _e,e as re,R as de,r as g,g as B,ag as S,o as i,c as _,b as u,a as e,t as c,F as y,v as ue,k as me,Y as W,ae as X,p as pe,l as ve}from"./index-c7c24b76.js";import{u as he}from"./hosting-ef6b8c8f.js";import{u as ge}from"./contracts-397b53fe.js";import{_ as fe}from"./paramsAccordionBlock-db172332.js";import{B as be}from"./BlockBalanceAgreement-f11c65ba.js";import"./bootstrap-vue-next.es-3f66213d.js";import"./IconHelp-ade5ebb4.js";import"./globalActions-306d29c7.js";import"./BasicInput-0178c2f2.js";import"./component2-1c15eb55.js";import"./component-d5bd2a45.js";import"./IconClose-447d7f82.js";import"./IconArrow-dfacb3d4.js";const Z=f=>(pe("data-v-ff165f25"),f=f(),ve(),f),ke={key:0,class:"hosting-sheme"},ye={class:"section"},De={class:"container"},Ie={class:"section-header"},Be={class:"section-title"},Se={class:"section-label"},we={class:"section"},He={class:"container"},Ce={class:"total-block"},Pe={class:"total-block__row divider-bottom"},Ee=Z(()=>e("div",{class:"total-block__col"},"Цена тарифа",-1)),Oe={class:"total-block__col"},xe={class:"total-block__row no-divider"},Fe={class:"total-block__col"},Ne={class:"total-block__col"},Le={class:"total-block__row total-block__row--big economy-line"},$e=Z(()=>e("div",{class:"total-block__col red"},"Выгода",-1)),Ae={class:"total-block__col flex-col"},Re={class:"red"},Te={class:"total-block__row total-block__row--big"},Ve={class:"total-block__col"},je={class:"total-block__col"},Ke={key:1,class:"section"},Ue={class:"container"},Ye={key:1,class:"section"},qe={class:"container"},ze={__name:"HostingProlong",async setup(f){let m,p;const s=he(),w=ge(),ee=_e(),H=re();de("emitter"),g(null),g(null),g("");const o=g(null),D=g(!1),n=B(()=>Object.keys(s==null?void 0:s.hostingList).map(t=>s==null?void 0:s.hostingList[t]).find(t=>t.OrderID===ee.params.id));console.log("getHostingOrderData",n);const r=B(()=>{var t,a;return(a=s==null?void 0:s.hostingSchemes)==null?void 0:a[(t=n.value)==null?void 0:t.SchemeID]});console.log("getHostingScheme",r);const te=B(()=>w.contractsList);function b(t){return Number(t).toFixed(2)||0}function C(){var a,d;let t=0;return(d=(a=o.value)==null?void 0:a.discounts)==null||d.Bonuses.map(v=>{t+=+v.Economy}),t}function oe(){var t,a,d;D.value=!0,s.HostingOrderPay({HostingOrderID:(t=n.value)==null?void 0:t.ID,DaysPayFromBallance:((a=o.value)==null?void 0:a.daysFromBalance)||0,DaysPay:(d=o.value)==null?void 0:d.actualDays,IsChange:!0}).then(v=>{var h;let{result:k,error:I}=v;k==="SUCCESS"?H.push(`/HostingOrders/${(h=n.value)==null?void 0:h.ID}`):k==="BASKET"&&H.push("/Basket"),D.value=!1})}function se(t){o.value=t}return[m,p]=S(()=>s.fetchHostingOrders()),await m,p(),[m,p]=S(()=>s.fetchHostingSchemes()),await m,p(),[m,p]=S(()=>w.fetchContracts()),await m,p(),(t,a)=>{var h,P,E,O,x,F,N,L,$,A,R,T,V,j,K,U,Y,q,z,G,J,M,Q;const d=ne,v=ce,k=le,I=ae;return i(),_(y,null,[u(be),n.value?(i(),_("div",ke,[e("div",ye,[e("div",De,[e("div",Ie,[e("h1",Be,c((h=n.value)==null?void 0:h.Domain),1),e("div",Se,c((P=r.value)==null?void 0:P.Name),1)]),u(d)])]),u(fe,{"params-list":(E=r.value)==null?void 0:E.SchemeParams,label:"Общая информация","main-param":"InternalName"},null,8,["params-list"]),(O=r.value)!=null&&O.IsPayed&&((x=r.value)!=null&&x.IsProlong)||!((F=r.value)!=null&&F.IsPayed)?(i(),_(y,{key:0},[u(v,{contractID:(N=n.value)==null?void 0:N.ContractID,scheme:r.value,isOrderID:!0,onSelect:se},null,8,["contractID","scheme"]),e("div",we,[e("div",He,[e("div",Ce,[((A=($=(L=o.value)==null?void 0:L.discounts)==null?void 0:$.Bonuses)==null?void 0:A.length)>0?(i(),_(y,{key:0},[e("div",Pe,[Ee,e("div",Oe,c(b((R=o.value)==null?void 0:R.price))+" ₽",1)]),(i(!0),_(y,null,ue((V=(T=o.value)==null?void 0:T.discounts)==null?void 0:V.Bonuses,l=>(i(),_("div",xe,[e("div",Fe,"Скидка "+c(l==null?void 0:l.Discount)+"% на "+c(l==null?void 0:l.Days)+" дней",1),e("div",Ne,"-"+c(b(l==null?void 0:l.Economy))+" ₽",1)]))),256))],64)):me("",!0),W(e("div",Le,[$e,e("div",Ae,[e("span",null,[e("s",null,c(b((j=o.value)==null?void 0:j.price))+" ₽",1)]),e("span",Re,"-"+c(C())+" ₽",1)])],512),[[X,((Y=(U=(K=o.value)==null?void 0:K.discounts)==null?void 0:U.Bonuses)==null?void 0:Y.length)>0]]),W(e("div",Te,[e("div",Ve,"Итого за "+c((q=o.value)==null?void 0:q.label),1),e("div",je,c(b(((z=o.value)==null?void 0:z.price)-C()))+" ₽",1)],512),[[X,(G=o.value)==null?void 0:G.price]])]),u(k,{class:"btn--wide",label:((J=te.value[n.value.ContractID])==null?void 0:J.Balance)>((M=o.value)==null?void 0:M.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:o.value===null||((Q=o.value)==null?void 0:Q.price)===null,"is-loading":D.value,onClick:a[0]||(a[0]=l=>oe())},null,8,["label","disabled","is-loading"])])])],64)):(i(),_("div",Ke,[e("div",Ue,[u(I,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(i(),_("div",Ye,[e("div",qe,[u(I,{label:"не удалось найти заказ хостинга"})])]))],64)}}},rt=ie(ze,[["__scopeId","data-v-ff165f25"]]);export{rt as default};
