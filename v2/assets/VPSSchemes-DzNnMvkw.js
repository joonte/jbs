import{_ as le}from"./ButtonDefault-CMw2aBy6.js";import{_ as ne}from"./TotalAmount.vue_vue_type_script_setup_true_lang-Dg-09YER.js";import{_ as ue}from"./BlockOrderServiceWrapper-CSOQwJHk.js";import{_ as ce}from"./BlockAdditionalServices-Dc0oR6v8.js";import{_ as ie}from"./BlockOrderPayBalance-DG_N_8bZ.js";import{_ as de}from"./BlockSelectContract-CsqQBTZj.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as b,I as H,o as n,c as u,a,M as z,h as k,t as D,e as me,F as I,g as C,N as ve,f,n as _e,O as pe,H as fe,s as Se,E,b as g,w as G,C as M,d as ge}from"./index-Codq73aV.js";import{_ as be}from"./ClausesKeeper-iUM0yapS.js";import{_ as Ie}from"./BlockBalanceAgreement-v_bWuiVT.js";import{u as he}from"./server-DnY_Nzbw.js";import{u as we}from"./index-BO2gwtUe.js";import{u as Ve}from"./services-DyPBvbVy.js";import"./common-DyknwSqv.js";import"./EmptyStateBlock-DA3-0YDi.js";import"./bootstrap-vue-next-W16P-SAV.js";import"./InputServiceSelect-Dvi-CxI4.js";import"./InputSelect.vue_vue_type_script_setup_true_lang-D7E9_BoS.js";import"./IconChevronDown-DOsbTpSQ.js";import"./BasicInput-DeQAeyXe.js";import"./component-DqcwA9JN.js";import"./global-CdY51QQZ.js";import"./IconCross-DYjIbZqx.js";import"./multiselect-DElL0Rlw.js";import"./IconClose-Dia1noy8.js";const ye={class:"form-input_border"},ke={class:"form-input_border-label"},De=["checked"],Ce={class:"form-field__data"},Pe={key:0,class:"form-field__img"},Be=["src"],Oe={class:"form-field__name"},$e={class:"form-field__desc"},xe={class:"form-field__select"},Ue={__name:"InputBoxBorder",props:{modelValue:[String,Number,Object],data:{type:Object,default:()=>{}},name:{type:String,default:""},checked:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(c,{emit:v}){const d=c,p=v,h=b(null);function P(){p("update:modelValue",d.data)}return H(()=>{h.value=d.modelValue}),(t,w)=>(n(),u("div",ye,[a("label",ke,[a("input",{type:"radio",checked:c.checked,onInput:P},null,40,De),a("div",Ce,[z(t.$slots,"default",{},()=>[c.data.img?(n(),u("div",Pe,[a("img",{src:c.data.img},null,8,Be)])):k("",!0)],!0),a("div",Oe,D(c.data.name),1),a("div",$e,[me(D(c.data.desc)+" ",1),c.data.select?z(t.$slots,"default",{key:0},()=>[a("div",xe,[(n(!0),u(I,null,C(c.data.select,(l,m)=>(n(),u("div",{key:m,class:"form-field__select-item"},D(l.text),1))),128))])],!0):k("",!0)])])])]))}},Ae=T(Ue,[["__scopeId","data-v-ca59da76"]]),Ne={class:"tw-hidden md:tw-grid tw-grid-cols-6 tw-gap-4"},Ee={class:"tw-space-y-2 tw-mt-2"},Ge=["onClick"],Me={class:"tw-grid tw-grid-cols-2 md:tw-grid-cols-6 tw-gap-4"},Le={class:"tw-block md:tw-hidden tw-uppercase tw-text-2xs tw-font-bold tw-text-gray-500"},Te={__name:"VpsConfigurations",props:pe({configurations:{type:Array,default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(c){const v=c,d=ve(c,"modelValue"),p=f(()=>{const t=v.configurations?.[0]?.SchemeParams;return{PackageID:"Тариф",cpu_number:t?.cpu_number?.Name||"CPU",ram_mib:t?.ram_mib?.Name||"RAM",hdd_mib:t?.hdd_mib?.Name||"Память",net_in_mbitps:t?.net_in_mbitps?.Name||"Канал",CostMonth:"Стоимость"}});function h(t){return{ID:t?.ID,PackageID:t?.PackageID,ServersGroupID:t?.ServersGroupID,cpu_number:t?.SchemeParams?.cpu_number?.Value,ram_mib:t?.SchemeParams?.ram_mib?.Value,hdd_mib:t?.SchemeParams?.hdd_mib?.Value,net_in_mbitps:t?.SchemeParams?.net_in_mbitps?.Value,CostMonth:t?.CostMonth}}function P(t){d.value=t}return(t,w)=>(n(),u("div",null,[a("div",Ne,[(n(!0),u(I,null,C(p.value,(l,m)=>(n(),u("div",{key:m,class:"tw-text-sm tw-font-bold tw-text-gray-400"},D(l),1))),128))]),a("div",Ee,[(n(!0),u(I,null,C(c.configurations,l=>(n(),u("div",{key:l.ID,class:_e(["tw-cursor-pointer tw-border tw-rounded tw-p-4 md:tw-p-0",d.value.ID===l.ID?"tw-bg-sky-100 tw-border-sky-400":"tw-border-gray-200"]),onClick:m=>P(l)},[a("div",Me,[(n(!0),u(I,null,C(p.value,(m,_)=>(n(),u("div",{key:_,class:"tw-space-y-1 md:tw-p-4 last:tw-font-bold"},[a("div",Le,D(m),1),a("div",null,D(h(l)[_]),1)]))),128))])],10,Ge))),128))])]))}},je=T(Te,[["__scopeId","data-v-fb3a7f75"]]),Fe={class:"tw-px-4 md:tw-px-8"},Ke={class:"tw-mt-6"},Re={key:0,class:"tw-mt-6"},ze={class:"form grid-gorm"},He=["src","alt"],We={class:"tw-mt-6"},qe={class:"form"},Je={class:"tw-my-6"},L="Moscow",Qe={__name:"VPSSchemes",async setup(c){let v,d;const p=fe(),h=we(),P=he(),t=Ve(),w=ge(),l=b(null),m=b([]),_=b(null),B=b(null),$=b(!1),i=b(null),j=b(""),W=[{img:"/images/oc-2.jpg",value:"Moscow",name:"Россия",desc:"Москва"}],F=f(()=>Object.values(p.vpsSchemes).filter(s=>s.IsActive).sort((s,e)=>{const r=Number(s.SortID),S=Number(e.SortID);return r-S})),O=f(()=>P?.serverGroupsList?.ServersGroups),q=f(()=>t?.ServicesList),J=f(()=>{let s=0;return m.value.forEach(e=>{s+=+e?.Price}),s}),x=f(()=>{const s=i.value?.OS||[],e=i.value?.OSs||[];return s.map(r=>{const S=e.find(V=>V.Name===r);return{name:r,value:r,imageUrl:S?S.Image:""}})}),K=s=>{s.key==="Enter"&&s.ctrlKey&&!Q.value&&R()},Q=f(()=>l.value===null||_.value===null),X=f(()=>{if(l.value?.daysFromBalance)return"Оплатить c баланса договора";const s=l.value?.CostPay+J.value;return(A.value?.Balance||0)>=s?"Оплатить c баланса договора":"Добавить в корзину"}),A=f(()=>h.contractsList[_.value]);H(()=>{document.addEventListener("keyup",K)}),Se(()=>{document.removeEventListener("keyup",K)});function Y(){let s=Object.keys(O.value?.[i.value?.ServersGroupID])?.find(r=>O.value?.[i.value?.ServersGroupID]?.[r]?.IsActive&&O.value?.[i.value?.ServersGroupID]?.[r]?.IsDefault),e=Object.keys(O.value?.[i.value?.ServersGroupID])?.find(r=>O.value?.[i.value?.ServersGroupID]?.[r]?.IsActive);return s||e}async function Z(s){for(const e of m.value){let r=q.value[e.ServiceID]?.Code;const{result:S,info:V}=await t.ServiceOrder({Code:r,DependOrderID:s,...e,ContractID:_.value});if(S==="SUCCESS"){let y={};r==="Default"?y.ServiceOrderID=V?.ServiceOrderID:y[`${r}OrderID`]=V?.ServiceOrderID;const{result:U}=await t.ServiceOrderPay(r,y);U==="SUCCESS"?w.push("/AdditionalServices"):U==="BASKET"&&w.push("/Basket")}else break}}async function R(){$.value=!0;const{result:s,info:e}=await p.VPSOrder({ContractID:_.value,VPSSchemeID:i.value?.ID,ServerID:Y(),DiskTemplate:B.value?.value});if(s==="SUCCESS"){Z(e?.OrderID);const{result:r}=await p.VPSOrderPay({VPSOrderID:e?.VPSOrderID,DaysPayFromBallance:l.value?.daysFromBalance||0,DaysPay:l.value?.actualDays,IsChange:!0});r==="SUCCESS"?w.push("/VPSOrders"):r==="BASKET"&&w.push("/Basket"),$.value=!1}else $.value=!1}function ee(){x?.value?.length>0&&(B.value=x.value?.[0])}return[v,d]=E(()=>p.fetchVPSSchemes()),await v,d(),[v,d]=E(()=>h.fetchContracts()),await v,d(),[v,d]=E(()=>t.fetchServices()),await v,d(),i.value=F.value?.[0],ee(),(s,e)=>{const r=Ie,S=be,V=je,y=Ae,U=de,te=ie,ae=ce,se=ue,oe=ne,re=le;return n(),u(I,null,[g(r),a("div",Fe,[e[11]||(e[11]=a("h1",{class:"tw-text-xl sm:tw-text-4xl tw-mb-4"},"Заказать VPS/VDS сервер",-1)),g(S),g(se,{modelValue:j.value,"onUpdate:modelValue":e[6]||(e[6]=o=>j.value=o),basic_title:"VPS/VDS сервер"},{page:G(()=>[a("div",Ke,[e[8]||(e[8]=a("h2",{class:"section-block_title"},"Конфигурация",-1)),g(V,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=o=>i.value=o),configurations:F.value},null,8,["modelValue","configurations"])]),x.value?(n(),u("div",Re,[e[9]||(e[9]=a("h2",{class:"section-block_title"},"Операционная система",-1)),a("div",ze,[(n(!0),u(I,null,C(x.value,o=>(n(),M(y,{key:o.value,modelValue:B.value,"onUpdate:modelValue":e[1]||(e[1]=N=>B.value=N),data:o,checked:o?.value===B.value?.value},{default:G(()=>[o.imageUrl?(n(),u("img",{key:0,src:o.imageUrl,alt:o.name},null,8,He)):k("",!0)]),_:2},1032,["modelValue","data","checked"]))),128))])])):k("",!0),a("div",We,[e[10]||(e[10]=a("h2",{class:"section-block_title"},"Регион",-1)),a("div",qe,[(n(),u(I,null,C(W,o=>g(y,{key:o.value,modelValue:L,"onUpdate:modelValue":e[2]||(e[2]=N=>L=N),data:o,checked:o?.value===L},null,8,["data","checked"])),64))])]),g(U,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=o=>_.value=o),title:"Информация о сервере",class:"tw-mt-6"},null,8,["modelValue"]),A.value?(n(),M(te,{key:1,modelValue:l.value,"onUpdate:modelValue":e[4]||(e[4]=o=>l.value=o),contract:A.value,scheme:i.value,"service-id":3e4},null,8,["modelValue","contract","scheme"])):k("",!0)]),services:G(()=>[g(ae,{modelValue:m.value,"onUpdate:modelValue":e[5]||(e[5]=o=>m.value=o),"service-search-params":{ServiceID:3e4,ServersGroupID:i.value?.ServersGroupID}},null,8,["modelValue","service-search-params"])]),_:1},8,["modelValue"]),a("div",Je,[l.value?(n(),M(oe,{key:0,tariff:l.value,"additional-services":m.value},null,8,["tariff","additional-services"])):k("",!0),g(re,{class:"btn--wide",label:X.value,disabled:l.value===null||_.value===null,"is-loading":$.value,onClick:e[7]||(e[7]=o=>R())},null,8,["label","disabled","is-loading"])])])],64)}}},wt=T(Qe,[["__scopeId","data-v-befc5b91"]]);export{wt as default};
