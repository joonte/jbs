import{k as ee,o as _,c as L,b as c,a as l,n as oe,t as g,$ as w,a9 as C,w as M,d as ne,F as A,y as ae,z as N,_ as te,e as se,U as le,r as v,h as D,i as re}from"./index-400feb76.js";import{u as ce}from"./domain-71fce806.js";import{u as ie}from"./contracts-d1f15c94.js";import{s as me}from"./useTimeFunction-8602dd60.js";import{I as de}from"./IconSearch-cc35bac7.js";import{S as ue}from"./Select2-2298341f.js";import{s as fe}from"./multiselect-f4d64e06.js";import{D as F}from"./DomainItem-4bda6203.js";import{_ as z}from"./ClausesKeeper-d8c25fea.js";import{B as q}from"./BlockBalanceAgreement-9b1029a8.js";import{u as _e}from"./globalActions-9f4dbd2c.js";import{_ as ve,B as H}from"./IconButtonBack-1a427027.js";import{E as pe}from"./EmptyStateBlock-d1623b92.js";import{_ as ge}from"./FormInputSearch-4b3080df.js";import{f as De}from"./bootstrap-vue-next.es-03cca149.js";import{_ as he}from"./ButtonDefault-7609cc9e.js";import"./OrderIDBadge-045480e3.js";import"./IconDots-af08ce2d.js";import"./IconCard-1439ea83.js";import"./StatusBadge-9e94e9cc.js";import"./HelperComponent-a820e494.js";import"./IconClose-20ed8b3b.js";import"./IconArrow-10b76666.js";import"./IconPlus-8b0adc75.js";const Se={class:"section"},ke={class:"container"},be={class:"title__icon"},Oe={class:"btn__group"},we={class:"group__several"},Ce={class:"list-form"},Ie={class:"list-form_col list-form_col--sm"},Be={class:"list-form_select"},ye={class:"multiselect-option"},Pe={key:0};function Ue(I,n,m,e,d,h){var p,b,O;const u=q,f=ve,i=he,S=H,k=De,B=z,y=ee("Multiselect"),P=ge,U=F,r=pe;return _(),L(A,null,[c(u),l("div",Se,[l("div",ke,[l("div",{class:oe(["section-header",e.isSeveral?"column":""])},[l("div",be,[l("h1",{class:"section-title",onClick:n[0]||(n[0]=o=>e.reloadNow())},g(e.isSeveral?"Продление услуг Домена":"Домены"),1),w(c(f,{onClick:n[1]||(n[1]=o=>e.outSeveralOrders())},null,512),[[C,e.isSeveral]])]),w(l("div",Oe,[w(c(i,{class:"btn-several",label:"Продлить несколько заказов",onClick:n[2]||(n[2]=o=>e.prolongSeveralOrders())},null,512),[[C,e.getDomainsList.length>1]]),c(i,{label:"Заказать",onClick:n[3]||(n[3]=o=>e.navigateToDomainSchemes())}),c(i,{label:"Перенести домен",onClick:n[4]||(n[4]=o=>e.openTransferModal())})],512),[[C,!e.isSeveral]]),w(l("div",we,[c(S,{class:"contr period",modelValue:e.selectPeriod,"onUpdate:modelValue":n[5]||(n[5]=o=>e.selectPeriod=o)},null,8,["modelValue"]),c(k,{id:"checkbox-balance",modelValue:e.useBalance,"onUpdate:modelValue":n[6]||(n[6]=o=>e.useBalance=o),name:"checkbox-balance"},{default:M(()=>[ne("Использовать средства с баланса")]),_:1},8,["modelValue"]),c(i,{label:"Продлить",onClick:n[7]||(n[7]=o=>e.prolongOrders())})],512),[[C,e.isSeveral]])],2),c(B,{partition:"Header:/DomainOrders"}),l("div",Ce,[l("div",Ie,[l("div",Be,[c(y,{modelValue:e.select,"onUpdate:modelValue":n[8]||(n[8]=o=>e.select=o),options:e.getUsers,label:"name",disabled:((p=e.getUsers)==null?void 0:p.length)<=1},{singlelabel:M(({value:o})=>[l("span",null,"# "+g(o.value.padStart(5,"0"))+" / "+g(o.name),1)]),option:M(({option:o})=>[l("div",ye,"# "+g(o.value.padStart(5,"0"))+" / "+g(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),c(P,{modelValue:e.search,"onUpdate:modelValue":n[9]||(n[9]=o=>e.search=o)},null,8,["modelValue"])]),e.getDomainsList&&((b=e.getDomainsList)==null?void 0:b.length)>0?(_(),L("div",Pe,[e.filterProducts&&((O=e.filterProducts)==null?void 0:O.length)>0?(_(!0),L(A,{key:0},ae(e.filterProducts,(o,V)=>(_(),N(U,{"item-data":o,"user-name":e.getUserName(o==null?void 0:o.ContractID),scheme:e.filterDomainScheme(o==null?void 0:o.SchemeID),"info-link":`/DomainOrders/${o==null?void 0:o.OrderID}`,"is-last":V===e.filterProducts.length-1,isSeveral:e.isSeveral,"selected-rows":e.selectedRows,onUpdateSelectedRows:e.handleSelectedRowsUpdate,onDelete:e.deleteItem,onTransfer:e.transferItem,onDesignateOwner:x=>e.designateOwner(o==null?void 0:o.ID),onManage:e.orderManage},null,8,["item-data","user-name","scheme","info-link","is-last","isSeveral","selected-rows","onUpdateSelectedRows","onDelete","onTransfer","onDesignateOwner","onManage"]))),256)):(_(),N(r,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(_(),N(r,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}const Ve={components:{IconSearch:de,DomainItem:F,Select2:ue,Multiselect:fe,ClausesKeeper:z,BlockBalanceAgreement:q,BlockSelectPeriod:H},async setup(){const I=_e(),n=ce(),m=ie(),e=se(),d=le("emitter");d.on("updateDomainsList",()=>{n.fetchDomains()});const h=v("*"),u=v(null),f=v(!1),i=v([]),S=v(null),k=v(!1),B=a=>{i.value=a};async function y(){console.log(i.value);const a=Object.keys(i.value).filter(s=>i.value[s]),t={ServiceID:"20000",ItemsPay:S.value,OrdersIDs:a,...k.value&&{UseBalance:"yes"}};await I.OrdersPay(t).then(s=>{s==="Basket"?(console.log("Success"),e.push("/Basket")):(s==null?void 0:s.Status)==="Ok"&&(f.value=!1,d.emit("open-modal",{component:"BalanceProlong",data:{Message:s==null?void 0:s.Message,Count:s==null?void 0:s.Count}}))})}function P(){f.value=!0}function U(){f.value=!1}const r=D(()=>{var a;return(a=Object.keys(n==null?void 0:n.domainsList).map(t=>n==null?void 0:n.domainsList[t]))==null?void 0:a.reverse()}),p=D(()=>n==null?void 0:n.domainSchemes),b=D(()=>m==null?void 0:m.contractsList),O=D(()=>K(x(r.value))),o=D(()=>{let a=[{value:"*",name:"Все договора"}];return r.value!==null?(Object.keys(r.value).forEach(t=>{var s,R,E;a.find($=>{var j;return $.value===((j=r.value[t])==null?void 0:j.ContractID)})||a.push({value:(s=r.value[t])==null?void 0:s.ContractID,name:(E=b.value[(R=r.value[t])==null?void 0:R.ContractID])==null?void 0:E.Customer})}),a):{value:"*",name:"Все договора"}});re(()=>{r.value.length<1&&T()});function V(){e.go(0)}function x(a){return h.value!=="*"?a.filter(t=>(t==null?void 0:t.ContractID)===h.value):a}function K(a){return u.value!==null?a.filter(t=>t==null?void 0:t.Domain.toLowerCase().includes(u.value.toLowerCase())):a}function G(a){var t;return(t=p.value)==null?void 0:t[a]}function J(a){var t,s;return(s=(t=m==null?void 0:m.contractsList)==null?void 0:t[a])==null?void 0:s.Customer}function Q(a){I.OrderManage(a)}function T(){const a=u.value;e.push({path:"/DomainSchemes",query:{DomainName:a}})}function W(a){d.emit("open-modal",{component:"DeleteItem",data:{id:a,message:`Вы действительно хотите удалить домен #${a}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function X(a){d.emit("open-modal",{component:"OrdersTransfer",data:a})}function Y(){d.emit("open-modal",{component:"DomainTransfer",data:{}})}function Z(a){const t={DomainOrderID:a};d.emit("open-modal",{component:"DomainSelectOwner",data:t})}return await n.fetchDomains(),await n.fetchDomainSchemes(),await m.fetchContracts(),await m.fetchProfiles(),{getDomainsList:r,getDomainsSchemes:p,getUsers:o,select:h,search:u,openTransferModal:Y,filterProducts:O,getUserName:J,designateOwner:Z,deleteItem:W,orderManage:Q,filterDomainScheme:G,navigateToDomainSchemes:T,startFunction:me,transferItem:X,reloadNow:V,prolongSeveralOrders:P,isSeveral:f,selectedRows:i,selectPeriod:S,prolongOrders:y,outSeveralOrders:U,useBalance:k,handleSelectedRowsUpdate:B}}},no=te(Ve,[["render",Ue],["__scopeId","data-v-84fe4f32"]]);export{no as default};
