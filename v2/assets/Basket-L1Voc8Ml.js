import{_ as V}from"./EmptyStateBlock-DA3-0YDi.js";import{_ as $}from"./BlueButton.vue_vue_type_script_setup_true_lang-BKdLNEec.js";import{L as A}from"./bootstrap-vue-next-W16P-SAV.js";import{_ as g}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{o as i,c as r,a as e,D as E,E as j,b as u,v as n,F as f,g as M,C as O,h as y,x as R,t as l,w as m,e as T}from"./index-Codq73aV.js";import{_ as q}from"./ClausesKeeper-iUM0yapS.js";import{_ as z}from"./BlockBalanceAgreement-v_bWuiVT.js";import{u as G}from"./basket-CkUYOxAg.js";import{u as H}from"./index-BO2gwtUe.js";import{f as S}from"./common-DyknwSqv.js";import"./IconClose-Dia1noy8.js";import"./ButtonDefault-CMw2aBy6.js";const J={},K={fill:"none",height:"32",viewBox:"0 0 32 32",width:"32",xmlns:"http://www.w3.org/2000/svg"};function Q(h,c){return i(),r("svg",K,c[0]||(c[0]=[e("rect",{fill:"#F7F9FF",height:"31",rx:"3.5",width:"31",x:".5",y:".5"},null,-1),e("path",{d:"M8.5 11h15m-1.665 0v11.667a1.667 1.667 0 0 1-1.667 1.666h-8.333a1.667 1.667 0 0 1-1.667-1.666V11m2.5 0V9.333a1.667 1.667 0 0 1 1.667-1.666h3.333a1.667 1.667 0 0 1 1.667 1.666V11m-5.003 4.167v5m3.336-5v5",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("rect",{height:"31",rx:"3.5",stroke:"#C7D1ED",width:"31",x:".5",y:".5"},null,-1)]))}const U=g(J,[["render",Q]]),W={class:"tw-px-4 md:tw-px-8"},X={key:0,class:"cart-list tw-mt-4"},Y={key:0,class:"cart-item tw-mb-6"},Z={class:"cart-item__subtitle"},tt={class:"cart-item__subtitle-name"},et={class:"d-block"},st={class:"d-block table-td-blue"},ot=["onClick"],nt={class:"tw-flex tw-items-center tw-justify-between tw-text-2xl tw-mt-4"},lt={__name:"Basket",async setup(h){let c,b;const B=[{key:"ServiceID",label:"Услуга",variant:"td-service"},{key:"OrderID",label:"Номер заказа",variant:"td-service"},{key:"Amount",label:"Период"},{key:"Summ",label:"Сумма"},{key:"controls",label:"Действия",variant:"td-controls"}],a=G(),p=H(),k=E(),v=R("emitter");v.on("form-cart-invoice",o=>{C(o)}),[c,b]=j(()=>Promise.all([a.fetchBasket(),k.fetchServices()])),await c,b();function w(o){let t=0;for(let _=0;_<o.length;_++)t=t+Number(o[_]?.Summ);return t}function D(o,t){v.emit("open-modal",{component:"InvoiceMakeBasket",data:{ItemID:t,ContractPaymentSystems:p.contractsList[t]?.PaymentSystems,ProfileID:p.contractsList[t]?.ProfileID,sum:w(o)}})}function C(o){delete a.basketList[o]}return(o,t)=>{const _=z,I=q,L=U,F=A,P=$,N=V;return i(),r(f,null,[u(_),e("div",W,[t[7]||(t[7]=e("h1",{class:"tw-text-xl sm:tw-text-4xl"},"Корзина",-1)),u(I),n(a).basketList&&Object.keys(n(a).basketList).length?(i(),r("div",X,[(i(!0),r(f,null,M(n(a).basketList,(d,x)=>(i(),r(f,null,[d.length?(i(),r("div",Y,[t[6]||(t[6]=e("div",{class:"cart-item__title"},"Заказ",-1)),e("div",Z,[e("div",tt,l(n(p).contractsList[x].Customer),1)]),u(F,{items:d,fields:B,class:"basic-table table-cart"},{"cell(ServiceID)":m(s=>[t[0]||(t[0]=e("span",{class:"td-mobile"},"Услуга",-1)),e("span",et,l(n(k).servicesList[s.item?.ServiceID]?.Name),1),e("span",st,l(s.item?.Comment),1)]),"cell(OrderID)":m(s=>[t[1]||(t[1]=e("span",{class:"td-mobile"},"Номер заказа",-1)),e("span",null,"№ "+l(s.item?.OrderID),1)]),"cell(Amount)":m(s=>[t[2]||(t[2]=e("span",{class:"td-mobile"},"Период",-1)),e("span",null,l(s.item?.Amount)+" "+l(s.item?.Measure),1)]),"cell(Summ)":m(s=>[t[3]||(t[3]=e("span",{class:"td-mobile"},"Сумма",-1)),e("span",null,l(n(S)(s.item?.Summ)),1)]),"cell(controls)":m(s=>[e("button",{class:"btn-delete btn",onClick:it=>n(a).deleteFromBasket(s.item.ID)},[u(L)],8,ot)]),_:2},1032,["items"]),e("div",nt,[t[4]||(t[4]=e("div",null,"Итого",-1)),e("div",null,l(n(S)(w(d))),1)]),u(P,{onClick:s=>D(d,x),class:"tw-w-full tw-mt-4"},{default:m(()=>t[5]||(t[5]=[T("Оплатить заказ",-1)])),_:2,__:[5]},1032,["onClick"])])):y("",!0)],64))),256))])):o.loading?y("",!0):(i(),O(N,{key:1,label:"Корзина заказов пуста",class:"tw-mt-4"}))])],64)}}},wt=g(lt,[["__scopeId","data-v-1aaeeb69"]]);export{wt as default};
