import{_ as M}from"./EmptyStateBlock-Dks67PsT.js";import{_ as j}from"./ButtonDefault-tVMF5ozh.js";import{m as B}from"./bootstrap-vue-next-9iQSFcL_.js";import{_ as x}from"./IconClip-keYZj_QX.js";import{_ as R}from"./IconClose-Br7S99e8.js";import{_ as q}from"./IconFile-DS54iwgj.js";import{_ as z,a as G,b as J}from"./PhoneInput-DIgphVm8.js";import{_ as K}from"./BasicInput-DI25CRuk.js";import{_ as Q}from"./ClausesKeeper-DtaNhp0a.js";import{_ as W}from"./BlockBalanceAgreement-ckI0MbGb.js";import{c,b as m,a as t,D as g,w as E,G as X,F as y,i as d,j as S,am as Y,r as _,f as H,g as Z,d as $,o as s,e as F,t as w,n as U}from"./index-DxPA2ffO.js";import{u as ee}from"./contracts-DD2O0C6m.js";import{u as le}from"./files--xco-kS0.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./multiselect-DxJoM0Ze.js";import"./component-BeTqOa0q.js";const ae={async setup(){const A=Y(),a=ee(),N=le(),l=$(),C=Z(),k=_(!1),h=_(!1),f=_({}),V=_(null),v=_([]),I=_([]),b=_(null),P=_(null),p=_(0),T=H(()=>A.data),u=H(()=>a.profileList?.[C.params.id]);function D(){if(k.value&&h.value){let o={};Object.keys(f.value).forEach(r=>{o[r]=f.value[r].value});let i=new FormData;Object.keys(f.value).forEach(r=>{i.append(r,f.value[r]?.value)}),i.append("TemplateID",p.value),i.append("Agree",k.value),i.append("AgreeHandle",h.value),i.append("ProfileID",C.params.id),v.value.forEach((r,Ce)=>{i.append("Document[]",r?.value)}),b.value="pending",a.createNewContract({ProfileID:C.params.id,TemplateID:p.value,Agree:k.value,AgreeHandle:h.value,...o}).then(r=>{r.status==="success"?l.push("/Contracts?section=Profiles"):(b.value="error",P.value=r.data?.Exception)})}}function L(o){v.value=v.value.filter((i,r)=>r!==o)}function O(o){return""+n(o)}function e(o){let i=o.target.files?.[0]||null;i&&(V.value.value="",N.sendFile(i).then(r=>{v.value.push({name:i?.name,value:r.slice(r.lastIndexOf("^")+1,r.length)})}))}function n(o){return o?"<div>"+o?.String+"</div>"+n(o?.Parent):""}return await a.fetchContracts().then(()=>{a.fetchProfiles().then(()=>{p.value=u.value?.TemplateID,u.value?.Files&&(I.value=Object.keys(u.value?.Files)?.map(o=>({name:u.value?.Files[o].Name,value:u.value?.Files[o].Name}))),Object.keys(u.value.Attribs).forEach(o=>{f.value[o]={value:u.value.Attribs[o],required:T.value?.Profiles?.Templates?.[p.value]?.Template?.Attribs[o].IsDuty==="1",error:!1}})})}),{getConfig:T,getProfile:u,templateValue:p,agreeHandle:h,fileInput:V,fileList:v,fileListOld:I,agree:k,createProfileResult:b,createProfileErrorMessage:P,checkForm:D,fileUpload:e,removeFile:L,formErrorMessage:O,form:f}}},ne={class:"container"},te={class:"section-header"},se={class:"breadcrumb"},re={class:"form"},ce={class:"special-form-row"},ie={key:0,class:"section-header inputs-block"},ue={class:"section-block_title"},me={key:0,class:"form width-limit"},fe={key:0,class:"form-field form-field--file form-field--basic"},de={class:"chat-files"},_e={key:1,class:"form-field form-field--file form-field--basic"},pe={class:"chat-files"},ve=["onClick"],he={class:"form-field form-field--file form-field--basic"},ge={class:"form-field-input__file-wrapper"},ke={class:"form-field-input__file"},be=["innerHTML"];function ye(A,a,N,l,C,k){const h=W,f=X("router-link"),V=Q,v=K,I=z,b=G,P=J,p=q,T=R,u=x,D=B,L=j,O=M;return s(),c(y,null,[m(h),t("section",null,[t("div",ne,[t("div",te,[t("div",se,[m(f,{to:"/Contracts",class:"section-label"},{default:E(()=>a[4]||(a[4]=[F("Договор /",-1)])),_:1,__:[4]}),m(f,{to:`/ContractScheme/${A.$route.params.id}`,class:"section-label"},{default:E(()=>[F(w(l.getProfile?.Name),1)]),_:1},8,["to"])]),a[5]||(a[5]=t("h1",{class:"section-title"},"Редактировать договор",-1))]),m(V),l.getProfile?(s(),c(y,{key:0},[t("div",re,[(s(!0),c(y,null,S(l.getConfig?.Profiles?.Templates?.[l.templateValue]?.Template?.Attribs,(e,n)=>(s(),c("div",{class:"form-row-wrapper",key:n},[t("div",ce,[e?.Title?(s(),c("div",ie,[t("h2",ue,w(e?.Title),1)])):d("",!0),e?.Type==="Input"&&e?.Check!=="Phone"?(s(),g(v,{key:1,class:U({"special-form-input":!0,"form-field-error":l.form[n].error}),label:e?.Comment,placeholder:e?.Example,necessarily:e?.IsDuty==="1",name:e?.Check,modelValue:l.form[n].value,"onUpdate:modelValue":o=>l.form[n].value=o},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):d("",!0),e?.Type==="Input"&&e?.Check==="Phone"?(s(),g(I,{key:2,class:U({"special-form-input":!0,"form-field-error":l.form[n].error}),label:e?.Comment,placeholder:e?.Example,necessarily:e?.IsDuty==="1",name:e?.Check,modelValue:l.form[n].value,"onUpdate:modelValue":o=>l.form[n].value=o},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):d("",!0),e?.Type==="TextArea"?(s(),g(b,{key:3,class:U({"special-form-input":!0,"form-field-error":l.form[n].error}),label:e?.Comment,placeholder:e?.Example,necessarily:e?.IsDuty==="1",name:e?.Check,modelValue:l.form[n].value,"onUpdate:modelValue":o=>l.form[n].value=o},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):e?.Type==="Select"?(s(),g(P,{key:4,class:U({"special-form-input":!0,"form-field-error":l.form[n].error}),label:e?.Comment,placeholder:e?.Example,necessarily:e?.IsDuty==="1",name:e?.Check,options:e?.Options,modelValue:l.form[n].value,"onUpdate:modelValue":o=>l.form[n].value=o},null,8,["class","label","placeholder","necessarily","name","options","modelValue","onUpdate:modelValue"])):d("",!0)])]))),128))]),l.templateValue!==0?(s(),c("div",me,[l.fileListOld.length?(s(),c("div",fe,[t("div",de,[(s(!0),c(y,null,S(l.fileListOld,(e,n)=>(s(),c("div",{class:"chat-files__item",key:"old-"+n},[t("span",null,[m(p,{class:"file-icon"})]),t("span",null,w(e?.name),1)]))),128))])])):d("",!0),l.fileList.length?(s(),c("div",_e,[t("div",pe,[(s(!0),c(y,null,S(l.fileList,(e,n)=>(s(),c("div",{class:"chat-files__item",key:"new-"+n},[t("span",null,[m(p,{class:"file-icon"})]),t("span",null,w(e?.name),1),t("button",{class:"close",onClick:o=>l.removeFile(n)},[m(T)],8,ve)]))),128))])])):d("",!0),t("label",he,[t("div",ge,[t("input",{ref:"fileInput",type:"file",onChange:a[0]||(a[0]=(...e)=>l.fileUpload&&l.fileUpload(...e))},null,544),t("div",ke,[m(u),a[6]||(a[6]=t("span",null,"Прикрепить документ подтверждающий личность",-1))])])]),m(D,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:l.agree,"onUpdate:modelValue":a[1]||(a[1]=e=>l.agree=e)},{default:E(()=>a[7]||(a[7]=[F(" Подтверждаю свое согласие на передачу информации в электроной форме (в том числе персональных данных) по открытым каналам связи сети Интернет ",-1)])),_:1,__:[7]},8,["modelValue"]),m(D,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:l.agreeHandle,"onUpdate:modelValue":a[2]||(a[2]=e=>l.agreeHandle=e)},{default:E(()=>a[8]||(a[8]=[F(" Я разрешаю передачу своих персональных данных третьим лицам, для выполнения заказанных мною услуг (регистрация доменов и т.п.) ",-1)])),_:1,__:[8]},8,["modelValue"])])):d("",!0),l.createProfileErrorMessage?(s(),c("div",{key:1,class:"error-message width-limit",innerHTML:l.formErrorMessage(l.createProfileErrorMessage)},null,8,be)):d("",!0),l.templateValue!==0?(s(),g(L,{key:2,class:"width-limit","is-loading":l.createProfileResult==="pending",label:"Сохранить",onClick:a[3]||(a[3]=e=>l.checkForm())},null,8,["is-loading"])):d("",!0)],64)):(s(),g(O,{key:1,label:"Профиль договора не найден"}))])])],64)}const je=oe(ae,[["render",ye],["__scopeId","data-v-7b233045"]]);export{je as default};
