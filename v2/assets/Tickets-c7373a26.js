import{j as O,o as P,c as R,b as _,a as o,w as n,d as q,t as i,F as L,a5 as G,x as J,p as Q,l as X,_ as Y,u as Z,e as $,r as d,g as S,h as j}from"./index-01c72474.js";import{u as ee}from"./edesks-1c1bd51d.js";import{_ as H}from"./ClausesKeeper-39926d40.js";import{s as te}from"./multiselect-b3bc32a2.js";import{E as z}from"./EmptyStateBlock-453d542f.js";import{B as K}from"./BlockBalanceAgreement-89ea0555.js";import{a as oe,f as se}from"./useTimeFunction-8602dd60.js";import{C as ae,F as le}from"./bootstrap-vue-next.es-44eeb912.js";import{S as ne}from"./StatusBadge-1436ac85.js";import{_ as re}from"./FormInputSearch-45daa112.js";import"./IconClose-6051fe98.js";import"./contracts-b8a59bf1.js";import"./ButtonDefault-6f60da99.js";import"./IconArrow-669aa41b.js";import"./IconPlus-404a795f.js";import"./IconSearch-411bb244.js";const ce=[{key:"ID",label:"Номер"},{key:"UpdateDate",label:"Дата и время",sortable:!0,variant:"td-gray td-order"},{key:"PriorityID",label:"Приоритет",sortable:!0,variant:"td-gray td-order"},{key:"Theme",label:"Тема"},{key:"MessageID",label:"Количество сообщений"},{key:"StatusID",label:"Статус",sortable:!0,variant:"td-gray td-order"}],ie={Newest:{color:"#459FD1",background:"#ADC1F04C"},Opened:{color:"#FFC107",background:"#FFC10733"},Working:{color:"#28A745",background:"#EAF7ED"},Closed:{color:"#838383",background:"#57699B19"}},de={Low:{background:"#8FD658"},Middle:{background:"#FFC700"},Hight:{background:"#DF5747"}},c=u=>(Q("data-v-23f1f86f"),u=u(),X(),u),ue={class:"section"},_e={class:"container"},pe={class:"section-header"},me=c(()=>o("h1",{class:"section-title"},"Служба поддержки",-1)),ge={class:"btn__group"},fe={class:"list-form"},be={class:"list-form_col list-form_col--sm"},ke={class:"list-form_select"},ve={class:"multiselect-option"},De=c(()=>o("span",{class:"td-mobile"},"Номер",-1)),he={class:"d-block"},ye=c(()=>o("span",{class:"td-mobile"},"Дата и время",-1)),Fe=c(()=>o("span",{class:"td-mobile"},"Приоритет",-1)),Ie=c(()=>o("span",{class:"td-mobile"},"Тема",-1)),Te={class:"cell__theme"},Be=c(()=>o("span",{class:"td-mobile"},"Количество сообщений",-1)),Ee=c(()=>o("span",{class:"td-mobile"},"Статус",-1)),Ce=c(()=>o("span",null,"Ничего не найдено",-1)),Pe=c(()=>o("span",null,"Ничего не найдено",-1)),Se={class:"table-controls"},Ve=c(()=>o("span",{class:"text-success"},"First",-1)),we=c(()=>o("span",{class:"text-info"},"Last",-1)),xe={class:"multiselect-multiple-label"},Ue={class:"multiselect-option"};function Ne(u,l,V,e,f,D){const I=K,b=O("router-link"),T=H,m=O("Multiselect"),B=re,E=ne,C=ae,k=le,g=z;return P(),R(L,null,[_(I),o("div",ue,[o("div",_e,[o("div",pe,[me,o("div",ge,[_(b,{class:"btn btn--blue btn-default",to:"/NewTicket"},{default:n(()=>[q("Создать тикет")]),_:1})])]),_(T,{partition:"Header:/Tickets"}),o("div",fe,[o("div",be,[o("div",ke,[_(m,{options:e.options,label:"name",modelValue:e.select,"onUpdate:modelValue":l[0]||(l[0]=t=>e.select=t)},{option:n(({option:t})=>[o("div",ve,i(t.name),1)]),_:1},8,["options","modelValue"])])]),_(B,{modelValue:e.filter,"onUpdate:modelValue":l[1]||(l[1]=t=>e.filter=t)},null,8,["modelValue"])]),e.getEDeskItems&&e.getEDeskItems.length?(P(),R(L,{key:0},[_(C,{class:"basic-table",items:e.onFiltered(e.filterTableItems(e.getEDeskItems)),"per-page":e.perPage,"current-page":e.currentPage,fields:e.ticketsTable,"show-empty":"","sort-by":e.sortBy,"onUpdate:sortBy":l[2]||(l[2]=t=>e.sortBy=t),"sort-desc":e.sortDesc,"onUpdate:sortDesc":l[3]||(l[3]=t=>e.sortDesc=t),"sort-direction":e.sortDirection,onRowClicked:e.navigateToTicket},{"cell(ID)":n(t=>[De,o("span",he,i(t.value),1)]),"cell(UpdateDate)":n(t=>[ye,o("span",null,i(e.formNormalDate(e.secondToDate(t.value))),1)]),"cell(PriorityID)":n(t=>{var v,h,y,F;return[Fe,o("span",{class:"status-tag",style:G(`color: #FFF; background-color: ${(h=(v=e.priorities)==null?void 0:v[t.value])==null?void 0:h.background}; border-color: ${(F=(y=e.priorities)==null?void 0:y[t.value])==null?void 0:F.background}`)},i(e.findPriority(t.value)),5)]}),"cell(Theme)":n(t=>[Ie,o("span",Te,i(t.value),1)]),"cell(MessageID)":n(t=>[Be,o("span",null,i(t.value),1)]),"cell(StatusID)":n(t=>[Ee,_(E,{status:t.value,"status-table":"Edesks"},null,8,["status"])]),empty:n(t=>[Ce]),emptyfiltered:n(t=>[Pe]),_:1},8,["items","per-page","current-page","fields","sort-by","sort-desc","sort-direction","onRowClicked"]),o("div",Se,[_(k,{modelValue:e.currentPage,"onUpdate:modelValue":l[4]||(l[4]=t=>e.currentPage=t),"total-rows":e.totalRows,"per-page":e.perPage,"first-number":"","last-number":""},{"first-text":n(()=>[Ve]),"last-text":n(()=>[we]),page:n(({page:t,active:v})=>[o("span",null,i((t-1)*e.perPage+1)+"-"+i(t*e.perPage),1)]),_:1},8,["modelValue","total-rows","per-page"]),_(m,{class:"multiselect--white",modelValue:e.perPage,"onUpdate:modelValue":l[5]||(l[5]=t=>e.perPage=t),options:e.pageOptions,label:"name",openDirection:"top"},{singlelabel:n(({value:t})=>[o("div",xe,[o("span",null,"Отображать "+i(t.value)+" строк",1)])]),option:n(({option:t})=>[o("div",Ue,"Отображать "+i(t.name)+" строк",1)]),_:1},8,["modelValue","options"])])],64)):(P(),J(g,{key:1,class:"no-margin",label:"Вы пока не обращались в тех. поддержку "}))])])],64)}const Me={components:{ClausesKeeper:H,Multiselect:te,EmptyStateBlock:z,BlockBalanceAgreement:K},async setup(){const u=ee(),l=Z(),V=$(),e=d("*"),f=d(""),D=d(1),I=d(10),b=d(0),T=d([10,25,50,100]),m=d([]),B=d("UpdateDate"),E=d(!0),C=d("desc"),k=S(()=>u==null?void 0:u.eDesksList),g=S(()=>l==null?void 0:l.ConfigList),t=S(()=>{var a,r;return(r=(a=Object.keys(k.value))==null?void 0:a.map(s=>{var p;return(p=k.value)==null?void 0:p[s]}))==null?void 0:r.reverse()});await u.fetchEDesks().then(()=>{var a,r,s,p,w;b.value=t.value.length,(r=(a=g.value)==null?void 0:a.Statuses)!=null&&r.Edesks&&(m.value=(w=Object.keys((p=(s=g.value)==null?void 0:s.Statuses)==null?void 0:p.Edesks))==null?void 0:w.map(x=>{var U,N,M,A;return{value:x,name:(A=(M=(N=(U=g.value)==null?void 0:U.Statuses)==null?void 0:N.Edesks)==null?void 0:M[x])==null?void 0:A.Name}})),m.value.push({value:"*",name:"Все тикеты"})});function v(a){var r;return(r=a==null?void 0:a.filter(s=>e.value==="*"?!0:(s==null?void 0:s.StatusID)===(e==null?void 0:e.value)))==null?void 0:r.filter(s=>(s==null?void 0:s.ID.includes(f.value))||(s==null?void 0:s.Theme.includes(f.value)))}function h(a){return b.value=a.length>0?a.length:1,a}function y(a){var r;return(r=m.value.find(s=>(s==null?void 0:s.value)===a))==null?void 0:r.name}function F(a){var r,s,p;return(p=(s=(r=g.value)==null?void 0:r.Edesks)==null?void 0:s.Priorities)==null?void 0:p[a]}function W(a){V.push({path:`Ticket/${a==null?void 0:a.ID}`})}return j(f,()=>{D.value=1}),j(e,()=>{D.value=1}),{getEDesks:k,getEDeskItems:t,select:e,filter:f,currentPage:D,perPage:I,options:m,totalRows:b,pageOptions:T,sortBy:B,sortDesc:E,sortDirection:C,ticketsTable:ce,statuses:ie,priorities:de,findStatus:y,findPriority:F,onFiltered:h,filterTableItems:v,secondToDate:oe,formNormalDate:se,navigateToTicket:W}}},$e=Y(Me,[["render",Ne],["__scopeId","data-v-23f1f86f"]]);export{$e as default};
