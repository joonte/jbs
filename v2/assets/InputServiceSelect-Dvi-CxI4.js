import{f as P}from"./common-DyknwSqv.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{N as B,o as l,c as r,a as n,t as D,v as U,h as f,O as R,r as g,m as k,I as E,i as L,f as S,b as M,e as $,F as y,g as x,K,Y,C as F}from"./index-Codq73aV.js";import{_ as z}from"./InputSelect.vue_vue_type_script_setup_true_lang-D7E9_BoS.js";import{_ as G}from"./BasicInput-DeQAeyXe.js";import{u as H}from"./services-DyPBvbVy.js";const J={class:"form-input_border"},Q=["value","checked"],W={class:"form-input_border-content"},X={class:"form-input_border-item form-input_border-item--left"},Z={class:"form-input_border-item form-input_border-item--right"},ee={key:0,class:"list-item__prompt"},te={__name:"InputRadio",props:R({data:{type:Object,default:()=>{}},prompt:{type:String,default:""}},{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const s=B(o,"modelValue");function _(d){s.value=d}return(d,m)=>(l(),r("label",J,[n("input",{type:"radio",value:o.data.value,checked:s.value.value===o.data.value,onChange:m[0]||(m[0]=u=>_(o.data))},null,40,Q),n("span",W,[m[1]||(m[1]=n("span",{class:"form-input_border-mark"},null,-1)),n("span",X,D(o.data.name),1),n("span",Z,D(U(P)(o.data.price)),1),o.prompt?(l(),r("div",ee,D(o.prompt),1)):f("",!0)])]))}},ae=N(te,[["__scopeId","data-v-b2c439da"]]),oe={class:"form-input_border"},se=["checked","type"],le={class:"form-input_border-content"},ne={class:"form-input_border-item form-input_border-item--left"},re={key:0,class:"form-input_border-item form-input_border-item--right"},ue={key:1,class:"list-item__prompt"},ie={__name:"InputBorderCheckboxRadio",props:{modelValue:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},checkbox:{type:Boolean,default:!1},prompt:{type:String,default:""}},emits:["update:modelValue"],setup(o,{emit:s}){const _=o,d=s,m=g(null);function u(){d("update:modelValue",_.data)}return k(_,()=>{m.value=_.modelValue}),E(()=>{m.value=_.modelValue}),(p,I)=>(l(),r("label",oe,[n("input",{checked:m.value?.value===o.data?.value,type:o.checkbox?"checkbox":"radio",onInput:u},null,40,se),n("span",le,[I[0]||(I[0]=n("span",{class:"form-input_border-mark"},null,-1)),n("span",ne,D(o.data.name),1),o.data.price?(l(),r("span",re,D(U(P)(o.data.price)),1)):f("",!0),o.prompt?(l(),r("div",ue,D(o.prompt),1)):f("",!0)])]))}},ce=N(ie,[["__scopeId","data-v-3bffc248"]]),de={key:0,class:"tw-flex tw-items-center tw-gap-4 tw-mt-4"},me={key:1,class:"tw-flex tw-flex-col md:tw-flex-row md:tw-items-center tw-gap-4 tw-mt-4"},pe={class:"tw-w-full"},ve={class:"form-field__label"},fe={key:0,class:"tw-text-red-500 tw-ml-1"},_e={class:"form-field-input__wrapper"},De=["onUpdate:modelValue","title","name"],Ie={key:3,class:"list tw-mt-4"},be={class:"list-col list-col--md"},he={key:4,class:"list"},Se={class:"list-item__title"},ye={key:0,class:"tw-text-red-500 tw-ml-1"},ke={__name:"InputServiceSelect",props:R({sectionData:{type:Object,default:()=>({})}},{modelValue:{type:Object},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const s=o,_=B(o,"modelValue"),d=H(),m=L(),u=g({}),p=g(null),I=g(null),w=S(()=>(console.log(d.additionalServicesScheme[s.sectionData.Code]),Object.values(d.additionalServicesScheme[s.sectionData.Code]||{}).filter(e=>e.IsActive).filter(e=>p.value===0||p.value===null?!0:e.DependOrders?Object.keys(e.DependOrders).map(Number).includes(p.value):!1).map(e=>({value:e.ID,price:e.CostMonth,name:e.Name})).sort((e,a)=>e.SortID-a.SortID))),V=S(()=>s.sectionData?.ServicesFields?s.sectionData.ServicesFields.filter(e=>e.TypeID==="Select").sort((e,a)=>e.SortID-a.SortID):[]),C=S(()=>s.sectionData?.ServicesFields?s.sectionData.ServicesFields.filter(e=>e.TypeID==="Input").sort((e,a)=>e.SortID-a.SortID):[]),b=S(()=>{let e=[];if(s.sectionData.Code==="Default"){const i=Object.values(d.ServicesList).find(t=>t.ID===Number(m.query.ServiceID));if(i){const t=i.DependOrders;t&&(e=Object.keys(t).map(c=>({name:t[c],value:Number(c)})))}return e}const a=d.additionalServicesScheme[s.sectionData.Code];if(!a)return e;const v=Object.values(a).filter(i=>i?.IsActive&&i?.DependOrders).flatMap(i=>Object.entries(i.DependOrders)),h=new Map;v.forEach(([i,t])=>{const c=`${i}:${t}`;h.has(c)||h.set(c,{name:t,value:Number(i)})});const O=Array.from(h.values());return s.sectionData.ID===51e3?e=[{name:"Без заказа",value:0},...O]:e=O,e}),A=S(()=>{let e=0;for(const a of Object.values(u.value).filter(v=>v?.price))e+=Number(a.price);return e+Number(s.sectionData?.Cost)+Number(s.sectionData?.CostOn)});k([V,w],()=>{for(const e of V.value)u.value[`ID${e?.ID}`]=j(e)?.[0];u.value[`${s.sectionData.Code}SchemeID`]=w.value?.[0]},{immediate:!0}),k(b,()=>{p.value=b.value[0]?.value},{immediate:!0}),k(m,async()=>{s.sectionData.Code!=="Default"&&await d.fetchAdditionalServiceScheme(s.sectionData.Code)},{immediate:!0}),k([u,p,I],()=>{const e={};for(const[a,v]of Object.entries(u.value||{}))e[a]=v?.value??v;e.ServiceID=s.sectionData.ID,e.Price=A.value,e.Name=d.ServicesList[e.ServiceID].Name,e.DependOrderID=p.value,p.value===0&&(e.IP=I.value),_.value=e},{immediate:!0,deep:!0});function j(e){return e?.Options?Object.entries(e.Options).map(([a,v])=>({value:a,name:v.Name,price:Number(v.Cost)})):[]}function T(){return s.sectionData.ID===5e4&&b.value.length<1}return(e,a)=>{const v=G,h=z,O=ce,i=ae;return l(),r(y,null,[p.value===0&&o.sectionData.ID===51e3?(l(),r("div",de,[M(v,{modelValue:I.value,"onUpdate:modelValue":a[0]||(a[0]=t=>I.value=t),name:"ServiceIP",placeholder:"0.0.0.0",label:"IP адрес лицензии",necessarily:!0},null,8,["modelValue"])])):f("",!0),b.value?.length>0?(l(),r("div",me,[a[3]||(a[3]=n("div",{class:"tw-flex-none tw-w-64"},[$(" Выбрать заказ "),n("span",{class:"tw-text-red-500 tw-ml-1"},"*")],-1)),n("div",pe,[M(h,{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=t=>p.value=t),options:b.value,class:"lg:tw-max-w-[660px]"},null,8,["modelValue","options"])])])):f("",!0),C.value?.length>0?(l(!0),r(y,{key:2},x(C.value,t=>(l(),r("div",{key:t.ID,class:"form-field form-field--basic tw-mt-4"},[n("div",ve,[$(D(t.Name)+" ",1),t.IsDuty?(l(),r("span",fe," * ")):f("",!0)]),n("div",_e,[K(n("input",{"onUpdate:modelValue":c=>u.value[`ID${t.ID}`]=c,title:t.Prompt,name:`ID${t.ID}`},null,8,De),[[Y,u.value[`ID${t.ID}`]]])])]))),128)):f("",!0),o.sectionData?.Code!=="Default"&&w.value.length>0?(l(),r("div",Ie,[n("div",be,[a[4]||(a[4]=n("div",{class:"list-item__title"},[$(" Тариф "),n("span",{class:"tw-text-red-500 tw-ml-1"},"*")],-1)),(l(!0),r(y,null,x(w.value,t=>(l(),F(O,{key:t.value,modelValue:u.value[`${o.sectionData?.Code}SchemeID`],"onUpdate:modelValue":a[2]||(a[2]=c=>u.value[`${o.sectionData?.Code}SchemeID`]=c),checkbox:!1,data:t,disabled:T()},null,8,["modelValue","data","disabled"]))),128))])])):f("",!0),V.value.length>0?(l(),r("div",he,[(l(!0),r(y,null,x(V.value,t=>(l(),r("div",{key:t.ID,class:"list-col list-col--md"},[n("div",Se,[$(D(t.Name)+" ",1),t.IsDuty?(l(),r("span",ye," * ")):f("",!0)]),(l(!0),r(y,null,x(j(t),c=>(l(),F(i,{key:c.value,modelValue:u.value[`ID${t.ID}`],"onUpdate:modelValue":q=>u.value[`ID${t.ID}`]=q,data:c,prompt:t.Prompt},null,8,["modelValue","onUpdate:modelValue","data","prompt"]))),128))]))),128))])):f("",!0)],64)}}},Ne=N(ke,[["__scopeId","data-v-b139a374"]]);export{Ne as _};
