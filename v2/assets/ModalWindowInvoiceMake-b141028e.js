import{o as n,c as a,F as _,x as A,n as L,a as v,t as w,k as B,p as N,l as O,_ as T,u as V,S as W,r as j,e as z,g as b}from"./index-145d9cde.js";import{_ as E}from"./ButtonDefault-6a3a5e1e.js";import{u as R}from"./invoices-c06baac9.js";import{u as q}from"./postings-e3294b77.js";const G=o=>(N("data-v-34f3f606"),o=o(),O(),o),H={class:"list-part"},J=G(()=>v("div",{class:"list-item__title"},"Выбрать платёжную систему",-1)),K={key:0,class:"list-row grid-net"},Q=["onClick"],U=["src"],X={class:"list-item__image-title"},Y={class:"modal__error"};function Z(o,y,p,s,m,f){return n(),a("div",H,[J,s.filterActiveSystems?(n(),a("div",K,[(n(!0),a(_,null,A(s.filterActiveSystems,u=>(n(),a(_,null,[(n(!0),a(_,null,A(u,e=>{var c;return n(),a(_,null,[e!=null&&e.IsActive?(n(),a("div",{key:0,class:L(["list-item",{"list-item_active":((c=s.paymentSystem)==null?void 0:c.id)===(e==null?void 0:e.ID)}]),onClick:I=>{s.paymentSystem={id:e==null?void 0:e.ID,type:e==null?void 0:e.Source},s.selectPaymentSystem()}},[v("img",{class:"list-item__image",src:e==null?void 0:e.Image},null,8,U),v("div",X,w(e==null?void 0:e.Description),1)],10,Q)):B("",!0)],64)}),256))],64))),256))])):B("",!0),v("div",Y,w(s.errorMessage),1)])}const $={components:{ButtonDefault:E},props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(o,{emit:y}){const p=V(),s=R(),m=q(),f=W("emitter"),u=j(null);z();const e=b(()=>p.ConfigList),c=j(null),I=b(()=>{var l,r;return(l=e.value)!=null&&l.PaymentSystems?Object.keys((r=e.value)==null?void 0:r.PaymentSystems).map(t=>{var i,d,S,g,D,h,C,k,P,M,x;return String((S=(d=(i=e.value)==null?void 0:i.PaymentSystems)==null?void 0:d[t])==null?void 0:S.IsActive)==="1"&&((k=(h=(D=(g=e.value)==null?void 0:g.PaymentSystems)==null?void 0:D[t])==null?void 0:h.ContractsTypes)==null?void 0:k[(C=o.data)==null?void 0:C.TypeID])==="1"?(x=(M=(P=e.value)==null?void 0:P.PaymentSystems)==null?void 0:M[t])==null?void 0:x.Collations:null}).filter(t=>t!==null):null});function F(){var l,r;c.value!==null&&s.InvoiceMake({ContractID:(l=o.data)==null?void 0:l.ItemID,PaymentSystemID:(r=c.value)==null?void 0:r.type}).then(t=>{if(t.status==="success"&&t.data&&t.data.InvoiceID){y("modalClose");const i=t.data.InvoiceID;m.InvoiceDocument({InvoiceID:i}).then(d=>{f.emit("open-modal",{component:"InvoiceDocument",data:{html:d,ID:i}})})}else u.value=t})}return{getConfig:e,errorMessage:u,filterActiveSystems:I,selectPaymentSystem:F,paymentSystem:c}}},ne=T($,[["render",Z],["__scopeId","data-v-34f3f606"]]);export{ne as default};
