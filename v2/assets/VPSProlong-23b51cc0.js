import{E as X}from"./EmptyStateBlock-dbc11827.js";import{_ as Z}from"./ButtonDefault-a8aacc82.js";import{_ as ee}from"./BlockOrderPayBalance-a68e17cc.js";import{_ as te}from"./ClausesKeeper-9aa8ead7.js";import{_ as se,e as oe,a6 as ae,r as f,g as S,af as y,o as d,c as u,a as t,b,F as K,t as c,v as ce,k as le,Y as U,ad as Y,p as ne,l as _e}from"./index-ed1f28f8.js";import{u as re}from"./vps-526e1f01.js";import{u as ie}from"./contracts-cedf6a91.js";import"./bootstrap-vue-next.es-79226723.js";import"./IconHelp-730981ad.js";import"./globalActions-55d313ae.js";import"./BasicInput-13cf2877.js";import"./component2-08856ab6.js";import"./component-cdbc2d35.js";import"./IconClose-a1e58263.js";const g=p=>(ne("data-v-403a4169"),p=p(),_e(),p),de={key:0,class:"vps-scheme-page"},ue={class:"section"},pe={class:"container"},ve=g(()=>t("div",{class:"section-header"},[t("h1",{class:"section-title"},"Оплата заказа VPS/VDS сервера")],-1)),me={class:"section"},he={class:"container"},Se={class:"total-block"},be={class:"total-block__row divider-bottom"},ke=g(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),fe={class:"total-block__col"},ye={class:"total-block__row no-divider"},ge={class:"total-block__col"},Ve={class:"total-block__col"},De={class:"total-block__row total-block__row--big economy-line"},Pe=g(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),Ie={class:"total-block__col flex-col"},we={class:"red"},Be={class:"total-block__row total-block__row--big"},Ce={class:"total-block__col"},Ee={class:"total-block__col"},xe={key:1,class:"section"},Oe={class:"container"},Fe={__name:"VPSProlong",async setup(p){let n,_;const l=re(),V=ie(),D=oe(),q=ae(),s=f(null),v=f(null),k=f(!1),z=S(()=>Object.keys(l.vpsSchemes).map(e=>l.vpsSchemes[e])),m=S(()=>Object.keys(l.vpsList).map(e=>l.vpsList[e]).find(e=>e.OrderID===q.params.id)),G=S(()=>V.contractsList),J=S(()=>z.value.find(e=>{var o;return(e==null?void 0:e.ID)===((o=m.value)==null?void 0:o.SchemeID)}));function h(e){return Number(e).toFixed(2)||0}function P(){var o,r;let e=0;return(r=(o=s.value)==null?void 0:o.discounts)==null||r.Bonuses.map(i=>{e+=+i.Economy}),e}function M(e){s.value=e}function Q(){var e,o;k.value=!0,l.VPSOrderPay({VPSOrderID:(e=m.value)==null?void 0:e.ID,DaysPay:(o=s.value)==null?void 0:o.actualDays,IsChange:!0}).then(r=>{let{result:i,error:I}=r;i==="SUCCESS"?D.push("/VPSOrders"):i==="BASKET"&&D.push("/Basket"),k.value=!0})}return[n,_]=y(()=>l.fetchVPSSchemes()),await n,_(),[n,_]=y(()=>V.fetchContracts()),await n,_(),[n,_]=y(()=>l.fetchVPS().then(()=>{var e;v.value=(e=m.value)==null?void 0:e.ContractID})),await n,_(),(e,o)=>{var w,B,C,E,x,O,F,L,N,T,$,j,A,R,H;const r=te,i=ee,I=Z,W=X;return m.value?(d(),u("div",de,[t("div",ue,[t("div",pe,[ve,b(r,{partition:"Header:/VPSSchemes"})])]),b(i,{contractID:v.value,scheme:J.value,serviceID:"30000",isOrderID:!1,onSelect:M},null,8,["contractID","scheme"]),t("div",me,[t("div",he,[t("div",Se,[((C=(B=(w=s.value)==null?void 0:w.discounts)==null?void 0:B.Bonuses)==null?void 0:C.length)>0?(d(),u(K,{key:0},[t("div",be,[ke,t("div",fe,c(h((E=s.value)==null?void 0:E.price))+" ₽",1)]),(d(!0),u(K,null,ce((O=(x=s.value)==null?void 0:x.discounts)==null?void 0:O.Bonuses,a=>(d(),u("div",ye,[t("div",ge,"Скидка "+c(a==null?void 0:a.Discount)+"% на "+c(a==null?void 0:a.Days)+" дней",1),t("div",Ve,"-"+c(h(a==null?void 0:a.Economy))+" ₽",1)]))),256))],64)):le("",!0),U(t("div",De,[Pe,t("div",Ie,[t("span",null,[t("s",null,c(h((F=s.value)==null?void 0:F.price))+" ₽",1)]),t("span",we,"-"+c(P())+" ₽",1)])],512),[[Y,((T=(N=(L=s.value)==null?void 0:L.discounts)==null?void 0:N.Bonuses)==null?void 0:T.length)>0]]),U(t("div",Be,[t("div",Ce,"Итого за "+c(($=s.value)==null?void 0:$.label),1),t("div",Ee,c(h(((j=s.value)==null?void 0:j.price)-P()))+" ₽",1)],512),[[Y,(A=s.value)==null?void 0:A.price]])]),b(I,{class:"btn--wide",label:((R=G.value[v.value])==null?void 0:R.Balance)>((H=s.value)==null?void 0:H.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:s.value===null||v.value===null,"is-loading":k.value,onClick:o[0]||(o[0]=a=>Q())},null,8,["label","disabled","is-loading"])])])])):(d(),u("div",xe,[t("div",Oe,[b(W,{label:"Заказ VPS/VDS сервера не найден"})])]))}}},Je=se(Fe,[["__scopeId","data-v-403a4169"]]);export{Je as default};
