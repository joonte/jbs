import{_ as F,j as R,o as g,c as L,a as c,b as i,w as _,d as h,t as I,k as U,F as A,v as G,x as V,p as J,l as Q,e as W,R as X,r as E,g as P}from"./index-87a66f57.js";import{u as Y}from"./domain-ded20d42.js";import{u as Z}from"./contracts-63b183f3.js";import{f as j,s as ee}from"./useTimeFunction-8602dd60.js";import{I as te}from"./IconSearch-c3e117a8.js";import{S as ne}from"./Select2-1a2df089.js";import{s as oe}from"./multiselect-19c64478.js";import{z as ae,k as se,d as re}from"./bootstrap-vue-next.es-e0094127.js";import{_ as ie}from"./OrderIDBadge-5be8d5d9.js";import{_ as le}from"./IconDots-c481ec47.js";import{_ as ce}from"./IconCard-4f04d33d.js";import{S as me}from"./StatusBadge-74310711.js";import{_ as de}from"./HelperComponent-cba1b053.js";import{_ as z}from"./ClausesKeeper-068355e6.js";import{B as H}from"./BlockBalanceAgreement-f9b358ae.js";import{u as ue}from"./globalActions-a3f84ce4.js";import{E as _e}from"./EmptyStateBlock-f512ef0a.js";import{_ as fe}from"./FormInputSearch-f93020c4.js";import{_ as De}from"./ButtonDefault-646e2a65.js";import"./IconArrow-8c8c28c1.js";import"./IconClose-81d0053a.js";import"./IconPlus-a33d0542.js";const ge={class:"hosting-item"},pe={class:"hosting-item__row"},ve={class:"hosting-item__date"},he={class:"hosting-item__row"},Ie={class:"hosting-item__person"},be={class:"hosting-item__row"},ke={class:"hosting-item__list"},Oe={key:0},ye={key:1,class:"bold"},we={class:"hosting-item__controls"},Ce={class:"btn btn--dots"},Se={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","designateOwner","manage"],setup(n,{emit:t}){const m=n;function a(l){if(!l)return j(new Date);const o=new Date,D=new Date(o.getTime()+l*24*60*60*1e3);return j(D)}function p(){var l,o;console.log((l=m.itemData)==null?void 0:l.ID),t("delete",(o=m.itemData)==null?void 0:o.ID)}function y(){var l,o;t("transfer",{ServiceOrderID:(l=m.itemData)==null?void 0:l.ID,ServiceID:(o=m.itemData)==null?void 0:o.ServiceID})}function b(){var l;t("designateOwner",{DomainOrderID:(l=m.itemData)==null?void 0:l.ID})}function u(){var l,o,D;t("manage",{ServiceOrderID:(l=m.itemData)==null?void 0:l.ID,ServiceID:(o=m.itemData)==null?void 0:o.ServiceID,OrderID:(D=m.itemData)==null?void 0:D.OrderID})}return(l,o)=>{var O,s,S,M,N,x,T,e,r,v;const D=ie,k=R("router-link"),f=ae,w=se,C=re;return g(),L("div",ge,[c("div",pe,[i(D,{orderID:(O=n.itemData)==null?void 0:O.OrderID},null,8,["orderID"]),i(k,{class:"hosting-item__name",to:n.infoLink},{default:_(()=>{var d;return[h(I((d=n.itemData)==null?void 0:d.Domain),1)]}),_:1},8,["to"]),i(me,{status:(s=n.itemData)==null?void 0:s.StatusID,"status-table":"DomainOrders"},null,8,["status"]),c("div",ve,"Дата окончания "+I(a((S=n.itemData)==null?void 0:S.DaysRemainded))+" | "+I(((M=n.itemData)==null?void 0:M.DaysRemainded)||0)+" дн.",1)]),c("div",he,[c("div",Ie,I(n.userName),1),i(de,{"user-notice":(N=n.itemData)==null?void 0:N.UserNotice,id:(x=n.itemData)==null?void 0:x.OrderID,position:n.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),c("div",be,[c("ul",ke,[(T=n.scheme)!=null&&T.PackageID?(g(),L("li",Oe,I((e=n.scheme)==null?void 0:e.PackageID),1)):U("",!0),(r=n.scheme)!=null&&r.CostProlong?(g(),L("li",ye,I((v=n.scheme)==null?void 0:v.CostProlong)+" ₽",1)):U("",!0)])]),c("div",we,[c("button",{class:"btn btn--md btn--bold",onClick:o[0]||(o[0]=d=>{var B;return l.$router.push(`/DomainOrderPay/${(B=n.itemData)==null?void 0:B.OrderID}`)})},[i(ce),h("Оплатить")]),i(C,{class:"dropdown-dots",right:""},{"button-content":_(()=>[c("div",Ce,[i(le)])]),default:_(()=>[i(f,null,{default:_(()=>[i(k,{to:n.infoLink},{default:_(()=>[h("Дополнительная информация")]),_:1},8,["to"])]),_:1}),i(f,null,{default:_(()=>{var d;return[i(k,{to:`/DomainOrderPay/${(d=n.itemData)==null?void 0:d.OrderID}`},{default:_(()=>[h("Оплатить заказ")]),_:1},8,["to"])]}),_:1}),i(f,{onClick:o[1]||(o[1]=d=>b())},{default:_(()=>[h("Определить владельца")]),_:1}),i(f,{onClick:o[2]||(o[2]=d=>y())},{default:_(()=>[h("Передать на другой аккаунт")]),_:1}),i(f,{onClick:o[3]||(o[3]=d=>u())},{default:_(()=>[h("Управлять заказом")]),_:1}),i(w),i(f,{class:"color-red",onClick:o[4]||(o[4]=d=>p())},{default:_(()=>[h("Удалить")]),_:1})]),_:1})])])}}},K=F(Se,[["__scopeId","data-v-bacabddf"]]),Le=n=>(J("data-v-b8f62c5a"),n=n(),Q(),n),Be={class:"section"},Pe={class:"container"},Me={class:"section-header"},Ne=Le(()=>c("h1",{class:"section-title"},"Домены",-1)),xe={class:"btn__group"},Te={class:"list-form"},Ve={class:"list-form_col list-form_col--sm"},$e={class:"list-form_select"},Ue={class:"multiselect-option"},Ae={key:0};function Ee(n,t,m,a,p,y){var w,C,O;const b=H,u=De,l=z,o=R("Multiselect"),D=fe,k=K,f=_e;return g(),L(A,null,[i(b),c("div",Be,[c("div",Pe,[c("div",Me,[Ne,c("div",xe,[i(u,{label:"Заказать",onClick:t[0]||(t[0]=s=>a.navigateToDomainSchemes())}),i(u,{label:"Перенести домен",onClick:t[1]||(t[1]=s=>a.openTransferModal())})])]),i(l,{partition:"Header:/DomainOrders"}),c("div",Te,[c("div",Ve,[c("div",$e,[i(o,{modelValue:a.select,"onUpdate:modelValue":t[2]||(t[2]=s=>a.select=s),options:a.getUsers,label:"name",disabled:((w=a.getUsers)==null?void 0:w.length)<=1},{option:_(({option:s})=>[c("div",Ue,"# "+I(s.value.padStart(5,"0"))+" / "+I(s.name),1)]),_:1},8,["modelValue","options","disabled"])])]),i(D,{modelValue:a.search,"onUpdate:modelValue":t[3]||(t[3]=s=>a.search=s)},null,8,["modelValue"])]),a.getDomainsList&&((C=a.getDomainsList)==null?void 0:C.length)>0?(g(),L("div",Ae,[a.filterProducts&&((O=a.filterProducts)==null?void 0:O.length)>0?(g(!0),L(A,{key:0},G(a.filterProducts,(s,S)=>(g(),V(k,{"item-data":s,"user-name":a.getUserName(s==null?void 0:s.ContractID),scheme:a.filterDomainScheme(s==null?void 0:s.SchemeID),"info-link":`/DomainOrders/${s==null?void 0:s.OrderID}`,"is-last":S===a.filterProducts.length-1,onDelete:a.deleteItem,onTransfer:a.transferItem,onDesignateOwner:a.designateOwner,onManage:a.orderManage},null,8,["item-data","user-name","scheme","info-link","is-last","onDelete","onTransfer","onDesignateOwner","onManage"]))),256)):(g(),V(f,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(g(),V(f,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}const je={components:{IconSearch:te,DomainItem:K,Select2:ne,Multiselect:oe,ClausesKeeper:z,BlockBalanceAgreement:H},async setup(){const n=ue(),t=Y(),m=Z(),a=W(),p=X("emitter");p.on("updateDomainsList",()=>{t.fetchDomains()});const y=E("*"),b=E(null),u=P(()=>{var e;return(e=Object.keys(t==null?void 0:t.domainsList).map(r=>t==null?void 0:t.domainsList[r]))==null?void 0:e.reverse()}),l=P(()=>t==null?void 0:t.domainSchemes),o=P(()=>m==null?void 0:m.contractsList),D=P(()=>w(f(u.value))),k=P(()=>{let e=[{value:"*",name:"Все договора"}];return u.value!==null?(Object.keys(u.value).forEach(r=>{var v,d,B;e.find(q=>{var $;return q.value===(($=u.value[r])==null?void 0:$.ContractID)})||e.push({value:(v=u.value[r])==null?void 0:v.ContractID,name:(B=o.value[(d=u.value[r])==null?void 0:d.ContractID])==null?void 0:B.Customer})}),e):{value:"*",name:"Все договора"}});function f(e){return y.value!=="*"?e.filter(r=>(r==null?void 0:r.ContractID)===y.value):e}function w(e){return b.value!==null?e.filter(r=>r==null?void 0:r.Domain.toLowerCase().includes(b.value.toLowerCase())):e}function C(e){var r;return(r=l.value)==null?void 0:r[e]}function O(e){var r,v;return(v=(r=m==null?void 0:m.contractsList)==null?void 0:r[e])==null?void 0:v.Customer}function s(e){n.OrderManage(e)}function S(){a.push({path:"/DomainSchemes"})}function M(e){p.emit("open-modal",{component:"DeleteItem",data:{id:e,message:`Вы действительно хотите удалить домен #${e}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function N(e){p.emit("open-modal",{component:"OrdersTransfer",data:e})}function x(){p.emit("open-modal",{component:"DomainTransfer",data:{}})}function T(e){p.emit("open-modal",{component:"DomainSelectOwner",data:e})}return await t.fetchDomains(),await t.fetchDomainSchemes(),await m.fetchContracts(),{getDomainsList:u,getDomainsSchemes:l,getUsers:k,select:y,search:b,openTransferModal:x,filterProducts:D,getUserName:O,designateOwner:T,deleteItem:M,orderManage:s,filterDomainScheme:C,navigateToDomainSchemes:S,startFunction:ee,transferItem:N}}},ct=F(je,[["render",Ee],["__scopeId","data-v-b8f62c5a"]]);export{ct as default};
