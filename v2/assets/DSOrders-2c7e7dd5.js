import{j as V,o as D,c as C,a as l,b as r,w as f,d as S,t as I,F as A,v as T,k as q,_ as H,x as U,p as J,l as K,r as N,R as Q,g as L}from"./index-1d7f6848.js";import{u as W}from"./dedicatedServer-363de121.js";import{u as X}from"./contracts-97246549.js";import{I as Y}from"./IconSearch-f1afa701.js";import{_ as Z}from"./HelperComponent-8df5ca49.js";import{S as j}from"./StatusBadge-d0f26ab2.js";import{I as $}from"./IconRotate-188b9b6e.js";import{f as R}from"./useTimeFunction-8602dd60.js";import"./resetServer-18ce20e6.js";import{z as ee,k as te,d as oe}from"./bootstrap-vue-next.es-ee787e70.js";import{_ as ae}from"./IconDots-1fda845d.js";import{_ as ne}from"./IconCard-7dcad6e0.js";import{_ as se}from"./OrderIDBadge-84c1b1f6.js";import{S as re}from"./Select2-64f56f79.js";import{s as le}from"./multiselect-3f954972.js";import{_ as F}from"./FormInputSearch-22adbbb3.js";import{B as z}from"./BlockBalanceAgreement-fc8b62a5.js";import{u as ce}from"./globalActions-890e9872.js";import{E as de}from"./EmptyStateBlock-6e78acb3.js";import{_ as ie}from"./ClausesKeeper-9fc4bc59.js";import"./ButtonDefault-ceb0a858.js";import"./IconArrow-6ea40b14.js";import"./IconPlus-f101ee33.js";import"./IconClose-b09002f7.js";const _e={class:"hosting-item"},ue={class:"hosting-item__row"},me={class:"hosting-item__date"},fe={class:"hosting-item__row"},De={class:"hosting-item__person"},pe={key:0,class:"hosting-item__row"},ve={class:"hosting-item__list"},Ie=["innerHTML"],ge={class:"hosting-item__controls"},he={class:"btn btn--dots"};function Se(c,a,s,t,v,g){var h,d,b,B,o,e,_,P;const n=se,i=V("router-link"),u=j,k=V("Helper"),y=ne,M=ae,p=ee,w=te,O=oe;return D(),C("div",_e,[l("div",ue,[r(n,{orderID:(h=s.itemData)==null?void 0:h.OrderID},null,8,["orderID"]),r(i,{class:"hosting-item__name",to:`/DSOrders/${s.itemData.OrderID}`},{default:f(()=>[S(I(s.itemData.IP),1)]),_:1},8,["to"]),r(u,{status:(d=s.itemData)==null?void 0:d.StatusID,DaysRemainded:(b=s.itemData)==null?void 0:b.DaysRemainded,"status-table":"DSOrders"},null,8,["status","DaysRemainded"]),l("div",me,"Дата окончания "+I(t.calculateExpirationDate((B=s.itemData)==null?void 0:B.DaysRemainded))+" | "+I(((o=s.itemData)==null?void 0:o.DaysRemainded)||0)+" дн.",1)]),l("div",fe,[l("div",De,I((e=s.itemData)==null?void 0:e.Customer),1),r(k,{"user-notice":(_=s.itemData)==null?void 0:_.UserNotice,id:(P=s.itemData)==null?void 0:P.OrderID,position:s.isLast?"bottom":"top",emit:"updateDSOrdersList"},null,8,["user-notice","id","position"])]),s.params.length?(D(),C("div",pe,[l("ul",ve,[(D(!0),C(A,null,T(s.params,m=>(D(),C("li",{innerHTML:m},null,8,Ie))),256))])])):q("",!0),l("div",ge,[l("div",{class:"btn btn--md btn--bold",onClick:a[0]||(a[0]=m=>{var x;return c.$router.push(`/DSOrderPay/${(x=s.itemData)==null?void 0:x.OrderID}`)})},[r(y),S("Оплатить")]),r(O,{class:"dropdown-dots",right:""},{"button-content":f(()=>[l("div",he,[r(M)])]),default:f(()=>[r(p,null,{default:f(()=>{var m;return[r(i,{to:`DSOrders/${(m=s.itemData)==null?void 0:m.OrderID}`},{default:f(()=>[S("Дополнительная информация")]),_:1},8,["to"])]}),_:1}),r(p,{onClick:a[1]||(a[1]=m=>t.transferAccount())},{default:f(()=>[S("Передать на другой аккаунт")]),_:1}),r(p,{onClick:a[2]||(a[2]=m=>t.orderManage())},{default:f(()=>[S("Управлять заказом")]),_:1}),r(w),r(p,{class:"color-red",onClick:a[3]||(a[3]=m=>t.deleteItem())},{default:f(()=>[S("Удалить")]),_:1})]),_:1})])])}const Ce={components:{StatusBadge:j,IconRotate:$,Helper:Z},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","manage"],setup(c,{emit:a}){function s(n){if(!n)return R(new Date);const i=new Date,u=new Date(i.getTime()+n*24*60*60*1e3);return R(u)}function t(){var n;a("delete",(n=c.itemData)==null?void 0:n.ID)}function v(){var n,i;a("transfer",{ServiceOrderID:(n=c.itemData)==null?void 0:n.ID,ServiceID:(i=c.itemData)==null?void 0:i.ServiceID})}function g(){var n,i,u;a("manage",{ServiceOrderID:(n=c.itemData)==null?void 0:n.ID,ServiceID:(i=c.itemData)==null?void 0:i.ServiceID,OrderID:(u=c.itemData)==null?void 0:u.OrderID})}return{deleteItem:t,orderManage:g,transferAccount:v,calculateExpirationDate:s}}},G=H(Ce,[["render",Se],["__scopeId","data-v-674a35e8"]]),we=c=>(J("data-v-88c3e505"),c=c(),K(),c),Oe={class:"section"},be={class:"container"},Le={class:"section-header"},ke={class:"section-title__nowrap"},ye=we(()=>l("h1",{class:"section-title"},"Выделенные серверы",-1)),Me={class:"list-form"},Pe={class:"list-form_col list-form_col--sm"},Be={class:"list-form_select"},xe={class:"multiselect-option"},Ve={key:0};function Ue(c,a,s,t,v,g){var w,O,h;const n=z,i=V("router-link"),u=ie,k=V("Multiselect"),y=F,M=G,p=de;return D(),C(A,null,[r(n),l("div",Oe,[l("div",be,[l("div",Le,[l("div",ke,[ye,r(i,{class:"btn btn--blue btn-default",to:"DSSchemes"},{default:f(()=>[S("Заказать")]),_:1})])]),r(u,{partition:"Header:/DSOrders"}),l("div",Me,[l("div",Pe,[l("div",Be,[r(k,{modelValue:t.select,"onUpdate:modelValue":a[0]||(a[0]=d=>t.select=d),options:t.getUsers,disabled:((w=t.getUsers)==null?void 0:w.length)<=1,label:"name"},{singlelabel:f(({value:d})=>[l("span",null,"# "+I(d.value.padStart(5,"0"))+" / "+I(d.name),1)]),option:f(({option:d})=>[l("div",xe,"# "+I(d.value.padStart(5,"0"))+" / "+I(d.name),1)]),_:1},8,["modelValue","options","disabled"])])]),r(y,{modelValue:t.search,"onUpdate:modelValue":a[1]||(a[1]=d=>t.search=d)},null,8,["modelValue"])]),t.getDSList&&((O=t.getDSList)==null?void 0:O.length)>0?(D(),C("div",Ve,[t.filterProducts&&((h=t.filterProducts)==null?void 0:h.length)>0?(D(!0),C(A,{key:0},T(t.filterProducts,(d,b)=>(D(),U(M,{params:t.getDSItemParam(d),"is-last":b===t.filterProducts.length-1,"item-data":d,onDelete:t.deleteItem,onTransfer:t.transferItem,onManage:t.orderManage},null,8,["params","is-last","item-data","onDelete","onTransfer","onManage"]))),256)):(D(),U(p,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(D(),U(p,{key:1,class:"no-margin",label:"У Вас нет заказов на выделенные серверы"}))])])],64)}const Ae={components:{FormInputSearch:F,IconSearch:Y,Select2:re,Multiselect:le,DSItem:G,BlockBalanceAgreement:z},async setup(){const c=N("*"),a=N(null),s=ce(),t=W(),v=X(),g=Q("emitter");g.on("updateDSOrdersList",()=>{t.fetchDSOrders()});const n=L(()=>{var o;return(o=Object.keys(t==null?void 0:t.DSList).map(e=>t==null?void 0:t.DSList[e]))==null?void 0:o.reverse()}),i=L(()=>t==null?void 0:t.DSSchemes),u=L(()=>v==null?void 0:v.contractsList),k=L(()=>t==null?void 0:t.DSOrderIPMI),y=L(()=>p(M(n.value)));function M(o){return c.value!=="*"?o.filter(e=>(e==null?void 0:e.ContractID)===c.value):o}function p(o){return a.value!==null?o.filter(e=>(e==null?void 0:e.Customer.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.OrderID.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.Scheme.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.IP.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.disks.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.CPU.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.ram.toLowerCase().includes(a.value.toLowerCase()))):o}function w(o){s.OrderManage(o)}const O=L(()=>{let o=[{value:"*",name:"Все договора"}];return n.value!==null&&u.value!==null?(Object.keys(n.value).forEach(e=>{var _,P,m;o.find(x=>{var E;return x.value===((E=n.value[e])==null?void 0:E.ContractID)})||o.push({value:(_=n.value[e])==null?void 0:_.ContractID,name:(m=u.value[(P=n.value[e])==null?void 0:P.ContractID])==null?void 0:m.Customer})}),o):{value:"*",name:"Все договора"}});function h(o){let e=d(o==null?void 0:o.SchemeID);e===void 0&&(e=o);let _=[];return o!=null&&o.Scheme&&_.push(o==null?void 0:o.Scheme),o!=null&&o.CPU&&_.push(o==null?void 0:o.CPU),e!=null&&e.ram&&_.push("RAM "+(e==null?void 0:e.ram)+" GB"),e!=null&&e.disks&&_.push(e==null?void 0:e.disks),e!=null&&e.CostMonth&&_.push("<b>"+(e==null?void 0:e.CostMonth)+"/ месяц</b>"),_}function d(o){var e;return(e=i.value)==null?void 0:e[o]}function b(o){g.emit("open-modal",{component:"DeleteItem",data:{id:o,message:"Вы действительно хотите удалить этот сервер?",tableID:"DSOrders",successEmit:"updateDSOrdersList"}})}function B(o){g.emit("open-modal",{component:"OrdersTransfer",data:o})}return await t.fetchDSOrders(),await t.fetchDSSchemes(),await t.fetchDSOrderIPMI(),await v.fetchContracts(),{getDSList:n,filterProducts:y,select:c,search:a,getUsers:O,getDSSchemes:i,getDSItemParam:h,getDSOrderIPMI:k,orderManage:w,deleteItem:b,transferItem:B}}},rt=H(Ae,[["render",Ue],["__scopeId","data-v-88c3e505"]]);export{rt as default};
