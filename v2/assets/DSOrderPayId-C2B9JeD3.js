import{_ as T}from"./EmptyStateBlock-DA3-0YDi.js";import{_ as K}from"./TotalAmount.vue_vue_type_script_setup_true_lang-Dg-09YER.js";import{_ as N}from"./BlockOrderPayBalance-DG_N_8bZ.js";import{_ as R}from"./ClausesKeeper-iUM0yapS.js";import{_ as U}from"./ButtonDefault-CMw2aBy6.js";import{_ as j}from"./BlockBalanceAgreement-v_bWuiVT.js";import{r as I,P as F,f as u,I as M,s as q,E as h,o,c as r,b as m,a as e,t as S,F as B,g as z,C as p,h as C,d as G,i as H}from"./index-Codq73aV.js";import{u as J}from"./index-BO2gwtUe.js";import{a as Q}from"./common-DyknwSqv.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./bootstrap-vue-next-W16P-SAV.js";import"./component-DqcwA9JN.js";import"./global-CdY51QQZ.js";import"./IconCross-DYjIbZqx.js";import"./IconClose-Dia1noy8.js";const X={key:0},Y={class:"section"},Z={class:"container"},ee={class:"section-header"},te={class:"tw-flex tw-items-center tw-justify-between tw-gap-2 tw-w-full tw-mb-2"},se={class:"section-label"},ae={class:"section"},oe={class:"container"},ne={class:"tw-p-3 md:tw-p-6 tw-border tw-border-gray-200 tw-rounded tw-mt-8"},le={class:"tw-flex tw-flex-wrap tw-gap-6 tw-mt-2"},re={class:"tw-text-gray-500 tw-text-xs"},ce={class:"tw-text-gray-800 tw-text-sm"},ie={key:0,class:"section"},de={class:"container"},ue={key:1,class:"section"},_e={class:"container"},me={key:1,class:"section"},ve={class:"container"},pe={__name:"DSOrderPayId",async setup(fe){let c,i;const s=I(null),d=F(),b=J(),P=H(),D=G(),v=I(!1),a=u(()=>Object.values(d.dsOrders).find(n=>n.OrderID==P.params.id)),_=u(()=>d.DSSchemes?.[a.value?.SchemeID]),f=u(()=>b.contractsList[a.value.ContractID]),k=u(()=>f.value?.Balance>s.value?.price?"Оплатить c баланса договора":"Добавить в корзину"),O=u(()=>{const n=d.DSSchemes[a.value.SchemeID];return n?Q(n):[]}),g=n=>{n.key==="Enter"&&n.ctrlKey&&!E.value&&y()},E=u(()=>s.value===null||s.value?.price===null);M(()=>{document.addEventListener("keyup",g)}),q(()=>{document.removeEventListener("keyup",g)});function y(){v.value=!0,d.DSOrderPay({DSOrderID:a.value?.ID,DaysPay:s.value?.actualDays,IsChange:!0}).then(n=>{let{result:t}=n;t==="SUCCESS"?D.push("/DSOrders"):t==="BASKET"&&D.push("/Basket"),v.value=!1})}return[c,i]=h(()=>d.fetchDSOrders()),await c,i(),[c,i]=h(()=>d.fetchDSSchemes()),await c,i(),[c,i]=h(()=>b.fetchContracts()),await c,i(),(n,t)=>{const $=j,x=U,L=R,V=N,A=K,w=T;return o(),r(B,null,[m($),a.value&&a.value.ID&&_.value?.ID?(o(),r("div",X,[e("div",Y,[e("div",Z,[e("div",ee,[e("div",te,[t[3]||(t[3]=e("h1",{class:"tw-text-xl sm:tw-text-4xl"},"Оплата заказа выделенного сервера",-1)),e("div",null,[m(x,{label:k.value,disabled:s.value===null||s.value.price===null,"is-loading":v.value,onClick:t[0]||(t[0]=l=>y())},null,8,["label","disabled","is-loading"])])]),e("div",se,S(a.value.IP?`#${a.value.IP}`:""),1)]),m(L)])]),e("div",ae,[e("div",oe,[e("div",ne,[t[4]||(t[4]=e("div",{class:"tw-text-2xl"},"Конфигурация",-1)),e("div",le,[(o(!0),r(B,null,z(O.value,l=>(o(),r("div",{class:"tw-space-y-1",key:l.label},[e("div",re,S(l.label),1),e("div",ce,S(l.text),1)]))),128))])]),f.value?(o(),p(V,{key:0,modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=l=>s.value=l),contract:f.value,scheme:_.value,"service-id":4e4,"days-remainded":a.value?.DaysRemainded,order:a.value},null,8,["modelValue","contract","scheme","days-remainded","order"])):C("",!0)])]),_.value?.IsPayed&&_.value?.IsProlong||!_.value?.IsPayed?(o(),r("div",ie,[e("div",de,[s.value?(o(),p(A,{key:0,tariff:s.value},null,8,["tariff"])):C("",!0),m(x,{class:"btn--wide",label:k.value,disabled:s.value===null||s.value.price===null,"is-loading":v.value,onClick:t[2]||(t[2]=l=>y())},null,8,["label","disabled","is-loading"])])])):(o(),r("div",ue,[e("div",_e,[m(w,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(o(),r("div",me,[e("div",ve,[a.value?.ID?(o(),p(w,{key:0,label:"Заказ не может быть продлен"})):(o(),p(w,{key:1,label:"Заказ не найден"}))])]))],64)}}},$e=W(pe,[["__scopeId","data-v-6767fbd8"]]);export{$e as default};
