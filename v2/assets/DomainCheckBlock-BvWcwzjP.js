import{_ as G}from"./EmptyStateBlock-DgFyy_gi.js";import{I as J,m as X}from"./bootstrap-vue-next-CDL_Y1-V.js";import{_ as Y}from"./IconClose-Camrw-uN.js";import{_ as ee}from"./ButtonDefault-CgQ13ecW.js";import{O as oe,r as i,p as ne,d as ae,g as se,s as te,f as ie,h as N,v as le,Q as O,c as d,o as l,a,i as C,b as h,F as P,D as ce,j as de,n as B,k as re,t as r,w as _e,T as ue}from"./index-DakgQwZZ.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ve={class:"domain-check__wrapper"},fe={class:"domain-block"},pe={class:"domain-field"},ke={key:0,class:"domain__grid"},he=["id","onClick"],De={class:"domain__item-wrapper"},ye={class:"domain__item-info__title"},Ie={class:"domain__item-info__text"},ge={class:"domain__info-wrapper"},we={class:"domain__info-wrapper-vertical"},Ne={class:"domain__info-wrapper"},Ce={class:"domain__info-title"},be={class:"domain__info-title"},$e={class:"domain__package-name"},xe={key:1,class:"domain__loader"},Fe={key:1,class:"domain__info-wrapper"},Ee={class:"domain__price"},Le={class:"domain__price-order"},Se={class:"domain__price-prolong"},Oe={__name:"DomainCheckBlock",props:{search:{type:String,default:""},domainList:{type:Array,default:()=>[]}},emits:["select"],setup(T,{emit:V}){const I=T,A=V,b=oe(),Z=i(I.search);ne(()=>I.search,e=>{Z.value=e,e&&y()});const q=ae(),$=se(),m=te({}),x=i(!1),c=i(null);$.query.DomainName&&(c.value=$.query.DomainName,y()),i(null);const D=i(null),F=i(!1),k=i(null),U=i(!1),_=i([]),v=i([]);function z(e){return e.match(/\(([^)]+)\)/)?.[1]||""}function E(e){e.key==="Enter"&&!j.value&&y()}const j=ie(()=>!c.value);N(()=>{document.addEventListener("keyup",E)}),le(()=>{document.removeEventListener("keyup",E)});function M(){q.replace({query:{DomainName:c.value}})}function Q(){k.value=null}function R(e,n,s){const f=n.match(/\(([^)]+)\)/)?.[1],u=`${e}-${f}`;Object.keys(m).forEach(t=>{delete m[t]}),m[u]?(k.value=null,delete m[u],x.value=!1):(k.value=e,m[u]=!0,x.value=!0)}function W(e){L(e)}function g(){const e=document.querySelector(".domain__info-title");e&&(U.value=e.scrollWidth>e.clientWidth)}function y(){M(),b.DomainNameCheck({DomainName:c.value}).then(e=>{const{result:n,resultData:s}=e;if(s?.DomainName&&(c.value=s.DomainName,D.value=s.DomainName),s?.Zones){_.value=I.domainList.filter(t=>s?.Zones?.includes(t?.Name)&&t?.IsActive).sort((t,w)=>s?.Zones.indexOf(t?.Name)-s?.Zones.indexOf(w?.Name)).map(t=>({...t,isFree:null,info:n.Info})),F.value=!0;let f=0;const u=setInterval(()=>{H(f),f++},100);setTimeout(()=>{clearInterval(u)},_.value?.length*100)}else _.value=[]})}function H(e){b.DomainCheck({DomainName:D.value,DomainZone:_.value[e]?.Name}).then(n=>{_.value[e]={..._.value[e],isFree:n.status==="SUCCESS",info:n.info}}).catch(n=>{console.error("An error occurred:",n)})}function L(e){if(e.isFree){const n=v.value.findIndex(s=>s.ID===e.ID);n===-1?v.value.push(e):v.value.splice(n,1),A("select",v.value.map(s=>({...s,line:c.value})))}}function K(e){L(e),R(e?.info,e?.PackageID,`domain-item-${e.ID}-${e.PackageID}`)}N(()=>{g(),window.addEventListener("resize",g)}),O(()=>{window.removeEventListener("resize",g)});function S(e){e.key==="Escape"&&(k.value=null)}return N(()=>{window.addEventListener("keydown",S)}),O(()=>{window.removeEventListener("keydown",S)}),(e,n)=>{const s=J,f=ee,u=Y,t=X,w=G;return l(),d("div",ve,[a("div",fe,[n[4]||(n[4]=a("div",{class:"section-title"},[a("h2",{class:"section-block_title"},"Проверить домен")],-1)),a("div",pe,[h(s,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=o=>c.value=o),placeholder:"Например, yourName",type:"text"},null,8,["modelValue"]),h(f,{label:"Подобрать",disabled:!c.value,onClick:n[1]||(n[1]=o=>y())},null,8,["disabled"])]),F.value?(l(),d(P,{key:0},[_.value?.length>0?(l(),d("div",ke,[(l(!0),d(P,null,de(_.value,o=>(l(),d("div",{class:B(["domain__item",{domain__item_inactive:o?.isFree===!1||o?.isFree===null,domain__item_active:v.value.some(p=>p.ID===o.ID)}]),key:`domain-item-${o.ID}-${o.PackageID}`,id:`domain-item-${o.ID}-${o.PackageID}`,onClick:p=>K(o)},[o?.info&&k.value===o?.info&&m[`${o.info}-${z(o.PackageID)}`]?(l(),d("div",{key:0,class:"domain__item-info",onClick:n[3]||(n[3]=re(()=>{},["stop"]))},[a("div",De,[a("div",ye,"Данные домена "+r(D.value)+"."+r(o?.Name),1),h(u,{class:"domain__item-icon",onClick:n[2]||(n[2]=p=>Q())})]),a("pre",Ie,r(o?.info),1)])):C("",!0),a("div",ge,[a("div",we,[a("div",Ne,[a("div",Ce,r(D.value),1),a("div",be,"."+r(o?.Name),1)]),a("div",$e,r(o?.PackageID),1)]),h(ue,{name:"fade",mode:"out-in"},{default:_e(()=>[o?.isFree!==null?(l(),d("div",{key:0,class:B(["domain__info-status",{available:o?.isFree===!0}])},r(o?.isFree?"Свободен":"Занят"),3)):(l(),d("div",xe))]),_:2},1024)]),o?.isFree?(l(),d("div",Fe,[a("div",Ee,[a("span",Le,r(o?.CostOrder)+" ₽ / год",1),a("span",Se,"Продление: "+r(o?.CostProlong)+" ₽",1)]),h(t,{class:"domain__checkbox",checked:v.value.some(p=>p.ID===o.ID),onChange:p=>W(o)},null,8,["checked","onChange"])])):C("",!0)],10,he))),128))])):(l(),ce(w,{key:1,class:"domain__empty",label:"Неправильное доменное имя"}))],64)):C("",!0)])])}}},qe=me(Oe,[["__scopeId","data-v-7cff700c"]]);export{qe as _};
