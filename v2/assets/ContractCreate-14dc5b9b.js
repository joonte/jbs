import{j as Ce,o as n,c,b as d,a as r,w as N,d as H,F as P,x as O,k as f,y as C,t as ue,n as L,p as be,l as Ve,_ as me,u as Ie,f as Te,e as Pe,a7 as Ee,r as p,g as fe,i as de,O as Ue,h as xe}from"./index-00a0bf0d.js";import{u as De}from"./contracts-8ab155ab.js";import{s as pe}from"./SimpleCheckbox-4ce78c6d.js";import{_ as _e}from"./BasicInput-95ab4d38.js";import{P as ve,T as he,S as ie}from"./PhoneInput-b63584a9.js";import{B as ge}from"./BlockBalanceAgreement-fb81df3d.js";import{u as Re}from"./files-0d958b3a.js";import{I as ke}from"./IconFile-c95694ab.js";import{I as ye}from"./IconClose-97a82d3d.js";import{_ as we}from"./ButtonDefault-4233c21f.js";import{f as Fe}from"./bootstrap-vue-next.es-be8a8de1.js";import{_ as Se}from"./IconClip-01c2b119.js";import{_ as Ae}from"./ClausesKeeper-ce1dcc35.js";/* empty css                                                                       */import"./component-89555e8b.js";import"./multiselect-9faec1a5.js";import"./IconArrow-74dc045b.js";const j=i=>(be("data-v-085ab58f"),i=i(),Ve(),i),Be={class:"section"},Le={class:"container"},Me={class:"section-header"},qe=j(()=>r("h1",{class:"section-title"},"Создать профиль",-1)),Ne=j(()=>r("div",{class:"section-header"},[r("h2",{class:"section-block_title"},"Шаблон")],-1)),He={class:"form"},Oe={class:"form"},je={class:"form-row-wrapper"},Ke={class:"special-form-row"},ze={key:0,class:"section-header inputs-block"},Ge={class:"section-block_title"},Je={key:0,class:"form width-limit"},Qe={key:0,class:"form-field form-field--file form-field--basic"},We={class:"chat-files"},Xe={class:"chat-files__item"},Ye=["onClick"],Ze={class:"form-field form-field--file form-field--basic"},$e={class:"form-field-input__file-wrapper"},eo={class:"form-field-input__file"},oo=j(()=>r("span",null,"Прикрепить документ подтверждающий личность",-1)),lo=["innerHTML"];function ao(i,s,E,l,U,_){var w,m,F,I,S,T,A;const b=ge,V=Ce("router-link"),v=Ae,x=pe,h=_e,g=ve,D=he,t=ie,u=ke,M=ye,R=Se,k=Fe,q=we;return n(),c(P,null,[d(b),r("div",Be,[r("div",Le,[r("div",Me,[d(V,{class:"section-label",to:"/Contracts"},{default:N(()=>[H("Мои договора")]),_:1}),qe]),d(v),Ne,r("div",He,[(n(!0),c(P,null,O((m=(w=l.getConfig)==null?void 0:w.Contracts)==null?void 0:m.Types,e=>(n(),c(P,null,[(e==null?void 0:e.ProfileTemplateID)!==""?(n(),C(x,{key:0,label:e==null?void 0:e.Name,value:e==null?void 0:e.ProfileTemplateID,modelValue:l.templateValue,"onUpdate:modelValue":s[0]||(s[0]=o=>l.templateValue=o)},null,8,["label","value","modelValue"])):f("",!0)],64))),256))]),r("div",Oe,[(n(!0),c(P,null,O((A=(T=(S=(I=(F=l.getConfig)==null?void 0:F.Profiles)==null?void 0:I.Templates)==null?void 0:S[l.templateValue])==null?void 0:T.Template)==null?void 0:A.Attribs,(e,o)=>(n(),c("div",je,[r("div",Ke,[e!=null&&e.Title?(n(),c("div",ze,[r("h2",Ge,ue(e==null?void 0:e.Title),1)])):f("",!0),(e==null?void 0:e.Type)==="Input"&&(e==null?void 0:e.Check)!=="Phone"?(n(),C(h,{key:1,class:L({"special-form-input":!0,"form-field-error":l.form[o].error,"form-error":!l.form[o].value}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:l.form[o].value,"onUpdate:modelValue":a=>l.form[o].value=a,pattern:l.getFieldRegex(e==null?void 0:e.Check)},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue","pattern"])):f("",!0),(e==null?void 0:e.Type)==="Input"&&(e==null?void 0:e.Check)==="Phone"?(n(),C(g,{key:2,class:L({"special-form-input":!0,"form-field-error":l.form[o].error,"form-error":!l.form[o].value}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:l.form[o].value,"onUpdate:modelValue":a=>l.form[o].value=a,pattern:l.getPhoneRegex()},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue","pattern"])):f("",!0),(e==null?void 0:e.Type)==="TextArea"?(n(),C(D,{key:3,class:L({"special-form-input":!0,"form-field-error":l.form[o].error,"form-error":!l.form[o].value}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:l.form[o].value,"onUpdate:modelValue":a=>l.form[o].value=a},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):(e==null?void 0:e.Type)==="Select"?(n(),C(t,{key:4,class:L({"special-form-input":!0,"form-field-error":l.form[o].error,"form-error":!l.form[o].value}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,options:e==null?void 0:e.Options,modelValue:l.form[o].value,"onUpdate:modelValue":a=>l.form[o].value=a},null,8,["class","label","placeholder","necessarily","name","options","modelValue","onUpdate:modelValue"])):f("",!0)])]))),256))]),l.templateValue!==0?(n(),c("div",Je,[l.fileList.length?(n(),c("div",Qe,[r("div",We,[(n(!0),c(P,null,O(l.fileList,(e,o)=>(n(),c("div",Xe,[r("span",null,[d(u,{class:"file-icon"})]),r("span",null,ue(e==null?void 0:e.name),1),r("button",{class:"close",onClick:a=>l.removeFile(o)},[d(M)],8,Ye)]))),256))])])):f("",!0),r("label",Ze,[r("div",$e,[r("input",{ref:"fileInput",type:"file",onChange:s[1]||(s[1]=(...e)=>l.fileUpload&&l.fileUpload(...e))},null,544),r("div",eo,[d(R),oo])])]),d(k,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:l.agree,"onUpdate:modelValue":s[2]||(s[2]=e=>l.agree=e)},{default:N(()=>[H("Подтверждаю свое согласие на передачу информации в электроной форме (в том числе персональных данных) по открытым каналам связи сети Интернет")]),_:1},8,["modelValue"]),d(k,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:l.agreeHandle,"onUpdate:modelValue":s[3]||(s[3]=e=>l.agreeHandle=e)},{default:N(()=>[H("Я разрешаю передачу своих персональных данных третьим лицам, для выполнения заказанных мною услуг (регистрация доменто и т.п.)")]),_:1},8,["modelValue"])])):f("",!0),l.createProfileErrorMessage?(n(),c("div",{key:1,class:"error-message width-limit",innerHTML:l.formErrorMessage(l.createProfileErrorMessage)},null,8,lo)):f("",!0),l.templateValue!==0?(n(),C(q,{key:2,class:"width-limit","is-loading":l.createProfileResult==="pending",label:"Зарегистрировать",onClick:s[4]||(s[4]=e=>l.checkForm())},null,8,["is-loading"])):f("",!0)])])],64)}const ro={components:{TextAreaLine:he,simpleCheckbox:pe,basicInput:_e,SelectLine:ie,PhoneInput:ve,IconFile:ke,IconClose:ye,BlockBalanceAgreement:ge},setup(){const i=Ie(),s=De(),E=Te(),l=Re(),U=Pe(),_=Ee(),b=p(!1),V=p(!1),v=p({}),x=p(null),h=p([]),g=p(null),D=p(null),t=p(0),u=fe(()=>i.ConfigList),M=fe(()=>{var e;return(e=E==null?void 0:E.userInfo)==null?void 0:e.Email}),R=u.value,k={};for(const e in R.Regulars)k[e]=R.Regulars[e];const q=e=>k[e]||null,w=()=>{const e=u.value;return e&&e.Regulars&&e.Regulars.Phone?new RegExp(e.Regulars.Phone):/^[0-9]{10}$/},m=e=>{e.key==="Enter"&&e.ctrlKey&&I()};de(()=>{document.addEventListener("keyup",m)}),Ue(()=>{document.removeEventListener("keyup",m)});function F(e){h.value=h.value.filter((o,a)=>a!==e)}function I(){if(b.value&&V.value){let e=new FormData;Object.keys(v.value).forEach(o=>{var a;e.append(o,(a=v.value[o])==null?void 0:a.value)}),e.append("TemplateID",t.value),e.append("Agree",b.value),e.append("AgreeHandle",V.value),h.value.forEach((o,a)=>{e.append("Document[]",o==null?void 0:o.value)}),g.value="pending",s.createNewContractFormData(e).then(o=>{var a;o.status==="success"?(g.value="success",_.query.Contract?U.push(`/Balance/${_.query.Contract}`):!_.query.Contract&&_.query.TemplateID?U.push("/Basket"):U.push("/Contracts")):(g.value="error",D.value=(a=o.data)==null?void 0:a.Exception)})}}function S(e){return""+T(e)}function T(e){return e?"<div>"+(e==null?void 0:e.String)+"</div>"+T(e==null?void 0:e.Parent):""}function A(e){var a;let o=((a=e.target.files)==null?void 0:a[0])||null;o&&(x.value.value="",l.sendFile(o).then(y=>{h.value.push({name:o==null?void 0:o.name,value:y.slice(y.lastIndexOf("^")+1,y.length)})}))}return xe(t,()=>{var e,o,a,y,K;v.value={},Object.keys((K=(y=(a=(o=(e=u.value)==null?void 0:e.Profiles)==null?void 0:o.Templates)==null?void 0:a[t.value])==null?void 0:y.Template)==null?void 0:K.Attribs).forEach(B=>{var z,G,J,Q,W,X,Y,Z,$,ee,oe,le,ae,re,ne,se,ce,te;v.value[B]={error:!1,value:(((X=(W=(Q=(J=(G=(z=u.value)==null?void 0:z.Profiles)==null?void 0:G.Templates)==null?void 0:J[t.value])==null?void 0:Q.Template)==null?void 0:W.Attribs[B])==null?void 0:X.Value)==="%Email%"?M.value:(le=(oe=(ee=($=(Z=(Y=u.value)==null?void 0:Y.Profiles)==null?void 0:Z.Templates)==null?void 0:$[t.value])==null?void 0:ee.Template)==null?void 0:oe.Attribs[B])==null?void 0:le.Value)||null,required:((te=(ce=(se=(ne=(re=(ae=u.value)==null?void 0:ae.Profiles)==null?void 0:re.Templates)==null?void 0:ne[t.value])==null?void 0:se.Template)==null?void 0:ce.Attribs[B])==null?void 0:te.IsDuty)==="1"}})}),de(()=>{var e,o;(o=(e=u.value)==null?void 0:e.Contracts)!=null&&o.Types&&_.query.TemplateID&&(t.value=_.query.TemplateID)}),{getConfig:u,templateValue:t,agreeHandle:V,agree:b,createProfileResult:g,createProfileErrorMessage:D,checkForm:I,formErrorMessage:S,form:v,fileInput:x,fileList:h,removeFile:F,fileUpload:A,getPhoneRegex:w,getFieldRegex:q,fieldRegexMap:k}}},mo=me(ro,[["render",ao],["__scopeId","data-v-085ab58f"]]);export{mo as default};
