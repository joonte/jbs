import{L as O}from"./bootstrap-vue-next-CDL_Y1-V.js";import{_ as C}from"./StatusBadge-CiYQLfxg.js";import{c as P,o as T,a as o,t as i,b as _,w as d,e as u,r as S,f as b,al as x,W as E}from"./index-DakgQwZZ.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(l,{emit:t}){const c=S("StatusDate"),r=S(!0),I=S("desc"),D=b(()=>l.data.modeID),m=b(()=>l.data.rowID),n=S({}),a=b(()=>n.value?Object.keys(n.value).map(e=>n.value[e]).reverse().map(e=>({StatusDate:e.StatusDate,StatusID:e.StatusID,Initiator:e.Initiator,Comment:e.Comment})):[]),y=async()=>{try{const e=await x.get(`${E}/API/v2/StatusesHistory?ModeID=${D.value}&RowID=${m.value}`);e&&e.data?n.value=e.data:n.value={}}catch(e){console.error(e),n.value={}}};y();function p(e){let s="";switch(e){case"HostingOrders":s="Хостинг";break;case"DomainOrders":s="Домен";break;case"DSOrders":s="Выделенный сервер";break;case"VPSOrders":s="VPS/VDS Сервер";break;case"ExtraIPOrders":s="IP адрес";break;case"ISPswOrders":s="Лицензия ISPsystem";break;case"DNSmanagerOrders":s="Вторичный DNS";break;case"Contracts":s="Договор";break;case"Profiles":s="Профиль";break;case"Invoices":s="Счёт на оплату";break;case"Edesks":s="Тикет";break}return s}function v(e){const s=new Date(e*1e3),f=s.getDate().toString().padStart(2,"0"),g=(s.getMonth()+1).toString().padStart(2,"0"),k=s.getFullYear().toString(),w=s.getHours().toString().padStart(2,"0"),B=s.getMinutes().toString().padStart(2,"0");return`${f}.${g}.${k} ${w}:${B}`}return{getStatusesHistory:y,STATUSES_LIST:a,sortBy:c,sortDesc:r,sortDirection:I,modeID:D,rowID:m,formatDate:v,renameMode:p}}},V={class:"modal__body"},h={class:"list-item__title"},L={class:"statuses-list"},N={class:"td-column-heavy"},U={class:"table-td-gray"},A={class:"td-column-heavy"},W={class:"table-td-gray"},j={class:"td-column-heavy"},F={class:"table-td-gray"};function R(l,t,c,r,I,D){const m=C,n=O;return T(),P("div",V,[o("div",h,"История изменений: "+i(r.renameMode(c.data?.modeID))+", #"+i(c.data?.rowID),1),o("div",L,[_(n,{class:"basic-table",items:r.STATUSES_LIST,fields:l.statusesHistoryFields,"show-empty":!0,filterable:[],"sort-desc":r.sortDesc,"onUpdate:sortDesc":t[0]||(t[0]=a=>r.sortDesc=a),"sort-by":r.sortBy,"onUpdate:sortBy":t[1]||(t[1]=a=>r.sortBy=a),"sort-direction":r.sortDirection,"empty-text":"У вас пока нет истории статусов.","empty-filtered-text":"Статус не найден."},{"head(StatusDate)":d(()=>t[2]||(t[2]=[u(" Дата изменения ",-1)])),"head(StatusID)":d(()=>t[3]||(t[3]=[u(" Статус ",-1)])),"head(Initiator)":d(()=>t[4]||(t[4]=[u(" Инициатор ",-1)])),"head(Comment)":d(()=>t[5]||(t[5]=[u(" Комментарий ",-1)])),"cell(StatusDate)":d(a=>[t[6]||(t[6]=o("span",{class:"td-mobile"},"Дата изменения",-1)),o("div",N,[o("div",U,i(r.formatDate(a.item?.StatusDate)),1)])]),"cell(StatusID)":d(a=>[t[7]||(t[7]=o("span",{class:"td-mobile"},"Статус",-1)),_(m,{status:a.item?.StatusID,"status-table":r.modeID},null,8,["status","status-table"])]),"cell(Initiator)":d(a=>[t[8]||(t[8]=o("span",{class:"td-mobile"},"Инициатор",-1)),o("div",A,[o("div",W,i(a.item?.Initiator),1)])]),"cell(Comment)":d(a=>[t[9]||(t[9]=o("span",{class:"td-mobile"},"Комментарий",-1)),o("div",j,[o("div",F,i(a.item?.Comment),1)])]),_:1},8,["items","fields","sort-desc","sort-by","sort-direction"])])])}const G=H(M,[["render",R],["__scopeId","data-v-8e547d95"]]);export{G as default};
