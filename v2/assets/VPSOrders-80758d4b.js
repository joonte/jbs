import{j as R,o as D,c as I,a as s,b as i,w as S,d as L,t as y,F as U,v as q,n as $,k as tt,_ as G,r as A,x as N,p as et,l as at,R as ot,g as B}from"./index-87a66f57.js";import{I as nt}from"./IconSearch-c3e117a8.js";import{u as J}from"./vps-96e23700.js";import{_ as st}from"./HelperComponent-cba1b053.js";import{S as Q}from"./StatusBadge-74310711.js";import{I as W}from"./IconRotate-ab75b3e9.js";import{f as K}from"./useTimeFunction-8602dd60.js";import{v as rt}from"./vpsStatuses-32ffaaf5.js";import{z as it,d as lt}from"./bootstrap-vue-next.es-e0094127.js";import{_ as ct}from"./IconDots-c481ec47.js";import{_ as dt}from"./IconCard-4f04d33d.js";import{_ as _t}from"./OrderIDBadge-5be8d5d9.js";import{S as mt}from"./Select2-1a2df089.js";import{s as ut}from"./multiselect-19c64478.js";import{_ as X}from"./ClausesKeeper-068355e6.js";import{u as ft}from"./contracts-63b183f3.js";import{B as Y}from"./BlockBalanceAgreement-f9b358ae.js";import{u as Dt}from"./globalActions-a3f84ce4.js";import{E as gt}from"./EmptyStateBlock-f512ef0a.js";import{_ as vt}from"./FormInputSearch-f93020c4.js";import"./ButtonDefault-646e2a65.js";import"./IconArrow-8c8c28c1.js";import"./IconClose-81d0053a.js";import"./IconPlus-a33d0542.js";const pt={class:"hosting-item"},bt={class:"hosting-item__row"},It={class:"hosting-item__date"},ht={class:"hosting-item__row"},Vt={class:"hosting-item__person"},Pt={class:"hosting-item__row"},St={class:"hosting-item__list"},yt=["innerHTML"],Ct={class:"hosting-item__controls"},kt={class:"ico"},Ot={class:"btn btn--dots"};function wt(a,r,n,e,p,M){var o,t,u,m,g,b,v,O,w;const l=_t,d=R("router-link"),c=Q,_=R("Helper"),C=W,k=dt,h=ct,V=it,P=lt;return D(),I("div",pt,[s("div",bt,[i(l,{orderID:(o=n.itemData)==null?void 0:o.OrderID},null,8,["orderID"]),i(d,{class:"hosting-item__name",to:`/VPSOrders/${n.itemData.OrderID}`},{default:S(()=>[L(y(n.itemData.IP||n.itemData.Domain),1)]),_:1},8,["to"]),i(c,{status:(t=n.itemData)==null?void 0:t.StatusID,DaysRemainded:(u=n.itemData)==null?void 0:u.DaysRemainded,"status-table":"VPSOrders"},null,8,["status","DaysRemainded"]),s("div",It,"Дата окончания "+y(e.calculateExpirationDate((m=n.itemData)==null?void 0:m.DaysRemainded))+" | "+y(((g=n.itemData)==null?void 0:g.DaysRemainded)||0)+" дн.",1)]),s("div",ht,[s("div",Vt,y(n.userName),1),i(_,{"user-notice":(b=n.itemData)==null?void 0:b.UserNotice,id:(v=n.itemData)==null?void 0:v.OrderID,position:n.isLast?"bottom":"top",emit:"updateVPSList"},null,8,["user-notice","id","position"])]),s("div",Pt,[s("ul",St,[(D(!0),I(U,null,q(n.params,f=>(D(),I("li",{innerHTML:f==null?void 0:f.text},null,8,yt))),256))])]),s("div",Ct,[((O=n.itemData)==null?void 0:O.StatusID)==="Active"?(D(),I("div",{key:0,class:$(["btn btn--md btn--border btn--rotate btn--rotate_green button-large",{"btn--rotate_gray":((w=n.itemData)==null?void 0:w.StatusID)!=="Active"||e.isReloading,"btn--rotate_loading":e.isReloading}]),title:"Перезагрузить выделенный сервер",onClick:r[0]||(r[0]=(...f)=>e.reloadItem&&e.reloadItem(...f))},[L("Включен"),s("button",null,[s("div",kt,[i(C)])])],2)):tt("",!0),s("div",{class:"btn btn--md btn--bold",onClick:r[1]||(r[1]=f=>{var x;return a.$router.push(`/VPSOrderPay/${(x=n.itemData)==null?void 0:x.OrderID}`)})},[i(k),L("Оплатить")]),i(P,{class:"dropdown-dots",right:""},{"button-content":S(()=>[s("div",Ot,[i(h)])]),default:S(()=>[i(V,{onClick:r[2]||(r[2]=f=>e.orderManage())},{default:S(()=>[L("Управлять заказом")]),_:1})]),_:1})])])}const xt={components:{StatusBadge:Q,IconRotate:W,Helper:st},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1},userName:{type:String,default:""}},emits:["manage"],setup(a,{emit:r}){const n=J(),e=A(!1);function p(d){if(!d)return K(new Date);const c=new Date,_=new Date(c.getTime()+d*24*60*60*1e3);return K(_)}function M(d){var c;e.value=!0,n.VPSReboot({VPSOrderID:(c=a.itemData)==null?void 0:c.ID}).then(()=>{setTimeout(()=>{e.value=!1},1e3)})}function l(){var d,c,_;r("manage",{ServiceOrderID:(d=a.itemData)==null?void 0:d.ID,ServiceID:(c=a.itemData)==null?void 0:c.ServiceID,OrderID:(_=a.itemData)==null?void 0:_.OrderID})}return{vpsStatuses:rt,reloadItem:M,isReloading:e,orderManage:l,calculateExpirationDate:p}}},Z=G(xt,[["render",wt],["__scopeId","data-v-80912b0a"]]),Bt=a=>(et("data-v-8751ab58"),a=a(),at(),a),Lt={class:"section"},Mt={class:"container"},Rt={class:"section-header"},Nt=Bt(()=>s("h1",{class:"section-title"},"VPS/VDS серверы",-1)),Ut={class:"list-form"},At={class:"list-form_col list-form_col--sm"},Et={class:"list-form_select"},jt={class:"multiselect-option"},Ht={key:0};function Tt(a,r,n,e,p,M){var V,P,o;const l=Y,d=R("router-link"),c=X,_=R("Multiselect"),C=vt,k=Z,h=gt;return D(),I(U,null,[i(l),s("div",Lt,[s("div",Mt,[s("div",Rt,[Nt,i(d,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:S(()=>[L("Заказать")]),_:1})]),i(c),s("div",Ut,[s("div",At,[s("div",Et,[i(_,{modelValue:e.select,"onUpdate:modelValue":r[0]||(r[0]=t=>e.select=t),options:e.getUsers,disabled:((V=e.getUsers)==null?void 0:V.length)<=1,label:"name"},{option:S(({option:t})=>[s("div",jt,"# "+y(t.value.padStart(5,"0"))+" / "+y(t.name),1)]),_:1},8,["modelValue","options","disabled"])])]),i(C,{modelValue:e.search,"onUpdate:modelValue":r[1]||(r[1]=t=>e.search=t)},null,8,["modelValue"])]),e.getVpsOrders&&((P=e.getVpsOrders)==null?void 0:P.length)>0?(D(),I("div",Ht,[e.filterProducts&&((o=e.filterProducts)==null?void 0:o.length)>0?(D(!0),I(U,{key:0},q(e.filterProducts,(t,u)=>{var m;return D(),N(k,{"item-data":t,"is-last":u===e.filterProducts.length-1,"user-name":(m=e.getContracts[t==null?void 0:t.ContractID])==null?void 0:m.Customer,params:e.formItemParamList(t),onManage:e.orderManage},null,8,["item-data","is-last","user-name","params","onManage"])}),256)):(D(),N(h,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(D(),N(h,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])],64)}const zt={components:{IconSearch:nt,Select2:mt,ClausesKeeper:X,Multiselect:ut,VpsItem:Z,BlockBalanceAgreement:Y},async setup(){const a=J(),r=ft(),n=Dt(),e=A(null),p=A("*");ot("emitter").on("updateVPSList",()=>{a.fetchVPS()});const l=B(()=>{var o;return(o=Object.keys(a==null?void 0:a.vpsList).map(t=>a==null?void 0:a.vpsList[t]))==null?void 0:o.reverse()}),d=B(()=>a.vpsSchemes),c=B(()=>h(C(l.value))),_=B(()=>r==null?void 0:r.contractsList);function C(o){return p.value!=="*"?o.filter(t=>(t==null?void 0:t.ContractID)===p.value):o}function k(o){n.OrderManage(o)}function h(o){return e.value!==null?o.filter(t=>t==null?void 0:t.IP.toLowerCase().includes(e.value.toLowerCase())):o}const V=B(()=>{let o=[{value:"*",name:"Все договора"}];return l.value!==null?(Object.keys(l.value).forEach(t=>{var u,m,g;o.find(b=>{var v;return b.value===((v=l.value[t])==null?void 0:v.ContractID)})||o.push({value:(u=l.value[t])==null?void 0:u.ContractID,name:(g=_.value[(m=l.value[t])==null?void 0:m.ContractID])==null?void 0:g.Customer})}),o):{value:"*",name:"Все договора"}});function P(o){var u,m,g,b,v,O,w,f,x,E,j,H,T,z,F;const t=(u=d.value)==null?void 0:u[o.SchemeID];return[{text:`${t==null?void 0:t.Name}`},{text:`${(g=(m=t==null?void 0:t.SchemeParams)==null?void 0:m.hdd_mib)==null?void 0:g.InternalName} ${(v=(b=t==null?void 0:t.SchemeParams)==null?void 0:b.hdd_mib)==null?void 0:v.Value} ${(w=(O=t==null?void 0:t.SchemeParams)==null?void 0:O.hdd_mib)==null?void 0:w.Unit}`},{text:`RAM ${(x=(f=t==null?void 0:t.SchemeParams)==null?void 0:f.ram_mib)==null?void 0:x.Value} ${(j=(E=t==null?void 0:t.SchemeParams)==null?void 0:E.ram_mib)==null?void 0:j.Unit}`},{text:`Канал ${(T=(H=t==null?void 0:t.SchemeParams)==null?void 0:H.net_bandwidth_mbitps)==null?void 0:T.Value} ${(F=(z=t==null?void 0:t.SchemeParams)==null?void 0:z.net_bandwidth_mbitps)==null?void 0:F.Unit}`}]}return await a.fetchVPS(),await a.fetchVPSSchemes(),await r.fetchContracts(),{getVpsOrders:l,search:e,getContracts:_,select:p,orderManage:k,formItemParamList:P,getUsers:V,filterProducts:c}}},ue=G(zt,[["render",Tt],["__scopeId","data-v-8751ab58"]]);export{ue as default};
