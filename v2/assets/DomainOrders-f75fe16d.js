import{_ as E,j as F,o as _,c as S,a as m,b as l,w as d,d as p,t as C,k as U,F as A,v as q,x as V,p as G,l as J,e as Q,R as W,r as j,g as L}from"./index-4434f005.js";import{u as X}from"./domain-05a1d406.js";import{u as Y}from"./contracts-d017d511.js";import{s as Z}from"./useTimeFunction-8602dd60.js";import{I as ee}from"./IconSearch-d168a9f9.js";import{S as te}from"./Select2-bf6aa49e.js";import{s as oe}from"./multiselect-eb561fe9.js";import{z as ne,k as se,d as ae}from"./bootstrap-vue-next.es-5d8af788.js";import{_ as re}from"./OrderIDBadge-4cc1db15.js";import{_ as ie}from"./IconDots-a0319d0c.js";import{_ as le}from"./IconCard-285cc6ac.js";import{S as ce}from"./StatusBadge-129e5649.js";import{_ as me}from"./HelperComponent-e4e3ffbd.js";import{_ as z}from"./ClausesKeeper-68df7f35.js";import{B as R}from"./BlockBalanceAgreement-4e844242.js";import{u as de}from"./globalActions-e617f474.js";import{E as ue}from"./EmptyStateBlock-927727c9.js";import{_ as _e}from"./FormInputSearch-29c276f6.js";import{_ as fe}from"./ButtonDefault-f91c301e.js";import"./IconArrow-6847c901.js";import"./IconClose-0cfbf563.js";import"./IconPlus-6c2cbbce.js";const De={class:"hosting-item"},pe={class:"hosting-item__row"},ge={class:"hosting-item__row"},ve={class:"hosting-item__person"},he={class:"hosting-item__row"},Ie={class:"hosting-item__list"},be={key:0},ke={key:1,class:"bold"},Oe={class:"hosting-item__controls"},ye={class:"btn btn--dots"},Ce={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","designateOwner","manage"],setup(r,{emit:t}){const c=r;function o(){var n,s;console.log((n=c.itemData)==null?void 0:n.ID),t("delete",(s=c.itemData)==null?void 0:s.ID)}function f(){var n,s;t("transfer",{ServiceOrderID:(n=c.itemData)==null?void 0:n.ID,ServiceID:(s=c.itemData)==null?void 0:s.ServiceID})}function b(){var n;t("designateOwner",{DomainOrderID:(n=c.itemData)==null?void 0:n.ID})}function g(){var n,s,D;t("manage",{ServiceOrderID:(n=c.itemData)==null?void 0:n.ID,ServiceID:(s=c.itemData)==null?void 0:s.ServiceID,OrderID:(D=c.itemData)==null?void 0:D.OrderID})}return(n,s)=>{var h,I,a,y,B,P,M,N;const D=re,v=F("router-link"),u=ne,k=se,O=ae;return _(),S("div",De,[m("div",pe,[l(D,{orderID:(h=r.itemData)==null?void 0:h.OrderID},null,8,["orderID"]),l(v,{class:"hosting-item__name",to:r.infoLink},{default:d(()=>{var e;return[p(C((e=r.itemData)==null?void 0:e.Domain),1)]}),_:1},8,["to"]),l(ce,{status:(I=r.itemData)==null?void 0:I.StatusID,"status-table":"DomainOrders"},null,8,["status"])]),m("div",ge,[m("div",ve,C(r.userName),1),l(me,{"user-notice":(a=r.itemData)==null?void 0:a.UserNotice,id:(y=r.itemData)==null?void 0:y.OrderID,position:r.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),m("div",he,[m("ul",Ie,[(B=r.scheme)!=null&&B.PackageID?(_(),S("li",be,C((P=r.scheme)==null?void 0:P.PackageID),1)):U("",!0),(M=r.scheme)!=null&&M.CostProlong?(_(),S("li",ke,C((N=r.scheme)==null?void 0:N.CostProlong)+" ₽",1)):U("",!0)])]),m("div",Oe,[m("button",{class:"btn btn--md btn--bold",onClick:s[0]||(s[0]=e=>{var i;return n.$router.push(`/DomainOrderPay/${(i=r.itemData)==null?void 0:i.OrderID}`)})},[l(le),p("Оплатить")]),l(O,{class:"dropdown-dots",right:""},{"button-content":d(()=>[m("div",ye,[l(ie)])]),default:d(()=>[l(u,null,{default:d(()=>[l(v,{to:r.infoLink},{default:d(()=>[p("Дополнительная информация")]),_:1},8,["to"])]),_:1}),l(u,null,{default:d(()=>{var e;return[l(v,{to:`/DomainOrderPay/${(e=r.itemData)==null?void 0:e.OrderID}`},{default:d(()=>[p("Оплатить заказ")]),_:1},8,["to"])]}),_:1}),l(u,{onClick:s[1]||(s[1]=e=>b())},{default:d(()=>[p("Определить владельца")]),_:1}),l(u,{onClick:s[2]||(s[2]=e=>f())},{default:d(()=>[p("Передать на другой аккаунт")]),_:1}),l(u,{onClick:s[3]||(s[3]=e=>g())},{default:d(()=>[p("Управлять заказом")]),_:1}),l(k),l(u,{class:"color-red",onClick:s[4]||(s[4]=e=>o())},{default:d(()=>[p("Удалить")]),_:1})]),_:1})])])}}},H=E(Ce,[["__scopeId","data-v-255c17df"]]),Se=r=>(G("data-v-b8f62c5a"),r=r(),J(),r),we={class:"section"},Le={class:"container"},Be={class:"section-header"},Pe=Se(()=>m("h1",{class:"section-title"},"Домены",-1)),Me={class:"btn__group"},Ne={class:"list-form"},Ve={class:"list-form_col list-form_col--sm"},$e={class:"list-form_select"},Te={class:"multiselect-option"},xe={key:0};function Ue(r,t,c,o,f,b){var O,h,I;const g=R,n=fe,s=z,D=F("Multiselect"),v=_e,u=H,k=ue;return _(),S(A,null,[l(g),m("div",we,[m("div",Le,[m("div",Be,[Pe,m("div",Me,[l(n,{label:"Заказать",onClick:t[0]||(t[0]=a=>o.navigateToDomainSchemes())}),l(n,{label:"Перенести домен",onClick:t[1]||(t[1]=a=>o.openTransferModal())})])]),l(s,{partition:"Header:/DomainOrders"}),m("div",Ne,[m("div",Ve,[m("div",$e,[l(D,{modelValue:o.select,"onUpdate:modelValue":t[2]||(t[2]=a=>o.select=a),options:o.getUsers,label:"name",disabled:((O=o.getUsers)==null?void 0:O.length)<=1},{option:d(({option:a})=>[m("div",Te,"# "+C(a.value.padStart(5,"0"))+" / "+C(a.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l(v,{modelValue:o.search,"onUpdate:modelValue":t[3]||(t[3]=a=>o.search=a)},null,8,["modelValue"])]),o.getDomainsList&&((h=o.getDomainsList)==null?void 0:h.length)>0?(_(),S("div",xe,[o.filterProducts&&((I=o.filterProducts)==null?void 0:I.length)>0?(_(!0),S(A,{key:0},q(o.filterProducts,(a,y)=>(_(),V(u,{"item-data":a,"user-name":o.getUserName(a==null?void 0:a.ContractID),scheme:o.filterDomainScheme(a==null?void 0:a.SchemeID),"info-link":`/DomainOrders/${a==null?void 0:a.OrderID}`,"is-last":y===o.filterProducts.length-1,onDelete:o.deleteItem,onTransfer:o.transferItem,onDesignateOwner:o.designateOwner,onManage:o.orderManage},null,8,["item-data","user-name","scheme","info-link","is-last","onDelete","onTransfer","onDesignateOwner","onManage"]))),256)):(_(),V(k,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(_(),V(k,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}const Ae={components:{IconSearch:ee,DomainItem:H,Select2:te,Multiselect:oe,ClausesKeeper:z,BlockBalanceAgreement:R},async setup(){const r=de(),t=X(),c=Y(),o=Q(),f=W("emitter");f.on("updateDomainsList",()=>{t.fetchDomains()});const b=j("*"),g=j(null),n=L(()=>{var e;return(e=Object.keys(t==null?void 0:t.domainsList).map(i=>t==null?void 0:t.domainsList[i]))==null?void 0:e.reverse()}),s=L(()=>t==null?void 0:t.domainSchemes),D=L(()=>c==null?void 0:c.contractsList),v=L(()=>O(k(n.value))),u=L(()=>{let e=[{value:"*",name:"Все договора"}];return n.value!==null?(Object.keys(n.value).forEach(i=>{var w,$,T;e.find(K=>{var x;return K.value===((x=n.value[i])==null?void 0:x.ContractID)})||e.push({value:(w=n.value[i])==null?void 0:w.ContractID,name:(T=D.value[($=n.value[i])==null?void 0:$.ContractID])==null?void 0:T.Customer})}),e):{value:"*",name:"Все договора"}});function k(e){return b.value!=="*"?e.filter(i=>(i==null?void 0:i.ContractID)===b.value):e}function O(e){return g.value!==null?e.filter(i=>i==null?void 0:i.Domain.toLowerCase().includes(g.value.toLowerCase())):e}function h(e){var i;return(i=s.value)==null?void 0:i[e]}function I(e){var i,w;return(w=(i=c==null?void 0:c.contractsList)==null?void 0:i[e])==null?void 0:w.Customer}function a(e){r.OrderManage(e)}function y(){o.push({path:"/DomainSchemes"})}function B(e){f.emit("open-modal",{component:"DeleteItem",data:{id:e,message:`Вы действительно хотите удалить домен #${e}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function P(e){f.emit("open-modal",{component:"OrdersTransfer",data:e})}function M(){f.emit("open-modal",{component:"DomainTransfer",data:{}})}function N(e){f.emit("open-modal",{component:"DomainSelectOwner",data:e})}return await t.fetchDomains(),await t.fetchDomainSchemes(),await c.fetchContracts(),{getDomainsList:n,getDomainsSchemes:s,getUsers:u,select:b,search:g,openTransferModal:M,filterProducts:v,getUserName:I,designateOwner:N,deleteItem:B,orderManage:a,filterDomainScheme:h,navigateToDomainSchemes:y,startFunction:Z,transferItem:P}}},it=E(Ae,[["render",Ue],["__scopeId","data-v-b8f62c5a"]]);export{it as default};
