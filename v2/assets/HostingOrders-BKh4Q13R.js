import{_ as ae}from"./EmptyStateBlock-Ad1AmtSS.js";import{_ as re}from"./HostingCard-D0TzA-ge.js";import{_ as le}from"./FormInputSearch-B6VLZUqq.js";import{_ as ie}from"./ClausesKeeper-gPyacQ05.js";import{_ as ue}from"./ButtonDefault-B1FApUky.js";import{m as me}from"./bootstrap-vue-next-BglOzul_.js";import{_ as ce,a as de}from"./IconButtonBack-CCfO1LXm.js";import{_ as pe}from"./BlueButton.vue_vue_type_script_setup_true_lang-q3k2Q2g8.js";import{_ as _e,b as C,f as fe}from"./BlockBalanceAgreement-DSLTUOoQ.js";import{u as ve,r as u,D as ge,x as we,f as O,H as Se,c as d,b as l,a,C as m,h,t as p,w as _,Q as he,v as I,F as M,i as ke,d as be,o as s,e as D}from"./index-C9dBN6m4.js";import{s as xe}from"./multiselect-B6DlyfA6.js";import{u as ye}from"./hosting-C49ZUiO9.js";import{u as Ce}from"./contracts-BEc0DZS2.js";import{u as Oe}from"./orders-D_JLVTov.js";import{u as Ie}from"./global-DiPSuX9n.js";import{_ as De}from"./WhiteButton.vue_vue_type_script_setup_true_lang-ClwvvVEf.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StatusBadge-DZmmWv0G.js";import"./IconLink-kGICMNL4.js";import"./OrderIDBadge-Cc01CaG4.js";import"./ServerStatusBadge.vue_vue_type_script_setup_true_lang-DbXnhqPA.js";import"./IconDots-Mp79qN9u.js";import"./UserNote-Cq01thJ0.js";import"./IconCard-CjQefsRP.js";import"./CardButton-Y2h0wZDl.js";import"./time-DenPiOX5.js";import"./IconPlus-aXPVPivX.js";import"./IconClose-CgjzG0Yf.js";import"./index-D0iqQ1zq.js";const He={class:"tw-px-4 md:tw-px-8"},$e={class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-2 tw-mb-4"},Ve={class:"tw-flex tw-items-center tw-gap-2"},Pe={key:0,class:"tw-flex tw-items-center tw-gap-2"},Le={key:1,class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-4 tw-my-4"},Ne={class:"list-form"},Me={class:"list-form_col list-form_col--sm"},Ue={class:"list-form_select"},Ae={class:"multiselect-option"},je={key:0,class:"tw-my-6 tw-space-y-4"},Re={__name:"HostingOrders",async setup(Ee){let B,H;const c=ye(),U=ve(),k=Ce(),$=Ie(),V=Oe(),b=be(),f=u("*"),v=u(null),r=u(!1),g=u([]),x=u(null),y=u(!1),w=we("emitter");[B,H]=ge(()=>Promise.all([c.fetchHostingSchemes(),V.fetchAllOrders(),c.fetchHostingOrders(),k.fetchContracts()])),await B,H(),w.on("updateHostingList",()=>{c.fetchHostingOrders()});const i=O(()=>Object.values(c.hostingList).reverse().map(t=>({...t,Stat:V.orders[t.OrderID]?.Stat||[]}))),P=O(()=>{let t=[{value:"*",name:"Все договора"}];return i.value!==null?(i.value.forEach(e=>{t.find(n=>n.value===e.ContractID)||t.push({value:e.ContractID,name:k.contractsList?.[e?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}}),S=O(()=>Q(K(i.value))),A=t=>{g.value=t};async function j(){const t=Object.keys(g.value).filter(n=>g.value[n]),e={ServiceID:1e4,ItemsPay:x.value,OrdersIDs:t,...y.value&&{UseBalance:"yes"}};await $.OrdersPay(e).then(n=>{n==="Basket"?b.push("/Basket"):n?.Status==="Ok"&&(r.value=!1,w.emit("open-modal",{component:"BalanceProlong",data:{Message:n?.Message,Count:n?.Count}}))})}function R(){r.value=!0}function E(){r.value=!1}function T(){b.go(0)}function L(){b.push("/HostingSchemes")}function F(t,e){w.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить хостинг #${e}?`,tableID:"HostingOrders",successEmit:"updateHostingList"}})}function q(t){w.emit("open-modal",{component:"OrdersTransfer",data:t})}function G(t){$.OrderManageHosting(t)}function K(t){return f.value!=="*"?t.filter(e=>e?.ContractID===f.value):t}function Q(t){return v.value!==null?t.filter(e=>e?.Domain.toLowerCase().includes(v.value.toLowerCase())):t}function z(t){const e=J(t?.SchemeID);return[{text:e?.Name},{text:C(e?.SchemeParams?.limit_webdomains)},{text:C(e?.SchemeParams?.limit_quota)},{text:C(e?.SchemeParams?.limit_emails)},{text:`${fe(e?.CostMonth)} в месяц`,bold:!0}]}function J(t){return c.hostingSchemes?.[t]}return Se(()=>{i.value.length<1&&L()}),(t,e)=>{const n=_e,W=ce,X=pe,Y=de,Z=me,ee=ue,te=ie,oe=le,se=re,N=ae;return s(),d(M,null,[l(n),a("div",He,[a("div",$e,[a("div",Ve,[r.value?(s(),m(W,{key:0,onClick:e[0]||(e[0]=o=>E()),class:"tw-cursor-pointer"})):h("",!0),a("h1",{class:"tw-text-xl sm:tw-text-4xl tw-cursor-pointer",onClick:e[1]||(e[1]=o=>T())},p(r.value?"Продление услуг Хостинга":"Хостинг"),1)]),r.value?h("",!0):(s(),d("div",Pe,[i.value.length?(s(),m(De,{key:0,onClick:e[2]||(e[2]=o=>R())},{default:_(()=>e[9]||(e[9]=[D("Продлить несколько заказов ",-1)])),_:1,__:[9]})):h("",!0),l(X,{onClick:e[3]||(e[3]=o=>L())},{default:_(()=>e[10]||(e[10]=[D("Заказать",-1)])),_:1,__:[10]})])),r.value?(s(),d("div",Le,[l(Y,{class:"contr period",modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=o=>x.value=o)},null,8,["modelValue"]),l(Z,{id:"checkbox-balance",modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=o=>y.value=o),name:"checkbox-balance"},{default:_(()=>e[11]||(e[11]=[D(" Использовать средства с баланса ",-1)])),_:1,__:[11]},8,["modelValue"]),l(ee,{label:"Продлить",onClick:e[6]||(e[6]=o=>j())})])):h("",!0)]),(s(),m(he,null,[l(te)],1024)),a("div",Ne,[a("div",Me,[a("div",Ue,[l(I(xe),{modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=o=>f.value=o),options:P.value,disabled:P.value?.length<=1,label:"name"},{singlelabel:_(({value:o})=>[a("span",null,"# "+p(String(o.value).padStart(5,"0"))+" / "+p(o.name),1)]),option:_(({option:o})=>[a("span",Ae,"# "+p(String(o.value).padStart(5,"0"))+" / "+p(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l(oe,{modelValue:v.value,"onUpdate:modelValue":e[8]||(e[8]=o=>v.value=o)},null,8,["modelValue"])]),i.value&&i.value.length>0?(s(),d("div",je,[S.value&&S.value?.length>0?(s(!0),d(M,{key:0},ke(S.value,(o,ne)=>(s(),m(se,{key:o.OrderID,hosting:o,"user-name":`${I(U).userInfo?.Name} - ${I(k).contractsList?.[o?.ContractID]?.Customer}`,params:z(o),"info-link":`/HostingOrders/${o?.OrderID}`,"is-last":ne===S.value.length-1,isSeveral:r.value,"selected-rows":g.value,onUpdateSelectedRows:A,onDelete:F,onTransfer:q,onManage:G},null,8,["hosting","user-name","params","info-link","is-last","isSeveral","selected-rows"]))),128)):(s(),m(N,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(s(),m(N,{key:1,class:"no-margin",label:"У Вас нет заказов на хостинг"}))])],64)}}},gt=Be(Re,[["__scopeId","data-v-b2457a20"]]);export{gt as default};
