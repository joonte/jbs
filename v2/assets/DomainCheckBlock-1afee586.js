import{o as i,c as u,a as s,b as w,F as Z,y as K,n as q,ac as Q,t as v,l as F,w as G,T as J,z as X,p as Y,m as $,_ as oo,r as t,j as eo,e as no,f as ao,I as so,h as co,i as P,P as lo,D as z}from"./index-400feb76.js";import{u as io}from"./domain-71fce806.js";import{s as to}from"./multiselect-f4d64e06.js";import{E as ro}from"./EmptyStateBlock-d1623b92.js";import{b as _o,f as fo}from"./bootstrap-vue-next.es-03cca149.js";import{I as uo}from"./IconClose-20ed8b3b.js";import{_ as vo}from"./ButtonDefault-7609cc9e.js";const ho=h=>(Y("data-v-df467d9f"),h=h(),$(),h),mo={class:"section domain-check__wrapper"},po={class:"container"},ko={class:"domain-block"},yo=ho(()=>s("div",{class:"section-title"},[s("h2",{class:"section-block_title"},"Проверить домен")],-1)),Do={class:"domain-field"},Io={key:0,class:"domain__grid"},go=["id","onClick"],wo={class:"domain__item-wrapper"},No={class:"domain__item-info__title"},Co={class:"domain__item-info__text"},So={class:"domain__info-wrapper"},bo={class:"domain__info-wrapper-vertical"},xo={class:"domain__info-wrapper"},Eo={class:"domain__info-title"},Lo={class:"domain__info-title"},Fo={class:"domain__package-name"},Po={key:1,class:"domain__loader"},Bo={key:1,class:"domain__info-wrapper"},Oo={class:"domain__price"},Ao={class:"domain__price-order"},To={class:"domain__price-prolong"};function Vo(h,d,x,a,B,E){var g;const r=_o,I=vo,_=uo,L=fo,p=ro;return i(),u("div",mo,[s("div",po,[s("div",ko,[yo,s("div",Do,[w(r,{modelValue:a.domainName,"onUpdate:modelValue":d[0]||(d[0]=o=>a.domainName=o),placeholder:"Например, yourName",type:"text"},null,8,["modelValue"]),w(I,{label:"Подобрать",disabled:!a.domainName,onClick:d[1]||(d[1]=o=>a.checkDomain())},null,8,["disabled"])]),a.isListLoaded?(i(),u(Z,{key:0},[((g=a.domainsArray)==null?void 0:g.length)>0?(i(),u("div",Io,[(i(!0),u(Z,null,K(a.domainsArray,o=>(i(),u("div",{class:q(["domain__item",{domain__item_inactive:(o==null?void 0:o.isFree)===!1||(o==null?void 0:o.isFree)===null,domain__item_active:a.selectedDomain.some(f=>f.ID===o.ID)}]),key:`domain-item-${o.ID}-${o.PackageID}`,id:`domain-item-${o.ID}-${o.PackageID}`,onClick:f=>{a.selectDomain(o),a.checkInfo(o==null?void 0:o.info,o==null?void 0:o.PackageID,`domain-item-${o.ID}-${o.PackageID}`)}},[o!=null&&o.info&&a.selectedDomainInfo===(o==null?void 0:o.info)&&a.displayedInfo[`${o.info}-${a.getOperator(o.PackageID)}`]?(i(),u("div",{key:0,class:"domain__item-info",onClick:d[3]||(d[3]=Q(()=>{},["stop"]))},[s("div",wo,[s("div",No,"Данные домена "+v(a.checkedDomain)+"."+v(o==null?void 0:o.Name),1),w(_,{class:"domain__item-icon",onClick:d[2]||(d[2]=f=>a.closeInfo())})]),s("pre",Co,v(o==null?void 0:o.info),1)])):F("",!0),s("div",So,[s("div",bo,[s("div",xo,[s("div",Eo,v(a.checkedDomain),1),s("div",Lo,"."+v(o==null?void 0:o.Name),1)]),s("div",Fo,v(o==null?void 0:o.PackageID),1)]),w(J,{name:"fade",mode:"out-in"},{default:G(()=>[(o==null?void 0:o.isFree)!==null?(i(),u("div",{key:0,class:q(["domain__info-status",{available:(o==null?void 0:o.isFree)===!0}])},v(o!=null&&o.isFree?"Свободен":"Занят"),3)):(i(),u("div",Po))]),_:2},1024)]),o!=null&&o.isFree?(i(),u("div",Bo,[s("div",Oo,[s("div",Ao,v(o==null?void 0:o.CostOrder)+" ₽ / год",1),s("div",To,"Продление: "+v(o==null?void 0:o.CostProlong)+" ₽",1)]),w(L,{class:"domain__checkbox",checked:a.selectedDomain.some(f=>f.ID===o.ID),onChange:f=>a.toggleDomain(o)},null,8,["checked","onChange"])])):F("",!0)],10,go))),128))])):(i(),X(p,{key:1,class:"domain__empty",label:"Неправильное доменное имя"}))],64)):F("",!0)])])])}const Zo={components:{Multiselect:to},props:{search:{type:String,default:""},domainList:{type:Array,default:()=>[]}},emits:["select"],setup(h,{emit:d}){const x=io(),a=t(h.search);eo(()=>h.search,e=>{a.value=e,e&&C()});const B=no(),E=ao(),r=so({}),I=t(!1),_=t(null);E.query.DomainName&&(_.value=E.query.DomainName,C());const L=t(null),p=t(null),g=t(!1),o=t(null),f=t(!1),m=t([]),k=t([]),U=e=>{var l;return((l=e.match(/\(([^)]+)\)/))==null?void 0:l[1])||""},O=e=>{e.key==="Enter"&&!A.value&&C()},A=co(()=>!_.value);P(()=>{document.addEventListener("keyup",O)}),lo(()=>{document.removeEventListener("keyup",O)});let T=e=>{e.key==="Escape"&&(o.value=null)};function M(){B.replace({query:{DomainName:_.value}})}function j(){o.value=null}function R(e,l,n){var b;const S=(b=l.match(/\(([^)]+)\)/))==null?void 0:b[1],y=`${e}-${S}`;Object.keys(r).forEach(c=>{delete r[c]}),r[y]?(o.value=null,delete r[y],I.value=!1):(o.value=e,r[y]=!0,I.value=!0),console.log("Selected Info:",o.value),console.log("Displayed Info:",r)}function W(e){V(e)}function N(){const e=document.querySelector(".domain__info-title");e&&(f.value=e.scrollWidth>e.clientWidth)}function C(){M(),x.DomainNameCheck({DomainName:_.value}).then(e=>{var S;const{result:l,resultData:n}=e;if(n!=null&&n.DomainName&&(_.value=n.DomainName,p.value=n.DomainName,console.log(p)),n!=null&&n.Zones){m.value=h.domainList.filter(c=>{var D;return((D=n==null?void 0:n.Zones)==null?void 0:D.includes(c==null?void 0:c.Name))&&(c==null?void 0:c.IsActive)}).sort((c,D)=>(n==null?void 0:n.Zones.indexOf(c==null?void 0:c.Name))-(n==null?void 0:n.Zones.indexOf(D==null?void 0:D.Name))).map(c=>({...c,isFree:null,info:l.Info})),g.value=!0;let y=0;const b=setInterval(()=>{H(y),y++},100);setTimeout(()=>{clearInterval(b)},((S=m.value)==null?void 0:S.length)*100)}else m.value=[]})}function H(e){var l;x.DomainCheck({DomainName:p.value,DomainZone:(l=m.value[e])==null?void 0:l.Name}).then(n=>{m.value[e]={...m.value[e],isFree:n.status==="SUCCESS",info:n.info}}).catch(n=>{console.error("An error occurred:",n)})}function V(e){if(e.isFree){const l=k.value.findIndex(n=>n.ID===e.ID);l===-1?k.value.push(e):k.value.splice(l,1),d("select",k.value.map(n=>({...n,line:_.value}))),console.log("Selected Domains:",k.value)}}return P(()=>{N(),window.addEventListener("resize",N)}),z(()=>{window.removeEventListener("resize",N)}),P(()=>{window.addEventListener("keydown",T)}),z(()=>{window.removeEventListener("keydown",T)}),{domainName:_,isListLoaded:g,checkedDomain:p,domain:L,domainsArray:m,selectedDomain:k,selectDomain:V,checkDomain:C,isTextOverflow:f,checkTextOverflow:N,buttonDisabled:A,checkInfo:R,selectedDomainInfo:o,toggleDomain:W,displayedInfo:r,showSinglePackageInfo:I,getOperator:U,closeInfo:j}}},Ho=oo(Zo,[["render",Vo],["__scopeId","data-v-df467d9f"]]);export{Ho as D};
