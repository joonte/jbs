import{j as O,o as P,c as R,a as s,b as p,w as n,d as K,t as i,F as W,a5 as q,x as G,p as J,l as Q,_ as X,u as Y,e as Z,r as d,g as S,h as L}from"./index-1c309346.js";import{u as $}from"./edesks-e690358e.js";import{_ as j}from"./ClausesKeeper-b9906182.js";import{s as ee}from"./multiselect-b7ad6876.js";import{E as A}from"./EmptyStateBlock-5a6a4cd4.js";import{a as te,f as se}from"./useTimeFunction-8602dd60.js";import{C as oe,F as ae}from"./bootstrap-vue-next.es-b799f76d.js";import{S as le}from"./StatusBadge-a49537d5.js";import{_ as ne}from"./FormInputSearch-de4e3004.js";import"./IconClose-7cf50ca7.js";import"./IconPlus-ea6f8c21.js";import"./IconSearch-373e7b4f.js";const re=[{key:"ID",label:"Номер"},{key:"UpdateDate",label:"Дата и время",sortable:!0,variant:"td-gray td-order"},{key:"PriorityID",label:"Приоритет",sortable:!0,variant:"td-gray td-order"},{key:"Theme",label:"Тема"},{key:"MessageID",label:"Количество сообщений"},{key:"StatusID",label:"Статус",sortable:!0,variant:"td-gray td-order"}],ce={Newest:{color:"#459FD1",background:"#ADC1F04C"},Opened:{color:"#FFC107",background:"#FFC10733"},Working:{color:"#28A745",background:"#EAF7ED"},Closed:{color:"#838383",background:"#57699B19"}},ie={Low:{background:"#8FD658"},Middle:{background:"#FFC700"},Hight:{background:"#DF5747"}},c=u=>(J("data-v-ee3dcb70"),u=u(),Q(),u),de={class:"section"},ue={class:"container"},_e={class:"section-header"},pe=c(()=>s("h1",{class:"section-title"},"Служба поддержки",-1)),me={class:"btn__group"},ge={class:"list-form"},be={class:"list-form_col list-form_col--sm"},ke={class:"list-form_select"},ve={class:"multiselect-option"},fe=c(()=>s("span",{class:"td-mobile"},"Номер",-1)),De={class:"d-block"},he=c(()=>s("span",{class:"td-mobile"},"Дата и время",-1)),ye=c(()=>s("span",{class:"td-mobile"},"Приоритет",-1)),Fe=c(()=>s("span",{class:"td-mobile"},"Тема",-1)),Ie={class:"cell__theme"},Te=c(()=>s("span",{class:"td-mobile"},"Количество сообщений",-1)),Ee=c(()=>s("span",{class:"td-mobile"},"Статус",-1)),Ce=c(()=>s("span",null,"Ничего не найдено",-1)),Pe=c(()=>s("span",null,"Ничего не найдено",-1)),Se={class:"table-controls"},Ve=c(()=>s("span",{class:"text-success"},"First",-1)),we=c(()=>s("span",{class:"text-info"},"Last",-1)),Be={class:"multiselect-multiple-label"},xe={class:"multiselect-option"};function Ue(u,l,V,t,b,f){const I=O("router-link"),k=j,D=O("Multiselect"),m=ne,T=le,E=oe,C=ae,v=A;return P(),R("div",de,[s("div",ue,[s("div",_e,[pe,s("div",me,[p(I,{class:"btn btn--blue btn-default",to:"/NewTicket"},{default:n(()=>[K("Создать тикет")]),_:1})])]),p(k,{partition:"Header:/Tickets"}),s("div",ge,[s("div",be,[s("div",ke,[p(D,{options:t.options,label:"name",modelValue:t.select,"onUpdate:modelValue":l[0]||(l[0]=e=>t.select=e)},{option:n(({option:e})=>[s("div",ve,i(e.name),1)]),_:1},8,["options","modelValue"])])]),p(m,{modelValue:t.filter,"onUpdate:modelValue":l[1]||(l[1]=e=>t.filter=e)},null,8,["modelValue"])]),t.getEDeskItems&&t.getEDeskItems.length?(P(),R(W,{key:0},[p(E,{class:"basic-table",items:t.onFiltered(t.filterTableItems(t.getEDeskItems)),"per-page":t.perPage,"current-page":t.currentPage,fields:t.ticketsTable,"show-empty":"","sort-by":t.sortBy,"onUpdate:sortBy":l[2]||(l[2]=e=>t.sortBy=e),"sort-desc":t.sortDesc,"onUpdate:sortDesc":l[3]||(l[3]=e=>t.sortDesc=e),"sort-direction":t.sortDirection,onRowClicked:t.navigateToTicket},{"cell(ID)":n(e=>[fe,s("span",De,i(e.value),1)]),"cell(UpdateDate)":n(e=>[he,s("span",null,i(t.formNormalDate(t.secondToDate(e.value))),1)]),"cell(PriorityID)":n(e=>{var g,h,y,F;return[ye,s("span",{class:"status-tag",style:q(`color: #FFF; background-color: ${(h=(g=t.priorities)==null?void 0:g[e.value])==null?void 0:h.background}; border-color: ${(F=(y=t.priorities)==null?void 0:y[e.value])==null?void 0:F.background}`)},i(t.findPriority(e.value)),5)]}),"cell(Theme)":n(e=>[Fe,s("span",Ie,i(e.value),1)]),"cell(MessageID)":n(e=>[Te,s("span",null,i(e.value),1)]),"cell(StatusID)":n(e=>[Ee,p(T,{status:e.value,"status-table":"Edesks"},null,8,["status"])]),empty:n(e=>[Ce]),emptyfiltered:n(e=>[Pe]),_:1},8,["items","per-page","current-page","fields","sort-by","sort-desc","sort-direction","onRowClicked"]),s("div",Se,[p(C,{modelValue:t.currentPage,"onUpdate:modelValue":l[4]||(l[4]=e=>t.currentPage=e),"total-rows":t.totalRows,"per-page":t.perPage,"first-number":"","last-number":""},{"first-text":n(()=>[Ve]),"last-text":n(()=>[we]),page:n(({page:e,active:g})=>[s("span",null,i((e-1)*t.perPage+1)+"-"+i(e*t.perPage),1)]),_:1},8,["modelValue","total-rows","per-page"]),p(D,{class:"multiselect--white",modelValue:t.perPage,"onUpdate:modelValue":l[5]||(l[5]=e=>t.perPage=e),options:t.pageOptions,label:"name",openDirection:"top"},{singlelabel:n(({value:e})=>[s("div",Be,[s("span",null,"Отображать "+i(e.value)+" строк",1)])]),option:n(({option:e})=>[s("div",xe,"Отображать "+i(e.name)+" строк",1)]),_:1},8,["modelValue","options"])])],64)):(P(),G(v,{key:1,class:"no-margin",label:"Вы пока не обращались в тех. поддержку "}))])])}const Ne={components:{ClausesKeeper:j,Multiselect:ee,EmptyStateBlock:A},async setup(){const u=$(),l=Y(),V=Z(),t=d("*"),b=d(""),f=d(1),I=d(10),k=d(0),D=d([10,25,50,100]),m=d([]),T=d("UpdateDate"),E=d(!0),C=d("desc"),v=S(()=>u==null?void 0:u.eDesksList),e=S(()=>l==null?void 0:l.ConfigList),g=S(()=>{var a,r;return(r=(a=Object.keys(v.value))==null?void 0:a.map(o=>{var _;return(_=v.value)==null?void 0:_[o]}))==null?void 0:r.reverse()});await u.fetchEDesks().then(()=>{var a,r,o,_,w;k.value=g.value.length,(r=(a=e.value)==null?void 0:a.Statuses)!=null&&r.Edesks&&(m.value=(w=Object.keys((_=(o=e.value)==null?void 0:o.Statuses)==null?void 0:_.Edesks))==null?void 0:w.map(B=>{var x,U,N,M;return{value:B,name:(M=(N=(U=(x=e.value)==null?void 0:x.Statuses)==null?void 0:U.Edesks)==null?void 0:N[B])==null?void 0:M.Name}})),m.value.push({value:"*",name:"Все тикеты"})});function h(a){var r;return(r=a==null?void 0:a.filter(o=>t.value==="*"?!0:(o==null?void 0:o.StatusID)===(t==null?void 0:t.value)))==null?void 0:r.filter(o=>(o==null?void 0:o.ID.includes(b.value))||(o==null?void 0:o.Theme.includes(b.value)))}function y(a){return k.value=a.length>0?a.length:1,a}function F(a){var r;return(r=m.value.find(o=>(o==null?void 0:o.value)===a))==null?void 0:r.name}function H(a){var r,o,_;return(_=(o=(r=e.value)==null?void 0:r.Edesks)==null?void 0:o.Priorities)==null?void 0:_[a]}function z(a){V.push({path:`Ticket/${a==null?void 0:a.ID}`})}return L(b,()=>{f.value=1}),L(t,()=>{f.value=1}),{getEDesks:v,getEDeskItems:g,select:t,filter:b,currentPage:f,perPage:I,options:m,totalRows:k,pageOptions:D,sortBy:T,sortDesc:E,sortDirection:C,ticketsTable:re,statuses:ce,priorities:ie,findStatus:F,findPriority:H,onFiltered:y,filterTableItems:h,secondToDate:te,formNormalDate:se,navigateToTicket:z}}},Je=X(Ne,[["render",Ue],["__scopeId","data-v-ee3dcb70"]]);export{Je as default};
