import{_ as j,j as E,o as u,c as y,a as c,b as i,w as m,d as h,t as S,k as x,F as z,v as R,x as N,p as H,l as K,e as q,R as G,r as U,g as w}from"./index-ed1f28f8.js";import{u as J}from"./domain-0e22d159.js";import{u as Q}from"./contracts-cedf6a91.js";import{s as W}from"./useTimeFunction-8602dd60.js";import{I as X}from"./IconSearch-518c61a1.js";import{S as Y}from"./Select2-667a8d46.js";import{s as Z}from"./multiselect-198a8c51.js";import{z as ee,k as te,d as oe}from"./bootstrap-vue-next.es-79226723.js";import{_ as ne}from"./OrderIDBadge-7e968b28.js";import{_ as se}from"./IconDots-296f1d69.js";import{_ as ae}from"./IconCard-ec16e358.js";import{S as re}from"./StatusBadge-2304b071.js";import{_ as ie}from"./HelperComponent-4528cb6e.js";import{_ as M}from"./ClausesKeeper-9aa8ead7.js";import{E as le}from"./EmptyStateBlock-dbc11827.js";import{_ as ce}from"./FormInputSearch-d1c13d60.js";import{_ as me}from"./ButtonDefault-a8aacc82.js";import"./IconArrow-6ab5d812.js";import"./IconClose-a1e58263.js";import"./IconPlus-56dc71c7.js";const de={class:"hosting-item"},ue={class:"hosting-item__row"},_e={class:"hosting-item__row"},fe={class:"hosting-item__person"},De={class:"hosting-item__row"},pe={class:"hosting-item__list"},ge={key:0},he={key:1,class:"bold"},ve={class:"hosting-item__controls"},Ie={class:"btn btn--dots"},be={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","designateOwner"],setup(e,{emit:r}){const _=e;function o(){var a,l;console.log((a=_.itemData)==null?void 0:a.ID),r("delete",(l=_.itemData)==null?void 0:l.ID)}function v(){var a,l;r("transfer",{ServiceOrderID:(a=_.itemData)==null?void 0:a.ID,ServiceID:(l=_.itemData)==null?void 0:l.ServiceID})}function I(){var a;r("designateOwner",{DomainOrderID:(a=_.itemData)==null?void 0:a.ID})}return(a,l)=>{var p,g,s,O,L,P,B,n;const C=ne,D=E("router-link"),d=ee,b=te,k=oe;return u(),y("div",de,[c("div",ue,[i(C,{orderID:(p=e.itemData)==null?void 0:p.OrderID},null,8,["orderID"]),i(D,{class:"hosting-item__name",to:e.infoLink},{default:m(()=>{var t;return[h(S((t=e.itemData)==null?void 0:t.Domain),1)]}),_:1},8,["to"]),i(re,{status:(g=e.itemData)==null?void 0:g.StatusID,"status-table":"DomainOrders"},null,8,["status"])]),c("div",_e,[c("div",fe,S(e.userName),1),i(ie,{"user-notice":(s=e.itemData)==null?void 0:s.UserNotice,id:(O=e.itemData)==null?void 0:O.OrderID,position:e.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),c("div",De,[c("ul",pe,[(L=e.scheme)!=null&&L.PackageID?(u(),y("li",ge,S((P=e.scheme)==null?void 0:P.PackageID),1)):x("",!0),(B=e.scheme)!=null&&B.CostProlong?(u(),y("li",he,S((n=e.scheme)==null?void 0:n.CostProlong)+" ₽",1)):x("",!0)])]),c("div",ve,[c("button",{class:"btn btn--md btn--bold",onClick:l[0]||(l[0]=t=>{var f;return a.$router.push(`/DomainOrderPay/${(f=e.itemData)==null?void 0:f.OrderID}`)})},[i(ae),h("Оплатить")]),i(k,{class:"dropdown-dots",right:""},{"button-content":m(()=>[c("div",Ie,[i(se)])]),default:m(()=>[i(d,null,{default:m(()=>[i(D,{to:e.infoLink},{default:m(()=>[h("Дополнительная информация")]),_:1},8,["to"])]),_:1}),i(d,null,{default:m(()=>{var t;return[i(D,{to:`/DomainOrderPay/${(t=e.itemData)==null?void 0:t.OrderID}`},{default:m(()=>[h("Оплатить заказ")]),_:1},8,["to"])]}),_:1}),i(d,{onClick:l[1]||(l[1]=t=>I())},{default:m(()=>[h("Определить владельца")]),_:1}),i(d,{onClick:l[2]||(l[2]=t=>v())},{default:m(()=>[h("Передать на другой аккаунт")]),_:1}),i(b),i(d,{class:"color-red",onClick:l[3]||(l[3]=t=>o())},{default:m(()=>[h("Удалить")]),_:1})]),_:1})])])}}},A=j(be,[["__scopeId","data-v-fcc3037e"]]),ke=e=>(H("data-v-9bfeaa91"),e=e(),K(),e),Oe={class:"section"},ye={class:"container"},Ce={class:"section-header"},we=ke(()=>c("h1",{class:"section-title"},"Домены",-1)),Se={class:"btn__group"},Le={class:"list-form"},Pe={class:"list-form_col list-form_col--sm"},Be={class:"list-form_select"},Ne={class:"multiselect-option"},Ve={key:0};function $e(e,r,_,o,v,I){var k,p,g;const a=me,l=M,C=E("Multiselect"),D=ce,d=A,b=le;return u(),y("div",Oe,[c("div",ye,[c("div",Ce,[we,c("div",Se,[i(a,{label:"Заказать",onClick:r[0]||(r[0]=s=>o.navigateToDomainSchemes())}),i(a,{label:"Перенести домен",onClick:r[1]||(r[1]=s=>o.openTransferModal())})])]),i(l,{partition:"Header:/DomainOrders"}),c("div",Le,[c("div",Pe,[c("div",Be,[i(C,{modelValue:o.select,"onUpdate:modelValue":r[2]||(r[2]=s=>o.select=s),options:o.getUsers,label:"name",disabled:((k=o.getUsers)==null?void 0:k.length)<=1},{option:m(({option:s})=>[c("div",Ne,S(s.name),1)]),_:1},8,["modelValue","options","disabled"])])]),i(D,{modelValue:o.search,"onUpdate:modelValue":r[3]||(r[3]=s=>o.search=s)},null,8,["modelValue"])]),o.getDomainsList&&((p=o.getDomainsList)==null?void 0:p.length)>0?(u(),y("div",Ve,[o.filterProducts&&((g=o.filterProducts)==null?void 0:g.length)>0?(u(!0),y(z,{key:0},R(o.filterProducts,(s,O)=>(u(),N(d,{"item-data":s,"user-name":o.getUserName(s==null?void 0:s.ContractID),scheme:o.filterDomainScheme(s==null?void 0:s.SchemeID),"info-link":`/DomainOrders/${s==null?void 0:s.OrderID}`,"is-last":O===o.filterProducts.length-1,onDelete:o.deleteItem,onTransfer:o.transferItem,onDesignateOwner:o.designateOwner},null,8,["item-data","user-name","scheme","info-link","is-last","onDelete","onTransfer","onDesignateOwner"]))),256)):(u(),N(b,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(u(),N(b,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])}const Te={components:{IconSearch:X,DomainItem:A,Select2:Y,Multiselect:Z,ClausesKeeper:M},async setup(){const e=J(),r=Q(),_=q(),o=G("emitter");o.on("updateDomainsList",()=>{e.fetchDomains()});const v=U("*"),I=U(null),a=w(()=>{var n;return(n=Object.keys(e==null?void 0:e.domainsList).map(t=>e==null?void 0:e.domainsList[t]))==null?void 0:n.reverse()}),l=w(()=>e==null?void 0:e.domainSchemes),C=w(()=>r==null?void 0:r.contractsList),D=w(()=>k(b(a.value))),d=w(()=>{let n=[{value:"*",name:"Все договора"}];return a.value!==null?(Object.keys(a.value).forEach(t=>{var f,V,$;n.find(F=>{var T;return F.value===((T=a.value[t])==null?void 0:T.ContractID)})||n.push({value:(f=a.value[t])==null?void 0:f.ContractID,name:($=C.value[(V=a.value[t])==null?void 0:V.ContractID])==null?void 0:$.Customer})}),n):{value:"*",name:"Все договора"}});function b(n){return v.value!=="*"?n.filter(t=>(t==null?void 0:t.ContractID)===v.value):n}function k(n){return I.value!==null?n.filter(t=>t==null?void 0:t.Domain.toLowerCase().includes(I.value.toLowerCase())):n}function p(n){var t;return(t=l.value)==null?void 0:t[n]}function g(n){var t,f;return(f=(t=r==null?void 0:r.contractsList)==null?void 0:t[n])==null?void 0:f.Customer}function s(){_.push({path:"/DomainSchemes"})}function O(n){o.emit("open-modal",{component:"DeleteItem",data:{id:n,message:`Вы действительно хотите удалить домен #${n}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function L(n){o.emit("open-modal",{component:"OrdersTransfer",data:n})}function P(){o.emit("open-modal",{component:"DomainTransfer",data:{}})}function B(n){o.emit("open-modal",{component:"DomainSelectOwner",data:n})}return await e.fetchDomains(),await e.fetchDomainSchemes(),await r.fetchContracts(),{getDomainsList:a,getDomainsSchemes:l,getUsers:d,select:v,search:I,openTransferModal:P,filterProducts:D,getUserName:g,designateOwner:B,deleteItem:O,filterDomainScheme:p,navigateToDomainSchemes:s,startFunction:W,transferItem:L}}},tt=j(Te,[["render",$e],["__scopeId","data-v-9bfeaa91"]]);export{tt as default};
