import{j as R,o as _,c as p,a as c,b as r,w as u,d as g,t as x,F as A,v as H,k as U,x as V,_ as N,p as F,l as z,r as M,R as G,g as P}from"./index-ed1f28f8.js";import{u as q}from"./dedicatedServer-6a47cd5c.js";import{u as J}from"./contracts-cedf6a91.js";import{I as K}from"./IconSearch-518c61a1.js";import{_ as Q}from"./HelperComponent-4528cb6e.js";import{S as T}from"./StatusBadge-2304b071.js";import{I as W}from"./IconRotate-9f02186b.js";import{u as X}from"./resetServer-f1402ced.js";import{z as Y,k as Z,d as $}from"./bootstrap-vue-next.es-79226723.js";import{_ as tt}from"./IconDots-296f1d69.js";import{_ as et}from"./IconCard-ec16e358.js";import{_ as ot}from"./OrderIDBadge-7e968b28.js";import{S as st}from"./Select2-667a8d46.js";import{s as nt}from"./multiselect-198a8c51.js";import{_ as j}from"./FormInputSearch-d1c13d60.js";import{E as at}from"./EmptyStateBlock-dbc11827.js";import{_ as rt}from"./ClausesKeeper-9aa8ead7.js";import"./ButtonDefault-a8aacc82.js";import"./IconArrow-6ab5d812.js";import"./IconPlus-56dc71c7.js";import"./IconClose-a1e58263.js";const lt={class:"hosting-item"},ct={class:"hosting-item__row"},dt={class:"hosting-item__row"},it={class:"hosting-item__person"},_t={key:0,class:"hosting-item__row"},ut={class:"hosting-item__list"},ft=["innerHTML"],mt={class:"hosting-item__controls"},Dt={key:0,class:"btn btn--md btn--border btn--rotate btn--rotate_green"},vt={class:"btn btn--dots"};function pt(l,s,o,n,I,a){var d,e,t,i,y,O,B;const f=ot,h=R("router-link"),k=T,S=R("Helper"),C=et,b=tt,m=Y,w=Z,L=$;return _(),p("div",lt,[c("div",ct,[r(f,{orderID:(d=o.itemData)==null?void 0:d.OrderID},null,8,["orderID"]),r(h,{class:"hosting-item__name",to:`/DSOrders/${o.itemData.OrderID}`},{default:u(()=>[g(x(o.itemData.IP),1)]),_:1},8,["to"]),r(k,{status:(e=o.itemData)==null?void 0:e.StatusID,DaysRemainded:(t=o.itemData)==null?void 0:t.DaysRemainded,"status-table":"DSOrders"},null,8,["status","DaysRemainded"])]),c("div",dt,[c("div",it,x((i=o.itemData)==null?void 0:i.Customer),1),r(S,{"user-notice":(y=o.itemData)==null?void 0:y.UserNotice,id:(O=o.itemData)==null?void 0:O.OrderID,position:o.isLast?"bottom":"top",emit:"updateDSOrdersList"},null,8,["user-notice","id","position"])]),o.params.length?(_(),p("div",_t,[c("ul",ut,[(_(!0),p(A,null,H(o.params,D=>(_(),p("li",{innerHTML:D},null,8,ft))),256))])])):U("",!0),c("div",mt,[((B=o.itemData)==null?void 0:B.StatusID)==="Active"?(_(),p("div",Dt,"Включен")):U("",!0),c("div",{class:"btn btn--md btn--bold",onClick:s[0]||(s[0]=D=>{var v;return l.$router.push(`/DSOrderPay/${(v=o.itemData)==null?void 0:v.OrderID}`)})},[r(C),g("Оплатить")]),r(L,{class:"dropdown-dots",right:""},{"button-content":u(()=>[c("div",vt,[r(b)])]),default:u(()=>{var D;return[r(m,null,{default:u(()=>{var v;return[r(h,{to:`DSOrders/${(v=o.itemData)==null?void 0:v.OrderID}`},{default:u(()=>[g("Дополнительная информация")]),_:1},8,["to"])]}),_:1}),((D=o.itemData)==null?void 0:D.StatusID)==="Active"?(_(),V(m,{key:0,onClick:s[1]||(s[1]=v=>n.serverReset())},{default:u(()=>[g("Перезагрузить")]),_:1})):U("",!0),r(m,{onClick:s[2]||(s[2]=v=>n.transferAccount())},{default:u(()=>[g("Передать на другой аккаунт")]),_:1}),r(w),r(m,{class:"color-red",onClick:s[3]||(s[3]=v=>n.deleteItem())},{default:u(()=>[g("Удалить")]),_:1})]}),_:1})])])}const It={components:{StatusBadge:T,IconRotate:W,Helper:Q},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1}},emits:["delete","transfer"],setup(l,{emit:s}){function o(){var a;X().ServerReset((a=l.itemData)==null?void 0:a.ID)}function n(){var a;s("delete",(a=l.itemData)==null?void 0:a.ID)}function I(){var a,f;s("transfer",{ServiceOrderID:(a=l.itemData)==null?void 0:a.ID,ServiceID:(f=l.itemData)==null?void 0:f.ServiceID})}return{deleteItem:n,serverReset:o,transferAccount:I}}},E=N(It,[["render",pt],["__scopeId","data-v-2b6386e3"]]),ht=l=>(F("data-v-fc4a0794"),l=l(),z(),l),gt={class:"section"},St={class:"container"},Ct={class:"section-header"},bt={class:"section-title__nowrap"},wt=ht(()=>c("h1",{class:"section-title"},"Выделенные серверы",-1)),Lt={class:"list-form"},kt={class:"list-form_col list-form_col--sm"},yt={class:"list-form_select"},Ot={class:"multiselect-option"},Pt={key:0};function Bt(l,s,o,n,I,a){var m,w,L;const f=R("router-link"),h=rt,k=R("Multiselect"),S=j,C=E,b=at;return _(),p("div",gt,[c("div",St,[c("div",Ct,[c("div",bt,[wt,r(f,{class:"btn btn--blue btn-default",to:"DSSchemes"},{default:u(()=>[g("Заказать")]),_:1})])]),r(h,{partition:"Header:/DSOrders"}),c("div",Lt,[c("div",kt,[c("div",yt,[r(k,{modelValue:n.select,"onUpdate:modelValue":s[0]||(s[0]=d=>n.select=d),options:n.getUsers,disabled:((m=n.getUsers)==null?void 0:m.length)<=1,label:"name"},{option:u(({option:d})=>[c("div",Ot,x(d.name),1)]),_:1},8,["modelValue","options","disabled"])])]),r(S,{modelValue:n.search,"onUpdate:modelValue":s[1]||(s[1]=d=>n.search=d)},null,8,["modelValue"])]),n.getDSList&&((w=n.getDSList)==null?void 0:w.length)>0?(_(),p("div",Pt,[n.filterProducts&&((L=n.filterProducts)==null?void 0:L.length)>0?(_(!0),p(A,{key:0},H(n.filterProducts,(d,e)=>(_(),V(C,{params:n.getDSItemParam(d),"is-last":e===n.filterProducts.length-1,"item-data":d,onDelete:n.deleteItem,onTransfer:n.transferItem},null,8,["params","is-last","item-data","onDelete","onTransfer"]))),256)):(_(),V(b,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(_(),V(b,{key:1,class:"no-margin",label:"У Вас нет заказов на выделенные серверы"}))])])}const Vt={components:{FormInputSearch:j,IconSearch:K,Select2:st,Multiselect:nt,DSItem:E},async setup(){const l=M("*"),s=M(null),o=q(),n=J(),I=G("emitter");I.on("updateDSOrdersList",()=>{o.fetchDSOrders()});const a=P(()=>{var e;return(e=Object.keys(o==null?void 0:o.DSList).map(t=>o==null?void 0:o.DSList[t]))==null?void 0:e.reverse()}),f=P(()=>o==null?void 0:o.DSSchemes),h=P(()=>n==null?void 0:n.contractsList),k=P(()=>C(S(a.value)));function S(e){return l.value!=="*"?e.filter(t=>(t==null?void 0:t.ContractID)===l.value):e}function C(e){return s.value!==null?e.filter(t=>(t==null?void 0:t.Customer.toLowerCase().includes(s.value.toLowerCase()))||(t==null?void 0:t.OrderID.toLowerCase().includes(s.value.toLowerCase()))||(t==null?void 0:t.Scheme.toLowerCase().includes(s.value.toLowerCase()))||(t==null?void 0:t.IP.toLowerCase().includes(s.value.toLowerCase()))||(t==null?void 0:t.disks.toLowerCase().includes(s.value.toLowerCase()))||(t==null?void 0:t.CPU.toLowerCase().includes(s.value.toLowerCase()))||(t==null?void 0:t.ram.toLowerCase().includes(s.value.toLowerCase()))):e}const b=P(()=>{let e=[{value:"*",name:"Все договора"}];return a.value!==null&&h.value!==null?(Object.keys(a.value).forEach(t=>{var i,y,O;e.find(B=>{var D;return B.value===((D=a.value[t])==null?void 0:D.ContractID)})||e.push({value:(i=a.value[t])==null?void 0:i.ContractID,name:(O=h.value[(y=a.value[t])==null?void 0:y.ContractID])==null?void 0:O.Customer})}),e):{value:"*",name:"Все договора"}});function m(e){let t=w(e==null?void 0:e.SchemeID);t===void 0&&(t=e);let i=[];return e!=null&&e.Scheme&&i.push(e==null?void 0:e.Scheme),e!=null&&e.CPU&&i.push(e==null?void 0:e.CPU),t!=null&&t.ram&&i.push("RAM "+(t==null?void 0:t.ram)+" GB"),t!=null&&t.disks&&i.push(t==null?void 0:t.disks),t!=null&&t.CostMonth&&i.push("<b>"+(t==null?void 0:t.CostMonth)+"/ месяц</b>"),i}function w(e){var t;return(t=f.value)==null?void 0:t[e]}function L(e){I.emit("open-modal",{component:"DeleteItem",data:{id:e,message:"Вы действительно хотите удалить этот сервер?",tableID:"DSOrders",successEmit:"updateDSOrdersList"}})}function d(e){I.emit("open-modal",{component:"OrdersTransfer",data:e})}return await o.fetchDSOrders(),await o.fetchDSSchemes(),await n.fetchContracts(),{getDSList:a,filterProducts:k,select:l,search:s,getUsers:b,getDSSchemes:f,getDSItemParam:m,filterProductsByName:C,filterProductsByCategory:S,deleteItem:L,transferItem:d}}},$t=N(Vt,[["render",Bt],["__scopeId","data-v-fc4a0794"]]);export{$t as default};
