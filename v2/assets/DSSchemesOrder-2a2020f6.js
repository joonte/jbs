import{_ as et}from"./ButtonDefault-7609cc9e.js";import{_ as lt}from"./BlockOrderPayBalance-605ea2fc.js";import{_ as ot}from"./BlockSelectContract-8213faa6.js";import{_ as at}from"./ClausesKeeper-d8c25fea.js";import{_ as ct,f as nt,e as it,U as _t,r as B,h as w,i as rt,P as dt,ag as C,o as b,c as p,b as h,a as s,t as a,F as S,y as W,l as ut,$ as X,a9 as Y,p as vt,m as bt}from"./index-400feb76.js";import{u as pt}from"./dedicatedServer-5c757cde.js";import{u as mt}from"./contracts-d1f15c94.js";import{B as ht}from"./BlockBalanceAgreement-9b1029a8.js";import"./bootstrap-vue-next.es-03cca149.js";import"./IconHelp-39b892d8.js";import"./globalActions-9f4dbd2c.js";import"./component-5bf95be3.js";import"./multiselect-f4d64e06.js";import"./IconClose-20ed8b3b.js";import"./IconArrow-10b76666.js";const f=k=>(vt("data-v-a53ccb14"),k=k(),bt(),k),ft={class:"dedicated-server-order"},kt={class:"section"},Dt={class:"container"},yt={class:"section-header"},It={class:"section-title"},xt=f(()=>s("div",{class:"section-label"},"Выделенный сервер",-1)),wt={class:"section"},St={class:"container"},gt={class:"list"},Bt={class:"list-col list-col--xl"},Ct={class:"list-item"},Ot=f(()=>s("div",{class:"list-item__row"},[s("div",{class:"list-item__title"},"Конфигурация")],-1)),Et={class:"list-item__row list-item__table"},Nt={class:"list-item__table-col"},Pt={class:"list-item__label"},Lt={class:"list-item__text"},Ut=f(()=>s("div",{class:"section"},[s("div",{class:"container"},[s("div",{class:"section-subtitle"},"Что входит в стоимость"),s("div",{class:"text"},[s("p",null,"Для подключения дополнительных услуг"),s("ul",null,[s("li",null,"Размещение в РФ, Москва"),s("li",null,"IP адрес, с возможностью расширения"),s("li",null,"Бесплатная панель управления ISPManager Lite"),s("li",null,"Круглосуточная поддержка")])])])],-1)),Vt={class:"section"},$t={class:"container"},Ft={class:"total-block"},At={class:"total-block__row divider-bottom"},Kt=f(()=>s("div",{class:"total-block__col"},"Цена тарифа",-1)),Rt={class:"total-block__col"},Tt={class:"total-block__row no-divider"},jt={class:"total-block__col"},Mt={class:"total-block__col"},qt={class:"total-block__row total-block__row--big economy-line"},zt=f(()=>s("div",{class:"total-block__col red"},"Выгода",-1)),Gt={class:"total-block__col flex-col"},Ht={class:"red"},Jt={class:"total-block__row total-block__row--big"},Qt={class:"total-block__col"},Wt={class:"total-block__col"},Xt={__name:"DSSchemesOrder",async setup(k){let r,d;const O=mt(),i=pt(),E=nt(),N=it();_t("emitter");const o=B(null),D=B(!1),c=B(null),m=w(()=>O.contractsList),u=w(()=>i==null?void 0:i.DSSchemes),y=w(()=>{var t;return(t=u==null?void 0:u.value)==null?void 0:t[E.params.id]}),P=t=>{t.key==="Enter"&&t.ctrlKey&&!Z.value&&U()},Z=w(()=>o.value===null||c.value===null);rt(()=>{document.addEventListener("keyup",P)}),dt(()=>{document.removeEventListener("keyup",P)});function tt(t){o.value=t}function L(){var e,_;let t=0;return(_=(e=o.value)==null?void 0:e.discounts)==null||_.Bonuses.map(n=>{t+=+n.Economy}),t}function I(t){var v;const e=Number((v=y.value)==null?void 0:v.CostInstall)||0,_=Number(t)||0,n=(e+_).toFixed(2);return Number(n)}function st(){var e;const t=(e=u==null?void 0:u.value)==null?void 0:e[E.params.id];return[{label:"Процессор",text:(t==null?void 0:t.CPU)||"-"},{label:"Объём оперативной памяти",text:(t==null?void 0:t.ram)||"-"},{label:"Характеристики жёстких дисков",text:(t==null?void 0:t.disks)||"-"},{label:"Предустановленная ОС",text:(t==null?void 0:t.OS)||"-"},{label:"RAID",text:(t==null?void 0:t.raid)||"-"},{label:"Месячный трафик",text:t!=null&&t.trafflimit?`${t==null?void 0:t.trafflimit} ГБ`:"-"},{label:"Скорость канала",text:t!=null&&t.chrate?`${t==null?void 0:t.chrate} Мбит/с`:"-"}]}function U(){D.value=!0,i.DSOrder({ContractID:c.value,DSSchemeID:y.value.ID}).then(({result:t,info:e,error:_})=>{var n;t==="SUCCESS"?i.DSOrderPay({DSOrderID:e==null?void 0:e.DSOrderID,DaysPay:(n=o.value)==null?void 0:n.actualDays,IsChange:!0}).then(v=>{let{result:x,error:g}=v;x==="SUCCESS"?N.push("/DSOrders"):x==="BASKET"&&N.push("/Basket"),D.value=!1}):D.value=!1})}return[r,d]=C(()=>i.fetchDSOrders()),await r,d(),[r,d]=C(()=>i.fetchDSSchemes()),await r,d(),[r,d]=C(()=>O.fetchContracts().then(()=>{var t;m.value&&(c.value=(t=Object.keys(m==null?void 0:m.value))==null?void 0:t[0])})),await r,d(),(t,e)=>{var g,V,$,F,A,K,R,T,j,M,q,z,G,H,J,Q;const _=at,n=ot,v=lt,x=et;return b(),p(S,null,[h(ht),s("div",ft,[s("div",kt,[s("div",Dt,[s("div",yt,[s("h1",It,a((g=y.value)==null?void 0:g.Name),1),xt]),h(_)])]),s("div",wt,[s("div",St,[s("div",gt,[s("div",Bt,[s("div",Ct,[Ot,s("div",Et,[(b(!0),p(S,null,W(st(),l=>(b(),p("div",Nt,[s("div",Pt,a(l.label),1),s("div",Lt,a(l.text),1)]))),256))])])])])])]),Ut,h(n,{title:"Оформление услуги",modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=l=>c.value=l)},null,8,["modelValue"]),h(v,{contractID:c.value,scheme:y.value,serviceID:"40000",isOrderID:!1,onSelect:tt},null,8,["contractID","scheme"]),s("div",Vt,[s("div",$t,[s("div",Ft,[((F=($=(V=o.value)==null?void 0:V.discounts)==null?void 0:$.Bonuses)==null?void 0:F.length)>0?(b(),p(S,{key:0},[s("div",At,[Kt,s("div",Rt,a(I((A=o.value)==null?void 0:A.price))+" ₽",1)]),(b(!0),p(S,null,W((R=(K=o.value)==null?void 0:K.discounts)==null?void 0:R.Bonuses,l=>(b(),p("div",Tt,[s("div",jt,"Скидка "+a(l==null?void 0:l.Discount)+"% на "+a(l==null?void 0:l.Days)+" дней",1),s("div",Mt,"-"+a(I(l==null?void 0:l.Economy))+" ₽",1)]))),256))],64)):ut("",!0),X(s("div",qt,[zt,s("div",Gt,[s("span",null,[s("s",null,a(I((T=o.value)==null?void 0:T.price))+" ₽",1)]),s("span",Ht,"-"+a(L())+" ₽",1)])],512),[[Y,((q=(M=(j=o.value)==null?void 0:j.discounts)==null?void 0:M.Bonuses)==null?void 0:q.length)>0]]),X(s("div",Jt,[s("div",Qt,"Итого за "+a((z=o.value)==null?void 0:z.label),1),s("div",Wt,a(I(((G=o.value)==null?void 0:G.price)-L()))+" ₽",1)],512),[[Y,(H=o.value)==null?void 0:H.price]])]),h(x,{class:"btn--wide",label:((J=m.value[c.value])==null?void 0:J.Balance)>((Q=o.value)==null?void 0:Q.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:o.value===null||c.value===null,"is-loading":D.value,onClick:e[1]||(e[1]=l=>U())},null,8,["label","disabled","is-loading"])])])])],64)}}},vs=ct(Xt,[["__scopeId","data-v-a53ccb14"]]);export{vs as default};
