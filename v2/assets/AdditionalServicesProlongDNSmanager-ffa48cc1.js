import{E as se}from"./EmptyStateBlock-9f752916.js";import{_ as le}from"./BlockOrderPayBalance-e0feb4e8.js";import{_ as ce}from"./ClausesKeeper-eb954229.js";import{_ as ne}from"./ButtonDefault-7c216fc6.js";import{_ as ie,a7 as re,e as _e,r as Y,g as w,h as de,ag as I,o as r,c as _,b as d,a as o,t as i,F as C,x as ue,Z as ee,ae as oe,k as ve,p as me,l as pe}from"./index-5e313302.js";import{u as he}from"./contracts-3351d68f.js";import{u as be}from"./services-21abfb71.js";/* empty css                                                                             */import{B as ge}from"./BlockBalanceAgreement-bb87adc1.js";import"./bootstrap-vue-next.es-a19a8b41.js";import"./IconHelp-37cb81ff.js";import"./globalActions-a7429ad5.js";import"./BasicInput-be1c88a0.js";import"./component-6a5a025c.js";import"./IconClose-1f889a2e.js";import"./IconArrow-555f9d45.js";const N=k=>(me("data-v-749adc4d"),k=k(),pe(),k),De={key:0,class:"hosting-sheme"},ke={class:"section"},Se={class:"container"},ye={class:"section-header"},fe={class:"section-header__wrapper"},Ne=N(()=>o("h1",{class:"section-title"},"Оплата заказа вторичного DNS",-1)),Be={class:"section-label"},we={key:0,class:"section"},Ie={class:"container"},Ce=N(()=>o("div",{class:"total-block"},null,-1)),Oe={class:"total-block__row divider-bottom"},xe=N(()=>o("div",{class:"total-block__col"},"Цена тарифа",-1)),Pe={class:"total-block__col"},Ae={class:"total-block__row no-divider"},Ee={class:"total-block__col"},Fe={class:"total-block__col"},Le={class:"total-block__row total-block__row--big economy-line"},Re=N(()=>o("div",{class:"total-block__col red"},"Выгода",-1)),Me={class:"total-block__col flex-col"},Ue={class:"red"},Ve={class:"total-block__row total-block__row--big"},$e={class:"total-block__col"},je={class:"total-block__col"},Te={key:1,class:"section"},qe={class:"container"},Ze={key:1,class:"section"},ze={class:"container"},Ge={__name:"AdditionalServicesProlongDNSmanager",async setup(k){let u,v;const O=he(),s=be(),ae=re(),x=_e(),a=Y(null),S=Y(!1),c=w(()=>Object.keys(s==null?void 0:s.DNSmanagerOrdersList).map(t=>s==null?void 0:s.DNSmanagerOrdersList[t]).find(t=>t.OrderID===ae.params.id)),p=w(()=>{var t;return(t=s==null?void 0:s.additionalServicesScheme)!=null&&t.DNSmanager?Object.keys(s.additionalServicesScheme.DNSmanager).map(l=>{const e=s.additionalServicesScheme.DNSmanager[l];return{...e,value:e==null?void 0:e.ID,name:e==null?void 0:e.Name,cost:e==null?void 0:e.CostDay,month:e==null?void 0:e.CostMonth}}).filter(l=>{var e;return(l==null?void 0:l.ID)==((e=c.value)==null?void 0:e.SchemeID)}):[]}),B=w(()=>O.contractsList);function P(){var m,f,h,b,g;S.value=!0;const t=((m=B.value[c.ContractID])==null?void 0:m.Balance)>((f=a==null?void 0:a.value)==null?void 0:f.price)||((h=p.value[0])==null?void 0:h.cost)==="0.00"&&((b=p.value[0])==null?void 0:b.month)==="0.00",l=!t,e={DNSmanagerOrderID:c.value.ID,DaysPay:(g=a.value)==null?void 0:g.actualDays,IsNoBasket:t,IsUseBasket:l,PayMessage:""};s.DNSOrderPay(e).then(D=>{D==="UseBasket"?x.push("/Basket"):D==="NoBasket"?x.push("/AdditionalServices"):console.error("Ошибка оплаты заказа"),S.value=!0})}function y(t){return Number(t).toFixed(2)||0}function A(){var l,e;let t=0;return(e=(l=a.value)==null?void 0:l.discounts)==null||e.Bonuses.map(m=>{t+=+m.Economy}),t}function te(t){a.value=t}return de(()=>{s.fetchAdditionalServiceScheme("DNSmanager"),console.log("Orders ",c),console.log("Scheme ",p[0])}),[u,v]=I(()=>s.fetchDNSmanagerOrders()),await u,v(),[u,v]=I(()=>s.fetchAdditionalServiceScheme("DNSmanager")),await u,v(),[u,v]=I(()=>O.fetchContracts()),await u,v(),(t,l)=>{var b,g,D,E,F,L,R,M,U,V,$,j,T,q,Z,z,G,H,J,K,Q,W,X;const e=ne,m=ce,f=le,h=se;return r(),_(C,null,[d(ge),c.value?(r(),_("div",De,[o("div",ke,[o("div",Se,[o("div",ye,[o("div",fe,[Ne,d(e,{class:"btn--wide",label:((b=B.value[c.value.ContractID])==null?void 0:b.Balance)>((g=a.value)==null?void 0:g.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:a.value===null||((D=a.value)==null?void 0:D.price)===null,"is-loading":S.value,onClick:l[0]||(l[0]=n=>P())},null,8,["label","disabled","is-loading"])]),o("div",Be,i((E=p.value[0])==null?void 0:E.Name),1)])]),d(m)]),d(f,{contractID:(F=c.value)==null?void 0:F.ContractID,daysRemainded:(L=c.value)==null?void 0:L.DaysRemainded,serviceID:"51000",scheme:p.value[0],orderID:(R=c.value)==null?void 0:R.OrderID,isOrderID:!0,onSelect:te},null,8,["contractID","daysRemainded","scheme","orderID"]),c.value?(r(),_("div",we,[o("div",Ie,[Ce,((V=(U=(M=a.value)==null?void 0:M.discounts)==null?void 0:U.Bonuses)==null?void 0:V.length)>0?(r(),_(C,{key:0},[o("div",Oe,[xe,o("div",Pe,i(y(($=a.value)==null?void 0:$.price))+" ₽",1)]),(r(!0),_(C,null,ue((T=(j=a.value)==null?void 0:j.discounts)==null?void 0:T.Bonuses,n=>(r(),_("div",Ae,[o("div",Ee,"Скидка "+i(n==null?void 0:n.Discount)+"% на "+i(n==null?void 0:n.Days)+" дней",1),o("div",Fe,"-"+i(y(n==null?void 0:n.Economy))+" ₽",1)]))),256)),ee(o("div",Le,[Re,o("div",Me,[o("span",null,[o("s",null,i(y((q=a.value)==null?void 0:q.price))+" ₽",1)]),o("span",Ue,"-"+i(A())+" ₽",1)])],512),[[oe,((G=(z=(Z=a.value)==null?void 0:Z.discounts)==null?void 0:z.Bonuses)==null?void 0:G.length)>0]]),ee(o("div",Ve,[o("div",$e,"Итого за "+i((H=a.value)==null?void 0:H.label),1),o("div",je,i(y(((J=a.value)==null?void 0:J.price)-A()))+" ₽",1)],512),[[oe,(K=a.value)==null?void 0:K.price]])],64)):ve("",!0),d(e,{class:"btn--wide",label:((Q=B.value[c.value.ContractID])==null?void 0:Q.Balance)>((W=a.value)==null?void 0:W.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:a.value===null||((X=a.value)==null?void 0:X.price)===null,"is-loading":S.value,onClick:l[1]||(l[1]=n=>P())},null,8,["label","disabled","is-loading"])])])):(r(),_("div",Te,[o("div",qe,[d(h,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(r(),_("div",Ze,[o("div",ze,[d(h,{label:"не удалось найти заказ хостинга"})])]))],64)}}},ro=ie(Ge,[["__scopeId","data-v-749adc4d"]]);export{ro as default};
