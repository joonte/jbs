import{_ as x}from"./ButtonDefault-CMw2aBy6.js";import{_ as A}from"./ClausesKeeper-iUM0yapS.js";import{_ as B}from"./BlockBalanceAgreement-v_bWuiVT.js";import{D as N,u as E,r as S,f as g,I as F,E as y,o as C,c as b,b as d,a as t,t as i,F as I,h as $,am as V,W as L,d as R,i as q}from"./index-Codq73aV.js";import{u as M}from"./services-DyPBvbVy.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IconClose-Dia1noy8.js";import"./index-BO2gwtUe.js";import"./common-DyknwSqv.js";const T={class:"additional-service-prolong"},W={class:"container"},H={class:"section-header"},J={class:"section-label"},K={class:"container"},X={class:"service-prolong__data"},z={class:"form-field"},G=["value"],Q={class:"form-field"},Y={class:"form-field__label"},Z={class:"form-field"},j=["value"],ee={class:"container"},te={class:"service-prolong__data"},se={class:"total-block"},oe={class:"total-block__row total-block__row--big"},ae={class:"total-block__col"},le={__name:"AdditionalServicesProlong",async setup(ne){let l,n;const k=q(),u=R(),_=N(),p=E(),D=M(),c=S(!1),a=g(()=>Object.values(p?.userOrders).find(s=>s.ID==k.params.id)),v=S(0);async function O(s){try{const o=(await V.get(`${L}/ServiceOrderPay?OrderID=${s}&JSON=1`)).data;return f(o)}catch(e){return console.error("Ошибка при получении данных о стоимости заказа",e),null}}function f(s){let e=0;for(const o in s)s.hasOwnProperty(o)&&(typeof s[o]=="object"?e+=f(s[o]):o==="Cost"&&!isNaN(s[o])&&(e+=parseFloat(s[o])));return e}function m(){return((parseFloat(r.value?.Cost)||parseFloat(v.value)||0)*1).toFixed(2)}function w(){c.value=!0,D.ServiceOrderPay(a.value?.Code,{AmountPay:"1",ServiceOrderID:a.value?.ID,IsChange:!0},{XMLHttpRequest:"yes"}).then(s=>{let{result:e}=s;e==="SUCCESS"?u.push(`/AdditionalServices/${a.value?.ID}`):e==="BASKET"&&u.push("/Basket"),c.value=!1})}F(async()=>{if(a.value){const s=a.value.ID,e=await O(s);e!==null&&(v.value=e)}});const r=g(()=>_?.servicesList[a.value?.ServiceID]);return[l,n]=y(()=>p.fetchUserOrders()),await l,n(),[l,n]=y(()=>_.fetchServices()),await l,n(),(s,e)=>{const o=B,h=A,P=x;return C(),b(I,null,[d(o,{"contract-id":a.value?.ContractID},null,8,["contract-id"]),t("div",T,[t("section",null,[t("div",W,[t("div",H,[e[1]||(e[1]=t("h1",{class:"section-title"},"Оплата заказа дополнительной услуги",-1)),t("div",J,i(r.value?.Name)+" # "+i(a.value?.ID),1)]),d(h)])]),a.value?(C(),b(I,{key:0},[t("section",null,[t("div",K,[t("div",X,[t("label",z,[e[2]||(e[2]=t("span",{class:"form-field__label"},"Стоимость заказа",-1)),t("input",{type:"text",placeholder:"0 руб",value:r.value?.Cost+" руб",disabled:""},null,8,G)]),t("label",Q,[t("span",Y,"Количество ("+i(r.value?.Measure)+")",1),e[3]||(e[3]=t("input",{type:"text",placeholder:"0 руб",value:"1",disabled:""},null,-1))]),t("label",Z,[e[4]||(e[4]=t("span",{class:"form-field__label"},"Всего к оплате",-1)),t("input",{type:"text",placeholder:"0 руб",value:m()+" руб",disabled:""},null,8,j)])])])]),t("section",null,[t("div",ee,[t("div",te,[t("div",se,[t("div",oe,[e[5]||(e[5]=t("div",{class:"total-block__col"},"Итого",-1)),t("div",ae,i(m()||"0")+" ₽",1)])]),d(P,{class:"btn--wide",label:"Оплатить",onClick:e[0]||(e[0]=re=>w()),"is-loading":c.value},null,8,["is-loading"])])])])],64)):$("",!0)])],64)}}},he=U(le,[["__scopeId","data-v-639edfd2"]]);export{he as default};
