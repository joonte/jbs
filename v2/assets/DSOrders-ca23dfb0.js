import{j as A,o as i,c as v,a as l,b as r,w as _,d as g,t as U,F as x,v as H,k as R,x as V,_ as N,p as z,l as G,r as M,R as q,g as B}from"./index-33bd9cf4.js";import{u as J}from"./dedicatedServer-aee0e546.js";import{u as K}from"./contracts-141debab.js";import{I as Q}from"./IconSearch-55746ee2.js";import{_ as W}from"./HelperComponent-ebb207b6.js";import{S as T}from"./StatusBadge-b80983a6.js";import{I as X}from"./IconRotate-e1cfbb59.js";import{u as Y}from"./resetServer-cd32c829.js";import{z as Z,k as $,d as ee}from"./bootstrap-vue-next.es-6bb0e5cd.js";import{_ as te}from"./IconDots-463e8bba.js";import{_ as oe}from"./IconCard-c2e605c3.js";import{_ as se}from"./OrderIDBadge-24fa2e7f.js";import{S as ne}from"./Select2-d10615a4.js";import{s as ae}from"./multiselect-acf9ef65.js";import{_ as j}from"./FormInputSearch-aa64849b.js";import{B as E}from"./BlockBalanceAgreement-5028e9bc.js";import{E as re}from"./EmptyStateBlock-98549fc8.js";import{_ as le}from"./ClausesKeeper-69d31679.js";import"./ButtonDefault-34d9e627.js";import"./IconArrow-dadffb08.js";import"./IconPlus-5f47af9a.js";import"./IconClose-d9fbf580.js";const ce={class:"hosting-item"},de={class:"hosting-item__row"},ie={class:"hosting-item__row"},_e={class:"hosting-item__person"},ue={key:0,class:"hosting-item__row"},me={class:"hosting-item__list"},fe=["innerHTML"],De={class:"hosting-item__controls"},ve={key:0,class:"btn btn--md btn--border btn--rotate btn--rotate_green"},pe={class:"btn btn--dots"};function Ie(c,s,o,n,p,a){var h,t,e,d,y,O,P;const u=se,I=A("router-link"),w=T,S=A("Helper"),C=oe,L=te,m=Z,b=$,k=ee;return i(),v("div",ce,[l("div",de,[r(u,{orderID:(h=o.itemData)==null?void 0:h.OrderID},null,8,["orderID"]),r(I,{class:"hosting-item__name",to:`/DSOrders/${o.itemData.OrderID}`},{default:_(()=>[g(U(o.itemData.IP),1)]),_:1},8,["to"]),r(w,{status:(t=o.itemData)==null?void 0:t.StatusID,DaysRemainded:(e=o.itemData)==null?void 0:e.DaysRemainded,"status-table":"DSOrders"},null,8,["status","DaysRemainded"])]),l("div",ie,[l("div",_e,U((d=o.itemData)==null?void 0:d.Customer),1),r(S,{"user-notice":(y=o.itemData)==null?void 0:y.UserNotice,id:(O=o.itemData)==null?void 0:O.OrderID,position:o.isLast?"bottom":"top",emit:"updateDSOrdersList"},null,8,["user-notice","id","position"])]),o.params.length?(i(),v("div",ue,[l("ul",me,[(i(!0),v(x,null,H(o.params,f=>(i(),v("li",{innerHTML:f},null,8,fe))),256))])])):R("",!0),l("div",De,[((P=o.itemData)==null?void 0:P.StatusID)==="Active"?(i(),v("div",ve,"Включен")):R("",!0),l("div",{class:"btn btn--md btn--bold",onClick:s[0]||(s[0]=f=>{var D;return c.$router.push(`/DSOrderPay/${(D=o.itemData)==null?void 0:D.OrderID}`)})},[r(C),g("Оплатить")]),r(k,{class:"dropdown-dots",right:""},{"button-content":_(()=>[l("div",pe,[r(L)])]),default:_(()=>{var f;return[r(m,null,{default:_(()=>{var D;return[r(I,{to:`DSOrders/${(D=o.itemData)==null?void 0:D.OrderID}`},{default:_(()=>[g("Дополнительная информация")]),_:1},8,["to"])]}),_:1}),((f=o.itemData)==null?void 0:f.StatusID)==="Active"?(i(),V(m,{key:0,onClick:s[1]||(s[1]=D=>n.serverReset())},{default:_(()=>[g("Перезагрузить")]),_:1})):R("",!0),r(m,{onClick:s[2]||(s[2]=D=>n.transferAccount())},{default:_(()=>[g("Передать на другой аккаунт")]),_:1}),r(b),r(m,{class:"color-red",onClick:s[3]||(s[3]=D=>n.deleteItem())},{default:_(()=>[g("Удалить")]),_:1})]}),_:1})])])}const he={components:{StatusBadge:T,IconRotate:X,Helper:W},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1}},emits:["delete","transfer"],setup(c,{emit:s}){function o(){var a;Y().ServerReset((a=c.itemData)==null?void 0:a.ID)}function n(){var a;s("delete",(a=c.itemData)==null?void 0:a.ID)}function p(){var a,u;s("transfer",{ServiceOrderID:(a=c.itemData)==null?void 0:a.ID,ServiceID:(u=c.itemData)==null?void 0:u.ServiceID})}return{deleteItem:n,serverReset:o,transferAccount:p}}},F=N(he,[["render",Ie],["__scopeId","data-v-2b6386e3"]]),ge=c=>(z("data-v-79a3ed0e"),c=c(),G(),c),Se={class:"section"},Ce={class:"container"},be={class:"section-header"},ke={class:"section-title__nowrap"},we=ge(()=>l("h1",{class:"section-title"},"Выделенные серверы",-1)),Le={class:"list-form"},ye={class:"list-form_col list-form_col--sm"},Oe={class:"list-form_select"},Be={class:"multiselect-option"},Pe={key:0};function Ve(c,s,o,n,p,a){var b,k,h;const u=E,I=A("router-link"),w=le,S=A("Multiselect"),C=j,L=F,m=re;return i(),v(x,null,[r(u),l("div",Se,[l("div",Ce,[l("div",be,[l("div",ke,[we,r(I,{class:"btn btn--blue btn-default",to:"DSSchemes"},{default:_(()=>[g("Заказать")]),_:1})])]),r(w,{partition:"Header:/DSOrders"}),l("div",Le,[l("div",ye,[l("div",Oe,[r(S,{modelValue:n.select,"onUpdate:modelValue":s[0]||(s[0]=t=>n.select=t),options:n.getUsers,disabled:((b=n.getUsers)==null?void 0:b.length)<=1,label:"name"},{option:_(({option:t})=>[l("div",Be,U(t.name),1)]),_:1},8,["modelValue","options","disabled"])])]),r(C,{modelValue:n.search,"onUpdate:modelValue":s[1]||(s[1]=t=>n.search=t)},null,8,["modelValue"])]),n.getDSList&&((k=n.getDSList)==null?void 0:k.length)>0?(i(),v("div",Pe,[n.filterProducts&&((h=n.filterProducts)==null?void 0:h.length)>0?(i(!0),v(x,{key:0},H(n.filterProducts,(t,e)=>(i(),V(L,{params:n.getDSItemParam(t),"is-last":e===n.filterProducts.length-1,"item-data":t,onDelete:n.deleteItem,onTransfer:n.transferItem},null,8,["params","is-last","item-data","onDelete","onTransfer"]))),256)):(i(),V(m,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(i(),V(m,{key:1,class:"no-margin",label:"У Вас нет заказов на выделенные серверы"}))])])],64)}const Ae={components:{FormInputSearch:j,IconSearch:Q,Select2:ne,Multiselect:ae,DSItem:F,BlockBalanceAgreement:E},async setup(){const c=M("*"),s=M(null),o=J(),n=K(),p=q("emitter");p.on("updateDSOrdersList",()=>{o.fetchDSOrders()});const a=B(()=>{var t;return(t=Object.keys(o==null?void 0:o.DSList).map(e=>o==null?void 0:o.DSList[e]))==null?void 0:t.reverse()}),u=B(()=>o==null?void 0:o.DSSchemes),I=B(()=>n==null?void 0:n.contractsList),w=B(()=>C(S(a.value)));function S(t){return c.value!=="*"?t.filter(e=>(e==null?void 0:e.ContractID)===c.value):t}function C(t){return s.value!==null?t.filter(e=>(e==null?void 0:e.Customer.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.OrderID.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.Scheme.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.IP.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.disks.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.CPU.toLowerCase().includes(s.value.toLowerCase()))||(e==null?void 0:e.ram.toLowerCase().includes(s.value.toLowerCase()))):t}const L=B(()=>{let t=[{value:"*",name:"Все договора"}];return a.value!==null&&I.value!==null?(Object.keys(a.value).forEach(e=>{var d,y,O;t.find(P=>{var f;return P.value===((f=a.value[e])==null?void 0:f.ContractID)})||t.push({value:(d=a.value[e])==null?void 0:d.ContractID,name:(O=I.value[(y=a.value[e])==null?void 0:y.ContractID])==null?void 0:O.Customer})}),t):{value:"*",name:"Все договора"}});function m(t){let e=b(t==null?void 0:t.SchemeID);e===void 0&&(e=t);let d=[];return t!=null&&t.Scheme&&d.push(t==null?void 0:t.Scheme),t!=null&&t.CPU&&d.push(t==null?void 0:t.CPU),e!=null&&e.ram&&d.push("RAM "+(e==null?void 0:e.ram)+" GB"),e!=null&&e.disks&&d.push(e==null?void 0:e.disks),e!=null&&e.CostMonth&&d.push("<b>"+(e==null?void 0:e.CostMonth)+"/ месяц</b>"),d}function b(t){var e;return(e=u.value)==null?void 0:e[t]}function k(t){p.emit("open-modal",{component:"DeleteItem",data:{id:t,message:"Вы действительно хотите удалить этот сервер?",tableID:"DSOrders",successEmit:"updateDSOrdersList"}})}function h(t){p.emit("open-modal",{component:"OrdersTransfer",data:t})}return await o.fetchDSOrders(),await o.fetchDSSchemes(),await n.fetchContracts(),{getDSList:a,filterProducts:w,select:c,search:s,getUsers:L,getDSSchemes:u,getDSItemParam:m,filterProductsByName:C,filterProductsByCategory:S,deleteItem:k,transferItem:h}}},tt=N(Ae,[["render",Ve],["__scopeId","data-v-79a3ed0e"]]);export{tt as default};
