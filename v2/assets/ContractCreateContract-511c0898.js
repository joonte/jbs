import{_ as $}from"./ButtonDefault-40efcd87.js";import{s as O}from"./SimpleCheckbox-05ca3d00.js";import{_ as j}from"./ClausesKeeper-3ae27028.js";import{_ as M,u as U,e as A,a7 as K,S as J,r as v,g as d,i as S,O as q,h as z,ag as G,j as H,o as p,c as f,b as r,a as s,w as Q,d as W,F as h,x as X,y as Y,k as Z,p as ee,l as te}from"./index-6f846e0d.js";import{u as oe}from"./contracts-b643bcd5.js";import{B as ae}from"./BlockSelectProfile-d57247a9.js";import{B as se}from"./BlockBalanceAgreement-4579706c.js";/* empty css                                                                       */import"./IconClose-12869131.js";import"./multiselect-265f6f4c.js";import"./bootstrap-vue-next.es-6bf04585.js";import"./IconArrow-37547b0b.js";const V=u=>(ee("data-v-d304e6e3"),u=u(),te(),u),le={class:"section"},ne={class:"container"},ce={class:"section-header"},re=V(()=>s("h1",{class:"section-title"},"Создать договор",-1)),ue=V(()=>s("div",{class:"section-header"},[s("h2",{class:"section-block_title"},"Шаблон")],-1)),ie={class:"form"},de={class:"container-limited"},pe={__name:"ContractCreateContract",async setup(u){let C,k;const P=U(),n=oe(),c=A(),T=K(),x=J("emitter"),_=v(!1),i=v("Natural"),o=v(null),B=d(()=>P.ConfigList),a=d(()=>n==null?void 0:n.profileList),m=d(()=>Object.keys(a.value).map(e=>{if(a.value[e].TemplateID==="Natural"||a.value[e].TemplateID==="Juridical"||a.value[e].TemplateID==="Individual"||a.value[e].TemplateID==="NaturalPartner")return{value:a.value[e].ID,name:a.value[e].Name,contractID:a.value[e].ContractID}}).filter(e=>e.contractID===0)),I=e=>{e.key==="Enter"&&e.ctrlKey&&!L.value&&g()},L=d(()=>o.value===null||o.value===void 0);S(()=>{document.addEventListener("keyup",I)}),q(()=>{document.removeEventListener("keyup",I)});function g(){_.value=!0,n.contractMake({ProfileID:o.value,TypeID:i.value}).then(e=>{console.log(e),e.status==="success"&&(x.emit("open-modal",{component:"SuccessContract",data:"Договор успешно создан!"}),c.push("/Contracts")),_.value=!1})}function y(){var e,l;o.value=((l=(e=m.value)==null?void 0:e[0])==null?void 0:l.value)||null}return z(i,()=>{y()}),S(()=>{m.value.length<1&&c.push(`/ProfileMake?ProfileEmpty=true&Redirect=${c.options.history.state.back}`),console.log(T,"route contracts"),console.log(c.options,"options"),console.log(c.options.history.state.back,"full path"),y()}),[C,k]=G(()=>n.fetchProfiles()),await C,k(),(e,l)=>{var b,D;const E=H("router-link"),N=j,w=O,R=$;return p(),f(h,null,[r(se),s("div",le,[s("div",ne,[s("div",ce,[r(E,{class:"section-label",to:"/Contracts"},{default:Q(()=>[W("Мои договора")]),_:1}),re]),r(N),ue,s("div",ie,[(p(!0),f(h,null,X((D=(b=B.value)==null?void 0:b.Contracts)==null?void 0:D.Types,t=>(p(),f(h,null,[(t==null?void 0:t.ProfileTemplateID)!==""?(p(),Y(w,{key:0,label:t==null?void 0:t.Name,value:t==null?void 0:t.ProfileTemplateID,modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=F=>i.value=F)},null,8,["label","value","modelValue"])):Z("",!0)],64))),256))]),s("div",de,[r(ae,{title:"Использовать профиль",items:m.value,modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=t=>o.value=t)},null,8,["items","modelValue"]),r(R,{onClick:g,disabled:o.value===null||o.value===void 0,"is-loading":_.value,label:"Зарегистрировать"},null,8,["disabled","is-loading"])])])])],64)}}},Se=M(pe,[["__scopeId","data-v-d304e6e3"]]);export{Se as default};
