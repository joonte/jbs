import{E as le}from"./EmptyStateBlock-ccb3476e.js";import{_ as ce}from"./BlockOrderPayBalance-f20d5ae2.js";import{_ as ne}from"./ClausesKeeper-ce1dcc35.js";import{_ as ie}from"./ButtonDefault-4233c21f.js";import{_ as re,a7 as _e,e as de,r as Y,g as P,i as ue,ag as x,o as r,c as _,b as d,a as t,t as i,F as B,x as ve,Z as ee,a9 as te,k as pe,p as me,l as he}from"./index-00a0bf0d.js";import{u as be}from"./contracts-8ab155ab.js";import{u as ke}from"./services-1b7b90ba.js";/* empty css                                                                             */import{B as Ie}from"./BlockBalanceAgreement-fb81df3d.js";import"./bootstrap-vue-next.es-be8a8de1.js";import"./IconHelp-6dba2040.js";import"./globalActions-72d167c2.js";import"./BasicInput-95ab4d38.js";import"./component-89555e8b.js";import"./IconClose-97a82d3d.js";import"./IconArrow-74dc045b.js";const E=I=>(me("data-v-766e933b"),I=I(),he(),I),ye={key:0,class:"hosting-sheme"},fe={class:"section"},ge={class:"container"},De={class:"section-header"},Se={class:"section-header__wrapper"},Pe={class:"section-label"},xe={key:0,class:"section"},Be={class:"container"},Ee=E(()=>t("div",{class:"total-block"},null,-1)),we={class:"total-block__row divider-bottom"},Ce=E(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),Oe={class:"total-block__col"},Fe={class:"total-block__row no-divider"},Ne={class:"total-block__col"},Ae={class:"total-block__col"},Le={class:"total-block__row total-block__row--big economy-line"},Re=E(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),$e={class:"total-block__col flex-col"},Me={class:"red"},Ue={class:"total-block__row total-block__row--big"},Ve={class:"total-block__col"},je={class:"total-block__col"},Te={key:1,class:"section"},qe={class:"container"},Ze={key:1,class:"section"},ze={class:"container"},Ge={__name:"AdditionalServicesProlongExtraIP",async setup(I){let u,v;const w=be(),l=ke(),oe=_e(),C=de(),o=Y(null),y=Y(!1),n=P(()=>Object.keys(l==null?void 0:l.ExtraIPOrdersList).map(a=>l==null?void 0:l.ExtraIPOrdersList[a]).find(a=>a.OrderID===oe.params.id)),f=P(()=>{var a;return(a=l==null?void 0:l.additionalServicesScheme)!=null&&a.ExtraIP?Object.keys(l.additionalServicesScheme.ExtraIP).map(s=>{const e=l.additionalServicesScheme.ExtraIP[s];return{...e,value:e==null?void 0:e.ID,name:e==null?void 0:e.Name,cost:e==null?void 0:e.CostDay,month:e==null?void 0:e.CostMonth}}).filter(s=>{var e;return(s==null?void 0:s.ID)==((e=n.value)==null?void 0:e.SchemeID)}):[]}),S=P(()=>w.contractsList);function ae(){console.log(o.value)}function O(){var p,D,m,h,b;y.value=!0;const a=((p=S.value[n.ContractID])==null?void 0:p.Balance)>((D=o==null?void 0:o.value)==null?void 0:D.price)||((m=f.value[0])==null?void 0:m.cost)==="0.00"&&((h=f.value[0])==null?void 0:h.month)==="0.00",s=!a,e={ExtraIPOrderID:n.value.ID,DaysPay:(b=o.value)==null?void 0:b.actualDays,IsNoBasket:a,IsUseBasket:s,PayMessage:""};l.ExtraIPOrderPay(e).then(k=>{k==="UseBasket"?C.push("/Basket"):k==="NoBasket"?C.push("/AdditionalServices"):console.error("Ошибка оплаты заказа"),y.value=!0})}function g(a){return Number(a).toFixed(2)||0}function F(){var s,e;let a=0;return(e=(s=o.value)==null?void 0:s.discounts)==null||e.Bonuses.map(p=>{a+=+p.Economy}),a}function se(a){o.value=a}return ue(()=>{l.fetchAdditionalServiceScheme("ExtraIP")}),[u,v]=x(()=>l.fetchExtraIPOrders()),await u,v(),[u,v]=x(()=>l.fetchAdditionalServiceScheme("ExtraIP")),await u,v(),[u,v]=x(()=>w.fetchContracts()),await u,v(),(a,s)=>{var h,b,k,N,A,L,R,$,M,U,V,j,T,q,Z,z,G,H,J,K,Q,W,X;const e=ie,p=ne,D=ce,m=le;return r(),_(B,null,[d(Ie),n.value?(r(),_("div",ye,[t("div",fe,[t("div",ge,[t("div",De,[t("div",Se,[t("h1",{class:"section-title",onClick:s[0]||(s[0]=c=>ae())},"Оплата заказа IP адреса"),d(e,{class:"btn--wide",label:parseFloat((h=S.value[n.value.ContractID])==null?void 0:h.Balance)>=parseFloat((b=o.value)==null?void 0:b.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:o.value===null||((k=o.value)==null?void 0:k.price)===null,"is-loading":y.value,onClick:s[1]||(s[1]=c=>O())},null,8,["label","disabled","is-loading"])]),t("div",Pe,i((N=f.value[0])==null?void 0:N.Name),1)])]),d(p)]),d(D,{contractID:(A=n.value)==null?void 0:A.ContractID,daysRemainded:(L=n.value)==null?void 0:L.DaysRemainded,serviceID:"50000",scheme:f.value[0],orderID:(R=n.value)==null?void 0:R.OrderID,isOrderID:!0,onSelect:se},null,8,["contractID","daysRemainded","scheme","orderID"]),n.value?(r(),_("div",xe,[t("div",Be,[Ee,((U=(M=($=o.value)==null?void 0:$.discounts)==null?void 0:M.Bonuses)==null?void 0:U.length)>0?(r(),_(B,{key:0},[t("div",we,[Ce,t("div",Oe,i(g((V=o.value)==null?void 0:V.price))+" ₽",1)]),(r(!0),_(B,null,ve((T=(j=o.value)==null?void 0:j.discounts)==null?void 0:T.Bonuses,c=>(r(),_("div",Fe,[t("div",Ne,"Скидка "+i(c==null?void 0:c.Discount)+"% на "+i(c==null?void 0:c.Days)+" дней",1),t("div",Ae,"-"+i(g(c==null?void 0:c.Economy))+" ₽",1)]))),256)),ee(t("div",Le,[Re,t("div",$e,[t("span",null,[t("s",null,i(g((q=o.value)==null?void 0:q.price))+" ₽",1)]),t("span",Me,"-"+i(F())+" ₽",1)])],512),[[te,((G=(z=(Z=o.value)==null?void 0:Z.discounts)==null?void 0:z.Bonuses)==null?void 0:G.length)>0]])],64)):pe("",!0),ee(t("div",Ue,[t("div",Ve,"Итого за "+i((H=o.value)==null?void 0:H.label),1),t("div",je,i(g(((J=o.value)==null?void 0:J.price)-F()))+" ₽",1)],512),[[te,(K=o.value)==null?void 0:K.price]]),d(e,{class:"btn--wide",label:parseFloat((Q=S.value[n.value.ContractID])==null?void 0:Q.Balance)>=parseFloat((W=o.value)==null?void 0:W.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:o.value===null||((X=o.value)==null?void 0:X.price)===null,"is-loading":y.value,onClick:s[2]||(s[2]=c=>O())},null,8,["label","disabled","is-loading"])])])):(r(),_("div",Te,[t("div",qe,[d(m,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(r(),_("div",Ze,[t("div",ze,[d(m,{label:"не удалось найти заказ хостинга"})])]))],64)}}},rt=re(Ge,[["__scopeId","data-v-766e933b"]]);export{rt as default};
