import{E as oe}from"./EmptyStateBlock-98549fc8.js";import{_ as se}from"./ButtonDefault-34d9e627.js";import{_ as ae}from"./BlockOrderPayBalance-32f68a26.js";import{_ as le}from"./ClausesKeeper-69d31679.js";import{_ as ce,a7 as ne,e as ie,R as _e,r as h,g as B,ag as I,o as n,c as i,b as u,a as e,t as c,F as w,v as re,k as ue,Y as M,ae as Q,p as de,l as me}from"./index-33bd9cf4.js";import{u as pe}from"./hosting-61dcf5ca.js";import{u as ve}from"./contracts-141debab.js";import{_ as he}from"./paramsAccordionBlock-07545bcf.js";import{B as be}from"./BlockBalanceAgreement-5028e9bc.js";import"./bootstrap-vue-next.es-6bb0e5cd.js";import"./IconHelp-778266d8.js";import"./globalActions-75584fd3.js";import"./BasicInput-05417191.js";import"./component2-2c0ce76f.js";import"./component-512acaec.js";import"./IconClose-d9fbf580.js";import"./IconArrow-dadffb08.js";const W=b=>(de("data-v-e797a62c"),b=b(),me(),b),ge={key:0,class:"hosting-sheme"},ke={class:"section"},fe={class:"container"},ye={class:"section-header"},De={class:"section-title"},Be={class:"section-label"},Ie={key:0,class:"section"},we={class:"container"},Se={class:"total-block"},Ce={class:"total-block__row divider-bottom"},He=W(()=>e("div",{class:"total-block__col"},"Цена тарифа",-1)),Ee={class:"total-block__col"},Pe={class:"total-block__row no-divider"},xe={class:"total-block__col"},Oe={class:"total-block__col"},Fe={class:"total-block__row total-block__row--big economy-line"},Ne=W(()=>e("div",{class:"total-block__col red"},"Выгода",-1)),Le={class:"total-block__col flex-col"},$e={class:"red"},Ae={class:"total-block__row total-block__row--big"},Re={class:"total-block__col"},Te={class:"total-block__col"},Ve={key:1,class:"section"},je={class:"container"},Ke={key:1,class:"section"},Ue={class:"container"},Ye={__name:"HostingProlong",async setup(b){let d,m;const s=pe(),S=ve(),X=ne(),C=ie();_e("emitter"),h(null),h(null),h("");const o=h(null),y=h(!1),_=B(()=>Object.keys(s==null?void 0:s.hostingList).map(t=>s==null?void 0:s.hostingList[t]).find(t=>t.OrderID===X.params.id)),g=B(()=>{var t,a;return(a=s==null?void 0:s.hostingSchemes)==null?void 0:a[(t=_.value)==null?void 0:t.SchemeID]}),Z=B(()=>S.contractsList);function k(t){return Number(t).toFixed(2)||0}function H(){var a,r;let t=0;return(r=(a=o.value)==null?void 0:a.discounts)==null||r.Bonuses.map(p=>{t+=+p.Economy}),t}function ee(){var t,a,r;y.value=!0,s.HostingOrderPay({HostingOrderID:(t=_.value)==null?void 0:t.ID,DaysPayFromBallance:((a=o.value)==null?void 0:a.daysFromBalance)||0,DaysPay:(r=o.value)==null?void 0:r.actualDays,IsChange:!0}).then(p=>{var v;let{result:f,error:D}=p;f==="SUCCESS"?C.push(`/HostingOrders/${(v=_.value)==null?void 0:v.ID}`):f==="BASKET"&&C.push("/Basket"),y.value=!1})}function te(t){o.value=t}return[d,m]=I(()=>s.fetchHostingOrders()),await d,m(),[d,m]=I(()=>s.fetchHostingSchemes()),await d,m(),[d,m]=I(()=>S.fetchContracts()),await d,m(),(t,a)=>{var v,E,P,x,O,F,N,L,$,A,R,T,V,j,K,U,Y,q,z,G,J;const r=le,p=ae,f=se,D=oe;return n(),i(w,null,[u(be),_.value?(n(),i("div",ge,[e("div",ke,[e("div",fe,[e("div",ye,[e("h1",De,c((v=_.value)==null?void 0:v.Domain),1),e("div",Be,c((E=g.value)==null?void 0:E.Name),1)]),u(r)])]),u(he,{"params-list":(P=g.value)==null?void 0:P.SchemeParams,label:"Общая информация","main-param":"InternalName"},null,8,["params-list"]),u(p,{contractID:(x=_.value)==null?void 0:x.ContractID,scheme:g.value,isOrderID:!0,onSelect:te},null,8,["contractID","scheme"]),(O=g.value)!=null&&O.IsProlong?(n(),i("div",Ie,[e("div",we,[e("div",Se,[((L=(N=(F=o.value)==null?void 0:F.discounts)==null?void 0:N.Bonuses)==null?void 0:L.length)>0?(n(),i(w,{key:0},[e("div",Ce,[He,e("div",Ee,c(k(($=o.value)==null?void 0:$.price))+" ₽",1)]),(n(!0),i(w,null,re((R=(A=o.value)==null?void 0:A.discounts)==null?void 0:R.Bonuses,l=>(n(),i("div",Pe,[e("div",xe,"Скидка "+c(l==null?void 0:l.Discount)+"% на "+c(l==null?void 0:l.Days)+" дней",1),e("div",Oe,"-"+c(k(l==null?void 0:l.Economy))+" ₽",1)]))),256))],64)):ue("",!0),M(e("div",Fe,[Ne,e("div",Le,[e("span",null,[e("s",null,c(k((T=o.value)==null?void 0:T.price))+" ₽",1)]),e("span",$e,"-"+c(H())+" ₽",1)])],512),[[Q,((K=(j=(V=o.value)==null?void 0:V.discounts)==null?void 0:j.Bonuses)==null?void 0:K.length)>0]]),M(e("div",Ae,[e("div",Re,"Итого за "+c((U=o.value)==null?void 0:U.label),1),e("div",Te,c(k(((Y=o.value)==null?void 0:Y.price)-H()))+" ₽",1)],512),[[Q,(q=o.value)==null?void 0:q.price]])]),u(f,{class:"btn--wide",label:((z=Z.value[_.value.ContractID])==null?void 0:z.Balance)>((G=o.value)==null?void 0:G.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:o.value===null||((J=o.value)==null?void 0:J.price)===null,"is-loading":y.value,onClick:a[0]||(a[0]=l=>ee())},null,8,["label","disabled","is-loading"])])])):(n(),i("div",Ve,[e("div",je,[u(D,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(n(),i("div",Ke,[e("div",Ue,[u(D,{label:"не удалось найти заказ хостинга"})])]))],64)}}},it=ce(Ye,[["__scopeId","data-v-e797a62c"]]);export{it as default};
