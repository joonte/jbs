import{_ as w}from"./ButtonDefault-eJbeaBtE.js";import{_ as A}from"./BasicInput-TTn3Hxre.js";import{s as P}from"./multiselect-eqvbz1NV.js";import{am as U,u as J,x as O,r as m,f as i,h as $,c as y,o as R,a as c,b as f,v as K}from"./index-XtiBO-PZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./component-YfTGPdLe.js";const F={class:"modal__body"},H={class:"modal__input-row"},W={class:"profile-info__item"},q={class:"profile-info__item wrap-item"},z={class:"profile-info__item"},te={__name:"ModalWindowCreateContact",emits:["modalClose","buttonClicked"],setup(G,{emit:S}){const b=U(),u=J();O("emitter");const M=S,d=m(""),n=m(""),V=m({}),B=m({Name:"",Sign:""}),o=i(()=>u.userInfo),p=i(()=>b.data.Notifies?.Methods),E=i(()=>Object.keys(o.value?.Contacts).map(e=>{if(!o.value?.Contacts?.[e]?.IsHidden)return o.value?.Contacts?.[e]}).filter(Boolean)),h=i(()=>Object.keys(p.value).filter(e=>p.value[e].IsActive==="1").map(e=>({name:p.value[e].Name,value:e}))),a=i(()=>b.data.Messages?.Prompts),x=e=>{switch(e){case"Email":const t=a.value.Email,l=/<B>Например:<\/B>\s*([^<]+)/,r=t.match(l);return r&&r[1]?`${r[1]}`:t;case"SMS":const s=a.value.SMS,T=/<B>Например:<\/B>\s*([^<]+)/,_=s.match(T);return _&&_[1]?`${_[1]}`:s;case"Jabber":const C=a.value.Jabber,j=/<B>Например:<\/B>\s*([^<]+)/,v=C.match(j);return v&&v[1]?`${v[1]}`:C;default:return"Ссылка или id"}},k=e=>{switch(e){case"Email":return a.value.Email;case"SMS":return a.value.SMS;case"Jabber":return a.value.Jabber;case"Telegram":return a.value.Telegram;case"Viber":return a.value.Viber;case"VKontakte":return a.value.VKontakte;default:return"Ссылка или id"}};function D(){M("modalClose")}function g(){let e={};E.value.forEach((t,l)=>{e[l]={...t,oldValue:t.Address}}),V.value=e,I()}function I(){B.value={Name:o.value?.Name,Email:o.value?.Email,Sign:o.value?.Sign}}g();function N(){const e={MethodID:n.value,Address:d.value,TimeBegin:"00",TimeEnd:"00",IsActive:"yes",ContactID:"0"};u.userEditContact(e).then(t=>{t.response==="SUCCESS"&&(u.fetchUserData().then(()=>{g()}),D())})}return $(()=>{u.OAuth()}),(e,t)=>{const l=A,r=w;return R(),y("div",F,[t[2]||(t[2]=c("div",{class:"list-item__title"},"Новый контакт",-1)),c("div",H,[c("div",W,[f(K(P),{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=s=>n.value=s),options:h.value,disabled:h.value.length<=1,label:"name",placeholder:"Тип адреса"},null,8,["modelValue","options","disabled"])]),c("div",q,[f(l,{name:"name",placeholder:x(n.value),vertical:"",modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=s=>d.value=s),title:k(n.value)},null,8,["placeholder","modelValue","title"])]),c("div",z,[f(r,{class:"profile-info__add-button",label:"Добавить контакт",onClick:N})])])])}}};export{te as default};
