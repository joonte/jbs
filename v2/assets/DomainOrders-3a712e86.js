import{_ as F,j as R,o as g,c as L,a as m,b as i,w as _,d as h,t as I,k as U,F as A,v as G,x as V,p as J,l as Q,e as W,R as X,r as E,g as P}from"./index-e8e4a28d.js";import{u as Y}from"./domain-124d4d36.js";import{u as Z}from"./contracts-f70de43e.js";import{f as j,s as ee}from"./useTimeFunction-8602dd60.js";import{I as te}from"./IconSearch-20ab9363.js";import{S as ne}from"./Select2-242545f3.js";import{s as oe}from"./multiselect-762d23c8.js";import{z as ae,k as se,d as re}from"./bootstrap-vue-next.es-6aab83a5.js";import{_ as ie}from"./OrderIDBadge-67a1051d.js";import{_ as le}from"./IconDots-ef5e2b5e.js";import{_ as ce}from"./IconCard-49dbdefd.js";import{S as me}from"./StatusBadge-3b9ca694.js";import{_ as de}from"./HelperComponent-dd8d6ccf.js";import{_ as z}from"./ClausesKeeper-cfc0f758.js";import{B as H}from"./BlockBalanceAgreement-00019440.js";import{u as ue}from"./globalActions-78d58809.js";import{E as _e}from"./EmptyStateBlock-b36abca5.js";import{_ as fe}from"./FormInputSearch-61c2ee8e.js";import{_ as De}from"./ButtonDefault-28022e42.js";import"./IconArrow-0cda8946.js";import"./IconClose-c1bee414.js";import"./IconPlus-eed3ce1d.js";const ge={class:"hosting-item"},pe={class:"hosting-item__row"},ve={class:"hosting-item__date"},he={class:"hosting-item__row"},Ie={class:"hosting-item__person"},be={class:"hosting-item__row"},ke={class:"hosting-item__list"},Oe={key:0},we={key:1,class:"bold"},ye={class:"hosting-item__controls"},Ce={class:"btn btn--dots"},Se={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","designateOwner","manage"],setup(n,{emit:t}){const c=n;function a(l){if(!l)return j(new Date);const o=new Date,D=new Date(o.getTime()+l*24*60*60*1e3);return j(D)}function p(){var l,o;console.log((l=c.itemData)==null?void 0:l.ID),t("delete",(o=c.itemData)==null?void 0:o.ID)}function w(){var l,o;t("transfer",{ServiceOrderID:(l=c.itemData)==null?void 0:l.ID,ServiceID:(o=c.itemData)==null?void 0:o.ServiceID})}function b(){var l;t("designateOwner",{DomainOrderID:(l=c.itemData)==null?void 0:l.ID})}function u(){var l,o,D;t("manage",{ServiceOrderID:(l=c.itemData)==null?void 0:l.ID,ServiceID:(o=c.itemData)==null?void 0:o.ServiceID,OrderID:(D=c.itemData)==null?void 0:D.OrderID})}return(l,o)=>{var O,s,S,M,N,x,T,e,r,v;const D=ie,k=R("router-link"),f=ae,y=se,C=re;return g(),L("div",ge,[m("div",pe,[i(D,{orderID:(O=n.itemData)==null?void 0:O.OrderID},null,8,["orderID"]),i(k,{class:"hosting-item__name",to:n.infoLink},{default:_(()=>{var d;return[h(I((d=n.itemData)==null?void 0:d.Domain),1)]}),_:1},8,["to"]),i(me,{status:(s=n.itemData)==null?void 0:s.StatusID,"status-table":"DomainOrders"},null,8,["status"]),m("div",ve,"Дата окончания "+I(a((S=n.itemData)==null?void 0:S.DaysRemainded))+" | "+I(((M=n.itemData)==null?void 0:M.DaysRemainded)||0)+" дн.",1)]),m("div",he,[m("div",Ie,I(n.userName),1),i(de,{"user-notice":(N=n.itemData)==null?void 0:N.UserNotice,id:(x=n.itemData)==null?void 0:x.OrderID,position:n.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),m("div",be,[m("ul",ke,[(T=n.scheme)!=null&&T.PackageID?(g(),L("li",Oe,I((e=n.scheme)==null?void 0:e.PackageID),1)):U("",!0),(r=n.scheme)!=null&&r.CostProlong?(g(),L("li",we,I((v=n.scheme)==null?void 0:v.CostProlong)+" ₽",1)):U("",!0)])]),m("div",ye,[m("button",{class:"btn btn--md btn--bold",onClick:o[0]||(o[0]=d=>{var B;return l.$router.push(`/DomainOrderPay/${(B=n.itemData)==null?void 0:B.OrderID}`)})},[i(ce),h("Оплатить")]),i(C,{class:"dropdown-dots",right:""},{"button-content":_(()=>[m("div",Ce,[i(le)])]),default:_(()=>[i(f,null,{default:_(()=>[i(k,{to:n.infoLink},{default:_(()=>[h("Дополнительная информация")]),_:1},8,["to"])]),_:1}),i(f,null,{default:_(()=>{var d;return[i(k,{to:`/DomainOrderPay/${(d=n.itemData)==null?void 0:d.OrderID}`},{default:_(()=>[h("Оплатить заказ")]),_:1},8,["to"])]}),_:1}),i(f,{onClick:o[1]||(o[1]=d=>b())},{default:_(()=>[h("Определить владельца")]),_:1}),i(f,{onClick:o[2]||(o[2]=d=>w())},{default:_(()=>[h("Передать на другой аккаунт")]),_:1}),i(f,{onClick:o[3]||(o[3]=d=>u())},{default:_(()=>[h("Управлять заказом")]),_:1}),i(y),i(f,{class:"color-red",onClick:o[4]||(o[4]=d=>p())},{default:_(()=>[h("Удалить")]),_:1})]),_:1})])])}}},K=F(Se,[["__scopeId","data-v-bacabddf"]]),Le=n=>(J("data-v-dfa7d436"),n=n(),Q(),n),Be={class:"section"},Pe={class:"container"},Me={class:"section-header"},Ne=Le(()=>m("h1",{class:"section-title"},"Домены",-1)),xe={class:"btn__group"},Te={class:"list-form"},Ve={class:"list-form_col list-form_col--sm"},$e={class:"list-form_select"},Ue={class:"multiselect-option"},Ae={key:0};function Ee(n,t,c,a,p,w){var y,C,O;const b=H,u=De,l=z,o=R("Multiselect"),D=fe,k=K,f=_e;return g(),L(A,null,[i(b),m("div",Be,[m("div",Pe,[m("div",Me,[Ne,m("div",xe,[i(u,{label:"Заказать",onClick:t[0]||(t[0]=s=>a.navigateToDomainSchemes())}),i(u,{label:"Перенести домен",onClick:t[1]||(t[1]=s=>a.openTransferModal())})])]),i(l,{partition:"Header:/DomainOrders"}),m("div",Te,[m("div",Ve,[m("div",$e,[i(o,{modelValue:a.select,"onUpdate:modelValue":t[2]||(t[2]=s=>a.select=s),options:a.getUsers,label:"name",disabled:((y=a.getUsers)==null?void 0:y.length)<=1},{option:_(({option:s})=>[m("div",Ue,"# "+I(s.value.padStart(5,"0"))+" / "+I(s.name),1)]),_:1},8,["modelValue","options","disabled"])])]),i(D,{modelValue:a.search,"onUpdate:modelValue":t[3]||(t[3]=s=>a.search=s)},null,8,["modelValue"])]),a.getDomainsList&&((C=a.getDomainsList)==null?void 0:C.length)>0?(g(),L("div",Ae,[a.filterProducts&&((O=a.filterProducts)==null?void 0:O.length)>0?(g(!0),L(A,{key:0},G(a.filterProducts,(s,S)=>(g(),V(k,{"item-data":s,"user-name":a.getUserName(s==null?void 0:s.ContractID),scheme:a.filterDomainScheme(s==null?void 0:s.SchemeID),"info-link":`/DomainOrders/${s==null?void 0:s.OrderID}`,"is-last":S===a.filterProducts.length-1,onDelete:a.deleteItem,onTransfer:a.transferItem,onDesignateOwner:a.designateOwner,onManage:a.orderManage},null,8,["item-data","user-name","scheme","info-link","is-last","onDelete","onTransfer","onDesignateOwner","onManage"]))),256)):(g(),V(f,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(g(),V(f,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}const je={components:{IconSearch:te,DomainItem:K,Select2:ne,Multiselect:oe,ClausesKeeper:z,BlockBalanceAgreement:H},async setup(){const n=ue(),t=Y(),c=Z(),a=W(),p=X("emitter");p.on("updateDomainsList",()=>{t.fetchDomains()});const w=E("*"),b=E(null),u=P(()=>{var e;return(e=Object.keys(t==null?void 0:t.domainsList).map(r=>t==null?void 0:t.domainsList[r]))==null?void 0:e.reverse()}),l=P(()=>t==null?void 0:t.domainSchemes),o=P(()=>c==null?void 0:c.contractsList),D=P(()=>y(f(u.value))),k=P(()=>{let e=[{value:"*",name:"Все договора"}];return u.value!==null?(Object.keys(u.value).forEach(r=>{var v,d,B;e.find(q=>{var $;return q.value===(($=u.value[r])==null?void 0:$.ContractID)})||e.push({value:(v=u.value[r])==null?void 0:v.ContractID,name:(B=o.value[(d=u.value[r])==null?void 0:d.ContractID])==null?void 0:B.Customer})}),e):{value:"*",name:"Все договора"}});function f(e){return w.value!=="*"?e.filter(r=>(r==null?void 0:r.ContractID)===w.value):e}function y(e){return b.value!==null?e.filter(r=>r==null?void 0:r.Domain.toLowerCase().includes(b.value.toLowerCase())):e}function C(e){var r;return(r=l.value)==null?void 0:r[e]}function O(e){var r,v;return(v=(r=c==null?void 0:c.contractsList)==null?void 0:r[e])==null?void 0:v.Customer}function s(e){n.OrderManage(e)}function S(){a.push({path:"/DomainSchemes"})}function M(e){p.emit("open-modal",{component:"DeleteItem",data:{id:e,message:`Вы действительно хотите удалить домен #${e}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function N(e){p.emit("open-modal",{component:"OrdersTransfer",data:e})}function x(){p.emit("open-modal",{component:"DomainTransfer",data:{}})}function T(e){p.emit("open-modal",{component:"DomainSelectOwner",data:e})}return await t.fetchDomains(),await t.fetchDomainSchemes(),await c.fetchContracts(),await c.fetchProfiles(),{getDomainsList:u,getDomainsSchemes:l,getUsers:k,select:w,search:b,openTransferModal:x,filterProducts:D,getUserName:O,designateOwner:T,deleteItem:M,orderManage:s,filterDomainScheme:C,navigateToDomainSchemes:S,startFunction:ee,transferItem:N}}},ct=F(je,[["render",Ee],["__scopeId","data-v-dfa7d436"]]);export{ct as default};
