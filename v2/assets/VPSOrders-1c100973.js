import{j as U,o as S,c as L,a as c,b as d,w as g,d as k,t as h,F as E,x as W,n as J,k as it,p as X,l as Y,_ as Z,e as $,S as tt,r as H,y as A,g as N,h as lt}from"./index-5e313302.js";import{I as ct}from"./IconSearch-5f35739d.js";import{u as et}from"./vps-80bde7d9.js";import{_ as dt}from"./HelperComponent-21d9fd2e.js";import{S as at}from"./StatusBadge-98696de1.js";import{I as nt}from"./IconRotate-3e508a67.js";import{f as Q}from"./useTimeFunction-8602dd60.js";import{v as mt}from"./vpsStatuses-32ffaaf5.js";import{z as _t,k as ut,d as ft}from"./bootstrap-vue-next.es-a19a8b41.js";import{_ as Dt}from"./IconDots-f060bcd6.js";import{_ as gt}from"./IconCard-67ad5f17.js";import{_ as vt}from"./OrderIDBadge-9697206f.js";import{S as It}from"./Select2-59fcaca7.js";import{s as St}from"./multiselect-bfc29db8.js";import{_ as ot}from"./ClausesKeeper-eb954229.js";import{u as ht}from"./contracts-3351d68f.js";import{B as st}from"./BlockBalanceAgreement-bb87adc1.js";import{u as bt}from"./globalActions-a7429ad5.js";import{E as pt}from"./EmptyStateBlock-9f752916.js";import{_ as Pt}from"./FormInputSearch-4c769092.js";import"./ButtonDefault-7c216fc6.js";import"./IconArrow-555f9d45.js";import"./IconClose-1f889a2e.js";import"./IconPlus-856cd9b9.js";const Vt=a=>(X("data-v-1f65dec2"),a=a(),Y(),a),Ct={class:"hosting-item"},yt={class:"hosting-item__row"},Ot={class:"hosting-item__row"},kt={class:"hosting-item__person"},wt={class:"hosting-item__row"},Mt={class:"hosting-item__list"},xt=["innerHTML"],Bt={class:"hosting-status__info"},Lt={class:"hosting-status__date"},Rt={class:"hosting-item__controls"},Nt={class:"ico"},Ut=Vt(()=>c("div",{class:"hosting-item__title"},"Перезагрузить выделенный сервер",-1)),At={class:"btn btn--dots"};function Et(a,o,i,e,v,w){var r,C,s,t,u,I,y,B,O,R;const b=vt,_=U("router-link"),M=U("Helper"),x=at,p=nt,P=gt,V=Dt,f=_t,n=ut,l=ft;return S(),L("div",Ct,[c("div",yt,[d(b,{orderID:(r=i.itemData)==null?void 0:r.OrderID,onClick:o[0]||(o[0]=m=>{var D;return e.toItem((D=i.itemData)==null?void 0:D.OrderID)})},null,8,["orderID"]),d(_,{class:"hosting-item__name",to:`/VPSOrders/${i.itemData.OrderID}`},{default:g(()=>[k(h(i.itemData.IP||i.itemData.Domain),1)]),_:1},8,["to"])]),c("div",Ot,[c("div",kt,h(i.userName),1),d(M,{"user-notice":(C=i.itemData)==null?void 0:C.UserNotice,id:(s=i.itemData)==null?void 0:s.OrderID,position:i.isLast?"bottom":"top",emit:"updateVPSList"},null,8,["user-notice","id","position"])]),c("div",wt,[c("ul",Mt,[(S(!0),L(E,null,W(i.params,m=>(S(),L("li",{innerHTML:m==null?void 0:m.text},null,8,xt))),256)),c("div",{class:"btn btn--md btn--bold btn-manage",onClick:o[1]||(o[1]=m=>e.orderManage())},"Управлять заказом")]),c("div",Bt,[c("div",{class:J(["hosting-item__date",{danger:Number((t=i.itemData)==null?void 0:t.DaysRemainded)<14}])},h(e.calculateExpirationDate((u=i.itemData)==null?void 0:u.DaysRemainded))+" • "+h(((I=i.itemData)==null?void 0:I.DaysRemainded)||0)+" дн.",3),d(x,{class:"status-badge",status:(y=i.itemData)==null?void 0:y.StatusID,"status-table":"VPSOrders",onClick:o[2]||(o[2]=m=>{var D;return e.openHistoryStatuses((D=i.itemData)==null?void 0:D.ID)})},null,8,["status"]),c("div",Lt,h(e.calculateDaysSinceStatusUpdate((B=i.itemData)==null?void 0:B.StatusDate)),1)])]),c("div",Rt,[((O=i.itemData)==null?void 0:O.StatusID)==="Active"?(S(),L("div",{key:0,class:J(["btn btn--md btn--border btn--rotate btn--rotate_green button-large btn-reload",{"btn--rotate_gray":((R=i.itemData)==null?void 0:R.StatusID)!=="Active"||e.isReloading,"btn--rotate_loading":e.isReloading}]),onClick:o[3]||(o[3]=(...m)=>e.reloadItem&&e.reloadItem(...m))},[k("Включен"),c("button",null,[c("div",Nt,[d(p)])]),Ut],2)):it("",!0),c("div",{class:"btn btn--md btn--bold",onClick:o[4]||(o[4]=m=>{var D;return a.$router.push(`/VPSOrderPay/${(D=i.itemData)==null?void 0:D.OrderID}`)})},[d(P),k("Оплатить")]),d(l,{class:"dropdown-dots",right:""},{"button-content":g(()=>[c("div",At,[d(V)])]),default:g(()=>[d(f,{onClick:o[5]||(o[5]=m=>e.transferAccount())},{default:g(()=>[k("Передать на другой аккаунт")]),_:1}),d(f,{onClick:o[6]||(o[6]=m=>e.openPasswordChange())},{default:g(()=>[k("Сменить пароль")]),_:1}),d(f,null,{default:g(()=>{var m;return[d(_,{to:`/VPSOrders/${(m=i.itemData)==null?void 0:m.OrderID}/SchemeChange`},{default:g(()=>[k("Изменить тариф")]),_:1},8,["to"])]}),_:1}),d(n),d(f,{class:"color-red",onClick:o[7]||(o[7]=m=>e.deleteItem())},{default:g(()=>[k("Удалить")]),_:1})]),_:1})])])}const Ht={components:{StatusBadge:at,IconRotate:nt,Helper:dt},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1},userName:{type:String,default:""}},emits:["manage","transfer","delete"],setup(a,{emit:o}){et();const i=$(),e=tt("emitter"),v=H(!1);function w(n){if(!n)return Q(new Date);const l=new Date,r=new Date(l.getTime()+n*24*60*60*1e3);return Q(r)}function b(){var n,l;console.log((n=a.itemData)==null?void 0:n.ID),o("delete",(l=a.itemData)==null?void 0:l.ID)}function _(n){i.push(`/VPSOrders/${n}`)}function M(){var n,l;e.emit("open-modal",{component:"OrdersTransfer",data:{ServiceOrderID:(n=a.itemData)==null?void 0:n.ID,ServiceID:(l=a.itemData)==null?void 0:l.ServiceID}})}function x(n){e.emit("open-modal",{component:"StatusHistory",data:{modeID:"VPSOrders",rowID:n}})}function p(){var n,l;e.emit("open-modal",{component:"OrderPasswordChange",data:{OrderID:(n=a.itemData)==null?void 0:n.ID,ServiceID:(l=a.itemData)==null?void 0:l.ServiceID,emitEvent:"updateVPSIDPage"}})}function P(){var l;function n(r){v.value=r}e.emit("open-modal",{component:"ReloadVPS",data:{VPSOrderID:(l=a.itemData)==null?void 0:l.ID,isReloading:v.value,onReloadStatusChange:n}})}function V(){var n,l,r;o("manage",{ServiceOrderID:(n=a.itemData)==null?void 0:n.ID,ServiceID:(l=a.itemData)==null?void 0:l.ServiceID,OrderID:(r=a.itemData)==null?void 0:r.OrderID})}function f(n){if(!n)return"";const l=new Date(parseInt(n)*1e3),C=new Date-l,s=Math.floor(C/1e3),t=Math.floor(s/60),u=Math.floor(t/60),I=Math.floor(u/24);return s<60?`${s} сек. от статуса`:t<60?`${t} мин. от статуса`:u<24?`${u} ч. от статуса`:`${I} дн. от статуса`}return{vpsStatuses:mt,reloadItem:P,isReloading:v,orderManage:V,calculateExpirationDate:w,isReloading:v,transferAccount:M,openHistoryStatuses:x,toItem:_,deleteItem:b,calculateDaysSinceStatusUpdate:f,openPasswordChange:p}}},rt=Z(Ht,[["render",Et],["__scopeId","data-v-1f65dec2"]]),Tt=a=>(X("data-v-82a5e60b"),a=a(),Y(),a),jt={class:"section"},zt={class:"container"},Ft={class:"section-header"},Kt=Tt(()=>c("h1",{class:"section-title"},"VPS/VDS серверы",-1)),qt={class:"list-form"},Gt={class:"list-form_col list-form_col--sm"},Jt={class:"list-form_select"},Qt={class:"multiselect-option"},Wt={key:0};function Xt(a,o,i,e,v,w){var f,n,l;const b=st,_=U("router-link"),M=ot,x=U("Multiselect"),p=Pt,P=rt,V=pt;return S(),L(E,null,[d(b),c("div",jt,[c("div",zt,[c("div",Ft,[Kt,d(_,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:g(()=>[k("Заказать")]),_:1})]),d(M),c("div",qt,[c("div",Gt,[c("div",Jt,[d(x,{modelValue:e.select,"onUpdate:modelValue":o[0]||(o[0]=r=>e.select=r),options:e.getUsers,disabled:((f=e.getUsers)==null?void 0:f.length)<=1,label:"name"},{singlelabel:g(({value:r})=>[c("span",null,"# "+h(r.value.padStart(5,"0"))+" / "+h(r.name),1)]),option:g(({option:r})=>[c("div",Qt,"# "+h(r.value.padStart(5,"0"))+" / "+h(r.name),1)]),_:1},8,["modelValue","options","disabled"])])]),d(p,{modelValue:e.search,"onUpdate:modelValue":o[1]||(o[1]=r=>e.search=r)},null,8,["modelValue"])]),e.getVpsOrders&&((n=e.getVpsOrders)==null?void 0:n.length)>0?(S(),L("div",Wt,[e.filterProducts&&((l=e.filterProducts)==null?void 0:l.length)>0?(S(!0),L(E,{key:0},W(e.filterProducts,(r,C)=>{var s;return S(),A(P,{"item-data":r,"is-last":C===e.filterProducts.length-1,"user-name":(s=e.getContracts[r==null?void 0:r.ContractID])==null?void 0:s.Customer,params:e.formItemParamList(r),onDelete:e.deleteItem,onManage:e.orderManage},null,8,["item-data","is-last","user-name","params","onDelete","onManage"])}),256)):(S(),A(V,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(S(),A(V,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])],64)}const Yt={components:{IconSearch:ct,Select2:It,ClausesKeeper:ot,Multiselect:St,VpsItem:rt,BlockBalanceAgreement:st},async setup(){const a=et(),o=ht(),i=bt(),e=$(),v=H(null),w=H("*"),b=tt("emitter");b.on("updateVPSList",()=>{a.fetchVPS()});const _=N(()=>{var s;return(s=Object.keys(a==null?void 0:a.vpsList).map(t=>a==null?void 0:a.vpsList[t]))==null?void 0:s.reverse()}),M=N(()=>a.vpsSchemes),x=N(()=>l(V(_.value))),p=N(()=>o==null?void 0:o.contractsList);lt(()=>{_.value.length<1&&P()});function P(){e.push({path:"/VPSSchemes"})}function V(s){return w.value!=="*"?s.filter(t=>(t==null?void 0:t.ContractID)===w.value):s}function f(s){i.OrderManage(s)}function n(s){b.emit("open-modal",{component:"DeleteItem",data:{id:s,message:`Вы действительно хотите удалить виртуальный сервер #${s}?`,tableID:"VPSOrders",successEmit:"updateVPSList"}})}function l(s){return v.value!==null?s.filter(t=>t==null?void 0:t.IP.toLowerCase().includes(v.value.toLowerCase())):s}const r=N(()=>{let s=[{value:"*",name:"Все договора"}];return _.value!==null?(Object.keys(_.value).forEach(t=>{var u,I,y;s.find(B=>{var O;return B.value===((O=_.value[t])==null?void 0:O.ContractID)})||s.push({value:(u=_.value[t])==null?void 0:u.ContractID,name:(y=p.value[(I=_.value[t])==null?void 0:I.ContractID])==null?void 0:y.Customer})}),s):{value:"*",name:"Все договора"}});function C(s){var u,I,y,B,O,R,m,D,T,j,z,F,K,q,G;const t=(u=M.value)==null?void 0:u[s.SchemeID];return[{text:`${t==null?void 0:t.Name}`},{text:`${(y=(I=t==null?void 0:t.SchemeParams)==null?void 0:I.hdd_mib)==null?void 0:y.InternalName} ${(O=(B=t==null?void 0:t.SchemeParams)==null?void 0:B.hdd_mib)==null?void 0:O.Value} ${(m=(R=t==null?void 0:t.SchemeParams)==null?void 0:R.hdd_mib)==null?void 0:m.Unit}`},{text:`RAM ${(T=(D=t==null?void 0:t.SchemeParams)==null?void 0:D.ram_mib)==null?void 0:T.Value} ${(z=(j=t==null?void 0:t.SchemeParams)==null?void 0:j.ram_mib)==null?void 0:z.Unit}`},{text:`Канал ${(K=(F=t==null?void 0:t.SchemeParams)==null?void 0:F.net_bandwidth_mbitps)==null?void 0:K.Value} ${(G=(q=t==null?void 0:t.SchemeParams)==null?void 0:q.net_bandwidth_mbitps)==null?void 0:G.Unit}`}]}return await a.fetchVPS(),await a.fetchVPSSchemes(),await o.fetchContracts(),{getVpsOrders:_,search:v,getContracts:p,select:w,orderManage:f,formItemParamList:C,getUsers:r,filterProducts:x,navigateToVPSSchemes:P,deleteItem:n}}},pe=Z(Yt,[["render",Xt],["__scopeId","data-v-82a5e60b"]]);export{pe as default};
