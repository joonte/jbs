import{_ as le}from"./ButtonDefault-BIBStZbJ.js";import{_ as ne}from"./TotalAmount.vue_vue_type_script_setup_true_lang-CXrtmBc-.js";import{_ as ue}from"./BlockOrderServiceWrapper-C9FvvAWz.js";import{_ as ce}from"./BlockAdditionalServices-BALrMbkE.js";import{_ as ie}from"./BlockOrderPayBalance-3MeD3TJ2.js";import{_ as de}from"./BlockSelectContract-uyQ-oMQe.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as g,H as q,c as u,o as r,a as s,L as W,h as V,t as y,e as me,F as I,i as k,M as ve,N as _e,f,n as pe,G as fe,s as Se,D as L,b as h,w as F,C as N,d as ge}from"./index-CmCGXBst.js";import{_ as be}from"./ClausesKeeper-CTja-fCz.js";import{_ as he}from"./BlockBalanceAgreement-qtspRQ_B.js";import{u as Ie}from"./server-CRQmsQ4v.js";import{u as we}from"./contracts-P7YPBhEI.js";import{u as De}from"./services-C54cnl9l.js";import"./EmptyStateBlock-BaR9js3E.js";import"./bootstrap-vue-next-DwS3lKQb.js";import"./ServiceListOrderSelection-DUe6fwsE.js";import"./BasicInput-KlObNzdO.js";import"./component-0WedTVCo.js";import"./multiselect-DhoC9bwZ.js";import"./global-5eUCDNCu.js";import"./IconCross-BH1MaI1J.js";import"./IconClose-B_k4TzXM.js";const Ve={class:"form-input_border"},ye={class:"form-input_border-label"},ke=["checked"],Ce={class:"form-field__data"},Pe={key:0,class:"form-field__img"},Be=["src"],Oe={class:"form-field__name"},$e={class:"form-field__desc"},xe={class:"form-field__select"},Ue={__name:"InputBoxBorder",props:{modelValue:[String,Number,Object],data:{type:Object,default:()=>{}},name:{type:String,default:""},checked:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(c,{emit:_}){const d=c,S=_,w=g(null);function C(){S("update:modelValue",d.data)}return q(()=>{w.value=d.modelValue}),(a,D)=>(r(),u("div",Ve,[s("label",ye,[s("input",{type:"radio",checked:c.checked,onInput:C},null,40,ke),s("div",Ce,[W(a.$slots,"default",{},()=>[c.data.img?(r(),u("div",Pe,[s("img",{src:c.data.img,alt:""},null,8,Be)])):V("",!0)],!0),s("div",Oe,y(c.data.name),1),s("div",$e,[me(y(c.data.desc)+" ",1),c.data.select?W(a.$slots,"default",{key:0},()=>[s("div",xe,[(r(!0),u(I,null,k(c.data.select,(l,m)=>(r(),u("div",{key:m,class:"form-field__select-item"},y(l.text),1))),128))])],!0):V("",!0)])])])]))}},Ne=j(Ue,[["__scopeId","data-v-6a542839"]]),Ae={class:"tw-hidden md:tw-grid tw-grid-cols-6 tw-gap-4"},Me={class:"tw-space-y-2 tw-mt-2"},Ge=["onClick"],Ee={class:"tw-grid tw-grid-cols-2 md:tw-grid-cols-6 tw-gap-4"},Le={class:"tw-block md:tw-hidden tw-uppercase tw-text-2xs tw-font-bold tw-text-gray-500"},Fe={__name:"VpsConfigurations",props:ve({configurations:{type:Array,default:()=>[]}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(c){const _=c,d=_e(c,"modelValue"),S=f(()=>{const a=_.configurations?.[0]?.SchemeParams;return{PackageID:"Тариф",cpu_number:a?.cpu_number?.Name||"CPU",ram_mib:a?.ram_mib?.Name||"RAM",hdd_mib:a?.hdd_mib?.Name||"Память",net_in_mbitps:a?.net_in_mbitps?.Name||"Канал",CostMonth:"Стоимость"}});function w(a){return{ID:a?.ID,PackageID:a?.PackageID,ServersGroupID:a?.ServersGroupID,cpu_number:a?.SchemeParams?.cpu_number?.Value,ram_mib:a?.SchemeParams?.ram_mib?.Value,hdd_mib:a?.SchemeParams?.hdd_mib?.Value,net_in_mbitps:a?.SchemeParams?.net_in_mbitps?.Value,CostMonth:a?.CostMonth}}function C(a){d.value=a}return(a,D)=>(r(),u("div",null,[s("div",Ae,[(r(!0),u(I,null,k(S.value,(l,m)=>(r(),u("div",{key:m,class:"tw-text-sm tw-font-bold tw-text-gray-400"},y(l),1))),128))]),s("div",Me,[(r(!0),u(I,null,k(c.configurations,l=>(r(),u("div",{key:l.ID,onClick:m=>C(l),class:pe(["tw-cursor-pointer tw-border tw-rounded tw-p-4 md:tw-p-0",d.value.ID===l.ID?"tw-bg-gray-50 tw-border-sky-400":"tw-border-gray-200"])},[s("div",Ee,[(r(!0),u(I,null,k(S.value,(m,p)=>(r(),u("div",{key:p,class:"tw-space-y-1 md:tw-p-4 last:tw-font-bold"},[s("div",Le,y(m),1),s("div",null,y(w(l)[p]),1)]))),128))])],10,Ge))),128))])]))}},Te=j(Fe,[["__scopeId","data-v-8cdf77c3"]]),je="/v2/images/oc-2.jpg",Ke={class:"tw-px-4 md:tw-px-8"},Re={class:"tw-mt-6"},ze={key:0,class:"tw-mt-6"},He={class:"form grid-gorm"},We=["src","alt"],qe={class:"tw-mt-6"},Je={class:"form"},Qe={class:"tw-my-6"},T="Moscow",Xe={__name:"VPSSchemes",async setup(c){let _,d;const S=fe(),w=we(),C=Ie(),a=De(),D=ge(),l=g(null),m=g([]),p=g(null),P=g(null),$=g(!1),i=g(null),K=g(""),J=g([{img:je,value:"Moscow",name:"Россия",desc:"Москва"}]);f(()=>{const t=A.value?.[0]?.SchemeParams;return{PackageID:"Тариф",cpu_number:t?.cpu_number?.Name||"CPU",ram_mib:t?.ram_mib?.Name||"RAM",hdd_mib:t?.hdd_mib?.Name||"Память",net_in_mbitps:t?.net_in_mbitps?.Name||"Канал",CostMonth:"Стоимость"}});const A=f(()=>Object.values(S.vpsSchemes).filter(t=>t.IsActive).sort((t,e)=>{const n=Number(t.SortID),v=Number(e.SortID);return n-v})),B=f(()=>C?.serverGroupsList?.ServersGroups),Q=f(()=>a?.ServicesList),X=f(()=>{let t=0;return m.value.forEach(e=>{t+=+e?.Price}),t}),x=f(()=>{const t=i.value?.OS||[],e=i.value?.OSs||[];return t.map(n=>{const v=e.find(b=>b.Name===n);return{name:n,value:n,imageUrl:v?v.Image:""}})}),R=t=>{t.key==="Enter"&&t.ctrlKey&&!Y.value&&z()},Y=f(()=>l.value===null||p.value===null),Z=f(()=>{if(l.value?.daysFromBalance)return"Оплатить c баланса договора";const t=l.value?.CostPay+X.value;return(M.value?.Balance||0)>=t?"Оплатить c баланса договора":"Добавить в корзину"}),M=f(()=>w.contractsList[p.value]);q(()=>{document.addEventListener("keyup",R)}),Se(()=>{document.removeEventListener("keyup",R)});function ee(){let t=Object.keys(B.value?.[i.value?.ServersGroupID])?.find(n=>B.value?.[i.value?.ServersGroupID]?.[n]?.IsActive&&B.value?.[i.value?.ServersGroupID]?.[n]?.IsDefault),e=Object.keys(B.value?.[i.value?.ServersGroupID])?.find(n=>B.value?.[i.value?.ServersGroupID]?.[n]?.IsActive);return t||e}async function te(t){for(const e of m.value){let n=Q.value[e.ServiceID]?.Code;const{result:v,info:b,error:G}=await a.ServiceOrder({Code:n,DependOrderID:t,...e,ContractID:p.value});if(v==="SUCCESS"){let O={};n==="Default"?O.ServiceOrderID=b?.ServiceOrderID:O[`${n}OrderID`]=b?.ServiceOrderID;const{result:U,error:H}=await a.ServiceOrderPay(n,O);U==="SUCCESS"?D.push("/AdditionalServices"):U==="BASKET"&&D.push("/Basket")}else break}}async function z(){$.value=!0;const{result:t,info:e,error:n}=await S.VPSOrder({ContractID:p.value,VPSSchemeID:i.value?.ID,ServerID:ee(),DiskTemplate:P.value?.value});if(t==="SUCCESS"){te(e?.OrderID);const{result:v,error:b}=await S.VPSOrderPay({VPSOrderID:e?.VPSOrderID,DaysPayFromBallance:l.value?.daysFromBalance||0,DaysPay:l.value?.actualDays,IsChange:!0});v==="SUCCESS"?D.push("/VPSOrders"):v==="BASKET"&&D.push("/Basket"),$.value=!1}else $.value=!1}function ae(){x?.value?.length>0&&(P.value=x.value?.[0])}return[_,d]=L(()=>S.fetchVPSSchemes()),await _,d(),[_,d]=L(()=>w.fetchContracts()),await _,d(),[_,d]=L(()=>a.fetchServices()),await _,d(),i.value=A.value?.[0],ae(),(t,e)=>{const n=he,v=be,b=Te,G=Ne,O=de,U=ie,H=ce,se=ue,oe=ne,re=le;return r(),u(I,null,[h(n),s("div",Ke,[e[11]||(e[11]=s("h1",{class:"tw-text-xl sm:tw-text-4xl tw-mb-4"},"Заказать VPS/VDS сервер",-1)),h(v),h(se,{basic_title:"VPS/VDS сервер",modelValue:K.value,"onUpdate:modelValue":e[6]||(e[6]=o=>K.value=o)},{page:F(()=>[s("div",Re,[e[8]||(e[8]=s("h2",{class:"section-block_title"},"Конфигурация",-1)),h(b,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=o=>i.value=o),configurations:A.value},null,8,["modelValue","configurations"])]),x.value?(r(),u("div",ze,[e[9]||(e[9]=s("h2",{class:"section-block_title"},"Операционная система",-1)),s("div",He,[(r(!0),u(I,null,k(x.value,o=>(r(),N(G,{key:o.value,data:o,modelValue:P.value,"onUpdate:modelValue":e[1]||(e[1]=E=>P.value=E),checked:o?.value===P.value?.value},{default:F(()=>[o.imageUrl?(r(),u("img",{key:0,src:o.imageUrl,alt:o.name},null,8,We)):V("",!0)]),_:2},1032,["data","modelValue","checked"]))),128))])])):V("",!0),s("div",qe,[e[10]||(e[10]=s("h2",{class:"section-block_title"},"Регион",-1)),s("div",Je,[(r(!0),u(I,null,k(J.value,o=>(r(),N(G,{key:o.value,data:o,checked:o?.value===T,modelValue:T,"onUpdate:modelValue":e[2]||(e[2]=E=>T=E)},null,8,["data","checked"]))),128))])]),h(O,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=o=>p.value=o),title:"Информация о сервере",class:"tw-mt-6"},null,8,["modelValue"]),M.value?(r(),N(U,{key:1,modelValue:l.value,"onUpdate:modelValue":e[4]||(e[4]=o=>l.value=o),contract:M.value,scheme:i.value,serviceID:3e4},null,8,["modelValue","contract","scheme"])):V("",!0)]),services:F(()=>[h(H,{modelValue:m.value,"onUpdate:modelValue":e[5]||(e[5]=o=>m.value=o),serviceSearchParams:{ServiceID:"30000",ServersGroupID:i.value?.ServersGroupID}},null,8,["modelValue","serviceSearchParams"])]),_:1},8,["modelValue"]),s("div",Qe,[l.value?(r(),N(oe,{key:0,tariff:l.value,"additional-services":m.value},null,8,["tariff","additional-services"])):V("",!0),h(re,{class:"btn--wide",label:Z.value,disabled:l.value===null||p.value===null,"is-loading":$.value,onClick:e[7]||(e[7]=o=>z())},null,8,["label","disabled","is-loading"])])])],64)}}},ht=j(Xe,[["__scopeId","data-v-1c5b9af9"]]);export{ht as default};
