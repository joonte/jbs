import{_ as C}from"./ButtonDefault-B1FApUky.js";import{u as y}from"./services-moLhYNFg.js";import{s as k}from"./multiselect-B6DlyfA6.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as D,x,f as l,H as _,s as j,c as M,o as V,a as o,b as h,e as E,t as r,w as f,v as B}from"./index-C9dBN6m4.js";const L={class:"modal__body"},H={class:"list-item__subtitle"},U={class:"modal__input-row tw-items-center"},G={class:"list-form_col list-form_col--xl"},W={class:"search-field form-field"},A={class:"multiselect-multiple-label"},K={class:"multiselect-option"},P={__name:"ModalWindowDNSOrderSchemeChange",props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(g,{emit:N}){const i=g,I=N,s=y(),d=D(!1),n=D(null);x("emitter");const b=l(()=>s?.DNSmanagerOrdersList),c=l(()=>{const t=b.value;if(!(!t||typeof t!="object"))return Object.keys(t).map(a=>t[a]).find(a=>a.OrderID===i.data?.DNSID)}),m=l(()=>Object.keys(s?.additionalServicesScheme.DNSmanager).map(t=>({...s?.additionalServicesScheme.DNSmanager[t],value:s?.additionalServicesScheme.DNSmanager[t]?.ID,name:s?.additionalServicesScheme.DNSmanager[t]?.Name,cost:s?.additionalServicesScheme.DNSmanager[t]?.CostMonth})).filter(t=>t?.ID==c.value?.SchemeID)),S=l(()=>{const t=m.value[0],a=Object.keys(s?.additionalServicesScheme.DNSmanager).map(e=>({...s?.additionalServicesScheme.DNSmanager[e],value:s?.additionalServicesScheme.DNSmanager[e]?.ID}))?.filter(e=>e?.value?.HardServerID==t?.HardServerID&&e?.IsSchemeChangeable&&e?.ID!==c.value?.SchemeID&&e?.ServersGroupID===i.data?.ServerGroup);return[t,...a].sort((e,O)=>e.SortID-O.SortID).map(e=>({...e,disabled:e.ID==t.ID}))});function v(){d.value=!0,s.DNSmanagerOrderSchemeChange({NewSchemeID:n.value,DNSmanagerOrderID:c.value?.ID}).then(t=>{let{result:a,error:u}=t;a==="SUCCESS"&&I("modalClose"),d.value=!1})}_(()=>{s.fetchAdditionalServiceScheme(i.data?.Code),s.fetchDNSmanagerOrders(),n.value=S.value?.[1]?.value});const p=t=>{t.key==="Enter"&&v()};return _(()=>{document.addEventListener("keyup",p)}),j(()=>{document.removeEventListener("keyup",p)}),(t,a)=>{const u=C;return V(),M("div",L,[a[4]||(a[4]=o("div",{class:"list-item__title"},"Смена тарифного плана",-1)),o("div",H,[a[2]||(a[2]=E(" Текущий тарифный план ",-1)),o("span",null,r(m.value[0]?.name)+"/"+r(m.value[0]?.cost),1)]),o("div",U,[a[3]||(a[3]=o("div",{class:"modal__input-label"},"Новый тарифный план",-1)),o("div",G,[o("div",W,[h(B(k),{class:"multiselect--white",options:S.value,type:"text",modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),placeholder:"Поиск"},{singlelabel:f(({value:e})=>[o("div",A,[o("span",null,r(e?.Name)+"/"+r(e?.CostMonth),1)])]),option:f(({option:e})=>[o("div",K,r(e?.Name)+"/"+r(e?.CostMonth),1)]),_:1},8,["options","modelValue"])])])]),h(u,{class:"modal__button",label:"Сменить","is-loading":d.value,onClick:a[1]||(a[1]=e=>v())},null,8,["is-loading"])])}}},J=w(P,[["__scopeId","data-v-f59e1847"]]);export{J as default};
