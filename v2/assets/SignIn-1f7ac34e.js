import{o as M,c as A,a as c,b as u,n as y,w as F,d as H,_ as N,u as T,e as q,r as i,f as D,g as E,h as j}from"./index-83b4b7ba.js";import{_ as O}from"./BasicInput-3f1e9fd6.js";import{_ as S}from"./ButtonDefault-dc248ec6.js";import{I as z,a as G,b as X,c as Y}from"./IconYandex-ec3e5175.js";import{u as J}from"./promoStore-04cdad02.js";import{_ as B}from"./BlockAuthEnter-d8ea2a6c.js";import{f as K}from"./bootstrap-vue-next.es-8f3ae81a.js";import"./component-abb1f5a9.js";const Q={class:"sign-in"},W={class:"section"},Z={class:"container"},$=c("div",{class:"section-header"},[c("h1",{class:"section-title"},"Войти в аккаунт")],-1),ee={class:"form-offset_label"},oe={class:"form-offset_label"};function te(m,o,s,e,d,v){const l=O,a=S,f=K,r=B;return M(),A("div",Q,[c("div",W,[c("div",Z,[$,u(l,{class:y({"form-field-error":e.submitStatus==="ERROR"}),label:"Email",name:"login",modelValue:e.mail,"onUpdate:modelValue":o[0]||(o[0]=t=>e.mail=t)},null,8,["class","modelValue"]),u(l,{class:y({"form-field-error":e.submitStatus==="ERROR"}),label:"Пароль",name:"password",modelValue:e.password,"onUpdate:modelValue":o[1]||(o[1]=t=>e.password=t),"is-password":""},null,8,["class","modelValue"]),c("div",ee,[u(a,{class:"button-password-restore",label:"ЗАБЫЛ ПАРОЛЬ",onClick:o[2]||(o[2]=t=>e.navigateToPage("/UserPasswordRestore"))})]),c("div",oe,[u(a,{onClick:o[3]||(o[3]=t=>e.signIn()),"is-loading":e.isLoading,label:"Войти"},null,8,["is-loading"]),u(f,{id:"checkbox-1",modelValue:e.isRemember,"onUpdate:modelValue":o[4]||(o[4]=t=>e.isRemember=t),name:"checkbox-1"},{default:F(()=>[H("Запомнить меня")]),_:1},8,["modelValue"])])])]),u(r,{label:"Войти с помощью"})])}const se={components:{BlockAuthEnter:B,BasicInput:O,IconGoogle:z,IconOk:G,IconVk:X,IconYandex:Y,ButtonDefault:S},setup(){const m=T(),o=J(),s=q(),e=i(null),d=i(null),v=i(!0),l=i(null),a=i(!1),f=i(""),r=D();E(()=>r==null?void 0:r.userInfo);const t=E(()=>m==null?void 0:m.ConfigList);function U(){var p;e.value===null||((p=e.value)==null?void 0:p.length)<3||d.value===null||d.value<4?l.value="ERROR":(a.value=!0,r.signIn({Email:e.value,Password:d.value,IsRemember:v.value===!0?"1":"0",ReOpen:"yes",XMLHttpRequest:"yes"}).then(n=>{var g,b,R,h,C,I;if(a.value=!1,(n==null?void 0:n.result)!=="success")l.value="ERROR",f.value=n.errorMessage;else if(m.fetchConfig().then(()=>{var _,V,k;if((_=t.value)!=null&&_.Colors){let w=document.documentElement;Object.keys((V=t.value)==null?void 0:V.Colors).map(P=>{var x;w.style.setProperty(`--${P}`,(x=t.value)==null?void 0:x.Colors[P])}),w.style.setProperty("--btn-hover-transparent",`${(k=t.value)==null?void 0:k.Colors["btn-hover"]}33`)}}),((b=(g=n==null?void 0:n.data)==null?void 0:g.User)==null?void 0:b.InterfaceID)==="User")if((R=s.currentRoute.value.redirectedFrom)!=null&&R.fullPath){const _=(C=(h=s.currentRoute.value.redirectedFrom)==null?void 0:h.query)==null?void 0:C.PromoCode;_&&o.setPromoCode(_),s.push({path:(I=s.currentRoute.value.redirectedFrom)==null?void 0:I.fullPath})}else s.push({path:"/Home"});else window.location.replace("/Administrator/Home")}))}function L(p){s.push(p)}return j(()=>{console.log(s)}),{isRemember:v,submitStatus:l,errorMessage:f,mail:e,password:d,isLoading:a,navigateToPage:L,signIn:U}}},de=N(se,[["render",te]]);export{de as default};
