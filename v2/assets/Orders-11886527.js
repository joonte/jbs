import{C as Z,F as ee}from"./bootstrap-vue-next.es-f4c478af.js";import{_ as te}from"./IconCard-6f1a0464.js";import{S as se}from"./StatusBadge-e3643114.js";import{_ as le}from"./FormInputSearch-2aef6046.js";import{_ as ae}from"./ClausesKeeper-a152fc61.js";import{_ as oe,e as ne,f as ue,u as ce,R as ie,r as m,g as v,ag as U,o as q,c as z,b as u,a as l,w as o,t as c,L as _,Y as re,ae as pe,k as ve,F as de,p as me,l as _e}from"./index-eaeb1281.js";import{u as fe}from"./contracts-ac470ffa.js";import{u as be}from"./services-736a125a.js";import{f as Se,a as De}from"./useTimeFunction-8602dd60.js";import{_ as ge}from"./HelperComponent-5cf2547f.js";import{s as k}from"./multiselect-92d0918e.js";import{B as he}from"./BlockBalanceAgreement-11afb494.js";import"./IconPlus-b5e68f37.js";import"./IconSearch-77d111a7.js";import"./IconClose-e8029cfe.js";import"./ButtonDefault-598fef28.js";import"./IconArrow-ce1bc7b6.js";const Ie=[{key:"ID",label:"Заказ",variant:"td-blue",sortable:!0},{key:"ServiceID",label:"Услуга",variant:"td-gray td-order bold"},{key:"ContractID",label:"Договор",sortable:!0,variant:"td-blue"},{key:"StatusID",label:"Статус",variant:"td-gray td-order"},{key:"ExpirationDate",label:"Дата окончания",variant:"td-gray td-order"},{key:"UserNotice",label:"Примечание",variant:"td-gray td-limited"},{key:"controls",label:"",variant:"td-controls"}];const i=h=>(me("data-v-e0e2c9e3"),h=h(),_e(),h),Ce={class:"section"},ye={class:"container"},Ve=i(()=>l("div",{class:"section-header"},[l("h1",{class:"section-title"},"Мои заказы")],-1)),Oe={class:"list-form"},ke={class:"list-form_col list-form_col--sm"},xe={class:"list-form_select"},Le={class:"multiselect-option"},we={class:"list-form_col list-form_col--sm"},Te={class:"list-form_select"},Ue={class:"multiselect-option"},Ne={class:"list-form_col list-form_col--sm"},Re={class:"list-form_select"},Ae={class:"multiselect-option"},Ee=i(()=>l("span",{class:"td-mobile"},"Заказ",-1)),Be=i(()=>l("span",{class:"td-mobile"},"Услуга",-1)),Fe=i(()=>l("span",{class:"td-mobile"},"Договор",-1)),$e=i(()=>l("span",{class:"td-mobile"},"Комментарий",-1)),Pe=i(()=>l("span",{class:"td-mobile"},"Статус",-1)),je=i(()=>l("span",{class:"td-mobile"},"Дата окончания",-1)),Ye={class:"btn__group"},qe=["onClick"],ze=i(()=>l("p",null,"ОПЛАТИТЬ",-1)),Ge={key:0,class:"table-controls"},He=i(()=>l("span",{class:"text-success"},"First",-1)),Je=i(()=>l("span",{class:"text-info"},"Last",-1)),Ke={class:"multiselect-multiple-label"},Me={class:"multiselect-option"},Qe={__name:"Orders",async setup(h){let f,b;const I=ne(),r=ue(),C=fe(),N=be(),x=ce();ie("emitter").on("updateOrdersList",()=>{r.fetchUserOrders()});const L=m(""),S=m(10),g=m(1),G=m([10,25,50,100]),y=m("*"),V=m("*"),O=m("*"),d=v(()=>Object.keys(r==null?void 0:r.userOrders).map(s=>r==null?void 0:r.userOrders[s])),w=v(()=>{let s=d.value.filter(e=>e==null?void 0:e.ID.includes(L.value));return V.value!=="*"&&s!==null&&(s=s.filter(e=>e.ServiceID.includes(V.value))),y.value!=="*"&&s!==null&&(s=s.filter(e=>e.ContractID.includes(y.value))),O.value!=="*"&&s!==null&&(s=s.filter(e=>e.StatusID.includes(O.value))),g.value=1,s}),R=v(()=>C==null?void 0:C.contractsList),D=v(()=>N.ServicesList),A=v(()=>{let s=[{value:"*",name:"Все договора"}];return d.value!==null?(d.value.map(e=>{var a;s.find(p=>p.value===(e==null?void 0:e.ContractID))||s.push({value:e==null?void 0:e.ContractID,name:(a=R.value[e==null?void 0:e.ContractID])==null?void 0:a.Customer})}),s):{value:"*",name:"Все договора"}}),E=v(()=>{let s=[{value:"*",name:"Все услуги"}];return d.value!==null?(d.value.map(e=>{var a;s.find(p=>p.value===(e==null?void 0:e.ServiceID))||s.push({value:e==null?void 0:e.ServiceID,name:(a=D.value[e==null?void 0:e.ServiceID])==null?void 0:a.NameShort})}),s):{value:"*",name:"Все услуги"}}),H=v(()=>{var s,e;return(e=(s=x==null?void 0:x.ConfigList)==null?void 0:s.Statuses)==null?void 0:e.Orders}),B=v(()=>{let s=[{value:"*",name:"Все статусы"}];return d.value!==null?(d.value.map(e=>{var a,p;s.find(T=>T.value===(e==null?void 0:e.StatusID))||s.push({value:e==null?void 0:e.StatusID,name:((p=(a=H.value)==null?void 0:a[e==null?void 0:e.StatusID])==null?void 0:p.Name)||(e==null?void 0:e.StatusID)})}),s):{value:"*",name:"Все статусы"}});function J(s){var e,a;return((e=D.value[s])==null?void 0:e.Code)!=="Default"?((a=D.value[s])==null?void 0:a.Code)+"Orders":"Orders"}function K(s){var a;let e=(a=D.value[s.ServiceID])==null?void 0:a.Code;e==="Default"?I.push(`/AdditionalServices/${s.ID}`):I.push(`/${e}Orders/${s.ID}`)}function M(s){var a;let e=(a=D.value[s.ServiceID])==null?void 0:a.Code;e==="Default"?I.push(`/ServiceOrderPay/${s.ID}`):I.push(`/${e}OrderPay/${s.ID}`)}return[f,b]=U(()=>r.fetchUserOrders()),await f,b(),[f,b]=U(()=>C.fetchContracts()),await f,b(),[f,b]=U(()=>N.fetchServices()),await f,b(),(s,e)=>{var F,$,P,j,Y;const a=ae,p=le,T=se,Q=te,W=Z,X=ee;return q(),z(de,null,[u(he),l("div",Ce,[l("div",ye,[Ve,u(a),l("div",Oe,[u(p,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=t=>L.value=t)},null,8,["modelValue"]),l("div",ke,[l("div",xe,[u(_(k),{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),options:A.value,disabled:((F=A.value)==null?void 0:F.length)<=1,label:"name"},{option:o(({option:t})=>[l("div",Le,c(t.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l("div",we,[l("div",Te,[u(_(k),{modelValue:O.value,"onUpdate:modelValue":e[2]||(e[2]=t=>O.value=t),options:B.value,disabled:(($=B.value)==null?void 0:$.length)<=1,label:"name"},{option:o(({option:t})=>[l("div",Ue,c(t.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l("div",Ne,[l("div",Re,[u(_(k),{modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=t=>V.value=t),options:E.value,disabled:((P=E.value)==null?void 0:P.length)<=1,label:"name"},{option:o(({option:t})=>[l("div",Ae,c(t.name),1)]),_:1},8,["modelValue","options","disabled"])])])]),u(W,{class:"basic-table",fields:_(Ie),items:w.value,"show-empty":!0,"per-page":S.value,responsive:"","current-page":g.value,"empty-text":"Заказов пока нет.","empty-filtered-text":"Заказы не найдены.",onRowClicked:K},{"cell(ID)":o(t=>[Ee,l("span",null,c(t.value),1)]),"cell(ServiceID)":o(t=>{var n;return[Be,l("span",null,c((n=D.value[t.value])==null?void 0:n.NameShort),1)]}),"cell(ContractID)":o(t=>{var n;return[Fe,l("span",null,c((n=R.value[t.value])==null?void 0:n.Customer),1)]}),"cell(UserNotice)":o(t=>{var n;return[$e,u(ge,{"user-notice":t.value,id:(n=t.item)==null?void 0:n.ID,emit:"updateOrdersList"},null,8,["user-notice","id"])]}),"cell(StatusID)":o(t=>{var n;return[Pe,u(T,{status:t.value,"status-table":J((n=t.item)==null?void 0:n.ServiceID)},null,8,["status","status-table"])]}),"cell(ExpirationDate)":o(t=>[re(l("template",null,[je,l("span",null,c(_(Se)(_(De)(t.value))),1)],512),[[pe,t.value]])]),"cell(controls)":o(t=>[l("div",Ye,[l("button",{class:"btn btn-default btn--border",onClick:n=>M(t.item)},[u(Q),ze],8,qe)])]),_:1},8,["fields","items","per-page","current-page"]),((j=w.value)==null?void 0:j.length)>0?(q(),z("div",Ge,[u(X,{modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=t=>g.value=t),"total-rows":(Y=w.value)==null?void 0:Y.length,"per-page":S.value,"first-number":"","last-number":""},{"first-text":o(()=>[He]),"last-text":o(()=>[Je]),page:o(({page:t,active:n})=>[l("span",null,c((t-1)*S.value+1)+"-"+c(t*S.value),1)]),_:1},8,["modelValue","total-rows","per-page"]),u(_(k),{class:"multiselect--white",modelValue:S.value,"onUpdate:modelValue":e[5]||(e[5]=t=>S.value=t),options:G.value,label:"name",openDirection:"top",onInput:e[6]||(e[6]=t=>g.value=1)},{singlelabel:o(({value:t})=>[l("div",Ke,[l("span",null,"Отображать "+c(t.value)+" строк",1)])]),option:o(({option:t})=>[l("div",Me,"Отображать "+c(t.name)+" строк",1)]),_:1},8,["modelValue","options"])])):ve("",!0)])])],64)}}},_t=oe(Qe,[["__scopeId","data-v-e0e2c9e3"]]);export{_t as default};
