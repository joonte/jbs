import{j as V,o as D,c as h,a as d,b as c,w as m,d as g,t as v,F as A,v as H,k as K,_ as j,x as U,p as Q,l as W,r as E,e as X,R as Y,g as b,i as Z}from"./index-d4c8f165.js";import{u as $}from"./dedicatedServer-2bea085c.js";import{u as ee}from"./contracts-7ba5650d.js";import{I as te}from"./IconSearch-cf25d338.js";import{_ as oe}from"./HelperComponent-e23570da.js";import{S as F}from"./StatusBadge-1c56e28c.js";import{I as ae}from"./IconRotate-9d4cd322.js";import{f as N}from"./useTimeFunction-8602dd60.js";import"./resetServer-6c36d8fc.js";import{z as ne,k as se,d as re}from"./bootstrap-vue-next.es-d6fe4c6a.js";import{_ as le}from"./IconDots-77bb7b30.js";import{_ as ce}from"./IconCard-27c68f9d.js";import{_ as de}from"./OrderIDBadge-86a47e24.js";import{S as ie}from"./Select2-0d7ebe1f.js";import{s as _e}from"./multiselect-086e6a67.js";import{_ as z}from"./FormInputSearch-49e1105a.js";import{B as G}from"./BlockBalanceAgreement-60e87dc5.js";import{u as ue}from"./globalActions-a497c6e1.js";import{E as me}from"./EmptyStateBlock-514fe5ef.js";import{_ as fe}from"./ClausesKeeper-9fcac132.js";import"./ButtonDefault-5ca56e8e.js";import"./IconArrow-87a7eb9b.js";import"./IconPlus-1961dfa9.js";import"./IconClose-fe4fddee.js";const De={class:"hosting-item"},pe={class:"hosting-item__row"},ve={class:"hosting-item__date"},Ie={class:"hosting-item__row"},ge={class:"hosting-item__person"},he={key:0,class:"hosting-item__row"},Se={class:"hosting-item__list"},Ce=["innerHTML"],we={class:"hosting-item__controls"},Oe={class:"btn btn--dots"};function be(i,a,s,t,p,L){var I,_,O,P,B,x,o,e;const r=de,n=V("router-link"),u=F,S=V("Helper"),k=ce,y=le,f=ne,C=se,w=re;return D(),h("div",De,[d("div",pe,[c(r,{orderID:(I=s.itemData)==null?void 0:I.OrderID},null,8,["orderID"]),c(n,{class:"hosting-item__name",to:`/DSOrders/${s.itemData.OrderID}`},{default:m(()=>[g(v(s.itemData.IP),1)]),_:1},8,["to"]),c(u,{status:(_=s.itemData)==null?void 0:_.StatusID,DaysRemainded:(O=s.itemData)==null?void 0:O.DaysRemainded,"status-table":"DSOrders"},null,8,["status","DaysRemainded"]),d("div",ve,"Дата окончания "+v(t.calculateExpirationDate((P=s.itemData)==null?void 0:P.DaysRemainded))+" | "+v(((B=s.itemData)==null?void 0:B.DaysRemainded)||0)+" дн.",1)]),d("div",Ie,[d("div",ge,v((x=s.itemData)==null?void 0:x.Customer),1),c(S,{"user-notice":(o=s.itemData)==null?void 0:o.UserNotice,id:(e=s.itemData)==null?void 0:e.OrderID,position:s.isLast?"bottom":"top",emit:"updateDSOrdersList"},null,8,["user-notice","id","position"])]),s.params.length?(D(),h("div",he,[d("ul",Se,[(D(!0),h(A,null,H(s.params,l=>(D(),h("li",{innerHTML:l},null,8,Ce))),256))])])):K("",!0),d("div",we,[d("div",{class:"btn btn--md btn--bold",onClick:a[0]||(a[0]=l=>{var M;return i.$router.push(`/DSOrderPay/${(M=s.itemData)==null?void 0:M.OrderID}`)})},[c(k),g("Оплатить")]),c(w,{class:"dropdown-dots",right:""},{"button-content":m(()=>[d("div",Oe,[c(y)])]),default:m(()=>[c(f,null,{default:m(()=>{var l;return[c(n,{to:`DSOrders/${(l=s.itemData)==null?void 0:l.OrderID}`},{default:m(()=>[g("Дополнительная информация")]),_:1},8,["to"])]}),_:1}),c(f,{onClick:a[1]||(a[1]=l=>t.transferAccount())},{default:m(()=>[g("Передать на другой аккаунт")]),_:1}),c(f,{onClick:a[2]||(a[2]=l=>t.orderManage())},{default:m(()=>[g("Управлять заказом")]),_:1}),c(C),c(f,{class:"color-red",onClick:a[3]||(a[3]=l=>t.deleteItem())},{default:m(()=>[g("Удалить")]),_:1})]),_:1})])])}const Le={components:{StatusBadge:F,IconRotate:ae,Helper:oe},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","manage"],setup(i,{emit:a}){function s(r){if(!r)return N(new Date);const n=new Date,u=new Date(n.getTime()+r*24*60*60*1e3);return N(u)}function t(){var r;a("delete",(r=i.itemData)==null?void 0:r.ID)}function p(){var r,n;a("transfer",{ServiceOrderID:(r=i.itemData)==null?void 0:r.ID,ServiceID:(n=i.itemData)==null?void 0:n.ServiceID})}function L(){var r,n,u;a("manage",{ServiceOrderID:(r=i.itemData)==null?void 0:r.ID,ServiceID:(n=i.itemData)==null?void 0:n.ServiceID,OrderID:(u=i.itemData)==null?void 0:u.OrderID})}return{deleteItem:t,orderManage:L,transferAccount:p,calculateExpirationDate:s}}},q=j(Le,[["render",be],["__scopeId","data-v-674a35e8"]]),ke=i=>(Q("data-v-ca75e9f2"),i=i(),W(),i),ye={class:"section"},Me={class:"container"},Pe={class:"section-header"},Be={class:"section-title__nowrap"},xe=ke(()=>d("h1",{class:"section-title"},"Выделенные серверы",-1)),Ve={class:"list-form"},Ue={class:"list-form_col list-form_col--sm"},Ae={class:"list-form_select"},Re={class:"multiselect-option"},Te={key:0};function Ee(i,a,s,t,p,L){var C,w,I;const r=G,n=V("router-link"),u=fe,S=V("Multiselect"),k=z,y=q,f=me;return D(),h(A,null,[c(r),d("div",ye,[d("div",Me,[d("div",Pe,[d("div",Be,[xe,c(n,{class:"btn btn--blue btn-default",to:"DSSchemes"},{default:m(()=>[g("Заказать")]),_:1})])]),c(u,{partition:"Header:/DSOrders"}),d("div",Ve,[d("div",Ue,[d("div",Ae,[c(S,{modelValue:t.select,"onUpdate:modelValue":a[0]||(a[0]=_=>t.select=_),options:t.getUsers,disabled:((C=t.getUsers)==null?void 0:C.length)<=1,label:"name"},{singlelabel:m(({value:_})=>[d("span",null,"# "+v(_.value.padStart(5,"0"))+" / "+v(_.name),1)]),option:m(({option:_})=>[d("div",Re,"# "+v(_.value.padStart(5,"0"))+" / "+v(_.name),1)]),_:1},8,["modelValue","options","disabled"])])]),c(k,{modelValue:t.search,"onUpdate:modelValue":a[1]||(a[1]=_=>t.search=_)},null,8,["modelValue"])]),t.getDSList&&((w=t.getDSList)==null?void 0:w.length)>0?(D(),h("div",Te,[t.filterProducts&&((I=t.filterProducts)==null?void 0:I.length)>0?(D(!0),h(A,{key:0},H(t.filterProducts,(_,O)=>(D(),U(y,{params:t.getDSItemParam(_),"is-last":O===t.filterProducts.length-1,"item-data":_,onDelete:t.deleteItem,onTransfer:t.transferItem,onManage:t.orderManage},null,8,["params","is-last","item-data","onDelete","onTransfer","onManage"]))),256)):(D(),U(f,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(D(),U(f,{key:1,class:"no-margin",label:"У Вас нет заказов на выделенные серверы"}))])])],64)}const Ne={components:{FormInputSearch:z,IconSearch:te,Select2:ie,Multiselect:_e,DSItem:q,BlockBalanceAgreement:G},async setup(){const i=E("*"),a=E(null),s=ue(),t=$(),p=ee(),L=X(),r=Y("emitter");r.on("updateDSOrdersList",()=>{t.fetchDSOrders()});const n=b(()=>{var o;return(o=Object.keys(t==null?void 0:t.DSList).map(e=>t==null?void 0:t.DSList[e]))==null?void 0:o.reverse()}),u=b(()=>t==null?void 0:t.DSSchemes),S=b(()=>p==null?void 0:p.contractsList),k=b(()=>t==null?void 0:t.DSOrderIPMI),y=b(()=>w(C(n.value)));Z(()=>{n.value.length<1&&f()});function f(){L.push({path:"/DSSchemes"})}function C(o){return i.value!=="*"?o.filter(e=>(e==null?void 0:e.ContractID)===i.value):o}function w(o){return a.value!==null?o.filter(e=>(e==null?void 0:e.Customer.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.OrderID.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.Scheme.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.IP.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.disks.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.CPU.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.ram.toLowerCase().includes(a.value.toLowerCase()))):o}function I(o){s.OrderManage(o)}const _=b(()=>{let o=[{value:"*",name:"Все договора"}];return n.value!==null&&S.value!==null?(Object.keys(n.value).forEach(e=>{var l,M,R;o.find(J=>{var T;return J.value===((T=n.value[e])==null?void 0:T.ContractID)})||o.push({value:(l=n.value[e])==null?void 0:l.ContractID,name:(R=S.value[(M=n.value[e])==null?void 0:M.ContractID])==null?void 0:R.Customer})}),o):{value:"*",name:"Все договора"}});function O(o){let e=P(o==null?void 0:o.SchemeID);e===void 0&&(e=o);let l=[];return o!=null&&o.Scheme&&l.push(o==null?void 0:o.Scheme),o!=null&&o.CPU&&l.push(o==null?void 0:o.CPU),e!=null&&e.ram&&l.push("RAM "+(e==null?void 0:e.ram)+" GB"),e!=null&&e.disks&&l.push(e==null?void 0:e.disks),e!=null&&e.CostMonth&&l.push("<b>"+(e==null?void 0:e.CostMonth)+"/ месяц</b>"),l}function P(o){var e;return(e=u.value)==null?void 0:e[o]}function B(o){r.emit("open-modal",{component:"DeleteItem",data:{id:o,message:"Вы действительно хотите удалить этот сервер?",tableID:"DSOrders",successEmit:"updateDSOrdersList"}})}function x(o){r.emit("open-modal",{component:"OrdersTransfer",data:o})}return await t.fetchDSOrders(),await t.fetchDSSchemes(),await t.fetchDSOrderIPMI(),await p.fetchContracts(),{getDSList:n,filterProducts:y,select:i,search:a,getUsers:_,getDSSchemes:u,getDSItemParam:O,getDSOrderIPMI:k,orderManage:I,deleteItem:B,transferItem:x,navigateToDSSchemes:f}}},it=j(Ne,[["render",Ee],["__scopeId","data-v-ca75e9f2"]]);export{it as default};
