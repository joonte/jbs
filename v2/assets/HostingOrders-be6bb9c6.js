import{j as O,o as a,c as P,b as p,a as r,w as V,d as S,x as D,am as F,t as w,F as U,v as K,_ as q,f as R,r as A,R as z,g as i}from"./index-87a66f57.js";import{I as G}from"./IconSearch-c3e117a8.js";import{H as N}from"./HostingItem-296a4268.js";import{_ as T}from"./ClausesKeeper-068355e6.js";import{s as J}from"./multiselect-19c64478.js";import{u as Q}from"./hosting-69e0aef8.js";import{u as W}from"./contracts-63b183f3.js";import{B as E}from"./BlockBalanceAgreement-f9b358ae.js";import{u as X}from"./testTransforms-eec373ee.js";import{u as Y}from"./globalActions-a3f84ce4.js";import{E as Z}from"./EmptyStateBlock-f512ef0a.js";import{_ as $}from"./FormInputSearch-f93020c4.js";import"./IconDots-c481ec47.js";import"./IconCard-4f04d33d.js";import"./StatusBadge-74310711.js";import"./hostStatuses-94d00f20.js";import"./HelperComponent-cba1b053.js";import"./ButtonDefault-646e2a65.js";import"./IconArrow-8c8c28c1.js";import"./useTimeFunction-8602dd60.js";import"./bootstrap-vue-next.es-e0094127.js";import"./OrderIDBadge-5be8d5d9.js";import"./IconClose-81d0053a.js";import"./IconPlus-a33d0542.js";const tt={class:"section"},et={class:"container"},ot={class:"section-header"},st=r("h1",{class:"section-title"},"Хостинг",-1),nt={class:"list-form"},rt={class:"list-form_col list-form_col--sm"},at={class:"list-form_select"},lt={class:"multiselect-option"},ct={key:0};function it(n,l,m,o,v,h){var _,H,I;const u=E,d=O("router-link"),y=T,x=O("Multiselect"),B=$,c=N,f=Z;return a(),P(U,null,[p(u),r("div",tt,[r("div",et,[r("div",ot,[st,p(d,{class:"btn btn--blue btn-default",to:"/HostingSchemes"},{default:V(()=>[S("Заказать")]),_:1})]),(a(),D(F,null,[p(y)],1024)),r("div",nt,[r("div",rt,[r("div",at,[p(x,{modelValue:o.select,"onUpdate:modelValue":l[0]||(l[0]=s=>o.select=s),options:o.getUsers,disabled:((_=o.getUsers)==null?void 0:_.length)<=1,label:"name"},{option:V(({option:s})=>[r("div",lt,"# "+w(s.value.padStart(5,"0"))+" / "+w(s.name),1)]),_:1},8,["modelValue","options","disabled"])])]),p(B,{modelValue:o.search,"onUpdate:modelValue":l[1]||(l[1]=s=>o.search=s)},null,8,["modelValue"])]),o.getHostingList&&((H=o.getHostingList)==null?void 0:H.length)>0?(a(),P("div",ct,[o.filterProducts&&((I=o.filterProducts)==null?void 0:I.length)>0?(a(!0),P(U,{key:0},K(o.filterProducts,(s,L)=>{var C,k;return a(),D(c,{"item-data":s,"user-name":`${(C=o.getUser)==null?void 0:C.Name} - ${(k=o.getContracts[s==null?void 0:s.ContractID])==null?void 0:k.Customer}`,params:o.getHostingItemParam(s),"info-link":`/HostingOrders/${s==null?void 0:s.OrderID}`,"is-last":L===o.filterProducts.length-1,onDelete:o.deleteItem,onTransfer:o.transferItem,onManage:o.orderManage},null,8,["item-data","user-name","params","info-link","is-last","onDelete","onTransfer","onManage"])}),256)):(a(),D(f,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(a(),D(f,{key:1,class:"no-margin",label:"У Вас нет заказов на хостинг"}))])])],64)}const mt={components:{IconSearch:G,Multiselect:J,ClausesKeeper:T,HostingItem:N,BlockBalanceAgreement:E},async setup(){const n=Q(),l=R(),m=W(),o=Y(),{formDescriptionLine:v}=X(),h=A("*"),u=A(null),d=z("emitter");d.on("updateHostingList",()=>{n.fetchHostingOrders()});function y(e){d.emit("open-modal",{component:"DeleteItem",data:{id:e,message:"Вы действительно хотите удалить хостинг?",tableID:"HostingOrders",successEmit:"updateHostingList"}})}function x(e){d.emit("open-modal",{component:"OrdersTransfer",data:e})}function B(e){o.OrderManage(e)}const c=i(()=>{var e;return(e=Object.keys(n==null?void 0:n.hostingList).map(t=>n==null?void 0:n.hostingList[t]))==null?void 0:e.reverse()}),f=i(()=>n==null?void 0:n.hostingSchemes),_=i(()=>m==null?void 0:m.contractsList),H=i(()=>{let e=[{value:"*",name:"Все договора"}];return c.value!==null?(c.value.forEach(t=>{var g;e.find(b=>b.value===t.ContractID)||e.push({value:t.ContractID,name:(g=_.value[t==null?void 0:t.ContractID])==null?void 0:g.Customer})}),e):{value:"*",name:"Все договора"}}),I=i(()=>l.userInfo),s=i(()=>C(L(c.value)));function L(e){return h.value!=="*"?e.filter(t=>(t==null?void 0:t.ContractID)===h.value):e}function C(e){return u.value!==null?e.filter(t=>t==null?void 0:t.Domain.toLowerCase().includes(u.value.toLowerCase())):e}function k(e){var g,b,M;const t=j(e==null?void 0:e.SchemeID);return[{text:t==null?void 0:t.Name},{text:v((g=t==null?void 0:t.SchemeParams)==null?void 0:g.limit_webdomains)},{text:v((b=t==null?void 0:t.SchemeParams)==null?void 0:b.limit_quota)},{text:v((M=t==null?void 0:t.SchemeParams)==null?void 0:M.limit_emails)},{text:`${t==null?void 0:t.CostMonth} ₽ в месяц`,bold:!0}]}function j(e){var t;return(t=f.value)==null?void 0:t[e]}return await n.fetchHostingOrders(),await n.fetchHostingSchemes(),await m.fetchContracts(),{getHostingList:c,getHostingSchemes:f,orderManage:B,filterProducts:s,getUsers:H,getUser:I,select:h,search:u,getContracts:_,deleteItem:y,transferItem:x,getHostingItemParam:k}}},At=q(mt,[["render",it]]);export{At as default};
