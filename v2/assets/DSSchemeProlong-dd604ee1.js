import{E as bs}from"./EmptyStateBlock-b36abca5.js";import{_ as ps}from"./BlockOrderPayBalance-29672652.js";import{_ as hs}from"./ClausesKeeper-cfc0f758.js";import{_ as ms}from"./ButtonDefault-28022e42.js";import{_ as fs,r as cs,a7 as ks,e as ys,R as Ds,g as I,ag as g,o as c,c as n,b as p,a as t,t as i,F as k,v as is,k as Is,Y as ns,ae as _s,x as rs,p as gs,l as xs}from"./index-e8e4a28d.js";import{u as ws}from"./dedicatedServer-cbdd4809.js";import{u as Bs}from"./contracts-f70de43e.js";import{B as Cs}from"./BlockBalanceAgreement-00019440.js";import"./bootstrap-vue-next.es-6aab83a5.js";import"./IconHelp-5d2ceeda.js";import"./globalActions-78d58809.js";import"./BasicInput-fc01a75b.js";import"./component-2fc43b10.js";import"./IconClose-c1bee414.js";import"./IconArrow-0cda8946.js";const y=h=>(gs("data-v-de5c25ef"),h=h(),xs(),h),Ps={key:0,class:"domain-scheme"},Es={class:"section"},Os={class:"container"},Ss={class:"section-header"},$s={class:"section-header__wrapper"},Fs=y(()=>t("h1",{class:"section-title"},"Оплата заказа выделенного сервера",-1)),Ls={class:"section-label"},As={class:"section"},Ns={class:"container"},Rs={class:"list"},Ts={class:"list-col list-col--xl"},Vs={class:"list-item"},js=y(()=>t("div",{class:"list-item__row"},[t("div",{class:"list-item__title"},"Конфигурация")],-1)),Us={class:"list-item__row list-item__table"},Ks={class:"list-item__table-col"},Ys={class:"list-item__label"},qs={class:"list-item__text"},zs={key:0,class:"section"},Gs={class:"container"},Hs={class:"total-block"},Js={class:"total-block__row divider-bottom"},Ms=y(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),Qs={class:"total-block__col"},Ws={class:"total-block__row no-divider"},Xs={class:"total-block__col"},Zs={class:"total-block__col"},st={class:"total-block__row total-block__row--big economy-line"},tt=y(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),et={class:"total-block__col flex-col"},ot={class:"red"},lt={class:"total-block__row total-block__row--big"},at={class:"total-block__col"},ct={class:"total-block__col"},it={key:1,class:"section"},nt={class:"container"},_t={key:1,class:"section"},rt={class:"container"},dt={__name:"DSSchemeProlong",async setup(h){let u,v;const e=cs(null),a=ws(),x=Bs(),ds=ks(),w=ys();Ds("emitter");const m=cs(!1),_=I(()=>Object.keys(a==null?void 0:a.DSList).map(s=>a==null?void 0:a.DSList[s]).find(s=>s.OrderID===ds.params.id)),r=I(()=>{var s,l;return(l=a==null?void 0:a.DSSchemes)==null?void 0:l[(s=_.value)==null?void 0:s.SchemeID]}),B=I(()=>x.contractsList);function C(){var l,d;let s=0;return(d=(l=e.value)==null?void 0:l.discounts)==null||d.Bonuses.map(b=>{s+=+b.Economy}),s}function f(s){return Number(s).toFixed(2)||0}function us(){const s=r==null?void 0:r.value;return[{label:"Процессор",text:(s==null?void 0:s.CPU)||"-"},{label:"Объём оперативной памяти",text:(s==null?void 0:s.ram)||"-"},{label:"Характеристики жёстких дисков",text:(s==null?void 0:s.disks)||"-"},{label:"Предустановленная ОС",text:(s==null?void 0:s.OS)||"-"},{label:"RAID",text:(s==null?void 0:s.raid)||"-"},{label:"Месячный трафик",text:s!=null&&s.trafflimit?`${s==null?void 0:s.trafflimit} ГБ`:"-"},{label:"Скорость канала",text:s!=null&&s.chrate?`${s==null?void 0:s.chrate} Мбит/с`:"-"}]}function P(){var s,l;m.value=!0,a.DSOrderPay({DSOrderID:(s=_.value)==null?void 0:s.ID,DaysPay:(l=e.value)==null?void 0:l.actualDays,IsChange:!0}).then(d=>{let{result:b,error:E}=d;b==="SUCCESS"?w.push("/DSOrders"):b==="BASKET"&&w.push("/Basket"),m.value=!1})}function vs(s){e.value=s}return[u,v]=g(()=>a.fetchDSOrders()),await u,v(),[u,v]=g(()=>a.fetchDSSchemes()),await u,v(),[u,v]=g(()=>x.fetchContracts()),await u,v(),(s,l)=>{var O,S,$,F,L,A,N,R,T,V,j,U,K,Y,q,z,G,H,J,M,Q,W,X,Z,ss,ts,es,os,ls,as;const d=ms,b=hs,E=ps,D=bs;return c(),n(k,null,[p(Cs),(O=_.value)!=null&&O.ID&&((S=r.value)!=null&&S.ID)?(c(),n("div",Ps,[t("div",Es,[t("div",Os,[t("div",Ss,[t("div",$s,[Fs,p(d,{class:"btn--wide",label:((F=B.value[($=_.value)==null?void 0:$.ContractID])==null?void 0:F.Balance)>((L=e.value)==null?void 0:L.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:e.value===null||((A=e.value)==null?void 0:A.price)===null,"is-loading":m.value,onClick:l[0]||(l[0]=o=>P())},null,8,["label","disabled","is-loading"])]),t("div",Ls,i((N=_.value)!=null&&N.IP?`#${(R=_.value)==null?void 0:R.IP}`:""),1)]),p(b)])]),t("div",As,[t("div",Ns,[t("div",Rs,[t("div",Ts,[t("div",Vs,[js,t("div",Us,[(c(!0),n(k,null,is(us(),o=>(c(),n("div",Ks,[t("div",Ys,i(o.label),1),t("div",qs,i(o.text),1)]))),256))])])])])])]),p(E,{contractID:(T=_.value)==null?void 0:T.ContractID,scheme:r.value,serviceID:"40000",isOrderID:!1,onSelect:vs},null,8,["contractID","scheme"]),(V=r.value)!=null&&V.IsPayed&&((j=r.value)!=null&&j.IsProlong)||!((U=r.value)!=null&&U.IsPayed)?(c(),n("div",zs,[t("div",Gs,[t("div",Hs,[((q=(Y=(K=e.value)==null?void 0:K.discounts)==null?void 0:Y.Bonuses)==null?void 0:q.length)>0?(c(),n(k,{key:0},[t("div",Js,[Ms,t("div",Qs,i(f((z=e.value)==null?void 0:z.price))+" ₽",1)]),(c(!0),n(k,null,is((H=(G=e.value)==null?void 0:G.discounts)==null?void 0:H.Bonuses,o=>(c(),n("div",Ws,[t("div",Xs,"Скидка "+i(o==null?void 0:o.Discount)+"% на "+i(o==null?void 0:o.Days)+" дней",1),t("div",Zs,"-"+i(f(o==null?void 0:o.Economy))+" ₽",1)]))),256))],64)):Is("",!0),ns(t("div",st,[tt,t("div",et,[t("span",null,[t("s",null,i(f((J=e.value)==null?void 0:J.price))+" ₽",1)]),t("span",ot,"-"+i(C())+" ₽",1)])],512),[[_s,((W=(Q=(M=e.value)==null?void 0:M.discounts)==null?void 0:Q.Bonuses)==null?void 0:W.length)>0]]),ns(t("div",lt,[t("div",at,"Итого за "+i((X=e.value)==null?void 0:X.label),1),t("div",ct,i(f(((Z=e.value)==null?void 0:Z.price)-C()))+" ₽",1)],512),[[_s,(ss=e.value)==null?void 0:ss.price]])]),p(d,{class:"btn--wide",label:((es=B.value[(ts=_.value)==null?void 0:ts.ContractID])==null?void 0:es.Balance)>((os=e.value)==null?void 0:os.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:e.value===null||((ls=e.value)==null?void 0:ls.price)===null,"is-loading":m.value,onClick:l[1]||(l[1]=o=>P())},null,8,["label","disabled","is-loading"])])])):(c(),n("div",it,[t("div",nt,[p(D,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(c(),n("div",_t,[t("div",rt,[(as=_.value)!=null&&as.ID?(c(),rs(D,{key:0,label:"Заказ не может быть продлен"})):(c(),rs(D,{key:1,label:"Заказ не найден"}))])]))],64)}}},Ct=fs(dt,[["__scopeId","data-v-de5c25ef"]]);export{Ct as default};
