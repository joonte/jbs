import{_ as H}from"./EmptyStateBlock-D6U_EDq6.js";import{_ as M}from"./ButtonDefault-CghIUDY0.js";import{m as j}from"./bootstrap-vue-next-3DpAa4tb.js";import{_ as x}from"./IconClip-Du848aq1.js";import{_ as R}from"./IconClose-ChC2G6HM.js";import{_ as q}from"./IconFile-F4S-E8U9.js";import{_ as z,a as G,b as J}from"./PhoneInput-Cc-Mwvf_.js";import{_ as K}from"./BasicInput-BYe5b9L8.js";import{_ as Q}from"./ClausesKeeper-DVJgfLR3.js";import{_ as W}from"./BlockBalanceAgreement-2iQbaweR.js";import{c,b as m,a as t,C as g,w as D,E as X,F as y,h as d,i as O,ao as Y,r as _,f as B,g as Z,d as $,o as r,e as F,t as w,n as U}from"./index-CipWZKo_.js";import{u as ee}from"./contracts-CILh9uSu.js";import{u as le}from"./files-CtBs4iPb.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./multiselect-DWCHRlfT.js";import"./component-DWBAga-C.js";const ae={async setup(){const S=Y(),a=ee(),N=le(),l=$(),C=Z(),k=_(!1),h=_(!1),f=_({}),V=_(null),v=_([]),I=_([]),b=_(null),E=_(null),p=_(0),P=B(()=>S.data),u=B(()=>a.profileList?.[C.params.id]);function T(){if(k.value&&h.value){let o={};Object.keys(f.value).forEach(s=>{o[s]=f.value[s].value});let i=new FormData;Object.keys(f.value).forEach(s=>{i.append(s,f.value[s]?.value)}),i.append("TemplateID",p.value),i.append("Agree",k.value),i.append("AgreeHandle",h.value),i.append("ProfileID",C.params.id),v.value.forEach((s,Ce)=>{i.append("Document[]",s?.value)}),b.value="pending",a.createNewContract({ProfileID:C.params.id,TemplateID:p.value,Agree:k.value,AgreeHandle:h.value,...o}).then(s=>{s.status==="success"?l.push("/Contracts?section=Profiles"):(b.value="error",E.value=s.data?.Exception)})}}function A(o){v.value=v.value.filter((i,s)=>s!==o)}function L(o){return""+n(o)}function e(o){let i=o.target.files?.[0]||null;i&&(V.value.value="",N.sendFile(i).then(s=>{v.value.push({name:i?.name,value:s.slice(s.lastIndexOf("^")+1,s.length)})}))}function n(o){return o?"<div>"+o?.String+"</div>"+n(o?.Parent):""}return await a.fetchContracts().then(()=>{a.fetchProfiles().then(()=>{p.value=u.value?.TemplateID,u.value?.Files&&(I.value=Object.keys(u.value?.Files)?.map(o=>({name:u.value?.Files[o].Name,value:u.value?.Files[o].Name}))),Object.keys(u.value.Attribs).forEach(o=>{f.value[o]={value:u.value.Attribs[o],required:P.value?.Profiles?.Templates?.[p.value]?.Template?.Attribs[o].IsDuty==="1",error:!1}})})}),{getConfig:P,getProfile:u,templateValue:p,agreeHandle:h,fileInput:V,fileList:v,fileListOld:I,agree:k,createProfileResult:b,createProfileErrorMessage:E,checkForm:T,fileUpload:e,removeFile:A,formErrorMessage:L,form:f}}},ne={class:"container"},te={class:"section-header"},re={class:"breadcrumb"},se={class:"form"},ce={class:"special-form-row"},ie={key:0,class:"section-header inputs-block"},ue={class:"section-block_title"},me={key:0,class:"form width-limit"},fe={key:0,class:"form-field form-field--file form-field--basic"},de={class:"chat-files"},_e={key:1,class:"form-field form-field--file form-field--basic"},pe={class:"chat-files"},ve=["onClick"],he={class:"form-field form-field--file form-field--basic"},ge={class:"form-field-input__file-wrapper"},ke={class:"form-field-input__file"},be=["innerHTML"];function ye(S,a,N,l,C,k){const h=W,f=X("router-link"),V=Q,v=K,I=z,b=G,E=J,p=q,P=R,u=x,T=j,A=M,L=H;return r(),c(y,null,[m(h),t("section",null,[t("div",ne,[t("div",te,[t("div",re,[m(f,{to:"/Contracts",class:"section-label"},{default:D(()=>a[4]||(a[4]=[F("Договор /",-1)])),_:1,__:[4]}),m(f,{to:`/ContractScheme/${S.$route.params.id}`,class:"section-label"},{default:D(()=>[F(w(l.getProfile?.Name),1)]),_:1},8,["to"])]),a[5]||(a[5]=t("h1",{class:"section-title"},"Редактировать договор",-1))]),m(V),l.getProfile?(r(),c(y,{key:0},[t("div",se,[(r(!0),c(y,null,O(l.getConfig?.Profiles?.Templates?.[l.templateValue]?.Template?.Attribs,(e,n)=>(r(),c("div",{class:"form-row-wrapper",key:n},[t("div",ce,[e?.Title?(r(),c("div",ie,[t("h2",ue,w(e?.Title),1)])):d("",!0),e?.Type==="Input"&&e?.Check!=="Phone"?(r(),g(v,{key:1,class:U({"special-form-input":!0,"form-field-error":l.form[n].error}),label:e?.Comment,placeholder:e?.Example,necessarily:e?.IsDuty==="1",name:e?.Check,modelValue:l.form[n].value,"onUpdate:modelValue":o=>l.form[n].value=o},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):d("",!0),e?.Type==="Input"&&e?.Check==="Phone"?(r(),g(I,{key:2,class:U({"special-form-input":!0,"form-field-error":l.form[n].error}),label:e?.Comment,placeholder:e?.Example,necessarily:e?.IsDuty==="1",name:e?.Check,modelValue:l.form[n].value,"onUpdate:modelValue":o=>l.form[n].value=o},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):d("",!0),e?.Type==="TextArea"?(r(),g(b,{key:3,class:U({"special-form-input":!0,"form-field-error":l.form[n].error}),label:e?.Comment,placeholder:e?.Example,necessarily:e?.IsDuty==="1",name:e?.Check,modelValue:l.form[n].value,"onUpdate:modelValue":o=>l.form[n].value=o},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):e?.Type==="Select"?(r(),g(E,{key:4,class:U({"special-form-input":!0,"form-field-error":l.form[n].error}),label:e?.Comment,placeholder:e?.Example,necessarily:e?.IsDuty==="1",name:e?.Check,options:e?.Options,modelValue:l.form[n].value,"onUpdate:modelValue":o=>l.form[n].value=o},null,8,["class","label","placeholder","necessarily","name","options","modelValue","onUpdate:modelValue"])):d("",!0)])]))),128))]),l.templateValue!==0?(r(),c("div",me,[l.fileListOld.length?(r(),c("div",fe,[t("div",de,[(r(!0),c(y,null,O(l.fileListOld,(e,n)=>(r(),c("div",{class:"chat-files__item",key:"old-"+n},[t("span",null,[m(p,{class:"file-icon"})]),t("span",null,w(e?.name),1)]))),128))])])):d("",!0),l.fileList.length?(r(),c("div",_e,[t("div",pe,[(r(!0),c(y,null,O(l.fileList,(e,n)=>(r(),c("div",{class:"chat-files__item",key:"new-"+n},[t("span",null,[m(p,{class:"file-icon"})]),t("span",null,w(e?.name),1),t("button",{class:"close",onClick:o=>l.removeFile(n)},[m(P)],8,ve)]))),128))])])):d("",!0),t("label",he,[t("div",ge,[t("input",{ref:"fileInput",type:"file",onChange:a[0]||(a[0]=(...e)=>l.fileUpload&&l.fileUpload(...e))},null,544),t("div",ke,[m(u),a[6]||(a[6]=t("span",null,"Прикрепить документ подтверждающий личность",-1))])])]),m(T,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:l.agree,"onUpdate:modelValue":a[1]||(a[1]=e=>l.agree=e)},{default:D(()=>a[7]||(a[7]=[F(" Подтверждаю свое согласие на передачу информации в электроной форме (в том числе персональных данных) по открытым каналам связи сети Интернет ",-1)])),_:1,__:[7]},8,["modelValue"]),m(T,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:l.agreeHandle,"onUpdate:modelValue":a[2]||(a[2]=e=>l.agreeHandle=e)},{default:D(()=>a[8]||(a[8]=[F(" Я разрешаю передачу своих персональных данных третьим лицам, для выполнения заказанных мною услуг (регистрация доменов и т.п.) ",-1)])),_:1,__:[8]},8,["modelValue"])])):d("",!0),l.createProfileErrorMessage?(r(),c("div",{key:1,class:"error-message width-limit",innerHTML:l.formErrorMessage(l.createProfileErrorMessage)},null,8,be)):d("",!0),l.templateValue!==0?(r(),g(A,{key:2,class:"width-limit","is-loading":l.createProfileResult==="pending",label:"Сохранить",onClick:a[3]||(a[3]=e=>l.checkForm())},null,8,["is-loading"])):d("",!0)],64)):(r(),g(L,{key:1,label:"Профиль договора не найден"}))])])],64)}const Me=oe(ae,[["render",ye],["__scopeId","data-v-5c6c8992"]]);export{Me as default};
