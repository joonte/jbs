import{_ as O}from"./EmptyStateBlock-CV1Zaaf7.js";import{L as R,a as A}from"./bootstrap-vue-next-CxxkTytZ.js";import{_ as j}from"./StatusBadge-DoJSzeeo.js";import{_ as z}from"./FormInputSearch-DhLeThyA.js";import{_ as G}from"./ClausesKeeper-DEgaQ2N3.js";import{_ as W}from"./BlockBalanceAgreement-DjWMZ940.js";import{u as q}from"./edesks-C7o6eTx8.js";import{c as E,b as i,a as s,D as J,w as l,G as P,F as w,am as K,r as a,f as F,m as C,d as Q,x as X,o as T,e as Y,t as r,a2 as Z}from"./index-XtiBO-PZ.js";import{s as h}from"./multiselect-eqvbz1NV.js";import{f as $,s as ee}from"./time-DenPiOX5.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IconPlus-DYth91EZ.js";import"./IconClose-s_NQ_Q4c.js";import"./contracts-BdlSA9YT.js";import"./ButtonDefault-eJbeaBtE.js";const oe=[{key:"ID",label:"Номер"},{key:"UpdateDate",label:"Дата и время",sortable:!0,variant:"td-gray td-order"},{key:"PriorityID",label:"Приоритет",sortable:!0,variant:"td-gray td-order"},{key:"Theme",label:"Тема"},{key:"MessageID",label:"Количество сообщений"},{key:"StatusID",label:"Статус",sortable:!0,variant:"td-gray td-order"}],se={Newest:{color:"#459FD1",background:"#ADC1F04C"},Opened:{color:"#FFC107",background:"#FFC10733"},Working:{color:"#28A745",background:"#EAF7ED"},Closed:{color:"#838383",background:"#57699B19"}},ne={Low:{background:"#8FD658"},Middle:{background:"#FFC700"},Hight:{background:"#DF5747"}},le={components:{Multiselect:h},async setup(){const k=q(),t=K(),S=X("emitter"),o=Q(),u=a("*"),m=a(""),p=a(1),v=a(10),g=a(0),b=a([10,25,50,100]),d=a([]),D=a("UpdateDate"),y=a(!0),I=a("desc"),_=F(()=>k?.eDesksList),e=F(()=>t.data),f=F(()=>Object.keys(_.value)?.map(n=>_.value?.[n])?.reverse());await k.fetchEDesks().then(()=>{g.value=f.value.length,e.value?.Statuses?.Edesks&&(d.value=Object.keys(e.value?.Statuses?.Edesks)?.map(n=>({value:n,name:e.value?.Statuses?.Edesks?.[n]?.Name}))),d.value.push({value:"*",name:"Все тикеты"})});function V(){o.go(0)}function B(n){S.emit("open-modal",{component:"StatusHistory",data:{modeID:"Edesks",rowID:n}})}function x(n){return n?.filter(c=>u.value==="*"?!0:c?.StatusID===u?.value)?.filter(c=>c?.ID.includes(m.value)||c?.Theme.includes(m.value))}function N(n){return g.value=n.length>0?n.length:1,n}function U(n){return d.value.find(c=>c?.value===n)?.name}function M(n){return e.value?.Edesks?.Priorities?.[n]}function H(n,c,L){L.target.closest("button, a, .clickable-element")||o.push({path:`Ticket/${n?.ID}`})}return C(m,()=>{p.value=1}),C(u,()=>{p.value=1}),{getEDesks:_,getEDeskItems:f,select:u,filter:m,currentPage:p,perPage:v,options:d,totalRows:g,pageOptions:b,sortBy:D,sortDesc:y,sortDirection:I,ticketsTable:oe,statuses:se,priorities:ne,findStatus:U,findPriority:M,onFiltered:N,filterTableItems:x,secondToDate:ee,formNormalDate:$,navigateToTicket:H,openHistoryStatuses:B,reloadNow:V}}},ae={class:"section"},re={class:"container"},ie={class:"section-header"},ce={class:"btn__group"},de={class:"list-form"},ue={class:"list-form_col list-form_col--sm"},me={class:"list-form_select"},pe={class:"multiselect-option"},ge={class:"d-block"},_e={class:"cell__theme"},be={class:"table-controls"},fe={class:"multiselect-multiple-label"},ke={class:"multiselect-option"};function ve(k,t,S,o,u,m){const p=W,v=P("router-link"),g=G,b=P("Multiselect"),d=z,D=j,y=R,I=A,_=O;return T(),E(w,null,[i(p),s("section",ae,[s("div",re,[s("div",ie,[s("h1",{class:"section-title",onClick:t[0]||(t[0]=e=>o.reloadNow())},"Служба поддержки"),s("div",ce,[i(v,{class:"btn btn--blue btn-default",to:"/NewTicket"},{default:l(()=>t[7]||(t[7]=[Y("Создать тикет",-1)])),_:1,__:[7]})])]),i(g,{partition:"Header:/Tickets"}),s("div",de,[s("div",ue,[s("div",me,[i(b,{options:o.options,label:"name",modelValue:o.select,"onUpdate:modelValue":t[1]||(t[1]=e=>o.select=e)},{option:l(({option:e})=>[s("div",pe,r(e.name),1)]),_:1},8,["options","modelValue"])])]),i(d,{modelValue:o.filter,"onUpdate:modelValue":t[2]||(t[2]=e=>o.filter=e)},null,8,["modelValue"])]),o.getEDeskItems&&o.getEDeskItems.length?(T(),E(w,{key:0},[i(y,{class:"basic-table",items:o.onFiltered(o.filterTableItems(o.getEDeskItems)),"per-page":o.perPage,"current-page":o.currentPage,fields:o.ticketsTable,"show-empty":"","sort-by":o.sortBy,"onUpdate:sortBy":t[3]||(t[3]=e=>o.sortBy=e),"sort-desc":o.sortDesc,"onUpdate:sortDesc":t[4]||(t[4]=e=>o.sortDesc=e),"sort-direction":o.sortDirection,onRowClicked:o.navigateToTicket},{"cell(ID)":l(e=>[t[8]||(t[8]=s("span",{class:"td-mobile"},"Номер",-1)),s("span",ge,r(e.value),1)]),"cell(UpdateDate)":l(e=>[t[9]||(t[9]=s("span",{class:"td-mobile"},"Дата и время",-1)),s("span",null,r(o.formNormalDate(o.secondToDate(e.value))),1)]),"cell(PriorityID)":l(e=>[t[10]||(t[10]=s("span",{class:"td-mobile"},"Приоритет",-1)),s("span",{class:"status-tag",style:Z(`color: #FFF; background-color: ${o.priorities?.[e.value]?.background}; border-color: ${o.priorities?.[e.value]?.background}`)},r(o.findPriority(e.value)),5)]),"cell(Theme)":l(e=>[t[11]||(t[11]=s("span",{class:"td-mobile"},"Тема",-1)),s("span",_e,r(e.value),1)]),"cell(MessageID)":l(e=>[t[12]||(t[12]=s("span",{class:"td-mobile"},"Количество сообщений",-1)),s("span",null,r(e.value),1)]),"cell(StatusID)":l(e=>[t[13]||(t[13]=s("span",{class:"td-mobile"},"Статус",-1)),i(D,{class:"clickable-element",status:e.value,"status-table":"Edesks",onClick:f=>o.openHistoryStatuses(e.item?.ID)},null,8,["status","onClick"])]),empty:l(()=>t[14]||(t[14]=[s("span",null,"Ничего не найдено",-1)])),emptyfiltered:l(()=>t[15]||(t[15]=[s("span",null,"Ничего не найдено",-1)])),_:1},8,["items","per-page","current-page","fields","sort-by","sort-desc","sort-direction","onRowClicked"]),s("div",be,[i(I,{modelValue:o.currentPage,"onUpdate:modelValue":t[5]||(t[5]=e=>o.currentPage=e),"total-rows":o.totalRows,"per-page":o.perPage,"first-number":"","last-number":""},{"first-text":l(()=>t[16]||(t[16]=[s("span",{class:"text-success"},"First",-1)])),"last-text":l(()=>t[17]||(t[17]=[s("span",{class:"text-info"},"Last",-1)])),page:l(({page:e,active:f})=>[s("span",null,r((e-1)*o.perPage+1)+"-"+r(e*o.perPage),1)]),_:1},8,["modelValue","total-rows","per-page"]),i(b,{class:"multiselect--white",modelValue:o.perPage,"onUpdate:modelValue":t[6]||(t[6]=e=>o.perPage=e),options:o.pageOptions,label:"name",openDirection:"top"},{singlelabel:l(({value:e})=>[s("div",fe,[s("span",null,"Отображать "+r(e.value)+" строк",1)])]),option:l(({option:e})=>[s("div",ke,"Отображать "+r(e.name)+" строк",1)]),_:1},8,["modelValue","options"])])],64)):(T(),J(_,{key:1,class:"no-margin",label:"Вы пока не обращались в тех. поддержку "}))])])],64)}const Me=te(le,[["render",ve],["__scopeId","data-v-50c4ee3b"]]);export{Me as default};
