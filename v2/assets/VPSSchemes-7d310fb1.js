import{_ as Be}from"./ButtonDefault-11c4541b.js";import{_ as ae,r as I,i as se,o as u,c as i,a,q as pe,l as z,t as m,d as Ce,F as C,y as N,e as Oe,h as D,P as we,j as Ee,ah as X,b as U,w as Y,Z as me,ab as he,z as ee,p as xe,m as Ne,K as Ue}from"./index-aeb1df1e.js";import{_ as Ae}from"./ClausesKeeper-90c650cc.js";import{u as $e}from"./vps-31dc9173.js";import{u as Le}from"./resetServer-1c71747e.js";import{u as Fe}from"./IconArrow-a6c91ada.js";import{u as Re}from"./services-bb78f548.js";import{_ as Ge}from"./BlockSelectContract-9de95b8e.js";import{B as Me}from"./BlockOrderServiceWrapper-cd89416d.js";import{B as Te}from"./BlockAdditionalServices-3f8c8032.js";import{_ as je}from"./BlockOrderPayBalance-39bb297a.js";import{B as Ke}from"./BlockBalanceAgreement-906c1168.js";import"./IconClose-c7c36336.js";import"./multiselect-3fbc9d28.js";import"./EmptyStateBlock-b0a120e4.js";import"./bootstrap-vue-next.es-c6bcf011.js";import"./ServiceListOrderSelection-8635e3a9.js";import"./domain-0f1019af.js";import"./BasicInput-67b26a5e.js";import"./component-60ac2998.js";import"./IconHelp-66378dff.js";import"./globalActions-3944bebb.js";const qe={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},name:{type:String,default:""},type:{type:String,default:"radio"},checked:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(f,{emit:v}){const l=I(null),p=I(!1);function P(){v("update:modelValue",f.data)}function B(){p.value=!0}return se(()=>{l.value=f.modelValue}),{inputValue:l,isIconPressed:p,onMouseEvent:B,updateValue:P}}},He={class:"form-input_border"},ze={class:"form-input_border-label"},We=["name","checked"],Xe={class:"form-field__data"},Ze={key:0,class:"form-field__img"},Je=["src"],Qe={class:"form-field__name"},Ye={class:"form-field__desc"},et={class:"form-field__select"};function tt(f,v,l,p,P,B){return u(),i("div",He,[a("label",ze,[a("input",{name:l.name,type:"radio",checked:l.checked,onInput:v[0]||(v[0]=(...S)=>p.updateValue&&p.updateValue(...S))},null,40,We),a("div",Xe,[pe(f.$slots,"default",{},()=>[l.data.img?(u(),i("div",Ze,[a("img",{src:l.data.img,alt:""},null,8,Je)])):z("",!0)],!0),a("div",Qe,m(l.data.name),1),a("div",Ye,[Ce(m(l.data.desc)+" ",1),l.data.select?pe(f.$slots,"default",{key:0},()=>[a("div",et,[(u(!0),i(C,null,N(l.data.select,(S,O)=>(u(),i("div",{key:O,class:"form-field__select-item"},m(S.text),1))),128))])],!0):z("",!0)])])])])}const at=ae(qe,[["render",tt],["__scopeId","data-v-6ee6abfb"]]);const st={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},headers:{type:Array,default:()=>[]},name:{type:String,default:""},checkbox:{type:Boolean,default:!1},checked:{type:Boolean,default:!1}},emits:["update:modelValue","input"],setup(f,{emit:v}){const l=I(null),p=I(!1);function P(){v("update:modelValue",f.data),v("input",f.data)}function B(){p.value=!0}return se(()=>{l.value=f.modelValue}),{inputValue:l,isIconPressed:p,onMouseEvent:B,updateValue:P}}},ot={class:"form-input_border"},lt={class:"form-input_border-label"},nt=["name","type","checked"],ct={class:"form-field__data"},rt={class:"form-field_header"};function ut(f,v,l,p,P,B){return u(),i("div",ot,[a("label",lt,[a("input",{name:l.name,type:l.checkbox?"checkbox":"radio",checked:l.checked,onInput:v[0]||(v[0]=(...S)=>p.updateValue&&p.updateValue(...S))},null,40,nt),a("div",ct,[(u(!0),i(C,null,N(l.headers,(S,O)=>(u(),i("div",{key:O,class:"form-field__col"},[a("span",rt,m(S),1),a("span",null,m(l.data[O]),1)]))),128))])])])}const dt=ae(st,[["render",ut],["__scopeId","data-v-a13950e6"]]),_t="/v2/assets/oc-2-8f4c288c.jpg";const A=f=>(xe("data-v-f15698f7"),f=f(),Ne(),f),it={class:"vps-scheme-page"},vt={class:"section"},pt={class:"container"},mt=A(()=>a("div",{class:"section-header"},[a("h1",{class:"section-title"},"Заказать VPS/VDS сервер")],-1)),ht={class:"section"},ft={class:"container"},St=A(()=>a("h2",{class:"section-block_title"},"Конфигурация",-1)),bt={class:"form-column"},kt={class:"form-header"},It={class:"form-header_col"},yt={key:0,class:"section"},gt={class:"container"},Vt=A(()=>a("h2",{class:"section-block_title"},"Операционная система",-1)),Dt={class:"form grid-gorm"},Pt=["src","alt"],Bt={class:"section"},Ct={class:"container"},Ot=A(()=>a("h2",{class:"section-block_title"},"Регион",-1)),wt={class:"form"},Et={class:"section"},xt={class:"container"},Nt={class:"total-block"},Ut={class:"total-block__row divider-bottom"},At=A(()=>a("div",{class:"total-block__col"},"Цена тарифа",-1)),$t={class:"total-block__col"},Lt={class:"total-block__row no-divider"},Ft={class:"total-block__col"},Rt={class:"total-block__col"},Gt={class:"total-block__row"},Mt=A(()=>a("div",{class:"total-block__col"},"Дополнительные услуги",-1)),Tt={class:"total-block__col"},jt={class:"total-block__row no-divider"},Kt={class:"total-block__col"},qt={class:"total-block__col"},Ht={class:"total-block__row total-block__row--big economy-line"},zt=A(()=>a("div",{class:"total-block__col red"},"Выгода",-1)),Wt={class:"total-block__col flex-col"},Xt={class:"red"},Zt={class:"total-block__row total-block__row--big"},Jt={class:"total-block__col"},Qt={class:"total-block__col"},te="Moscow",Yt={__name:"VPSSchemes",async setup(f){let v,l;const p=$e(),P=Fe(),B=Le(),S=Re(),O=Oe(),h=I(null),R=I([]),E=I(null),G=I(null),W=I(!1),y=I(null),oe=I(!1),le=I(""),fe=I([{img:_t,value:"Moscow",name:"Россия",desc:"Москва"}]),ne=D(()=>{var t,c,o,n,d,r,b,_,k;const e=(t=M.value)==null?void 0:t[0];return e!=null&&e.SchemeParams?{PackageID:"Тариф",cpu_number:((o=(c=e==null?void 0:e.SchemeParams)==null?void 0:c.cpu_number)==null?void 0:o.Name)||"CPU",ram_mib:((d=(n=e==null?void 0:e.SchemeParams)==null?void 0:n.ram_mib)==null?void 0:d.Name)||"RAM",hdd_mib:((b=(r=e==null?void 0:e.SchemeParams)==null?void 0:r.hdd_mib)==null?void 0:b.Name)||"Память",net_in_mbitps:((k=(_=e==null?void 0:e.SchemeParams)==null?void 0:_.net_in_mbitps)==null?void 0:k.Name)||"Канал",CostMonth:"Стоимость"}:{PackageID:"Тариф",cpu_number:"CPU",ram_mib:"RAM",hdd_mib:"Память",net_in_mbitps:"Канал",CostMonth:"Стоимость"}}),M=D(()=>Object.keys(p.vpsSchemes).map(e=>p.vpsSchemes[e])),Se=D(()=>M.value.sort((t,c)=>{const o=Number(t.SortID),n=Number(c.SortID);return o-n})),be=D(()=>P==null?void 0:P.contractsList),$=D(()=>M.value.find(e=>{var t;return(e==null?void 0:e.ID)===((t=y.value)==null?void 0:t.ID)})),T=D(()=>{var e;return(e=B==null?void 0:B.serverGroupsList)==null?void 0:e.ServersGroups}),ce=D(()=>S==null?void 0:S.ServicesList),Z=D(()=>{let e=0;return R.value.forEach(t=>{e+=t==null?void 0:t.Price}),ue(e)||0}),L=D(()=>{var c,o;const e=((c=$.value)==null?void 0:c.OS)||[],t=((o=$.value)==null?void 0:o.OSs)||[];return e.map(n=>{const d=t.find(r=>r.Name===n);return{name:n,value:n,imageUrl:d?d.Image:""}})}),re=e=>{e.key==="Enter"&&e.ctrlKey&&!ke.value&&_e()},ke=D(()=>h.value===null||E.value===null),Ie=D(()=>{var c,o,n,d;if((c=h.value)!=null&&c.daysFromBalance)return"Оплатить c баланса договора";const e=F(((o=h.value)==null?void 0:o.price)-J()+ +Z.value);return(((d=(n=be.value)==null?void 0:n[E.value])==null?void 0:d.Balance)||0)>=e?"Оплатить c баланса договора":"Добавить в корзину"});se(()=>{console.log($),document.addEventListener("keyup",re)}),we(()=>{document.removeEventListener("keyup",re)});function F(e){var n;const t=Number((n=$.value)==null?void 0:n.CostInstall)||0,c=Number(e)||0,o=(t+c).toFixed(2);return Number(o)}function ue(e){return Number(e).toFixed(2)||0}function J(){var t,c;let e=0;return(c=(t=h.value)==null?void 0:t.discounts)==null||c.Bonuses.map(o=>{e+=+o.Economy}),e}Ee(y,e=>{});function de(e){var t,c,o,n,d,r,b,_;return{ID:e==null?void 0:e.ID,PackageID:e==null?void 0:e.PackageID,ServersGroupID:e==null?void 0:e.ServersGroupID,cpu_number:(c=(t=e==null?void 0:e.SchemeParams)==null?void 0:t.cpu_number)==null?void 0:c.Value,ram_mib:(n=(o=e==null?void 0:e.SchemeParams)==null?void 0:o.ram_mib)==null?void 0:n.Value,hdd_mib:(r=(d=e==null?void 0:e.SchemeParams)==null?void 0:d.hdd_mib)==null?void 0:r.Value,net_in_mbitps:(_=(b=e==null?void 0:e.SchemeParams)==null?void 0:b.net_in_mbitps)==null?void 0:_.Value,CostMonth:e==null?void 0:e.CostMonth}}function ye(){var c,o,n,d,r,b;let e=(n=Object.keys((o=T.value)==null?void 0:o[(c=y.value)==null?void 0:c.ServersGroupID]))==null?void 0:n.find(_=>{var k,V,w,x,j,K,q,H;return((x=(w=(V=T.value)==null?void 0:V[(k=y.value)==null?void 0:k.ServersGroupID])==null?void 0:w[_])==null?void 0:x.IsActive)&&((H=(q=(K=T.value)==null?void 0:K[(j=y.value)==null?void 0:j.ServersGroupID])==null?void 0:q[_])==null?void 0:H.IsDefault)}),t=(b=Object.keys((r=T.value)==null?void 0:r[(d=y.value)==null?void 0:d.ServersGroupID]))==null?void 0:b.find(_=>{var k,V,w,x;return(x=(w=(V=T.value)==null?void 0:V[(k=y.value)==null?void 0:k.ServersGroupID])==null?void 0:w[_])==null?void 0:x.IsActive});return e||t}function ge(e){e!==void 0&&(h.value=e)}async function Ve(e){var t;for(const c of R.value){let o="SUCCESS",n=(t=ce.value[c.ServiceID])==null?void 0:t.Code;if(await S.ServiceOrder({Code:n,DependOrderID:e,...c,ContractID:E.value}).then(({result:d,info:r,error:b})=>{if(d==="SUCCESS"){let _={};n==="Default"?_.ServiceOrderID=r==null?void 0:r.ServiceOrderID:_[`${n}OrderID`]=r==null?void 0:r.ServiceOrderID,S.ServiceOrderPay(n,_,{XMLHttpRequest:"yes"}).then(k=>{let{result:V,error:w}=k;V==="SUCCESS"?O.push("/AdditionalServices"):V==="BASKET"&&O.push("/Basket")})}else o="ERROR"}),o==="ERROR")break}}function _e(){var e,t;W.value=!0,p.VPSOrder({ContractID:E.value,VPSSchemeID:(e=y.value)==null?void 0:e.ID,ServerID:ye(),DiskTemplate:(t=G.value)==null?void 0:t.value}).then(({result:c,info:o,error:n})=>{var d,r;c==="SUCCESS"?(Ve(o==null?void 0:o.OrderID),p.VPSOrderPay({VPSOrderID:o==null?void 0:o.VPSOrderID,DaysPayFromBallance:((d=h.value)==null?void 0:d.daysFromBalance)||0,DaysPay:(r=h.value)==null?void 0:r.actualDays,IsChange:!0}).then(b=>{let{result:_,error:k}=b;_==="SUCCESS"?O.push("/VPSOrders"):_==="BASKET"&&O.push("/Basket"),W.value=!1})):W.value=!1})}const De=e=>{Ue(()=>{const t=document.querySelector(".form-input_border-label input:checked~.form-field__content");t&&t.click()})};function Pe(){var e,t;((e=L==null?void 0:L.value)==null?void 0:e.length)>0&&(G.value=(t=L.value)==null?void 0:t[0])}return[v,l]=X(()=>p.fetchVPSSchemes().then(()=>{var e,t;((e=M.value)==null?void 0:e.length)>0&&(y.value=de((t=M.value)==null?void 0:t[0])),Pe()})),await v,l(),[v,l]=X(()=>P.fetchContracts()),await v,l(),[v,l]=X(()=>B.fetchServerGroups()),await v,l(),[v,l]=X(()=>S.fetchServices()),await v,l(),(e,t)=>{var r,b,_,k,V,w,x,j,K,q,H,ie,ve;const c=Ae,o=dt,n=at,d=Be;return u(),i(C,null,[U(Ke),a("div",it,[a("div",vt,[a("div",pt,[mt,U(c)])]),U(Me,{basic_title:"VPS/VDS сервер",modelValue:le.value,"onUpdate:modelValue":t[6]||(t[6]=s=>le.value=s)},{page:Y(()=>[a("div",ht,[a("div",ft,[St,a("div",bt,[a("div",kt,[(u(!0),i(C,null,N(ne.value,s=>(u(),i("div",It,m(s),1))),256))]),(u(!0),i(C,null,N(Se.value,s=>{var g;return u(),ee(o,{data:de(s),type:"",modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=Q=>y.value=Q),name:"config",checked:((g=y.value)==null?void 0:g.ID)===(s==null?void 0:s.ID),headers:ne.value,onInput:De},null,8,["data","modelValue","checked","headers"])}),256))])])]),L.value?(u(),i("div",yt,[a("div",gt,[Vt,a("div",Dt,[(u(!0),i(C,null,N(L.value,s=>{var g;return u(),ee(n,{data:s,modelValue:G.value,"onUpdate:modelValue":t[1]||(t[1]=Q=>G.value=Q),checked:(s==null?void 0:s.value)===((g=G.value)==null?void 0:g.value),type:"",name:"operating_system"},{default:Y(()=>[s.imageUrl?(u(),i("img",{key:0,src:s.imageUrl,alt:s.name},null,8,Pt)):z("",!0)]),_:2},1032,["data","modelValue","checked"])}),256))])])])):z("",!0),a("div",Bt,[a("div",Ct,[Ot,a("div",wt,[(u(!0),i(C,null,N(fe.value,s=>(u(),ee(n,{data:s,checked:(s==null?void 0:s.value)===te,modelValue:te,"onUpdate:modelValue":t[2]||(t[2]=g=>te=g),type:"",name:"region"},null,8,["data","checked"]))),256))])])]),U(Ge,{title:"Информация о сервере",modelValue:E.value,"onUpdate:modelValue":t[3]||(t[3]=s=>E.value=s)},null,8,["modelValue"]),U(je,{contractID:E.value,scheme:$.value,serviceID:"30000",isOrderID:!1,onSelect:ge,isBalancePay:oe.value,"onUpdate:isBalancePay":t[4]||(t[4]=s=>oe.value=s)},null,8,["contractID","scheme","isBalancePay"])]),services:Y(()=>{var s;return[U(Te,{modelValue:R.value,"onUpdate:modelValue":t[5]||(t[5]=g=>R.value=g),serviceSearchParams:{ServiceID:"30000",ServersGroupID:(s=$.value)==null?void 0:s.ServersGroupID}},null,8,["modelValue","serviceSearchParams"])]}),_:1},8,["modelValue"]),a("div",Et,[a("div",xt,[a("div",Nt,[((_=(b=(r=h.value)==null?void 0:r.discounts)==null?void 0:b.Bonuses)==null?void 0:_.length)>0?(u(),i(C,{key:0},[a("div",Ut,[At,a("div",$t,m(F((k=h.value)==null?void 0:k.price))+" ₽",1)]),(u(!0),i(C,null,N((w=(V=h.value)==null?void 0:V.discounts)==null?void 0:w.Bonuses,s=>(u(),i("div",Lt,[a("div",Ft,"Скидка "+m(s==null?void 0:s.Discount)+"% на "+m(s==null?void 0:s.Days)+" дней",1),a("div",Rt,"-"+m(F(s==null?void 0:s.Economy))+" ₽",1)]))),256))],64)):z("",!0),a("div",Gt,[Mt,a("div",Tt,m(Z.value)+" ₽",1)]),(u(!0),i(C,null,N(R.value,s=>{var g;return u(),i("div",jt,[a("div",Kt,m((g=ce.value[s==null?void 0:s.ServiceID])==null?void 0:g.Name),1),a("div",qt,m(ue(s==null?void 0:s.Price))+" ₽",1)])}),256)),me(a("div",Ht,[zt,a("div",Wt,[a("span",null,[a("s",null,m(F((x=h.value)==null?void 0:x.price))+" ₽",1)]),a("span",Xt,"-"+m(F(J()))+" ₽",1)])],512),[[he,((q=(K=(j=h.value)==null?void 0:j.discounts)==null?void 0:K.Bonuses)==null?void 0:q.length)>0]]),me(a("div",Zt,[a("div",Jt,"Итого за "+m((H=h.value)==null?void 0:H.label),1),a("div",Qt,m(F(((ie=h.value)==null?void 0:ie.price)-J()+ +Z.value))+" ₽",1)],512),[[he,(ve=h.value)==null?void 0:ve.price]])]),U(d,{class:"btn--wide",label:Ie.value,disabled:h.value===null||E.value===null,"is-loading":W.value,onClick:t[7]||(t[7]=s=>_e())},null,8,["label","disabled","is-loading"])])])])],64)}}},ya=ae(Yt,[["__scopeId","data-v-f15698f7"]]);export{ya as default};
