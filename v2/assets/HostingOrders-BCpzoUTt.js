import{_ as ae}from"./EmptyStateBlock-D6U_EDq6.js";import{_ as re}from"./HostingCard-DJbT_GM1.js";import{_ as le}from"./FormInputSearch-D7D7Vqhf.js";import{_ as ie}from"./ClausesKeeper-DVJgfLR3.js";import{m as ue}from"./bootstrap-vue-next-3DpAa4tb.js";import{_ as ce,a as me}from"./IconButtonBack-D0IRTKQ9.js";import{_ as de}from"./ButtonDefault-CghIUDY0.js";import{_ as pe,f as _e}from"./BlockBalanceAgreement-2iQbaweR.js";import{u as fe,r as m,D,x as ve,f as O,H as ge,c as p,b as a,a as r,C as _,h as H,t as f,w as b,E as we,P as he,v as B,F as N,i as Se,d as be,o as n,e as M}from"./index-CipWZKo_.js";import{s as ke}from"./multiselect-DWCHRlfT.js";import{u as xe}from"./hosting-Fz3P7c2t.js";import{u as ye}from"./contracts-CILh9uSu.js";import{u as Ce}from"./testTransforms-CtLjUrql.js";import{u as Ie}from"./global-Fil99La8.js";import{_ as De}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StatusBadge-B65ys1I-.js";import"./IconLink--V9HJ_tV.js";import"./CardButton-Ym2KFbPf.js";import"./ServerStatusBadge.vue_vue_type_script_setup_true_lang-6rZqTOev.js";import"./IconDots-BE2XsWZ6.js";import"./Helper-BWCpStXX.js";import"./IconCard-jY7IitfY.js";import"./time-DenPiOX5.js";import"./IconPlus-bAw7b_ly.js";import"./IconClose-ChC2G6HM.js";const Oe={class:"tw-px-4 md:tw-px-8"},He={class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-2 tw-mb-4"},Be={class:"tw-flex tw-items-center tw-gap-2"},Ve={key:0,class:"tw-flex tw-items-center tw-gap-2"},$e={key:1,class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-4 tw-my-4"},Pe={class:"list-form"},Le={class:"list-form_col list-form_col--sm"},Ne={class:"list-form_select"},Me={class:"multiselect-option"},Ue={key:0,class:"tw-my-6 tw-space-y-4"},Te={__name:"HostingOrders",async setup(je){let i,u;const d=xe(),U=fe(),k=ye(),V=Ie(),x=be(),{formDescriptionLine:y}=Ce(),v=m("*"),g=m(null),l=m(!1),w=m([]),C=m(null),I=m(!1),h=ve("emitter");[i,u]=D(()=>d.fetchHostingOrders()),await i,u(),[i,u]=D(()=>d.fetchHostingSchemes()),await i,u(),[i,u]=D(()=>k.fetchContracts()),await i,u(),h.on("updateHostingList",()=>{d.fetchHostingOrders()});const c=O(()=>Object.values(d.hostingList).reverse()),$=O(()=>{let t=[{value:"*",name:"Все договора"}];return c.value!==null?(c.value.forEach(e=>{t.find(s=>s.value===e.ContractID)||t.push({value:e.ContractID,name:k.contractsList?.[e?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}}),S=O(()=>J(z(c.value))),T=t=>{w.value=t};async function j(){const t=Object.keys(w.value).filter(s=>w.value[s]),e={ServiceID:1e4,ItemsPay:C.value,OrdersIDs:t,...I.value&&{UseBalance:"yes"}};await V.OrdersPay(e).then(s=>{s==="Basket"?x.push("/Basket"):s?.Status==="Ok"&&(l.value=!1,h.emit("open-modal",{component:"BalanceProlong",data:{Message:s?.Message,Count:s?.Count}}))})}function A(){l.value=!0}function E(){l.value=!1}function R(){x.go(0)}function F(){x.push({path:"/HostingSchemes"})}function q(t,e){h.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить хостинг #${e}?`,tableID:"HostingOrders",successEmit:"updateHostingList"}})}function G(t){h.emit("open-modal",{component:"OrdersTransfer",data:t})}function K(t){V.OrderManageHosting(t)}function z(t){return v.value!=="*"?t.filter(e=>e?.ContractID===v.value):t}function J(t){return g.value!==null?t.filter(e=>e?.Domain.toLowerCase().includes(g.value.toLowerCase())):t}function Q(t){const e=W(t?.SchemeID);return[{text:e?.Name},{text:y(e?.SchemeParams?.limit_webdomains)},{text:y(e?.SchemeParams?.limit_quota)},{text:y(e?.SchemeParams?.limit_emails)},{text:`${_e(e?.CostMonth)} в месяц`,bold:!0}]}function W(t){return d.hostingSchemes?.[t]}return ge(()=>{c.value.length<1&&F()}),(t,e)=>{const s=pe,X=ce,P=de,Y=we("router-link"),Z=me,ee=ue,te=ie,oe=le,se=re,L=ae;return n(),p(N,null,[a(s),r("div",Oe,[r("div",He,[r("div",Be,[l.value?(n(),_(X,{key:0,onClick:e[0]||(e[0]=o=>E()),class:"tw-cursor-pointer"})):H("",!0),r("h1",{class:"tw-text-xl sm:tw-text-4xl tw-cursor-pointer",onClick:e[1]||(e[1]=o=>R())},f(l.value?"Продление услуг Хостинга":"Хостинг"),1)]),l.value?H("",!0):(n(),p("div",Ve,[a(P,{class:"btn-several",label:"Продлить несколько заказов",onClick:e[2]||(e[2]=o=>A())}),a(Y,{class:"btn btn--blue btn-default",to:"/HostingSchemes"},{default:b(()=>e[8]||(e[8]=[M("Заказать",-1)])),_:1,__:[8]})])),l.value?(n(),p("div",$e,[a(Z,{class:"contr period",modelValue:C.value,"onUpdate:modelValue":e[3]||(e[3]=o=>C.value=o)},null,8,["modelValue"]),a(ee,{id:"checkbox-balance",modelValue:I.value,"onUpdate:modelValue":e[4]||(e[4]=o=>I.value=o),name:"checkbox-balance"},{default:b(()=>e[9]||(e[9]=[M(" Использовать средства с баланса ",-1)])),_:1,__:[9]},8,["modelValue"]),a(P,{label:"Продлить",onClick:e[5]||(e[5]=o=>j())})])):H("",!0)]),(n(),_(he,null,[a(te)],1024)),r("div",Pe,[r("div",Le,[r("div",Ne,[a(B(ke),{modelValue:v.value,"onUpdate:modelValue":e[6]||(e[6]=o=>v.value=o),options:$.value,disabled:$.value?.length<=1,label:"name"},{singlelabel:b(({value:o})=>[r("span",null,"# "+f(String(o.value).padStart(5,"0"))+" / "+f(o.name),1)]),option:b(({option:o})=>[r("span",Me,"# "+f(String(o.value).padStart(5,"0"))+" / "+f(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),a(oe,{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=o=>g.value=o)},null,8,["modelValue"])]),c.value&&c.value.length>0?(n(),p("div",Ue,[S.value&&S.value?.length>0?(n(!0),p(N,{key:0},Se(S.value,(o,ne)=>(n(),_(se,{key:o.OrderID,hosting:o,"user-name":`${B(U).userInfo?.Name} - ${B(k).contractsList?.[o?.ContractID]?.Customer}`,params:Q(o),"info-link":`/HostingOrders/${o?.OrderID}`,"is-last":ne===S.value.length-1,isSeveral:l.value,"selected-rows":w.value,onUpdateSelectedRows:T,onDelete:q,onTransfer:G,onManage:K},null,8,["hosting","user-name","params","info-link","is-last","isSeveral","selected-rows"]))),128)):(n(),_(L,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(n(),_(L,{key:1,class:"no-margin",label:"У Вас нет заказов на хостинг"}))])],64)}}},mt=De(Te,[["__scopeId","data-v-a575d037"]]);export{mt as default};
