import{j as Ce,o as s,c,b as p,a as n,w as N,d as H,F as P,x as O,k as d,y as C,t as ue,n as L,p as be,l as Ve,_ as Ie,u as Te,f as me,e as Pe,a7 as Ee,r as _,g as de,h as fe,O as xe,i as Ue}from"./index-5e313302.js";import{u as De}from"./contracts-3351d68f.js";import{s as pe}from"./SimpleCheckbox-cae4154c.js";import{_ as _e}from"./BasicInput-be1c88a0.js";import{P as he,T as ve,S as ie}from"./PhoneInput-a38fd441.js";import{B as ge}from"./BlockBalanceAgreement-bb87adc1.js";import{u as Re}from"./files-1da1c955.js";import{I as ke}from"./IconFile-44cc57ed.js";import{I as ye}from"./IconClose-1f889a2e.js";import{_ as we}from"./ButtonDefault-7c216fc6.js";import{f as Fe}from"./bootstrap-vue-next.es-a19a8b41.js";import{_ as Se}from"./IconClip-25c35fb1.js";import{_ as Ae}from"./ClausesKeeper-eb954229.js";/* empty css                                                                       */import"./component-6a5a025c.js";import"./multiselect-bfc29db8.js";import"./IconArrow-555f9d45.js";const j=i=>(be("data-v-765d61e2"),i=i(),Ve(),i),Be={class:"section"},Le={class:"container"},Me={class:"section-header"},qe=j(()=>n("h1",{class:"section-title"},"Создать профиль",-1)),Ne=j(()=>n("div",{class:"section-header"},[n("h2",{class:"section-block_title"},"Шаблон")],-1)),He={class:"form"},Oe={class:"form"},je={class:"form-row-wrapper"},Ke={class:"special-form-row"},ze={key:0,class:"section-header inputs-block"},Ge={class:"section-block_title"},Je={key:0,class:"form width-limit"},Qe={key:0,class:"form-field form-field--file form-field--basic"},We={class:"chat-files"},Xe={class:"chat-files__item"},Ye=["onClick"],Ze={class:"form-field form-field--file form-field--basic"},$e={class:"form-field-input__file-wrapper"},eo={class:"form-field-input__file"},oo=j(()=>n("span",null,"Прикрепить документ подтверждающий личность",-1)),lo=["innerHTML"];function ao(i,r,E,l,x,f){var w,I,F,T,S,m,A;const b=ge,V=Ce("router-link"),h=Ae,U=pe,v=_e,g=he,D=ve,t=ie,u=ke,M=ye,R=Se,k=Fe,q=we;return s(),c(P,null,[p(b),n("div",Be,[n("div",Le,[n("div",Me,[p(V,{class:"section-label",to:"/Contracts"},{default:N(()=>[H("Мои договора")]),_:1}),qe]),p(h),Ne,n("div",He,[(s(!0),c(P,null,O((I=(w=l.getConfig)==null?void 0:w.Contracts)==null?void 0:I.Types,e=>(s(),c(P,null,[(e==null?void 0:e.ProfileTemplateID)!==""?(s(),C(U,{key:0,label:e==null?void 0:e.Name,value:e==null?void 0:e.ProfileTemplateID,modelValue:l.templateValue,"onUpdate:modelValue":r[0]||(r[0]=o=>l.templateValue=o)},null,8,["label","value","modelValue"])):d("",!0)],64))),256))]),n("div",Oe,[(s(!0),c(P,null,O((A=(m=(S=(T=(F=l.getConfig)==null?void 0:F.Profiles)==null?void 0:T.Templates)==null?void 0:S[l.templateValue])==null?void 0:m.Template)==null?void 0:A.Attribs,(e,o)=>(s(),c("div",je,[n("div",Ke,[e!=null&&e.Title?(s(),c("div",ze,[n("h2",Ge,ue(e==null?void 0:e.Title),1)])):d("",!0),(e==null?void 0:e.Type)==="Input"&&(e==null?void 0:e.Check)!=="Phone"?(s(),C(v,{key:1,class:L({"special-form-input":!0,"form-field-error":l.form[o].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:l.form[o].value,"onUpdate:modelValue":a=>l.form[o].value=a,pattern:l.getFieldRegex(e==null?void 0:e.Check)},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue","pattern"])):d("",!0),(e==null?void 0:e.Type)==="Input"&&(e==null?void 0:e.Check)==="Phone"?(s(),C(g,{key:2,class:L({"special-form-input":!0,"form-field-error":l.form[o].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:l.form[o].value,"onUpdate:modelValue":a=>l.form[o].value=a,pattern:l.getPhoneRegex()},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue","pattern"])):d("",!0),(e==null?void 0:e.Type)==="TextArea"?(s(),C(D,{key:3,class:L({"special-form-input":!0,"form-field-error":l.form[o].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:l.form[o].value,"onUpdate:modelValue":a=>l.form[o].value=a},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):(e==null?void 0:e.Type)==="Select"?(s(),C(t,{key:4,class:L({"special-form-input":!0,"form-field-error":l.form[o].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,options:e==null?void 0:e.Options,modelValue:l.form[o].value,"onUpdate:modelValue":a=>l.form[o].value=a},null,8,["class","label","placeholder","necessarily","name","options","modelValue","onUpdate:modelValue"])):d("",!0)])]))),256))]),l.templateValue!==0?(s(),c("div",Je,[l.fileList.length?(s(),c("div",Qe,[n("div",We,[(s(!0),c(P,null,O(l.fileList,(e,o)=>(s(),c("div",Xe,[n("span",null,[p(u,{class:"file-icon"})]),n("span",null,ue(e==null?void 0:e.name),1),n("button",{class:"close",onClick:a=>l.removeFile(o)},[p(M)],8,Ye)]))),256))])])):d("",!0),n("label",Ze,[n("div",$e,[n("input",{ref:"fileInput",type:"file",onChange:r[1]||(r[1]=(...e)=>l.fileUpload&&l.fileUpload(...e))},null,544),n("div",eo,[p(R),oo])])]),p(k,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:l.agree,"onUpdate:modelValue":r[2]||(r[2]=e=>l.agree=e)},{default:N(()=>[H("Подтверждаю свое согласие на передачу информации в электроной форме (в том числе персональных данных) по открытым каналам связи сети Интернет")]),_:1},8,["modelValue"]),p(k,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:l.agreeHandle,"onUpdate:modelValue":r[3]||(r[3]=e=>l.agreeHandle=e)},{default:N(()=>[H("Я разрешаю передачу своих персональных данных третьим лицам, для выполнения заказанных мною услуг (регистрация доменто и т.п.)")]),_:1},8,["modelValue"])])):d("",!0),l.createProfileErrorMessage?(s(),c("div",{key:1,class:"error-message width-limit",innerHTML:l.formErrorMessage(l.createProfileErrorMessage)},null,8,lo)):d("",!0),l.templateValue!==0?(s(),C(q,{key:2,class:"width-limit","is-loading":l.createProfileResult==="pending",label:"Зарегистрировать",onClick:r[4]||(r[4]=e=>l.checkForm())},null,8,["is-loading"])):d("",!0)])])],64)}const no={components:{TextAreaLine:ve,simpleCheckbox:pe,basicInput:_e,SelectLine:ie,PhoneInput:he,IconFile:ke,IconClose:ye,BlockBalanceAgreement:ge},setup(){const i=Te(),r=De(),E=me(),l=Re(),x=Pe(),f=Ee(),b=_(!1),V=_(!1),h=_({}),U=_(null),v=_([]),g=_(null),D=_(null),t=_(0),u=de(()=>i.ConfigList),M=de(()=>{var e;return(e=E==null?void 0:E.userInfo)==null?void 0:e.Email}),R=u.value,k={};for(const e in R.Regulars)k[e]=R.Regulars[e];const q=e=>k[e]||null,w=()=>{const e=u.value;return e&&e.Regulars&&e.Regulars.Phone?new RegExp(e.Regulars.Phone):/^[0-9]{10}$/},I=e=>{e.key==="Enter"&&e.ctrlKey&&T()};fe(()=>{document.addEventListener("keyup",I)}),xe(()=>{document.removeEventListener("keyup",I)});function F(e){v.value=v.value.filter((o,a)=>a!==e)}function T(){if(b.value&&V.value){let e=new FormData;Object.keys(h.value).forEach(o=>{var a;e.append(o,(a=h.value[o])==null?void 0:a.value)}),e.append("TemplateID",t.value),e.append("Agree",b.value),e.append("AgreeHandle",V.value),v.value.forEach((o,a)=>{e.append("Document[]",o==null?void 0:o.value)}),g.value="pending",r.createNewContractFormData(e).then(o=>{var a;o.status==="success"?(g.value="success",f.query.Contract?x.push(`/Balance/${f.query.Contract}`):!f.query.Contract&&f.query.TemplateID?x.push("/Basket"):x.push("/Contracts")):(g.value="error",D.value=(a=o.data)==null?void 0:a.Exception)})}}function S(e){return""+m(e)}function m(e){return e?"<div>"+(e==null?void 0:e.String)+"</div>"+m(e==null?void 0:e.Parent):""}function A(e){var a;let o=((a=e.target.files)==null?void 0:a[0])||null;o&&(U.value.value="",l.sendFile(o).then(y=>{v.value.push({name:o==null?void 0:o.name,value:y.slice(y.lastIndexOf("^")+1,y.length)})}))}return Ue(t,()=>{var e,o,a,y,K;h.value={},Object.keys((K=(y=(a=(o=(e=u.value)==null?void 0:e.Profiles)==null?void 0:o.Templates)==null?void 0:a[t.value])==null?void 0:y.Template)==null?void 0:K.Attribs).forEach(B=>{var z,G,J,Q,W,X,Y,Z,$,ee,oe,le,ae,ne,se,re,ce,te;h.value[B]={error:!1,value:(((X=(W=(Q=(J=(G=(z=u.value)==null?void 0:z.Profiles)==null?void 0:G.Templates)==null?void 0:J[t.value])==null?void 0:Q.Template)==null?void 0:W.Attribs[B])==null?void 0:X.Value)==="%Email%"?M.value:(le=(oe=(ee=($=(Z=(Y=u.value)==null?void 0:Y.Profiles)==null?void 0:Z.Templates)==null?void 0:$[t.value])==null?void 0:ee.Template)==null?void 0:oe.Attribs[B])==null?void 0:le.Value)||null,required:((te=(ce=(re=(se=(ne=(ae=u.value)==null?void 0:ae.Profiles)==null?void 0:ne.Templates)==null?void 0:se[t.value])==null?void 0:re.Template)==null?void 0:ce.Attribs[B])==null?void 0:te.IsDuty)==="1"}})}),fe(()=>{var e,o;console.log(f),(o=(e=u.value)==null?void 0:e.Contracts)!=null&&o.Types&&f.query.TemplateID&&(t.value=f.query.TemplateID)}),{getConfig:u,templateValue:t,agreeHandle:V,agree:b,createProfileResult:g,createProfileErrorMessage:D,checkForm:T,formErrorMessage:S,form:h,fileInput:U,fileList:v,removeFile:F,fileUpload:A,getPhoneRegex:w,getFieldRegex:q,fieldRegexMap:k}}},Io=Ie(no,[["render",ao],["__scopeId","data-v-765d61e2"]]);export{Io as default};
