import{_ as L}from"./EmptyStateBlock-CV1Zaaf7.js";import{_ as R}from"./BlockOrderPayBalance-CwLP8dIN.js";import{_ as $}from"./ClausesKeeper-DEgaQ2N3.js";import{_ as j}from"./ButtonDefault-eJbeaBtE.js";import{_ as M}from"./BlockBalanceAgreement-DjWMZ940.js";import{r as C,f as D,g as U,h as V,E as g,c as r,b as _,a as e,t as c,i as T,I as w,F as S,j as q,J as O,d as z,o as i}from"./index-XtiBO-PZ.js";import{u as J}from"./contracts-BdlSA9YT.js";import{u as G}from"./services-izfy4zss.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./bootstrap-vue-next-CxxkTytZ.js";import"./component-YfTGPdLe.js";import"./globalActions-Tf2FwXht.js";import"./IconHelp-C9M5tavY.js";import"./IconClose-s_NQ_Q4c.js";const K={key:0,class:"hosting-sheme"},Q={class:"section"},W={class:"container"},X={class:"section-header"},Y={class:"section-header__wrapper"},Z={class:"section-label"},ee={key:0,class:"section"},te={class:"container"},se={class:"total-block"},oe={class:"total-block__row divider-bottom"},ae={class:"total-block__col"},le={class:"total-block__col"},ce={class:"total-block__col"},ne={class:"total-block__row total-block__row--big economy-line"},re={class:"total-block__col flex-col"},ie={class:"red"},_e={class:"total-block__row total-block__row--big"},de={class:"total-block__col"},ue={class:"total-block__col"},ve={key:1,class:"section"},me={class:"container"},pe={key:1,class:"section"},he={class:"container"},ke={__name:"AdditionalServicesProlongExtraIP",async setup(be){let d,u;const P=J(),l=G(),F=U(),x=z(),s=C(null),p=C(!1),a=D(()=>Object.keys(l?.ExtraIPOrdersList).map(o=>l?.ExtraIPOrdersList[o]).find(o=>o.OrderID===F.params.id)),h=D(()=>l?.additionalServicesScheme?.ExtraIP?Object.keys(l.additionalServicesScheme.ExtraIP).map(o=>{const t=l.additionalServicesScheme.ExtraIP[o];return{...t,value:t?.ID,name:t?.Name,cost:t?.CostDay,month:t?.CostMonth}}).filter(o=>o?.ID==a.value?.SchemeID):[]),f=D(()=>P.contractsList);function N(){console.log(s.value)}function B(){p.value=!0;const o=parseFloat(f.value[a.value.ContractID]?.Balance)>=parseFloat(v(s.value?.price-k())??0),t=h.value[0]?.cost==="0.00"&&h.value[0]?.month==="0.00",b=o||t,I=!b,y={ExtraIPOrderID:a.value.ID,DaysPay:s.value?.actualDays,IsNoBasket:b,IsUseBasket:I,PayMessage:""};l.ExtraIPOrderPay(y).then(m=>{m==="UseBasket"?x.push("/Basket"):m==="NoBasket"?x.push("/AdditionalServices"):console.error("Ошибка оплаты заказа"),p.value=!1}).catch(m=>{console.error("ExtraIPOrderPay error:",m),p.value=!1})}function v(o){return Number(o).toFixed(2)||0}function k(){let o=0;return s.value?.discounts?.Bonuses.map(t=>{o+=+t.Economy}),o}function A(o){s.value=o}return V(()=>{l.fetchAdditionalServiceScheme("ExtraIP")}),[d,u]=g(()=>l.fetchExtraIPOrders()),await d,u(),[d,u]=g(()=>l.fetchAdditionalServiceScheme("ExtraIP")),await d,u(),[d,u]=g(()=>P.fetchContracts()),await d,u(),(o,t)=>{const b=M,I=j,y=$,m=R,E=L;return i(),r(S,null,[_(b),a.value?(i(),r("div",K,[e("section",Q,[e("div",W,[e("div",X,[e("div",Y,[e("h1",{class:"section-title",onClick:t[0]||(t[0]=n=>N())},"Оплата заказа IP адреса"),_(I,{class:"btn--wide",label:parseFloat(f.value[a.value.ContractID]?.Balance)>=parseFloat(s.value?.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:s.value===null||s.value?.price===null,"is-loading":p.value,onClick:t[1]||(t[1]=n=>B())},null,8,["label","disabled","is-loading"])]),e("div",Z,c(h.value[0]?.Name),1)]),_(y)])]),_(m,{contractID:a.value?.ContractID,daysRemainded:a.value?.DaysRemainded,serviceID:"50000",scheme:h.value[0],orderID:a.value?.OrderID,isOrderID:!0,onSelect:A},null,8,["contractID","daysRemainded","scheme","orderID"]),a.value?(i(),r("section",ee,[e("div",te,[e("div",se,[s.value?.discounts?.Bonuses?.length>0?(i(),r(S,{key:0},[e("div",oe,[t[3]||(t[3]=e("div",{class:"total-block__col"},"Цена тарифа",-1)),e("div",ae,c(v(s.value?.price))+" ₽",1)]),(i(!0),r(S,null,q(s.value?.discounts?.Bonuses,n=>(i(),r("div",{class:"total-block__row no-divider",key:n?.Discount+"-"+n?.Days},[e("div",le,"Скидка "+c(n?.Discount)+"% на "+c(n?.Days)+" дней",1),e("div",ce,"-"+c(v(n?.Economy))+" ₽",1)]))),128)),w(e("div",ne,[t[4]||(t[4]=e("div",{class:"total-block__col red"},"Выгода",-1)),e("div",re,[e("span",null,[e("s",null,c(v(s.value?.price))+" ₽",1)]),e("span",ie,"-"+c(k())+" ₽",1)])],512),[[O,s.value?.discounts?.Bonuses?.length>0]])],64)):T("",!0),w(e("div",_e,[e("div",de,"Итого за "+c(s.value?.label),1),e("div",ue,c(v(s.value?.price-k()))+" ₽",1)],512),[[O,s.value?.price]]),_(I,{class:"btn--wide",label:parseFloat(f.value[a.value.ContractID]?.Balance)>=(v(s.value?.price-k())??0)?"Оплатить c баланса договора":"Добавить в корзину",disabled:s.value===null||s.value?.price===null,"is-loading":p.value,onClick:t[2]||(t[2]=n=>B())},null,8,["label","disabled","is-loading"])])])])):(i(),r("section",ve,[e("div",me,[_(E,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(i(),r("section",pe,[e("div",he,[_(E,{label:"не удалось найти заказ хостинга"})])]))],64)}}},Ne=H(ke,[["__scopeId","data-v-5a63a87e"]]);export{Ne as default};
