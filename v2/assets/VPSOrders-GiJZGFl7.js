import{_ as te}from"./EmptyStateBlock-D6U_EDq6.js";import{_ as se}from"./VPSCard-ARo181Yn.js";import{_ as oe}from"./FormInputSearch-D7D7Vqhf.js";import{_ as ae}from"./ClausesKeeper-DVJgfLR3.js";import{m as ne}from"./bootstrap-vue-next-3DpAa4tb.js";import{_ as le,a as re}from"./IconButtonBack-D0IRTKQ9.js";import{_ as me}from"./ButtonDefault-CghIUDY0.js";import{_ as ue}from"./BlockBalanceAgreement-2iQbaweR.js";import{s as ce}from"./multiselect-DWCHRlfT.js";import{G as ie,r as p,D as x,x as pe,f as d,c as _,b as m,a as l,C as v,h as V,t as f,w as h,E as de,v as _e,F as N,i as ve,d as fe,o as a,e as j}from"./index-CipWZKo_.js";import{u as Se}from"./contracts-CILh9uSu.js";import{u as we}from"./global-Fil99La8.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StatusBadge-B65ys1I-.js";import"./IconLink--V9HJ_tV.js";import"./CardButton-Ym2KFbPf.js";import"./ServerStatusBadge.vue_vue_type_script_setup_true_lang-6rZqTOev.js";import"./IconDots-BE2XsWZ6.js";import"./Helper-BWCpStXX.js";import"./IconCard-jY7IitfY.js";import"./IconRotate-BbaZHZC2.js";import"./time-DenPiOX5.js";import"./IconPlus-bAw7b_ly.js";import"./IconClose-ChC2G6HM.js";const ge={class:"tw-px-4 md:tw-px-8"},Ve={class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-2 tw-mb-4"},he={class:"tw-flex tw-items-center tw-gap-2"},ke={key:0,class:"tw-flex tw-items-center tw-gap-2"},Pe={key:1,class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-4 tw-my-4"},ye={class:"list-form"},xe={class:"list-form_col list-form_col--sm"},Ce={class:"list-form_select"},Ie={class:"multiselect-option"},De={key:0,class:"tw-space-y-4 tw-mb-6"},Be={__name:"VPSOrders",async setup($e){let u,c;const i=ie(),C=Se(),I=we(),D=fe(),S=p(null),w=p("*"),r=p(!1),b=p([]),k=p(null),P=p(!1),y=pe("emitter");[u,c]=x(()=>i.fetchVPS()),await u,c(),[u,c]=x(()=>i.fetchVPSSchemes()),await u,c(),[u,c]=x(()=>C.fetchContracts()),await u,c(),y.on("updateVPSList",()=>{i.fetchVPS()});const M=t=>{b.value=t};async function E(){const t=Object.keys(b.value).filter(o=>b.value[o]),e={ServiceID:"30000",ItemsPay:k.value,OrdersIDs:t,...P.value&&{UseBalance:"yes"}};await I.OrdersPay(e).then(o=>{o==="Basket"?D.push("/Basket"):o?.Status==="Ok"&&(r.value=!1,y.emit("open-modal",{component:"BalanceProlong",data:{Message:o?.Message,Count:o?.Count}}))})}function R(){r.value=!0}function A(){r.value=!1}const n=d(()=>Object.keys(i?.vpsList).map(t=>i?.vpsList[t])?.reverse()),F=d(()=>i.vpsSchemes),g=d(()=>H(T(n.value))),B=d(()=>C?.contractsList);function G(){D.go(0)}function T(t){return w.value!=="*"?t.filter(e=>e?.ContractID==w.value):t}function q(t){I.OrderManage(t)}function z(t,e){y.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить виртуальный сервер #${e}?`,tableID:"VPSOrders",successEmit:"updateVPSList"}})}function H(t){return S.value!==null?t.filter(e=>e?.IP.toLowerCase().includes(S.value.toLowerCase())):t}const $=d(()=>{let t=[{value:"*",name:"Все договора"}];return n.value!==null?(Object.keys(n.value).forEach(e=>{t.find(o=>o.value===n.value[e]?.ContractID)||t.push({value:n.value[e]?.ContractID,name:B.value[n.value[e]?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}});function J(t){const e=F.value?.[t.SchemeID];return[{text:`${e?.Name}`},{text:`${e?.SchemeParams?.hdd_mib?.InternalName} ${e?.SchemeParams?.hdd_mib?.Value} ${e?.SchemeParams?.hdd_mib?.Unit}`},{text:`RAM ${e?.SchemeParams?.ram_mib?.Value} ${e?.SchemeParams?.ram_mib?.Unit}`},{text:`Канал ${e?.SchemeParams?.net_bandwidth_mbitps?.Value} ${e?.SchemeParams?.net_bandwidth_mbitps?.Unit}`}]}return(t,e)=>{const o=ue,K=le,O=me,Q=de("router-link"),W=re,X=ne,Y=ae,Z=oe,ee=se,U=te;return a(),_(N,null,[m(o),l("div",ge,[l("div",Ve,[l("div",he,[r.value?(a(),v(K,{key:0,onClick:e[0]||(e[0]=s=>A())})):V("",!0),l("h1",{class:"tw-text-xl sm:tw-text-4xl tw-cursor-pointer",onClick:e[1]||(e[1]=s=>G())},f(r.value?"Продление услуг виртуальных серверов":"VPS/VDS серверы"),1)]),r.value?V("",!0):(a(),_("div",ke,[n.value.length>1?(a(),v(O,{key:0,class:"btn-several",label:"Продлить несколько заказов",onClick:e[2]||(e[2]=s=>R())})):V("",!0),m(Q,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:h(()=>e[8]||(e[8]=[j("Заказать",-1)])),_:1,__:[8]})])),r.value?(a(),_("div",Pe,[m(W,{class:"contr period",modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=s=>k.value=s)},null,8,["modelValue"]),m(X,{id:"checkbox-balance",modelValue:P.value,"onUpdate:modelValue":e[4]||(e[4]=s=>P.value=s),name:"checkbox-balance"},{default:h(()=>e[9]||(e[9]=[j(" Использовать средства с баланса ",-1)])),_:1,__:[9]},8,["modelValue"]),m(O,{label:"Продлить",onClick:e[5]||(e[5]=s=>E())})])):V("",!0)]),m(Y),l("div",ye,[l("div",xe,[l("div",Ce,[m(_e(ce),{modelValue:w.value,"onUpdate:modelValue":e[6]||(e[6]=s=>w.value=s),options:$.value,disabled:$.value?.length<=1,label:"name"},{singlelabel:h(({value:s})=>[l("span",null," # "+f(String(s.value).padStart(5,"0"))+" / "+f(s.name),1)]),option:h(({option:s})=>[l("div",Ie,"# "+f(String(s.value).padStart(5,"0"))+" / "+f(s.name),1)]),_:1},8,["modelValue","options","disabled"])])]),m(Z,{modelValue:S.value,"onUpdate:modelValue":e[7]||(e[7]=s=>S.value=s)},null,8,["modelValue"])]),n.value&&n.value?.length>0?(a(),_("div",De,[g.value&&g.value?.length>0?(a(!0),_(N,{key:0},ve(g.value,(s,L)=>(a(),v(ee,{key:s.OrderID||L,vps:s,"is-last":L===g.value.length-1,"user-name":B.value[s?.ContractID]?.Customer,params:J(s),isSeveral:r.value,"selected-rows":b.value,onUpdateSelectedRows:M,onDelete:z,onManage:q},null,8,["vps","is-last","user-name","params","isSeveral","selected-rows"]))),128)):(a(),v(U,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(a(),v(U,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])],64)}}},st=be(Be,[["__scopeId","data-v-bf7829b0"]]);export{st as default};
