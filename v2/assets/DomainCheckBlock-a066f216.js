import{o as d,c as t,a as s,b as y,F as T,x as R,n as V,ac as W,t as r,k as b,w as H,T as K,y as Q,p as j,l as G,_ as J,r as _,h as X,e as Y,a7 as $,g as oo,i as x,O as no,C as Z}from"./index-4466e2da.js";import{u as eo}from"./domain-0e9ce7fa.js";import{s as ao}from"./multiselect-a1f1bb25.js";import{E as so}from"./EmptyStateBlock-1f67284f.js";import{b as co,f as lo}from"./bootstrap-vue-next.es-61f2820f.js";import{I as io}from"./IconClose-96271d50.js";import{_ as to}from"./ButtonDefault-18fa1414.js";const ro=u=>(j("data-v-7ee2b53c"),u=u(),G(),u),_o={class:"section"},uo={class:"container"},vo={class:"domain-block"},fo=ro(()=>s("div",{class:"section-title"},[s("h2",{class:"section-block_title"},"Проверить домен")],-1)),ho={class:"domain-field"},mo={key:0,class:"domain__grid"},po=["onClick"],ko={class:"domain__item-wrapper"},yo={class:"domain__item-info__title"},Do={class:"domain__item-info__text"},Io={class:"domain__info-wrapper"},No={class:"domain__info-wrapper-vertical"},wo={class:"domain__info-wrapper"},Co={class:"domain__info-title"},go={class:"domain__info-title"},bo={class:"domain__package-name"},xo={key:1,class:"domain__loader"},Lo={key:1,class:"domain__info-wrapper"},So={class:"domain__price"},Eo={class:"domain__price-order"},Fo={class:"domain__price-prolong"};function Bo(u,v,w,a,L,C){var k;const i=co,g=to,p=io,D=lo,f=so;return d(),t("div",_o,[s("div",uo,[s("div",vo,[fo,s("div",ho,[y(i,{modelValue:a.domainName,"onUpdate:modelValue":v[0]||(v[0]=o=>a.domainName=o),placeholder:"Например, yourName",type:"text"},null,8,["modelValue"]),y(g,{label:"Подобрать",disabled:!a.domainName,onClick:v[1]||(v[1]=o=>a.checkDomain())},null,8,["disabled"])]),a.isListLoaded?(d(),t(T,{key:0},[((k=a.domainsArray)==null?void 0:k.length)>0?(d(),t("div",mo,[(d(!0),t(T,null,R(a.domainsArray,o=>(d(),t("div",{class:V(["domain__item",{domain__item_inactive:(o==null?void 0:o.isFree)===!1||(o==null?void 0:o.isFree)===null,domain__item_active:a.selectedDomain.some(c=>c.ID===o.ID)}]),onClick:c=>{a.selectDomain(o),a.checkInfo(o==null?void 0:o.info)}},[o!=null&&o.info&&a.selectedDomainInfo===(o==null?void 0:o.info)?(d(),t("div",{key:0,class:"domain__item-info",onClick:v[2]||(v[2]=W(()=>{},["stop"]))},[s("div",ko,[s("div",yo,"Данные домена "+r(a.checkedDomain)+"."+r(o==null?void 0:o.Name),1),y(p,{class:"domain__item-icon",onClick:c=>a.checkInfo(o==null?void 0:o.info)},null,8,["onClick"])]),s("pre",Do,r(o==null?void 0:o.info),1)])):b("",!0),s("div",Io,[s("div",No,[s("div",wo,[s("div",Co,r(a.checkedDomain),1),s("div",go,"."+r(o==null?void 0:o.Name),1)]),s("div",bo,r(o==null?void 0:o.PackageID),1)]),y(K,{name:"fade",mode:"out-in"},{default:H(()=>[(o==null?void 0:o.isFree)!==null?(d(),t("div",{key:0,class:V(["domain__info-status",{available:(o==null?void 0:o.isFree)===!0}])},r(o!=null&&o.isFree?"Свободен":"Занят"),3)):(d(),t("div",xo))]),_:2},1024)]),o!=null&&o.isFree?(d(),t("div",Lo,[s("div",So,[s("div",Eo,r(o==null?void 0:o.CostOrder)+" ₽ / год",1),s("div",Fo,"Продление: "+r(o==null?void 0:o.CostProlong)+" ₽",1)]),y(D,{class:"domain__checkbox",checked:a.selectedDomain.some(c=>c.ID===o.ID),onChange:c=>a.toggleDomain(o)},null,8,["checked","onChange"])])):b("",!0)],10,po))),256))])):(d(),Q(f,{key:1,class:"domain__empty",label:"Неправильное доменное имя"}))],64)):b("",!0)])])])}const Ao={components:{Multiselect:ao},props:{search:{type:String,default:""},domainList:{type:Array,default:()=>[]}},emits:["select"],setup(u,{emit:v}){const w=eo(),a=_(u.search);X(()=>u.search,e=>{a.value=e,e&&N()});const L=Y(),C=$(),i=_(null);C.query.DomainName&&(i.value=C.query.DomainName,N());const g=_(null),p=_(null),D=_(!1),f=_(null),k=_(!1),o=_([]),c=_([]),S=e=>{e.key==="Enter"&&!E.value&&N()},E=oo(()=>!i.value);x(()=>{document.addEventListener("keyup",S)}),no(()=>{document.removeEventListener("keyup",S)});let F=e=>{e.key==="Escape"&&(f.value=null)};function q(){L.replace({query:{DomainName:i.value}})}function U(e){f.value===e?f.value=null:f.value=e}function z(e){B(e)}function I(){const e=document.querySelector(".domain__info-title");e&&(k.value=e.scrollWidth>e.clientWidth)}function N(){q(),w.DomainNameCheck({DomainName:i.value}).then(e=>{var A;const{result:h,resultData:n}=e;if(n!=null&&n.DomainName&&(i.value=n.DomainName,p.value=n.DomainName),n!=null&&n.Zones){o.value=u.domainList.filter(l=>{var m;return((m=n==null?void 0:n.Zones)==null?void 0:m.includes(l==null?void 0:l.Name))&&(l==null?void 0:l.IsActive)}).sort((l,m)=>(n==null?void 0:n.Zones.indexOf(l==null?void 0:l.Name))-(n==null?void 0:n.Zones.indexOf(m==null?void 0:m.Name))).map(l=>({...l,isFree:null,info:h.Info})),D.value=!0;let O=0;const P=setInterval(()=>{M(O),O++},100);setTimeout(()=>{clearInterval(P)},((A=o.value)==null?void 0:A.length)*100)}else o.value=[]})}function M(e){var h;w.DomainCheck({DomainName:p.value,DomainZone:(h=o.value[e])==null?void 0:h.Name}).then(n=>{o.value[e]={...o.value[e],isFree:n.status==="SUCCESS",info:n.info}}).catch(n=>{console.error("An error occurred:",n)})}function B(e){if(e.isFree){const h=c.value.findIndex(n=>n.ID===e.ID);h===-1?c.value.push(e):c.value.splice(h,1),v("select",c.value.map(n=>({...n,line:i.value}))),console.log("Selected Domains:",c.value)}}return x(()=>{I(),window.addEventListener("resize",I)}),Z(()=>{window.removeEventListener("resize",I)}),x(()=>{window.addEventListener("keydown",F)}),Z(()=>{window.removeEventListener("keydown",F)}),{domainName:i,isListLoaded:D,checkedDomain:p,domain:g,domainsArray:o,selectedDomain:c,selectDomain:B,checkDomain:N,isTextOverflow:k,checkTextOverflow:I,buttonDisabled:E,checkInfo:U,selectedDomainInfo:f,toggleDomain:z}}},Mo=J(Ao,[["render",Bo],["__scopeId","data-v-7ee2b53c"]]);export{Mo as D};
