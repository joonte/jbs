import{j as V,o as f,c as g,a as c,b as _,w as m,d as O,t as v,F as A,x as H,k as K,_ as j,y as U,p as Q,l as W,r as N,e as X,S as Y,g as w,h as Z}from"./index-642cdac5.js";import{u as $}from"./dedicatedServer-2accfe16.js";import{u as ee}from"./contracts-16ef7000.js";import{I as te}from"./IconSearch-f354c728.js";import{_ as oe}from"./HelperComponent-73967625.js";import{S as F}from"./StatusBadge-52b4bbab.js";import{I as ae}from"./IconRotate-4f01c174.js";import{f as R}from"./useTimeFunction-8602dd60.js";import"./resetServer-c8d5043b.js";import{z as se,k as ne,d as re}from"./bootstrap-vue-next.es-9ff54498.js";import{_ as ce}from"./IconDots-24f2aa45.js";import{_ as le}from"./IconCard-b302365f.js";import{_ as de}from"./OrderIDBadge-d3607d65.js";import{S as ie}from"./Select2-28406c99.js";import{s as _e}from"./multiselect-bb2ec7ab.js";import{_ as z}from"./FormInputSearch-7a23b402.js";import{B as G}from"./BlockBalanceAgreement-ccba2ab2.js";import{u as ue}from"./globalActions-c9fc22a3.js";import{E as me}from"./EmptyStateBlock-1861cff5.js";import{_ as fe}from"./ClausesKeeper-12bc5d50.js";import"./ButtonDefault-eb076df2.js";import"./IconArrow-c0196cbe.js";import"./IconPlus-08c75518.js";import"./IconClose-f1b85910.js";const De={class:"hosting-item"},pe={class:"hosting-item__row"},ve={class:"hosting-item__date"},Ie={class:"hosting-item__row"},ge={class:"hosting-item__person"},he={key:0,class:"hosting-item__row"},Se={class:"hosting-item__list"},Ce=["innerHTML"],be={class:"hosting-item__controls"},we={class:"btn btn--dots"};function Oe(l,a,n,o,p,L){var I,d,b,P,B,x,t,e;const r=de,s=V("router-link"),u=F,h=V("Helper"),y=le,k=ce,D=se,S=ne,C=re;return f(),g("div",De,[c("div",pe,[_(r,{orderID:(I=n.itemData)==null?void 0:I.OrderID},null,8,["orderID"]),_(s,{class:"hosting-item__name",to:`/DSOrders/${n.itemData.OrderID}`},{default:m(()=>[O(v(n.itemData.IP),1)]),_:1},8,["to"]),_(u,{status:(d=n.itemData)==null?void 0:d.StatusID,DaysRemainded:(b=n.itemData)==null?void 0:b.DaysRemainded,"status-table":"DSOrders"},null,8,["status","DaysRemainded"]),c("div",ve,"Дата окончания "+v(o.calculateExpirationDate((P=n.itemData)==null?void 0:P.DaysRemainded))+" | "+v(((B=n.itemData)==null?void 0:B.DaysRemainded)||0)+" дн.",1)]),c("div",Ie,[c("div",ge,v((x=n.itemData)==null?void 0:x.Customer),1),_(h,{"user-notice":(t=n.itemData)==null?void 0:t.UserNotice,id:(e=n.itemData)==null?void 0:e.OrderID,position:n.isLast?"bottom":"top",emit:"updateDSOrdersList"},null,8,["user-notice","id","position"])]),n.params.length?(f(),g("div",he,[c("ul",Se,[(f(!0),g(A,null,H(n.params,i=>(f(),g("li",{innerHTML:i},null,8,Ce))),256))])])):K("",!0),c("div",be,[c("div",{class:"btn btn--md btn--bold",onClick:a[0]||(a[0]=i=>{var M;return l.$router.push(`/DSOrderPay/${(M=n.itemData)==null?void 0:M.OrderID}`)})},[_(y),O("Оплатить")]),_(C,{class:"dropdown-dots",right:""},{"button-content":m(()=>[c("div",we,[_(k)])]),default:m(()=>[_(D,null,{default:m(()=>{var i;return[_(s,{to:`DSOrders/${(i=n.itemData)==null?void 0:i.OrderID}`},{default:m(()=>[O("Дополнительная информация")]),_:1},8,["to"])]}),_:1}),_(D,{onClick:a[1]||(a[1]=i=>o.transferAccount())},{default:m(()=>[O("Передать на другой аккаунт")]),_:1}),_(S),_(D,{class:"color-red",onClick:a[2]||(a[2]=i=>o.deleteItem())},{default:m(()=>[O("Удалить")]),_:1})]),_:1})])])}const Le={components:{StatusBadge:F,IconRotate:ae,Helper:oe},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","manage"],setup(l,{emit:a}){function n(r){if(!r)return R(new Date);const s=new Date,u=new Date(s.getTime()+r*24*60*60*1e3);return R(u)}function o(){var r;a("delete",(r=l.itemData)==null?void 0:r.ID)}function p(){var r,s;a("transfer",{ServiceOrderID:(r=l.itemData)==null?void 0:r.ID,ServiceID:(s=l.itemData)==null?void 0:s.ServiceID})}function L(){var r,s,u;a("manage",{ServiceOrderID:(r=l.itemData)==null?void 0:r.ID,ServiceID:(s=l.itemData)==null?void 0:s.ServiceID,OrderID:(u=l.itemData)==null?void 0:u.OrderID})}return{deleteItem:o,orderManage:L,transferAccount:p,calculateExpirationDate:n}}},q=j(Le,[["render",Oe],["__scopeId","data-v-cb298262"]]),ye=l=>(Q("data-v-ca75e9f2"),l=l(),W(),l),ke={class:"section"},Me={class:"container"},Pe={class:"section-header"},Be={class:"section-title__nowrap"},xe=ye(()=>c("h1",{class:"section-title"},"Выделенные серверы",-1)),Ve={class:"list-form"},Ue={class:"list-form_col list-form_col--sm"},Ae={class:"list-form_select"},Te={class:"multiselect-option"},Ee={key:0};function Ne(l,a,n,o,p,L){var S,C,I;const r=G,s=V("router-link"),u=fe,h=V("Multiselect"),y=z,k=q,D=me;return f(),g(A,null,[_(r),c("div",ke,[c("div",Me,[c("div",Pe,[c("div",Be,[xe,_(s,{class:"btn btn--blue btn-default",to:"DSSchemes"},{default:m(()=>[O("Заказать")]),_:1})])]),_(u,{partition:"Header:/DSOrders"}),c("div",Ve,[c("div",Ue,[c("div",Ae,[_(h,{modelValue:o.select,"onUpdate:modelValue":a[0]||(a[0]=d=>o.select=d),options:o.getUsers,disabled:((S=o.getUsers)==null?void 0:S.length)<=1,label:"name"},{singlelabel:m(({value:d})=>[c("span",null,"# "+v(d.value.padStart(5,"0"))+" / "+v(d.name),1)]),option:m(({option:d})=>[c("div",Te,"# "+v(d.value.padStart(5,"0"))+" / "+v(d.name),1)]),_:1},8,["modelValue","options","disabled"])])]),_(y,{modelValue:o.search,"onUpdate:modelValue":a[1]||(a[1]=d=>o.search=d)},null,8,["modelValue"])]),o.getDSList&&((C=o.getDSList)==null?void 0:C.length)>0?(f(),g("div",Ee,[o.filterProducts&&((I=o.filterProducts)==null?void 0:I.length)>0?(f(!0),g(A,{key:0},H(o.filterProducts,(d,b)=>(f(),U(k,{params:o.getDSItemParam(d),"is-last":b===o.filterProducts.length-1,"item-data":d,onDelete:o.deleteItem,onTransfer:o.transferItem,onManage:o.orderManage},null,8,["params","is-last","item-data","onDelete","onTransfer","onManage"]))),256)):(f(),U(D,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(f(),U(D,{key:1,class:"no-margin",label:"У Вас нет заказов на выделенные серверы"}))])])],64)}const Re={components:{FormInputSearch:z,IconSearch:te,Select2:ie,Multiselect:_e,DSItem:q,BlockBalanceAgreement:G},async setup(){const l=N("*"),a=N(null),n=ue(),o=$(),p=ee(),L=X(),r=Y("emitter");r.on("updateDSOrdersList",()=>{o.fetchDSOrders()});const s=w(()=>{var t;return(t=Object.keys(o==null?void 0:o.DSList).map(e=>o==null?void 0:o.DSList[e]))==null?void 0:t.reverse()}),u=w(()=>o==null?void 0:o.DSSchemes),h=w(()=>p==null?void 0:p.contractsList),y=w(()=>o==null?void 0:o.DSOrderIPMI),k=w(()=>C(S(s.value)));Z(()=>{s.value.length<1&&D()});function D(){L.push({path:"/DSSchemes"})}function S(t){return l.value!=="*"?t.filter(e=>(e==null?void 0:e.ContractID)===l.value):t}function C(t){return a.value!==null?t.filter(e=>(e==null?void 0:e.Customer.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.OrderID.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.Scheme.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.IP.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.disks.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.CPU.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.ram.toLowerCase().includes(a.value.toLowerCase()))):t}function I(t){n.OrderManage(t)}const d=w(()=>{let t=[{value:"*",name:"Все договора"}];return s.value!==null&&h.value!==null?(Object.keys(s.value).forEach(e=>{var i,M,T;t.find(J=>{var E;return J.value===((E=s.value[e])==null?void 0:E.ContractID)})||t.push({value:(i=s.value[e])==null?void 0:i.ContractID,name:(T=h.value[(M=s.value[e])==null?void 0:M.ContractID])==null?void 0:T.Customer})}),t):{value:"*",name:"Все договора"}});function b(t){let e=P(t==null?void 0:t.SchemeID);e===void 0&&(e=t);let i=[];return t!=null&&t.Scheme&&i.push(t==null?void 0:t.Scheme),t!=null&&t.CPU&&i.push(t==null?void 0:t.CPU),e!=null&&e.ram&&i.push("RAM "+(e==null?void 0:e.ram)+" GB"),e!=null&&e.disks&&i.push(e==null?void 0:e.disks),e!=null&&e.CostMonth&&i.push("<b>"+(e==null?void 0:e.CostMonth)+"/ месяц</b>"),i}function P(t){var e;return(e=u.value)==null?void 0:e[t]}function B(t){r.emit("open-modal",{component:"DeleteItem",data:{id:t,message:"Вы действительно хотите удалить этот сервер?",tableID:"DSOrders",successEmit:"updateDSOrdersList"}})}function x(t){r.emit("open-modal",{component:"OrdersTransfer",data:t})}return await o.fetchDSOrders(),await o.fetchDSSchemes(),await o.fetchDSOrderIPMI(),await p.fetchContracts(),{getDSList:s,filterProducts:k,select:l,search:a,getUsers:d,getDSSchemes:u,getDSItemParam:b,getDSOrderIPMI:y,orderManage:I,deleteItem:B,transferItem:x,navigateToDSSchemes:D}}},it=j(Re,[["render",Ne],["__scopeId","data-v-ca75e9f2"]]);export{it as default};
