import{_ as ke}from"./ButtonDefault-18fa1414.js";import{_ as ge}from"./BlockOrderPayBalance-daf9a2b4.js";import{_ as X,r as g,i as Y,o as l,c,a as t,m as de,k as K,t as v,d as Se,F as I,x as O,e as ye,g as E,O as Ve,h as Ie,ag as z,b as j,Z as _e,a9 as ie,y as Q,w as De,p as Pe,l as Be,J as Ce}from"./index-4466e2da.js";import{_ as we}from"./ClausesKeeper-f5a8709e.js";import{u as xe}from"./vps-495386a4.js";import{u as Oe}from"./resetServer-40ee621e.js";import{u as $e}from"./contracts-44396072.js";import{_ as Ee}from"./BlockSelectContract-87efa8ff.js";import{B as Ue}from"./BlockBalanceAgreement-762408e5.js";import"./bootstrap-vue-next.es-61f2820f.js";import"./IconHelp-18a91e01.js";import"./globalActions-a65ed06f.js";import"./BasicInput-01abb992.js";import"./component-a637f26d.js";import"./IconClose-96271d50.js";import"./multiselect-a1f1bb25.js";import"./IconArrow-1085f1dc.js";const Ge={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},name:{type:String,default:""},type:{type:String,default:"radio"},checked:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(_,{emit:u}){const a=g(null),r=g(!1);function S(){u("update:modelValue",_.data)}function y(){r.value=!0}return Y(()=>{a.value=_.modelValue}),{inputValue:a,isIconPressed:r,onMouseEvent:y,updateValue:S}}},Le={class:"form-input_border"},Me={class:"form-input_border-label"},Ne=["name","checked"],Ae={class:"form-field__data"},Fe={key:0,class:"form-field__img"},Te=["src"],je={class:"form-field__name"},Ke={class:"form-field__desc"},Re={class:"form-field__select"};function qe(_,u,a,r,S,y){return l(),c("div",Le,[t("label",Me,[t("input",{name:a.name,type:"radio",checked:a.checked,onInput:u[0]||(u[0]=(...V)=>r.updateValue&&r.updateValue(...V))},null,40,Ne),t("div",Ae,[de(_.$slots,"default",{},()=>[a.data.img?(l(),c("div",Fe,[t("img",{src:a.data.img,alt:""},null,8,Te)])):K("",!0)],!0),t("div",je,v(a.data.name),1),t("div",Ke,[Se(v(a.data.desc)+" ",1),a.data.select?de(_.$slots,"default",{key:0},()=>[t("div",Re,[(l(!0),c(I,null,O(a.data.select,(V,n)=>(l(),c("div",{key:n,class:"form-field__select-item"},v(V.text),1))),128))])],!0):K("",!0)])])])])}const He=X(Ge,[["render",qe],["__scopeId","data-v-6ee6abfb"]]);const Je={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},headers:{type:Array,default:()=>[]},name:{type:String,default:""},checkbox:{type:Boolean,default:!1},checked:{type:Boolean,default:!1}},emits:["update:modelValue","input"],setup(_,{emit:u}){const a=g(null),r=g(!1);function S(){u("update:modelValue",_.data),u("input",_.data)}function y(){r.value=!0}return Y(()=>{a.value=_.modelValue}),{inputValue:a,isIconPressed:r,onMouseEvent:y,updateValue:S}}},Ze={class:"form-input_border"},ze={class:"form-input_border-label"},Qe=["name","type","checked"],We={class:"form-field__data"},Xe={class:"form-field_header"};function Ye(_,u,a,r,S,y){return l(),c("div",Ze,[t("label",ze,[t("input",{name:a.name,type:a.checkbox?"checkbox":"radio",checked:a.checked,onInput:u[0]||(u[0]=(...V)=>r.updateValue&&r.updateValue(...V))},null,40,Qe),t("div",We,[(l(!0),c(I,null,O(a.headers,(V,n)=>(l(),c("div",{key:n,class:"form-field__col"},[t("span",Xe,v(V),1),t("span",null,v(a.data[n]),1)]))),128))])])])}const et=X(Je,[["render",Ye],["__scopeId","data-v-a13950e6"]]),tt="/v2/assets/oc-2-8f4c288c.jpg";const U=_=>(Pe("data-v-8d3207f6"),_=_(),Be(),_),st={class:"vps-scheme-page"},ot={class:"section"},at={class:"container"},lt=U(()=>t("div",{class:"section-header"},[t("h1",{class:"section-title"},"Заказать VPS/VDS сервер")],-1)),nt={class:"section"},ct={class:"container"},ut=U(()=>t("h2",{class:"section-block_title"},"Конфигурация",-1)),rt={class:"form-column"},dt={class:"form-header"},_t={class:"form-header_col"},it={key:0,class:"section"},vt={class:"container"},pt=U(()=>t("h2",{class:"section-block_title"},"Операционная система",-1)),mt={class:"form grid-gorm"},ht=["src","alt"],ft={class:"section"},bt={class:"container"},kt=U(()=>t("h2",{class:"section-block_title"},"Регион",-1)),gt={class:"form"},St={class:"section"},yt={class:"container"},Vt={class:"total-block"},It={class:"total-block__row divider-bottom"},Dt=U(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),Pt={class:"total-block__col"},Bt={class:"total-block__row no-divider"},Ct={class:"total-block__col"},wt={class:"total-block__col"},xt={class:"total-block__row total-block__row--big economy-line"},Ot=U(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),$t={class:"total-block__col flex-col"},Et={class:"red"},Ut={class:"total-block__row total-block__row--big"},Gt={class:"total-block__col"},Lt={class:"total-block__col"},W="Moscow",Mt={__name:"VPSSchemes",async setup(_){let u,a;const r=xe(),S=$e(),y=Oe(),V=ye(),n=g(null),w=g(null),G=g(null),R=g(!1),h=g(null),ve=g([{img:tt,value:"Moscow",name:"Россия",desc:"Москва"}]),ee=g({PackageID:"Тариф",cpu_number:"CPU",ram_mib:"RAM",hdd_mib:"Память",net_in_mbitps:"Канал",CostMonth:"Стоимость"}),q=E(()=>Object.keys(r.vpsSchemes).map(e=>r.vpsSchemes[e])),pe=E(()=>S==null?void 0:S.contractsList),L=E(()=>q.value.find(e=>{var s;return(e==null?void 0:e.ID)===((s=h.value)==null?void 0:s.ID)})),M=E(()=>{var e;return(e=y==null?void 0:y.serverGroupsList)==null?void 0:e.ServersGroups}),$=E(()=>{var i,d;const e=((i=L.value)==null?void 0:i.OS)||[],s=((d=L.value)==null?void 0:d.OSs)||[];return e.map(p=>{const m=s.find(f=>f.Name===p);return{name:p,value:p,imageUrl:m?m.Image:""}})}),te=e=>{e.key==="Enter"&&e.ctrlKey&&!me.value&&ae()},me=E(()=>n.value===null||w.value===null);Y(()=>{console.log(L),document.addEventListener("keyup",te)}),Ve(()=>{document.removeEventListener("keyup",te)});function H(e){return Number(e).toFixed(2)||0}function se(){var s,i;let e=0;return(i=(s=n.value)==null?void 0:s.discounts)==null||i.Bonuses.map(d=>{e+=+d.Economy}),e}Ie(h,e=>{n.value=e,J(),console.log(L)});function oe(e){var s,i,d,p,m,f,b,k;return{ID:e==null?void 0:e.ID,PackageID:e==null?void 0:e.PackageID,ServersGroupID:e==null?void 0:e.ServersGroupID,cpu_number:(i=(s=e==null?void 0:e.SchemeParams)==null?void 0:s.cpu_number)==null?void 0:i.Value,ram_mib:(p=(d=e==null?void 0:e.SchemeParams)==null?void 0:d.ram_mib)==null?void 0:p.Value,hdd_mib:(f=(m=e==null?void 0:e.SchemeParams)==null?void 0:m.hdd_mib)==null?void 0:f.Value,net_in_mbitps:(k=(b=e==null?void 0:e.SchemeParams)==null?void 0:b.net_in_mbitps)==null?void 0:k.Value,CostMonth:e==null?void 0:e.CostMonth}}function he(){var i,d,p,m,f,b;let e=(p=Object.keys((d=M.value)==null?void 0:d[(i=h.value)==null?void 0:i.ServersGroupID]))==null?void 0:p.find(k=>{var D,P,B,C,N,A,F,T;return((C=(B=(P=M.value)==null?void 0:P[(D=h.value)==null?void 0:D.ServersGroupID])==null?void 0:B[k])==null?void 0:C.IsActive)&&((T=(F=(A=M.value)==null?void 0:A[(N=h.value)==null?void 0:N.ServersGroupID])==null?void 0:F[k])==null?void 0:T.IsDefault)}),s=(b=Object.keys((f=M.value)==null?void 0:f[(m=h.value)==null?void 0:m.ServersGroupID]))==null?void 0:b.find(k=>{var D,P,B,C;return(C=(B=(P=M.value)==null?void 0:P[(D=h.value)==null?void 0:D.ServersGroupID])==null?void 0:B[k])==null?void 0:C.IsActive});return e||s}function fe(e){n.value=e}function ae(){var e,s;R.value=!0,r.VPSOrder({ContractID:w.value,VPSSchemeID:(e=h.value)==null?void 0:e.ID,ServerID:he(),DiskTemplate:(s=G.value)==null?void 0:s.value}).then(({result:i,info:d,error:p})=>{var m;i==="SUCCESS"?r.VPSOrderPay({VPSOrderID:d==null?void 0:d.VPSOrderID,DaysPay:(m=n.value)==null?void 0:m.actualDays,IsChange:!0}).then(f=>{let{result:b,error:k}=f;b==="SUCCESS"?V.push("/VPSOrders"):b==="BASKET"&&V.push("/Basket"),R.value=!0}):R.value=!1})}const be=e=>{Ce(()=>{const s=document.querySelector(".form-input_border-label input:checked~.form-field__content");s&&s.click(),J()})};function J(){var e,s;((e=$==null?void 0:$.value)==null?void 0:e.length)>0&&(G.value=(s=$.value)==null?void 0:s[0])}return[u,a]=z(()=>r.fetchVPSSchemes().then(()=>{var e,s;((e=q.value)==null?void 0:e.length)>0&&(h.value=oe((s=q.value)==null?void 0:s[0])),J()})),await u,a(),[u,a]=z(()=>S.fetchContracts()),await u,a(),[u,a]=z(()=>y.fetchServerGroups()),await u,a(),(e,s)=>{var b,k,D,P,B,C,N,A,F,T,le,ne,ce,ue,re;const i=we,d=et,p=He,m=ge,f=ke;return l(),c(I,null,[j(Ue),t("div",st,[t("div",ot,[t("div",at,[lt,j(i)])]),t("div",nt,[t("div",ct,[ut,t("div",rt,[t("div",dt,[(l(!0),c(I,null,O(ee.value,o=>(l(),c("div",_t,v(o),1))),256))]),(l(!0),c(I,null,O(q.value,o=>{var x;return l(),Q(d,{data:oe(o),type:"",modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=Z=>h.value=Z),name:"config",checked:((x=h.value)==null?void 0:x.ID)===(o==null?void 0:o.ID),headers:ee.value,onInput:be},null,8,["data","modelValue","checked","headers"])}),256))])])]),$.value?(l(),c("div",it,[t("div",vt,[pt,t("div",mt,[(l(!0),c(I,null,O($.value,o=>{var x;return l(),Q(p,{data:o,modelValue:G.value,"onUpdate:modelValue":s[1]||(s[1]=Z=>G.value=Z),checked:(o==null?void 0:o.value)===((x=G.value)==null?void 0:x.value),type:"",name:"operating_system"},{default:De(()=>[o.imageUrl?(l(),c("img",{key:0,src:o.imageUrl,alt:o.name},null,8,ht)):K("",!0)]),_:2},1032,["data","modelValue","checked"])}),256))])])])):K("",!0),t("div",ft,[t("div",bt,[kt,t("div",gt,[(l(!0),c(I,null,O(ve.value,o=>(l(),Q(p,{data:o,checked:(o==null?void 0:o.value)===W,modelValue:W,"onUpdate:modelValue":s[2]||(s[2]=x=>W=x),type:"",name:"region"},null,8,["data","checked"]))),256))])])]),j(Ee,{title:"Информация о сервере",modelValue:w.value,"onUpdate:modelValue":s[3]||(s[3]=o=>w.value=o)},null,8,["modelValue"]),j(m,{contractID:w.value,scheme:L.value,serviceID:"30000",isOrderID:!1,onSelect:fe},null,8,["contractID","scheme"]),t("div",St,[t("div",yt,[t("div",Vt,[((D=(k=(b=n.value)==null?void 0:b.discounts)==null?void 0:k.Bonuses)==null?void 0:D.length)>0?(l(),c(I,{key:0},[t("div",It,[Dt,t("div",Pt,v(H((P=n.value)==null?void 0:P.price))+" ₽",1)]),(l(!0),c(I,null,O((C=(B=n.value)==null?void 0:B.discounts)==null?void 0:C.Bonuses,o=>(l(),c("div",Bt,[t("div",Ct,"Скидка "+v(o==null?void 0:o.Discount)+"% на "+v(o==null?void 0:o.Days)+" дней",1),t("div",wt,"-"+v(H(o==null?void 0:o.Economy))+" ₽",1)]))),256))],64)):K("",!0),_e(t("div",xt,[Ot,t("div",$t,[t("span",null,[t("s",null,v(H((N=n.value)==null?void 0:N.price))+" ₽",1)]),t("span",Et,"-"+v(se())+" ₽",1)])],512),[[ie,((T=(F=(A=n.value)==null?void 0:A.discounts)==null?void 0:F.Bonuses)==null?void 0:T.length)>0]]),_e(t("div",Ut,[t("div",Gt,"Итого за "+v((le=n.value)==null?void 0:le.label),1),t("div",Lt,v(H(((ne=n.value)==null?void 0:ne.price)-se()))+" ₽",1)],512),[[ie,(ce=n.value)==null?void 0:ce.price]])]),j(f,{class:"btn--wide",label:((ue=pe.value[w.value])==null?void 0:ue.Balance)>((re=n.value)==null?void 0:re.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:n.value===null||w.value===null,"is-loading":R.value,onClick:s[4]||(s[4]=o=>ae())},null,8,["label","disabled","is-loading"])])])])],64)}}},ts=X(Mt,[["__scopeId","data-v-8d3207f6"]]);export{ts as default};
