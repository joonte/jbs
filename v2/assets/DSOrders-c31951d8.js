import{j as V,o as _,c as v,a as c,b as r,w as u,d as L,t as R,F as M,v as A,k as x,x as B,_ as H,p as E,l as F,r as U,R as z,g as P}from"./index-1c309346.js";import{u as G}from"./dedicatedServer-2cc92dfc.js";import{u as q}from"./contracts-7b919c67.js";import{I as J}from"./IconSearch-373e7b4f.js";import{_ as K}from"./HelperComponent-3eb94393.js";import{S as N}from"./StatusBadge-a49537d5.js";import{I as Q}from"./IconRotate-3c438b58.js";import{u as W}from"./resetServer-44295bca.js";import{z as X,k as Y,d as Z}from"./bootstrap-vue-next.es-b799f76d.js";import{_ as $}from"./IconDots-391abd93.js";import{_ as tt}from"./OrderIDBadge-afd00b65.js";import{S as et}from"./Select2-bf57061c.js";import{s as st}from"./multiselect-b7ad6876.js";import{_ as T}from"./FormInputSearch-de4e3004.js";import{E as ot}from"./EmptyStateBlock-5a6a4cd4.js";import{_ as nt}from"./ClausesKeeper-b9906182.js";import"./ButtonDefault-cd183bf8.js";import"./IconArrow-6927efe5.js";import"./IconPlus-ea6f8c21.js";import"./IconClose-7cf50ca7.js";const at={class:"hosting-item"},rt={class:"hosting-item__row"},lt={class:"hosting-item__row"},ct={class:"hosting-item__person"},dt={key:0,class:"hosting-item__row"},it={class:"hosting-item__list"},_t=["innerHTML"],ut={class:"hosting-item__controls"},ft={key:0,class:"btn btn--md btn--border btn--rotate btn--rotate_green"},mt={class:"btn btn--dots"};function Dt(l,n,s,o,p,a){var I,d,e,t,i,y,O;const f=tt,h=V("router-link"),k=N,g=V("Helper"),S=$,m=X,C=Y,b=Z;return _(),v("div",at,[c("div",rt,[r(f,{orderID:(I=s.itemData)==null?void 0:I.OrderID},null,8,["orderID"]),r(h,{class:"hosting-item__name",to:`/DSOrders/${s.itemData.OrderID}`},{default:u(()=>[L(R(s.itemData.IP),1)]),_:1},8,["to"]),r(k,{status:(d=s.itemData)==null?void 0:d.StatusID,DaysRemainded:(e=s.itemData)==null?void 0:e.DaysRemainded,"status-table":"DSOrders"},null,8,["status","DaysRemainded"])]),c("div",lt,[c("div",ct,R((t=s.itemData)==null?void 0:t.Customer),1),r(g,{"user-notice":(i=s.itemData)==null?void 0:i.UserNotice,id:(y=s.itemData)==null?void 0:y.OrderID,position:s.isLast?"bottom":"top",emit:"updateDSOrdersList"},null,8,["user-notice","id","position"])]),s.params.length?(_(),v("div",dt,[c("ul",it,[(_(!0),v(M,null,A(s.params,w=>(_(),v("li",{innerHTML:w},null,8,_t))),256))])])):x("",!0),c("div",ut,[((O=s.itemData)==null?void 0:O.StatusID)==="Active"?(_(),v("div",ft,"Включен")):x("",!0),r(b,{class:"dropdown-dots",right:""},{"button-content":u(()=>[c("div",mt,[r(S)])]),default:u(()=>{var w;return[r(m,null,{default:u(()=>{var D;return[r(h,{to:`DSOrders/${(D=s.itemData)==null?void 0:D.OrderID}`},{default:u(()=>[L("Дополнительная информация")]),_:1},8,["to"])]}),_:1}),((w=s.itemData)==null?void 0:w.StatusID)==="Active"?(_(),B(m,{key:0,onClick:n[0]||(n[0]=D=>o.serverReset())},{default:u(()=>[L("Перезагрузить")]),_:1})):x("",!0),r(m,{onClick:n[1]||(n[1]=D=>o.transferAccount())},{default:u(()=>[L("Передать на другой аккаунт")]),_:1}),r(C),r(m,{class:"color-red",onClick:n[2]||(n[2]=D=>o.deleteItem())},{default:u(()=>[L("Удалить")]),_:1})]}),_:1})])])}const vt={components:{StatusBadge:N,IconRotate:Q,Helper:K},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1}},emits:["delete","transfer"],setup(l,{emit:n}){function s(){var a;W().ServerReset((a=l.itemData)==null?void 0:a.ID)}function o(){var a;n("delete",(a=l.itemData)==null?void 0:a.ID)}function p(){var a,f;n("transfer",{ServiceOrderID:(a=l.itemData)==null?void 0:a.ID,ServiceID:(f=l.itemData)==null?void 0:f.ServiceID})}return{deleteItem:o,serverReset:s,transferAccount:p}}},j=H(vt,[["render",Dt],["__scopeId","data-v-37ac5b21"]]),pt=l=>(E("data-v-fc4a0794"),l=l(),F(),l),ht={class:"section"},It={class:"container"},gt={class:"section-header"},St={class:"section-title__nowrap"},Ct=pt(()=>c("h1",{class:"section-title"},"Выделенные серверы",-1)),bt={class:"list-form"},wt={class:"list-form_col list-form_col--sm"},Lt={class:"list-form_select"},kt={class:"multiselect-option"},yt={key:0};function Ot(l,n,s,o,p,a){var C,b,I;const f=V("router-link"),h=nt,k=V("Multiselect"),g=T,S=j,m=ot;return _(),v("div",ht,[c("div",It,[c("div",gt,[c("div",St,[Ct,r(f,{class:"btn btn--blue btn-default",to:"DSSchemes"},{default:u(()=>[L("Заказать")]),_:1})])]),r(h,{partition:"Header:/DSOrders"}),c("div",bt,[c("div",wt,[c("div",Lt,[r(k,{modelValue:o.select,"onUpdate:modelValue":n[0]||(n[0]=d=>o.select=d),options:o.getUsers,disabled:((C=o.getUsers)==null?void 0:C.length)<=1,label:"name"},{option:u(({option:d})=>[c("div",kt,R(d.name),1)]),_:1},8,["modelValue","options","disabled"])])]),r(g,{modelValue:o.search,"onUpdate:modelValue":n[1]||(n[1]=d=>o.search=d)},null,8,["modelValue"])]),o.getDSList&&((b=o.getDSList)==null?void 0:b.length)>0?(_(),v("div",yt,[o.filterProducts&&((I=o.filterProducts)==null?void 0:I.length)>0?(_(!0),v(M,{key:0},A(o.filterProducts,(d,e)=>(_(),B(S,{params:o.getDSItemParam(d),"is-last":e===o.filterProducts.length-1,"item-data":d,onDelete:o.deleteItem,onTransfer:o.transferItem},null,8,["params","is-last","item-data","onDelete","onTransfer"]))),256)):(_(),B(m,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(_(),B(m,{key:1,class:"no-margin",label:"У Вас нет заказов на выделенные серверы"}))])])}const Pt={components:{FormInputSearch:T,IconSearch:J,Select2:et,Multiselect:st,DSItem:j},async setup(){const l=U("*"),n=U(null),s=G(),o=q(),p=z("emitter");p.on("updateDSOrdersList",()=>{s.fetchDSOrders()});const a=P(()=>{var e;return(e=Object.keys(s==null?void 0:s.DSList).map(t=>s==null?void 0:s.DSList[t]))==null?void 0:e.reverse()}),f=P(()=>s==null?void 0:s.DSSchemes),h=P(()=>o==null?void 0:o.contractsList),k=P(()=>S(g(a.value)));function g(e){return l.value!=="*"?e.filter(t=>(t==null?void 0:t.ContractID)===l.value):e}function S(e){return n.value!==null?e.filter(t=>(t==null?void 0:t.Customer.toLowerCase().includes(n.value.toLowerCase()))||(t==null?void 0:t.OrderID.toLowerCase().includes(n.value.toLowerCase()))||(t==null?void 0:t.Scheme.toLowerCase().includes(n.value.toLowerCase()))||(t==null?void 0:t.IP.toLowerCase().includes(n.value.toLowerCase()))||(t==null?void 0:t.disks.toLowerCase().includes(n.value.toLowerCase()))||(t==null?void 0:t.CPU.toLowerCase().includes(n.value.toLowerCase()))||(t==null?void 0:t.ram.toLowerCase().includes(n.value.toLowerCase()))):e}const m=P(()=>{let e=[{value:"*",name:"Все договора"}];return a.value!==null&&h.value!==null?(Object.keys(a.value).forEach(t=>{var i,y,O;e.find(w=>{var D;return w.value===((D=a.value[t])==null?void 0:D.ContractID)})||e.push({value:(i=a.value[t])==null?void 0:i.ContractID,name:(O=h.value[(y=a.value[t])==null?void 0:y.ContractID])==null?void 0:O.Customer})}),e):{value:"*",name:"Все договора"}});function C(e){let t=b(e==null?void 0:e.SchemeID);t===void 0&&(t=e);let i=[];return e!=null&&e.Scheme&&i.push(e==null?void 0:e.Scheme),e!=null&&e.CPU&&i.push(e==null?void 0:e.CPU),t!=null&&t.ram&&i.push("RAM "+(t==null?void 0:t.ram)+" GB"),t!=null&&t.disks&&i.push(t==null?void 0:t.disks),t!=null&&t.CostMonth&&i.push("<b>"+(t==null?void 0:t.CostMonth)+"/ месяц</b>"),i}function b(e){var t;return(t=f.value)==null?void 0:t[e]}function I(e){p.emit("open-modal",{component:"DeleteItem",data:{id:e,message:"Вы действительно хотите удалить этот сервер?",tableID:"DSOrders",successEmit:"updateDSOrdersList"}})}function d(e){p.emit("open-modal",{component:"OrdersTransfer",data:e})}return await s.fetchDSOrders(),await s.fetchDSSchemes(),await o.fetchContracts(),{getDSList:a,filterProducts:k,select:l,search:n,getUsers:m,getDSSchemes:f,getDSItemParam:C,filterProductsByName:S,filterProductsByCategory:g,deleteItem:I,transferItem:d}}},Xt=H(Pt,[["render",Ot],["__scopeId","data-v-fc4a0794"]]);export{Xt as default};
