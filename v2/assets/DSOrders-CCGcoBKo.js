import{_ as se}from"./EmptyStateBlock-CV1Zaaf7.js";import{_ as ae}from"./DSItem-BDCu6aSn.js";import{_ as ne}from"./FormInputSearch-DhLeThyA.js";import{_ as le}from"./ClausesKeeper-DEgaQ2N3.js";import{m as re}from"./bootstrap-vue-next-CxxkTytZ.js";import{_ as ue,a as ce}from"./IconButtonBack-BwlFfJZM.js";import{_ as ie}from"./ButtonDefault-eJbeaBtE.js";import{_ as me}from"./BlockBalanceAgreement-DjWMZ940.js";import{r as d,M as de,E as g,x as _e,f as D,c as O,b as l,a,D as L,n as pe,I as h,t as v,J as b,w,G as ve,v as fe,F as $,j as Se,d as Ce,o as _,e as j}from"./index-XtiBO-PZ.js";import{u as ge}from"./contracts-BdlSA9YT.js";import{s as De}from"./multiselect-eqvbz1NV.js";import{u as he}from"./globalActions-Tf2FwXht.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IconDots-DWUcOOJk.js";import"./Helper-yVNH7dvZ.js";import"./IconCard-cFowCC2T.js";import"./StatusBadge-DoJSzeeo.js";import"./OrderIDBadge-Kd0drmnW.js";import"./time-DenPiOX5.js";import"./IconPlus-DYth91EZ.js";import"./IconClose-s_NQ_Q4c.js";const we={class:"section"},ke={class:"container"},Ie={class:"title__icon"},Oe={class:"btn__group"},Le={class:"group__several"},ye={class:"list-form"},Be={class:"list-form_col list-form_col--sm"},Ve={class:"list-form_select"},Pe={class:"multiselect-option"},Ue={key:0},xe={__name:"DSOrders",async setup(Me){let c,i;const f=d("*"),n=d(null),y=he(),m=de(),B=ge(),V=Ce(),r=d(!1),p=d([]),k=d(null),I=d(!1);[c,i]=g(()=>m.fetchDSOrders()),await c,i(),[c,i]=g(()=>m.fetchDSSchemes()),await c,i(),[c,i]=g(()=>m.fetchDSOrderIPMI()),await c,i(),[c,i]=g(()=>B.fetchContracts()),await c,i();const S=_e("emitter");S.on("updateDSOrdersList",()=>{m.fetchDSOrders()});const A=t=>{p.value=t};async function N(){console.log(p.value);const t=Object.keys(p.value).filter(s=>p.value[s]),e={ServiceID:"40000",ItemsPay:k.value,OrdersIDs:t,...I.value&&{UseBalance:"yes"}};await y.OrdersPay(e).then(s=>{s==="Basket"?(console.log("Success"),V.push("/Basket")):s?.Status==="Ok"&&(r.value=!1,S.emit("open-modal",{component:"BalanceProlong",data:{Message:s?.Message,Count:s?.Count}}))})}function R(){r.value=!0}function E(){r.value=!1}const u=D(()=>Object.keys(m.DSList).map(t=>m.DSList[t])?.reverse()),P=D(()=>B?.contractsList),C=D(()=>G(F(u.value)));function T(){V.go(0)}function F(t){return f.value!=="*"?t.filter(e=>e?.ContractID===f.value):t}function G(t){return n.value!==null?t.filter(e=>e?.Customer.toLowerCase().includes(n.value.toLowerCase())||e?.OrderID.toLowerCase().includes(n.value.toLowerCase())||e?.Scheme.toLowerCase().includes(n.value.toLowerCase())||e?.IP.toLowerCase().includes(n.value.toLowerCase())||e?.disks.toLowerCase().includes(n.value.toLowerCase())||e?.CPU.toLowerCase().includes(n.value.toLowerCase())||e?.ram.toLowerCase().includes(n.value.toLowerCase())):t}function z(t){y.OrderManage(t)}const U=D(()=>{let t=[{value:"*",name:"Все договора"}];return u.value!==null&&P.value!==null?(Object.keys(u.value).forEach(e=>{t.find(s=>s.value===u.value[e]?.ContractID)||t.push({value:u.value[e]?.ContractID,name:P.value[u.value[e]?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}});function H(t){let e=J(t?.SchemeID);e===void 0&&(e=t);let s=[];return t?.Scheme&&s.push(t?.Scheme),t?.CPU&&s.push(t?.CPU),e?.ram&&s.push("RAM "+e?.ram+" GB"),e?.disks&&s.push(e?.disks),e?.CostMonth&&s.push("<b>"+e?.CostMonth+"/ месяц</b>"),s}function J(t){return m.DSSchemes?.[t]}function q(t,e){S.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить выделенный сервер #${e}?`,tableID:"DSOrders",successEmit:"updateDSOrdersList"}})}function K(t){S.emit("open-modal",{component:"OrdersTransfer",data:t})}return(t,e)=>{const s=me,Q=ue,x=ie,W=ve("router-link"),X=ce,Y=re,Z=le,ee=ne,te=ae,M=se;return _(),O($,null,[l(s),a("section",we,[a("div",ke,[a("div",{class:pe(["section-header",r.value?"column":""])},[a("div",Ie,[a("h1",{class:"section-title",onClick:e[0]||(e[0]=o=>T())},v(r.value?"Продление услуг выделенных серверов":"Выделенные серверы"),1),h(l(Q,{onClick:e[1]||(e[1]=o=>E())},null,512),[[b,r.value]])]),h(a("div",Oe,[h(l(x,{class:"btn-several",label:"Продлить несколько заказов",onClick:e[2]||(e[2]=o=>R())},null,512),[[b,u.value.length>1]]),l(W,{class:"btn btn--blue btn-default",to:"DSSchemes"},{default:w(()=>e[8]||(e[8]=[j("Заказать",-1)])),_:1,__:[8]})],512),[[b,!r.value]]),h(a("div",Le,[l(X,{class:"contr period",modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=o=>k.value=o)},null,8,["modelValue"]),l(Y,{id:"checkbox-balance",modelValue:I.value,"onUpdate:modelValue":e[4]||(e[4]=o=>I.value=o),name:"checkbox-balance"},{default:w(()=>e[9]||(e[9]=[j(" Использовать средства с баланса ",-1)])),_:1,__:[9]},8,["modelValue"]),l(x,{label:"Продлить",onClick:e[5]||(e[5]=o=>N())})],512),[[b,r.value]])],2),l(Z,{partition:"Header:/DSOrders"}),a("div",ye,[a("div",Be,[a("div",Ve,[l(fe(De),{modelValue:f.value,"onUpdate:modelValue":e[6]||(e[6]=o=>f.value=o),options:U.value,disabled:U.value?.length<=1,label:"name"},{singlelabel:w(({value:o})=>[a("span",null," # "+v(o.value.padStart(5,"0"))+" / "+v(o.name),1)]),option:w(({option:o})=>[a("div",Pe,"# "+v(o.value.padStart(5,"0"))+" / "+v(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l(ee,{modelValue:n.value,"onUpdate:modelValue":e[7]||(e[7]=o=>n.value=o)},null,8,["modelValue"])]),u.value&&u.value?.length>0?(_(),O("div",Ue,[C.value&&C.value?.length>0?(_(!0),O($,{key:0},Se(C.value,(o,oe)=>(_(),L(te,{key:o.OrderID,params:H(o),"is-last":oe===C.value.length-1,"item-data":o,isSeveral:r.value,"selected-rows":p.value,onUpdateSelectedRows:A,onDelete:q,onTransfer:K,onManage:z},null,8,["params","is-last","item-data","isSeveral","selected-rows"]))),128)):(_(),L(M,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(_(),L(M,{key:1,class:"no-margin",label:"У Вас нет заказов на выделенные серверы"}))])])],64)}}},ot=be(xe,[["__scopeId","data-v-a54bfe67"]]);export{ot as default};
