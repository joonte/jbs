import{C as Z,F as ee}from"./bootstrap-vue-next.es-b799f76d.js";import{_ as se}from"./IconCard-ee273855.js";import{S as te}from"./StatusBadge-a49537d5.js";import{_ as le}from"./FormInputSearch-de4e3004.js";import{_ as ae}from"./ClausesKeeper-b9906182.js";import{_ as oe,e as ne,f as ue,u as ce,R as ie,r as _,g as v,af as U,o as q,c as z,a as l,b as u,w as o,t as c,L as m,Y as re,ad as pe,k as ve,p as de,l as _e}from"./index-1c309346.js";import{u as me}from"./contracts-7b919c67.js";import{u as fe}from"./services-4f3539cc.js";import{f as be,a as Se}from"./useTimeFunction-8602dd60.js";import{_ as De}from"./HelperComponent-3eb94393.js";import{s as k}from"./multiselect-b7ad6876.js";import"./IconPlus-ea6f8c21.js";import"./IconSearch-373e7b4f.js";import"./IconClose-7cf50ca7.js";import"./ButtonDefault-cd183bf8.js";import"./IconArrow-6927efe5.js";const he=[{key:"ID",label:"Заказ",variant:"td-blue",sortable:!0},{key:"ServiceID",label:"Услуга",variant:"td-gray td-order bold"},{key:"ContractID",label:"Договор",sortable:!0,variant:"td-blue"},{key:"StatusID",label:"Статус",variant:"td-gray td-order"},{key:"ExpirationDate",label:"Дата окончания",variant:"td-gray td-order"},{key:"UserNotice",label:"Примечание",variant:"td-gray td-limited"},{key:"controls",label:"",variant:"td-controls"}];const i=I=>(de("data-v-f3ec2129"),I=I(),_e(),I),Ie={class:"section"},ge={class:"container"},Ce=i(()=>l("div",{class:"section-header"},[l("h1",{class:"section-title"},"Мои заказы")],-1)),ye={class:"list-form"},Ve={class:"list-form_col list-form_col--sm"},Oe={class:"list-form_select"},ke={class:"multiselect-option"},xe={class:"list-form_col list-form_col--sm"},Le={class:"list-form_select"},we={class:"multiselect-option"},Te={class:"list-form_col list-form_col--sm"},Ue={class:"list-form_select"},Ne={class:"multiselect-option"},Re=i(()=>l("span",{class:"td-mobile"},"Заказ",-1)),Ee=i(()=>l("span",{class:"td-mobile"},"Услуга",-1)),Ae=i(()=>l("span",{class:"td-mobile"},"Договор",-1)),$e=i(()=>l("span",{class:"td-mobile"},"Комментарий",-1)),Be=i(()=>l("span",{class:"td-mobile"},"Статус",-1)),Fe=i(()=>l("span",{class:"td-mobile"},"Дата окончания",-1)),Pe={class:"btn__group"},je=["onClick"],Ye=i(()=>l("p",null,"ОПЛАТИТЬ",-1)),qe={key:0,class:"table-controls"},ze=i(()=>l("span",{class:"text-success"},"First",-1)),Ge=i(()=>l("span",{class:"text-info"},"Last",-1)),He={class:"multiselect-multiple-label"},Je={class:"multiselect-option"},Ke={__name:"Orders",async setup(I){let f,b;const g=ne(),r=ue(),C=me(),N=fe(),x=ce();ie("emitter").on("updateOrdersList",()=>{r.fetchUserOrders()});const L=_(""),S=_(10),h=_(1),G=_([10,25,50,100]),y=_("*"),V=_("*"),O=_("*"),d=v(()=>Object.keys(r==null?void 0:r.userOrders).map(t=>r==null?void 0:r.userOrders[t])),w=v(()=>{let t=d.value.filter(e=>e==null?void 0:e.ID.includes(L.value));return V.value!=="*"&&t!==null&&(t=t.filter(e=>e.ServiceID.includes(V.value))),y.value!=="*"&&t!==null&&(t=t.filter(e=>e.ContractID.includes(y.value))),O.value!=="*"&&t!==null&&(t=t.filter(e=>e.StatusID.includes(O.value))),h.value=1,t}),R=v(()=>C==null?void 0:C.contractsList),D=v(()=>N.ServicesList),E=v(()=>{let t=[{value:"*",name:"Все договора"}];return d.value!==null?(d.value.map(e=>{var a;t.find(p=>p.value===(e==null?void 0:e.ContractID))||t.push({value:e==null?void 0:e.ContractID,name:(a=R.value[e==null?void 0:e.ContractID])==null?void 0:a.Customer})}),t):{value:"*",name:"Все договора"}}),A=v(()=>{let t=[{value:"*",name:"Все услуги"}];return d.value!==null?(d.value.map(e=>{var a;t.find(p=>p.value===(e==null?void 0:e.ServiceID))||t.push({value:e==null?void 0:e.ServiceID,name:(a=D.value[e==null?void 0:e.ServiceID])==null?void 0:a.NameShort})}),t):{value:"*",name:"Все услуги"}}),H=v(()=>{var t,e;return(e=(t=x==null?void 0:x.ConfigList)==null?void 0:t.Statuses)==null?void 0:e.Orders}),$=v(()=>{let t=[{value:"*",name:"Все статусы"}];return d.value!==null?(d.value.map(e=>{var a,p;t.find(T=>T.value===(e==null?void 0:e.StatusID))||t.push({value:e==null?void 0:e.StatusID,name:((p=(a=H.value)==null?void 0:a[e==null?void 0:e.StatusID])==null?void 0:p.Name)||(e==null?void 0:e.StatusID)})}),t):{value:"*",name:"Все статусы"}});function J(t){var e,a;return((e=D.value[t])==null?void 0:e.Code)!=="Default"?((a=D.value[t])==null?void 0:a.Code)+"Orders":"Orders"}function K(t){var a;let e=(a=D.value[t.ServiceID])==null?void 0:a.Code;e==="Default"?g.push(`/AdditionalServices/${t.ID}`):g.push(`/${e}Orders/${t.ID}`)}function M(t){var a;let e=(a=D.value[t.ServiceID])==null?void 0:a.Code;e==="Default"?g.push(`/ServiceOrderPay/${t.ID}`):g.push(`/${e}OrderPay/${t.ID}`)}return[f,b]=U(()=>r.fetchUserOrders()),await f,b(),[f,b]=U(()=>C.fetchContracts()),await f,b(),[f,b]=U(()=>N.fetchServices()),await f,b(),(t,e)=>{var B,F,P,j,Y;const a=ae,p=le,T=te,Q=se,W=Z,X=ee;return q(),z("div",Ie,[l("div",ge,[Ce,u(a),l("div",ye,[u(p,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=s=>L.value=s)},null,8,["modelValue"]),l("div",Ve,[l("div",Oe,[u(m(k),{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=s=>y.value=s),options:E.value,disabled:((B=E.value)==null?void 0:B.length)<=1,label:"name"},{option:o(({option:s})=>[l("div",ke,c(s.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l("div",xe,[l("div",Le,[u(m(k),{modelValue:O.value,"onUpdate:modelValue":e[2]||(e[2]=s=>O.value=s),options:$.value,disabled:((F=$.value)==null?void 0:F.length)<=1,label:"name"},{option:o(({option:s})=>[l("div",we,c(s.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l("div",Te,[l("div",Ue,[u(m(k),{modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=s=>V.value=s),options:A.value,disabled:((P=A.value)==null?void 0:P.length)<=1,label:"name"},{option:o(({option:s})=>[l("div",Ne,c(s.name),1)]),_:1},8,["modelValue","options","disabled"])])])]),u(W,{class:"basic-table",fields:m(he),items:w.value,"show-empty":!0,"per-page":S.value,responsive:"","current-page":h.value,"empty-text":"Заказов пока нет.","empty-filtered-text":"Заказы не найдены.",onRowClicked:K},{"cell(ID)":o(s=>[Re,l("span",null,c(s.value),1)]),"cell(ServiceID)":o(s=>{var n;return[Ee,l("span",null,c((n=D.value[s.value])==null?void 0:n.NameShort),1)]}),"cell(ContractID)":o(s=>{var n;return[Ae,l("span",null,c((n=R.value[s.value])==null?void 0:n.Customer),1)]}),"cell(UserNotice)":o(s=>{var n;return[$e,u(De,{"user-notice":s.value,id:(n=s.item)==null?void 0:n.ID,emit:"updateOrdersList"},null,8,["user-notice","id"])]}),"cell(StatusID)":o(s=>{var n;return[Be,u(T,{status:s.value,"status-table":J((n=s.item)==null?void 0:n.ServiceID)},null,8,["status","status-table"])]}),"cell(ExpirationDate)":o(s=>[re(l("template",null,[Fe,l("span",null,c(m(be)(m(Se)(s.value))),1)],512),[[pe,s.value]])]),"cell(controls)":o(s=>[l("div",Pe,[l("button",{class:"btn btn-default btn--border",onClick:n=>M(s.item)},[u(Q),Ye],8,je)])]),_:1},8,["fields","items","per-page","current-page"]),((j=w.value)==null?void 0:j.length)>0?(q(),z("div",qe,[u(X,{modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=s=>h.value=s),"total-rows":(Y=w.value)==null?void 0:Y.length,"per-page":S.value,"first-number":"","last-number":""},{"first-text":o(()=>[ze]),"last-text":o(()=>[Ge]),page:o(({page:s,active:n})=>[l("span",null,c((s-1)*S.value+1)+"-"+c(s*S.value),1)]),_:1},8,["modelValue","total-rows","per-page"]),u(m(k),{class:"multiselect--white",modelValue:S.value,"onUpdate:modelValue":e[5]||(e[5]=s=>S.value=s),options:G.value,label:"name",openDirection:"top",onInput:e[6]||(e[6]=s=>h.value=1)},{singlelabel:o(({value:s})=>[l("div",He,[l("span",null,"Отображать "+c(s.value)+" строк",1)])]),option:o(({option:s})=>[l("div",Je,"Отображать "+c(s.name)+" строк",1)]),_:1},8,["modelValue","options"])])):ve("",!0)])])}}},vs=oe(Ke,[["__scopeId","data-v-f3ec2129"]]);export{vs as default};
