import{o as n,c as a,F as _,v as A,n as L,a as v,t as w,k as x,p as N,l as O,_ as R,u as T,R as V,r as j,e as W,g as b}from"./index-d4c8f165.js";import{_ as z}from"./ButtonDefault-5ca56e8e.js";import{u as E}from"./invoices-ae78448d.js";import{u as q}from"./postings-89970eb5.js";const G=o=>(N("data-v-c229531c"),o=o(),O(),o),H={class:"list-part"},J=G(()=>v("div",{class:"list-item__title"},"Выбрать платёжную систему",-1)),K={key:0,class:"list-row grid-net"},Q=["onClick"],U=["src"],X={class:"list-item__image-title"},Y={class:"modal__error"};function Z(o,y,p,s,m,I){return n(),a("div",H,[J,s.filterActiveSystems?(n(),a("div",K,[(n(!0),a(_,null,A(s.filterActiveSystems,u=>(n(),a(_,null,[(n(!0),a(_,null,A(u,e=>{var c;return n(),a(_,null,[e!=null&&e.IsActive?(n(),a("div",{key:0,class:L(["list-item",{"list-item_active":((c=s.paymentSystem)==null?void 0:c.id)===(e==null?void 0:e.ID)}]),onClick:S=>{s.paymentSystem={id:e==null?void 0:e.ID,type:e==null?void 0:e.Source},s.selectPaymentSystem()}},[v("img",{class:"list-item__image",src:e==null?void 0:e.Image},null,8,U),v("div",X,w(e==null?void 0:e.Description),1)],10,Q)):x("",!0)],64)}),256))],64))),256))])):x("",!0),v("div",Y,w(s.errorMessage),1)])}const $={components:{ButtonDefault:z},props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(o,{emit:y}){const p=T(),s=E(),m=q(),I=V("emitter"),u=j(null);W();const e=b(()=>p.ConfigList),c=j(null),S=b(()=>{var l,r;return(l=e.value)!=null&&l.PaymentSystems?Object.keys((r=e.value)==null?void 0:r.PaymentSystems).map(t=>{var i,d,f,g,D,k,h,C,P,B,M;return String((f=(d=(i=e.value)==null?void 0:i.PaymentSystems)==null?void 0:d[t])==null?void 0:f.IsActive)==="1"&&((C=(k=(D=(g=e.value)==null?void 0:g.PaymentSystems)==null?void 0:D[t])==null?void 0:k.ContractsTypes)==null?void 0:C[(h=o.data)==null?void 0:h.TypeID])==="1"?(M=(B=(P=e.value)==null?void 0:P.PaymentSystems)==null?void 0:B[t])==null?void 0:M.Collations:null}).filter(t=>t!==null):null});function F(){var l,r;c.value!==null&&s.InvoiceMake({ContractID:(l=o.data)==null?void 0:l.ItemID,PaymentSystemID:(r=c.value)==null?void 0:r.type}).then(t=>{if(t.status==="success"&&t.data&&t.data.InvoiceID){y("modalClose");const i=t.data.InvoiceID;m.InvoiceDocument({InvoiceID:i}).then(d=>{I.emit("open-modal",{component:"InvoiceDocumentBasket",data:{html:d,ID:i}})})}else u.value=t})}return{getConfig:e,errorMessage:u,filterActiveSystems:S,selectPaymentSystem:F,paymentSystem:c}}},ne=R($,[["render",Z],["__scopeId","data-v-c229531c"]]);export{ne as default};
