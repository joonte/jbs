import{j as O,o as y,c as k,a as s,t as S,b as v,w as b,p as M,l as j,_ as w,r as C,S as x,g as f,h as V}from"./index-83b4b7ba.js";import{u as B}from"./services-c044aff2.js";import{s as L}from"./multiselect-f2568231.js";import{_ as P}from"./ButtonDefault-dc248ec6.js";const h=c=>(M("data-v-95af7ce9"),c=c(),j(),c),E={class:"modal__body"},G=h(()=>s("div",{class:"list-item__title"},"Смена тарифного плана",-1)),H=h(()=>s("div",{class:"list-item__subtitle"},"Текущий тарифный план ",-1)),U=h(()=>s("div",{class:"modal__input-row"},null,-1)),W=h(()=>s("div",{class:"modal__input-label"},"Новый тарифный план",-1)),A={class:"list-form_col list-form_col--xl"},q=h(()=>s("div",{class:"search-field form-field"},null,-1)),z={class:"multiselect-multiple-label"},F={class:"multiselect-option"};function J(c,_,a,n,D,p){var i,g;const m=O("Multiselect"),u=P;return y(),k("div",E,[G,H,s("span",null,S((i=n.getDNSScheme[0])==null?void 0:i.name)+"/"+S((g=n.getDNSScheme[0])==null?void 0:g.cost),1),U,W,s("div",A,[q,v(m,{class:"multiselect--white",options:n.getDNSSchemes,type:"text",modelValue:n.selectedPackage,"onUpdate:modelValue":_[0]||(_[0]=e=>n.selectedPackage=e),placeholder:"Поиск"},{singlelabel:b(({value:e})=>[s("div",z,[s("span",null,S(e==null?void 0:e.Name)+"/"+S(e==null?void 0:e.CostMonth),1)])]),option:b(({option:e})=>[s("div",F,S(e==null?void 0:e.Name)+"/"+S(e==null?void 0:e.CostMonth),1)]),_:1},8,["options","modelValue"])]),v(u,{class:"modal__button",label:"Сменить","is-loading":n.isLoading,onClick:_[1]||(_[1]=e=>n.changeScheme())},null,8,["is-loading"])])}const K={components:{Multiselect:L},props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(c,{emit:_}){const a=B(),n=C(!1),D=C(null);x("emitter");const p=f(()=>a==null?void 0:a.DNSmanagerOrdersList),m=f(()=>{const e=p.value;if(!(!e||typeof e!="object"))return Object.keys(e).map(t=>e[t]).find(t=>{var o;return t.OrderID===((o=c.data)==null?void 0:o.DNSID)})}),u=f(()=>Object.keys(a==null?void 0:a.additionalServicesScheme.DNSmanager).map(e=>{var t,o,d;return{...a==null?void 0:a.additionalServicesScheme.DNSmanager[e],value:(t=a==null?void 0:a.additionalServicesScheme.DNSmanager[e])==null?void 0:t.ID,name:(o=a==null?void 0:a.additionalServicesScheme.DNSmanager[e])==null?void 0:o.Name,cost:(d=a==null?void 0:a.additionalServicesScheme.DNSmanager[e])==null?void 0:d.CostMonth}}).filter(e=>{var t;return(e==null?void 0:e.ID)==((t=m.value)==null?void 0:t.SchemeID)})),i=f(()=>{var d;const e=u.value[0],t=(d=Object.keys(a==null?void 0:a.additionalServicesScheme.DNSmanager).map(l=>{var r;return{...a==null?void 0:a.additionalServicesScheme.DNSmanager[l],value:(r=a==null?void 0:a.additionalServicesScheme.DNSmanager[l])==null?void 0:r.ID}}))==null?void 0:d.filter(l=>{var r,N,I;return((r=l==null?void 0:l.value)==null?void 0:r.HardServerID)===(e==null?void 0:e.HardServerID)&&(l==null?void 0:l.IsSchemeChangeable)&&(l==null?void 0:l.ID)!==((N=m.value)==null?void 0:N.SchemeID)&&(l==null?void 0:l.ServersGroupID)===((I=c.data)==null?void 0:I.ServerGroup)});return[e,...t].sort((l,r)=>l.SortID-r.SortID).map(l=>({...l,disabled:l.ID===e.ID}))});function g(){var e;n.value=!0,a.DNSmanagerOrderSchemeChange({NewSchemeID:D.value,DNSmanagerOrderID:(e=m.value)==null?void 0:e.ID}).then(t=>{let{result:o,error:d}=t;o==="SUCCESS"&&_("modalClose"),n.value=!1})}return V(()=>{var e,t,o,d;a.fetchAdditionalServiceScheme((e=c.data)==null?void 0:e.Code),a.fetchDNSmanagerOrders(),D.value=(o=(t=i.value)==null?void 0:t[1])==null?void 0:o.value,console.log((d=c.data)==null?void 0:d.Code),console.log(u.value[0]),console.log(i.value)}),{isLoading:n,getDNSSchemes:i,changeScheme:g,selectedPackage:D,getDNSScheme:u}}},Y=w(K,[["render",J],["__scopeId","data-v-95af7ce9"]]);export{Y as default};
