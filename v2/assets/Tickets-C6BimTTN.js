import{_ as Q}from"./EmptyStateBlock-Dks67PsT.js";import{L as W,a as X}from"./bootstrap-vue-next-9iQSFcL_.js";import{_ as Y}from"./StatusBadge-DroW9lKR.js";import{_ as Z}from"./FormInputSearch-CTZl1IoO.js";import{_ as ee}from"./ClausesKeeper-DtaNhp0a.js";import{_ as te}from"./BlockBalanceAgreement-ckI0MbGb.js";import{u as se}from"./edesks-4YmWMATL.js";import{am as oe,r as a,f as k,E as le,m as x,c as E,b as n,a as s,D as ae,w as l,G as ne,v as d,F as B,d as re,x as ie,o as g,e as ue,t as r}from"./index-DxPA2ffO.js";import{s as C}from"./multiselect-DxJoM0Ze.js";import{f as pe,s as me}from"./time-DenPiOX5.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IconPlus-BzyFfXEL.js";import"./IconClose-Br7S99e8.js";import"./contracts-DD2O0C6m.js";import"./ButtonDefault-tVMF5ozh.js";const de={class:"section"},_e={class:"container"},ve={class:"section-header"},fe={class:"btn__group"},be={class:"list-form"},ke={class:"list-form_col list-form_col--sm"},ge={class:"list-form_select"},De={class:"multiselect-option"},ye={class:"d-block"},Ve={class:"cell__theme"},we={class:"table-controls"},Ie={class:"multiselect-multiple-label"},Se={class:"multiselect-option"},Te={__name:"Tickets",async setup(xe){let D,y;const U=[{key:"ID",label:"Номер"},{key:"UpdateDate",label:"Дата и время",sortable:!0,variant:"td-gray td-order"},{key:"Theme",label:"Тема"},{key:"Messages",label:"Количество сообщений"},{key:"StatusID",label:"Статус",sortable:!0,variant:"td-gray td-order"}],V=se(),N=oe(),$=ie("emitter"),w=re(),u=a("*"),p=a(""),m=a(1),i=a(10),_=a(0),F=a([10,25,50,100]),v=a([]),I=a("UpdateDate"),S=a(!0),L=a("desc"),T=k(()=>V?.eDesksList),f=k(()=>N.data),c=k(()=>Object.keys(T.value)?.map(o=>T.value?.[o])?.reverse());[D,y]=le(()=>V.fetchEDesks().then(()=>{_.value=c.value.length,f.value?.Statuses?.Edesks&&(v.value=Object.keys(f.value?.Statuses?.Edesks)?.map(o=>({value:o,name:f.value?.Statuses?.Edesks?.[o]?.Name}))),v.value.push({value:"*",name:"Все тикеты"})})),await D,y();function j(){w.go(0)}function H(o){$.emit("open-modal",{component:"StatusHistory",data:{modeID:"Edesks",rowID:o}})}function O(o){return o?.filter(e=>u.value==="*"?!0:e?.StatusID===u?.value)?.filter(e=>e?.ID.includes(p.value)||e?.Theme.includes(p.value))}function R(o){return _.value=o.length>0?o.length:1,o}function A(o,e,b){b.target.closest("button, a, .clickable-element")||w.push({path:`Ticket/${o?.ID}`})}return x(p,()=>{m.value=1}),x(u,()=>{m.value=1}),(o,e)=>{const b=te,M=ne("router-link"),P=ee,h=Z,G=Y,q=W,z=X,J=Q;return g(),E(B,null,[n(b),s("section",de,[s("div",_e,[s("div",ve,[s("h1",{class:"tw-cursor-pointer",onClick:e[0]||(e[0]=t=>j())},"Служба поддержки"),s("div",fe,[n(M,{class:"btn btn--blue btn-default",to:"/NewTicket"},{default:l(()=>e[7]||(e[7]=[ue("Создать тикет",-1)])),_:1,__:[7]})])]),n(P,{partition:"Header:/Tickets"}),s("div",be,[s("div",ke,[s("div",ge,[n(d(C),{options:v.value,label:"name",modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t)},{option:l(({option:t})=>[s("div",De,r(t.name),1)]),_:1},8,["options","modelValue"])])]),n(h,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=t=>p.value=t)},null,8,["modelValue"])]),c.value&&c.value.length?(g(),E(B,{key:0},[n(q,{class:"basic-table",items:R(O(c.value)),"per-page":i.value,"current-page":m.value,fields:U,"show-empty":"","sort-by":I.value,"onUpdate:sortBy":e[3]||(e[3]=t=>I.value=t),"sort-desc":S.value,"onUpdate:sortDesc":e[4]||(e[4]=t=>S.value=t),"sort-direction":L.value,onRowClicked:A},{"cell(ID)":l(t=>[e[8]||(e[8]=s("span",{class:"td-mobile"},"Номер",-1)),s("span",ye,r(t.value),1)]),"cell(UpdateDate)":l(t=>[e[9]||(e[9]=s("span",{class:"td-mobile"},"Дата и время",-1)),s("span",null,r(d(pe)(d(me)(t.value))),1)]),"cell(Theme)":l(t=>[e[10]||(e[10]=s("span",{class:"td-mobile"},"Тема",-1)),s("span",Ve,r(t.value),1)]),"cell(MessageID)":l(t=>[e[11]||(e[11]=s("span",{class:"td-mobile"},"Количество сообщений",-1)),s("span",null,r(t.value),1)]),"cell(StatusID)":l(t=>[e[12]||(e[12]=s("span",{class:"td-mobile"},"Статус",-1)),n(G,{class:"clickable-element",status:t.value,"status-table":"Edesks",onClick:K=>H(t.item?.ID)},null,8,["status","onClick"])]),empty:l(()=>e[13]||(e[13]=[s("span",null,"Ничего не найдено",-1)])),emptyfiltered:l(()=>e[14]||(e[14]=[s("span",null,"Ничего не найдено",-1)])),_:1},8,["items","per-page","current-page","sort-by","sort-desc","sort-direction"]),s("div",we,[n(z,{modelValue:m.value,"onUpdate:modelValue":e[5]||(e[5]=t=>m.value=t),"total-rows":_.value,"per-page":i.value,"first-number":"","last-number":""},{"first-text":l(()=>e[15]||(e[15]=[s("span",{class:"text-success"},"First",-1)])),"last-text":l(()=>e[16]||(e[16]=[s("span",{class:"text-info"},"Last",-1)])),page:l(({page:t,active:K})=>[s("span",null,r((t-1)*i.value+1)+"-"+r(t*i.value),1)]),_:1},8,["modelValue","total-rows","per-page"]),n(d(C),{class:"multiselect--white",modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=t=>i.value=t),options:F.value,label:"name",openDirection:"top"},{singlelabel:l(({value:t})=>[s("div",Ie,[s("span",null,"Отображать "+r(t.value)+" строк",1)])]),option:l(({option:t})=>[s("div",Se,"Отображать "+r(t.name)+" строк",1)]),_:1},8,["modelValue","options"])])],64)):(g(),ae(J,{key:1,class:"no-margin",label:"Вы пока не обращались в тех. поддержку "}))])])],64)}}},he=ce(Te,[["__scopeId","data-v-420fa3fa"]]);export{he as default};
