import{j as V,o as D,c as C,a as c,b as i,w as f,d as L,t as h,F as U,x as R,k as Q,_ as j,S as F,y as H,p as W,l as X,r as E,e as Y,g as y,h as Z}from"./index-83b4b7ba.js";import{u as $}from"./dedicatedServer-5ad75190.js";import{u as ee}from"./contracts-623ec7a8.js";import{I as te}from"./IconSearch-30270af1.js";import{_ as oe}from"./HelperComponent-df0c894c.js";import{S as z}from"./StatusBadge-0d170ac0.js";import{I as ae}from"./IconRotate-e7e6c8d6.js";import{f as N}from"./useTimeFunction-8602dd60.js";import"./resetServer-94c466e3.js";import{z as ne,k as se,d as re}from"./bootstrap-vue-next.es-8f3ae81a.js";import{_ as ce}from"./IconDots-a66f045d.js";import{_ as le}from"./IconCard-2cc17a6b.js";import{_ as de}from"./OrderIDBadge-d89298b0.js";import{S as ie}from"./Select2-963d28df.js";import{s as ue}from"./multiselect-f2568231.js";import{_ as G}from"./FormInputSearch-48364fb5.js";import{B as q}from"./BlockBalanceAgreement-c5fad736.js";import{u as _e}from"./globalActions-633eb799.js";import{E as me}from"./EmptyStateBlock-68a1c33e.js";import{_ as fe}from"./ClausesKeeper-55c14b7f.js";import"./ButtonDefault-dc248ec6.js";import"./IconArrow-80c72216.js";import"./IconPlus-07b0a078.js";import"./IconClose-86aafc4e.js";const De={class:"hosting-item"},pe={class:"hosting-item__row"},ve={class:"hosting-item__row"},Ie={class:"hosting-item__person"},ge={class:"hosting-item__date"},he={key:0,class:"hosting-item__row"},Se={class:"hosting-item__list"},Ce=["innerHTML"],be={class:"hosting-item__controls"},we={class:"btn btn--dots"};function Oe(l,a,n,t,I,k){var S,d,O,P,B,x,o,e;const p=de,u=V("router-link"),s=z,_=V("Helper"),m=le,M=ce,v=ne,b=se,w=re;return D(),C("div",De,[c("div",pe,[i(p,{orderID:(S=n.itemData)==null?void 0:S.OrderID},null,8,["orderID"]),i(u,{class:"hosting-item__name",to:`/DSOrders/${n.itemData.OrderID}`},{default:f(()=>[L(h(n.itemData.IP),1)]),_:1},8,["to"]),i(s,{status:(d=n.itemData)==null?void 0:d.StatusID,DaysRemainded:(O=n.itemData)==null?void 0:O.DaysRemainded,"status-table":"DSOrders",onClick:a[0]||(a[0]=r=>{var g;return t.openHistoryStatuses((g=n.itemData)==null?void 0:g.ID)})},null,8,["status","DaysRemainded"])]),c("div",ve,[c("div",Ie,h((P=n.itemData)==null?void 0:P.Customer),1),c("div",ge,"Дата окончания "+h(t.calculateExpirationDate((B=n.itemData)==null?void 0:B.DaysRemainded))+" | "+h(((x=n.itemData)==null?void 0:x.DaysRemainded)||0)+" дн.",1),i(_,{"user-notice":(o=n.itemData)==null?void 0:o.UserNotice,id:(e=n.itemData)==null?void 0:e.OrderID,position:n.isLast?"bottom":"top",emit:"updateDSOrdersList"},null,8,["user-notice","id","position"])]),n.params.length?(D(),C("div",he,[c("ul",Se,[(D(!0),C(U,null,R(n.params,r=>(D(),C("li",{innerHTML:r},null,8,Ce))),256))])])):Q("",!0),c("div",be,[c("div",{class:"btn btn--md btn--bold",onClick:a[1]||(a[1]=r=>{var g;return l.$router.push(`/DSOrderPay/${(g=n.itemData)==null?void 0:g.OrderID}`)})},[i(m),L("Оплатить")]),i(w,{class:"dropdown-dots",right:""},{"button-content":f(()=>[c("div",we,[i(M)])]),default:f(()=>[i(v,null,{default:f(()=>{var r;return[i(u,{to:`DSOrders/${(r=n.itemData)==null?void 0:r.OrderID}`},{default:f(()=>[L("Дополнительная информация")]),_:1},8,["to"])]}),_:1}),i(v,{onClick:a[2]||(a[2]=r=>t.transferAccount())},{default:f(()=>[L("Передать на другой аккаунт")]),_:1}),i(b),i(v,{class:"color-red",onClick:a[3]||(a[3]=r=>t.deleteItem())},{default:f(()=>[L("Удалить")]),_:1})]),_:1})])])}const ye={components:{StatusBadge:z,IconRotate:ae,Helper:oe},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","manage"],setup(l,{emit:a}){const n=F("emitter");function t(s){if(!s)return N(new Date);const _=new Date,m=new Date(_.getTime()+s*24*60*60*1e3);return N(m)}function I(){var s;a("delete",(s=l.itemData)==null?void 0:s.ID)}function k(){var s,_;a("transfer",{ServiceOrderID:(s=l.itemData)==null?void 0:s.ID,ServiceID:(_=l.itemData)==null?void 0:_.ServiceID})}function p(s){n.emit("open-modal",{component:"StatusHistory",data:{modeID:"DSOrders",rowID:s}})}function u(){var s,_,m;a("manage",{ServiceOrderID:(s=l.itemData)==null?void 0:s.ID,ServiceID:(_=l.itemData)==null?void 0:_.ServiceID,OrderID:(m=l.itemData)==null?void 0:m.OrderID})}return{deleteItem:I,orderManage:u,transferAccount:k,calculateExpirationDate:t,openHistoryStatuses:p}}},J=j(ye,[["render",Oe],["__scopeId","data-v-8b0c4d0d"]]),Le=l=>(W("data-v-ca75e9f2"),l=l(),X(),l),ke={class:"section"},Me={class:"container"},Pe={class:"section-header"},Be={class:"section-title__nowrap"},xe=Le(()=>c("h1",{class:"section-title"},"Выделенные серверы",-1)),Ve={class:"list-form"},He={class:"list-form_col list-form_col--sm"},Ue={class:"list-form_select"},Ae={class:"multiselect-option"},Te={key:0};function Ee(l,a,n,t,I,k){var b,w,S;const p=q,u=V("router-link"),s=fe,_=V("Multiselect"),m=G,M=J,v=me;return D(),C(U,null,[i(p),c("div",ke,[c("div",Me,[c("div",Pe,[c("div",Be,[xe,i(u,{class:"btn btn--blue btn-default",to:"DSSchemes"},{default:f(()=>[L("Заказать")]),_:1})])]),i(s,{partition:"Header:/DSOrders"}),c("div",Ve,[c("div",He,[c("div",Ue,[i(_,{modelValue:t.select,"onUpdate:modelValue":a[0]||(a[0]=d=>t.select=d),options:t.getUsers,disabled:((b=t.getUsers)==null?void 0:b.length)<=1,label:"name"},{singlelabel:f(({value:d})=>[c("span",null,"# "+h(d.value.padStart(5,"0"))+" / "+h(d.name),1)]),option:f(({option:d})=>[c("div",Ae,"# "+h(d.value.padStart(5,"0"))+" / "+h(d.name),1)]),_:1},8,["modelValue","options","disabled"])])]),i(m,{modelValue:t.search,"onUpdate:modelValue":a[1]||(a[1]=d=>t.search=d)},null,8,["modelValue"])]),t.getDSList&&((w=t.getDSList)==null?void 0:w.length)>0?(D(),C("div",Te,[t.filterProducts&&((S=t.filterProducts)==null?void 0:S.length)>0?(D(!0),C(U,{key:0},R(t.filterProducts,(d,O)=>(D(),H(M,{params:t.getDSItemParam(d),"is-last":O===t.filterProducts.length-1,"item-data":d,onDelete:t.deleteItem,onTransfer:t.transferItem,onManage:t.orderManage},null,8,["params","is-last","item-data","onDelete","onTransfer","onManage"]))),256)):(D(),H(v,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(D(),H(v,{key:1,class:"no-margin",label:"У Вас нет заказов на выделенные серверы"}))])])],64)}const Ne={components:{FormInputSearch:G,IconSearch:te,Select2:ie,Multiselect:ue,DSItem:J,BlockBalanceAgreement:q},async setup(){const l=E("*"),a=E(null),n=_e(),t=$(),I=ee(),k=Y(),p=F("emitter");p.on("updateDSOrdersList",()=>{t.fetchDSOrders()});const u=y(()=>{var o;return(o=Object.keys(t==null?void 0:t.DSList).map(e=>t==null?void 0:t.DSList[e]))==null?void 0:o.reverse()}),s=y(()=>t==null?void 0:t.DSSchemes),_=y(()=>I==null?void 0:I.contractsList),m=y(()=>t==null?void 0:t.DSOrderIPMI),M=y(()=>w(b(u.value)));Z(()=>{u.value.length<1&&v()});function v(){k.push({path:"/DSSchemes"})}function b(o){return l.value!=="*"?o.filter(e=>(e==null?void 0:e.ContractID)===l.value):o}function w(o){return a.value!==null?o.filter(e=>(e==null?void 0:e.Customer.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.OrderID.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.Scheme.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.IP.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.disks.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.CPU.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.ram.toLowerCase().includes(a.value.toLowerCase()))):o}function S(o){n.OrderManage(o)}const d=y(()=>{let o=[{value:"*",name:"Все договора"}];return u.value!==null&&_.value!==null?(Object.keys(u.value).forEach(e=>{var r,g,A;o.find(K=>{var T;return K.value===((T=u.value[e])==null?void 0:T.ContractID)})||o.push({value:(r=u.value[e])==null?void 0:r.ContractID,name:(A=_.value[(g=u.value[e])==null?void 0:g.ContractID])==null?void 0:A.Customer})}),o):{value:"*",name:"Все договора"}});function O(o){let e=P(o==null?void 0:o.SchemeID);e===void 0&&(e=o);let r=[];return o!=null&&o.Scheme&&r.push(o==null?void 0:o.Scheme),o!=null&&o.CPU&&r.push(o==null?void 0:o.CPU),e!=null&&e.ram&&r.push("RAM "+(e==null?void 0:e.ram)+" GB"),e!=null&&e.disks&&r.push(e==null?void 0:e.disks),e!=null&&e.CostMonth&&r.push("<b>"+(e==null?void 0:e.CostMonth)+"/ месяц</b>"),r}function P(o){var e;return(e=s.value)==null?void 0:e[o]}function B(o){p.emit("open-modal",{component:"DeleteItem",data:{id:o,message:"Вы действительно хотите удалить этот сервер?",tableID:"DSOrders",successEmit:"updateDSOrdersList"}})}function x(o){p.emit("open-modal",{component:"OrdersTransfer",data:o})}return await t.fetchDSOrders(),await t.fetchDSSchemes(),await t.fetchDSOrderIPMI(),await I.fetchContracts(),{getDSList:u,filterProducts:M,select:l,search:a,getUsers:d,getDSSchemes:s,getDSItemParam:O,getDSOrderIPMI:m,orderManage:S,deleteItem:B,transferItem:x,navigateToDSSchemes:v}}},it=j(Ne,[["render",Ee],["__scopeId","data-v-ca75e9f2"]]);export{it as default};
