import{_ as ae}from"./EmptyStateBlock-DA3-0YDi.js";import{_ as se}from"./DomainCard-R-hadkWl.js";import{_ as le}from"./FormInputSearch-B47bjFcn.js";import{_ as re}from"./ClausesKeeper-iUM0yapS.js";import{m as ie}from"./bootstrap-vue-next-W16P-SAV.js";import{_ as me,a as ce}from"./IconButtonBack-CTMQ7Okc.js";import{_ as ue}from"./ButtonDefault-CMw2aBy6.js";import{_ as de}from"./BlockBalanceAgreement-v_bWuiVT.js";import{S as pe,E as y,r as p,f as v,o as l,c as _,b as a,a as r,K as fe,Q as ve,t as w,C as h,h as I,w as B,v as _e,F as N,g as we,x as ge,d as De,e as Se}from"./index-Codq73aV.js";import{u as ke}from"./index-BO2gwtUe.js";import{s as be}from"./multiselect-DElL0Rlw.js";import{u as ye}from"./global-CdY51QQZ.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StatusBadge-BmqDrHzy.js";import"./IconLink-D5X10WIs.js";import"./OrderIDBadge-DCIAfa63.js";import"./IconDots-BIoh_VC5.js";import"./UserNote-9g0f9gxP.js";import"./IconCard-C_8uFbeS.js";import"./CardButton-DT2I8_xv.js";import"./time-DenPiOX5.js";import"./common-DyknwSqv.js";import"./IconPlus-Bm8D3Wgq.js";import"./IconClose-Dia1noy8.js";const Ce={class:"tw-px-4 md:tw-px-8"},Oe={class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-2 tw-mb-4"},xe={class:"tw-flex tw-items-center tw-gap-2"},Ie={key:0,class:"tw-flex tw-flex-wrap tw-items-center tw-gap-2"},Be={key:1,class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-4 tw-my-4"},Ve={class:"list-form"},$e={class:"list-form_col list-form_col--sm"},Le={class:"list-form_select"},Ne={class:"multiselect-option"},Pe={key:0,class:"tw-my-6 tw-space-y-4"},Ue={__name:"DomainOrders",async setup(je){let i,m;const V=ye(),u=pe(),g=ke(),C=De(),d=ge("emitter");[i,m]=y(()=>u.fetchDomainOrders()),await i,m(),[i,m]=y(()=>u.fetchDomainSchemes()),await i,m(),[i,m]=y(()=>g.fetchContracts()),await i,m(),[i,m]=y(()=>g.fetchProfiles()),await i,m(),d.on("updateDomainsList",()=>{u.fetchDomainOrders()});const D=p("*"),f=p(null),c=p(!1),S=p([]),O=p(null),x=p(!1),P=t=>{S.value=t};async function U(){const t=Object.keys(S.value).filter(n=>S.value[n]),e={ServiceID:"20000",ItemsPay:O.value,OrdersIDs:t,...x.value&&{UseBalance:"yes"}};await V.OrdersPay(e).then(n=>{n==="Basket"?C.push("/Basket"):n?.Status==="Ok"&&(c.value=!1,d.emit("open-modal",{component:"BalanceProlong",data:{Message:n?.Message,Count:n?.Count}}))})}function j(){c.value=!0}function M(){c.value=!1}const s=v(()=>Object.keys(u?.domainsList).map(t=>u?.domainsList[t])?.reverse()),T=v(()=>u?.domainSchemes),E=v(()=>g?.contractsList),k=v(()=>F(A(s.value))),$=v(()=>{let t=[{value:"*",name:"Все договора"}];return s.value!==null?(Object.keys(s.value).forEach(e=>{t.find(n=>n.value==s.value[e]?.ContractID)||t.push({value:s.value[e]?.ContractID,name:E.value[s.value[e]?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}});function R(){C.go(0)}function A(t){return D.value!=="*"?t.filter(e=>e?.ContractID==D.value):t}function F(t){return f.value!==null?t.filter(e=>e?.Domain.toLowerCase().includes(f.value.toLowerCase())):t}function q(t){return T.value?.[t]}function G(t){return g?.contractsList?.[t]?.Customer}function H(t){V.OrderManage(t)}function K(){const t=f.value;C.push({path:"/DomainSchemes",query:{DomainName:t}})}function Q(t,e){d.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить домен #${e}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function z(t){d.emit("open-modal",{component:"OrdersTransfer",data:t})}function J(){d.emit("open-modal",{component:"DomainTransfer",data:{}})}function W(t){const e={DomainOrderID:t};d.emit("open-modal",{component:"DomainSelectOwner",data:e})}return(t,e)=>{const n=de,X=me,b=ue,Y=ce,Z=ie,ee=re,te=le,oe=se,L=ae;return l(),_(N,null,[a(n),r("div",Ce,[r("div",Oe,[r("div",xe,[fe(a(X,{onClick:e[0]||(e[0]=o=>M())},null,512),[[ve,c.value]]),r("h1",{class:"tw-text-xl sm:tw-text-4xl tw-cursor-pointer",onClick:e[1]||(e[1]=o=>R())},w(c.value?"Продление услуг Домена":"Домены"),1)]),c.value?I("",!0):(l(),_("div",Ie,[s.value.length>1?(l(),h(b,{key:0,class:"btn-several",label:"Продлить несколько заказов",onClick:e[2]||(e[2]=o=>j())})):I("",!0),a(b,{label:"Заказать",onClick:e[3]||(e[3]=o=>K())}),a(b,{label:"Перенести домен",onClick:e[4]||(e[4]=o=>J())})])),c.value?(l(),_("div",Be,[a(Y,{class:"contr period",modelValue:O.value,"onUpdate:modelValue":e[5]||(e[5]=o=>O.value=o)},null,8,["modelValue"]),a(Z,{id:"checkbox-balance",modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=o=>x.value=o),name:"checkbox-balance"},{default:B(()=>e[10]||(e[10]=[Se(" Использовать средства с баланса ",-1)])),_:1,__:[10]},8,["modelValue"]),a(b,{label:"Продлить",onClick:e[7]||(e[7]=o=>U())})])):I("",!0)]),a(ee,{partition:"Header:/DomainOrders"}),r("div",Ve,[r("div",$e,[r("div",Le,[a(_e(be),{modelValue:D.value,"onUpdate:modelValue":e[8]||(e[8]=o=>D.value=o),options:$.value,label:"name",disabled:$.value?.length<=1},{singlelabel:B(({value:o})=>[r("span",null," # "+w(String(o.value).padStart(5,"0"))+" / "+w(o.name),1)]),option:B(({option:o})=>[r("div",Ne," # "+w(String(o.value).padStart(5,"0"))+" / "+w(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),a(te,{modelValue:f.value,"onUpdate:modelValue":e[9]||(e[9]=o=>f.value=o)},null,8,["modelValue"])]),s.value&&s.value?.length>0?(l(),_("div",Pe,[k.value&&k.value?.length>0?(l(!0),_(N,{key:0},we(k.value,(o,ne)=>(l(),h(oe,{key:o?.OrderID,domain:o,"user-name":G(o?.ContractID),scheme:q(o?.SchemeID),"info-link":`/DomainOrders/${o?.OrderID}`,"is-last":ne===k.value.length-1,isSeveral:c.value,"selected-rows":S.value,onUpdateSelectedRows:P,onDelete:Q,onTransfer:z,onDesignateOwner:Me=>W(o?.ID),onManage:H},null,8,["domain","user-name","scheme","info-link","is-last","isSeveral","selected-rows","onDesignateOwner"]))),128)):(l(),h(L,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(l(),h(L,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])],64)}}},it=he(Ue,[["__scopeId","data-v-d5d1d7ab"]]);export{it as default};
