import{j as ie,o as s,c as f,b as v,a as n,w as M,d as N,F as I,v as H,k as _,x as b,t as ce,n as D,p as ke,l as be,_ as Ce,u as Ve,f as ye,e as Ie,r as h,g as te,h as Te}from"./index-d9e5d80f.js";import{u as Pe}from"./contracts-0b0db280.js";import{s as ue}from"./SimpleCheckbox-43436b0b.js";import{_ as fe}from"./BasicInput-59bbbbe3.js";import{P as de,T as pe,S as _e}from"./PhoneInput-e718ee63.js";import{B as ve}from"./BlockBalanceAgreement-bd5f9bec.js";import{u as xe}from"./files-17a134df.js";import{I as he}from"./IconFile-f4effaaa.js";import{I as ge}from"./IconClose-b8cba5ec.js";import{_ as Ee}from"./ButtonDefault-cf4dc84b.js";import{f as Ue}from"./bootstrap-vue-next.es-b0c2a08e.js";import{_ as we}from"./IconClip-1e2e0797.js";import{_ as Fe}from"./ClausesKeeper-54c941b5.js";import"./component-febbb147.js";import"./multiselect-547456cc.js";import"./IconArrow-3cf18905.js";const O=i=>(ke("data-v-0f1f98e9"),i=i(),be(),i),Re={class:"section"},Se={class:"container"},me={class:"section-header"},Ae=O(()=>n("h1",{class:"section-title"},"Создать профиль",-1)),De=O(()=>n("div",{class:"section-header"},[n("h2",{class:"section-block_title"},"Шаблон")],-1)),Be={class:"form"},Le={class:"form"},Me={class:"form-row-wrapper"},Ne={class:"special-form-row"},He={key:0,class:"section-header inputs-block"},Oe={class:"section-block_title"},je={key:0,class:"form width-limit"},qe={key:0,class:"form-field form-field--file form-field--basic"},ze={class:"chat-files"},Ge={class:"chat-files__item"},Je=["onClick"],Ke={class:"form-field form-field--file form-field--basic"},Qe={class:"form-field-input__file-wrapper"},We={class:"form-field-input__file"},Xe=O(()=>n("span",null,"Прикрепить документ подтверждающий личность",-1)),Ye=["innerHTML"];function Ze(i,c,T,l,j,P){var F,R,S,y,m,o,r;const C=ve,t=ie("router-link"),x=Fe,g=ue,k=fe,E=de,d=pe,p=_e,B=he,U=ge,V=we,w=Ue,L=Ee;return s(),f(I,null,[v(C),n("div",Re,[n("div",Se,[n("div",me,[v(t,{class:"section-label",to:"/Contracts"},{default:M(()=>[N("Мои договора")]),_:1}),Ae]),v(x),De,n("div",Be,[(s(!0),f(I,null,H((R=(F=l.getConfig)==null?void 0:F.Contracts)==null?void 0:R.Types,e=>(s(),f(I,null,[(e==null?void 0:e.ProfileTemplateID)!==""?(s(),b(g,{key:0,label:e==null?void 0:e.Name,value:e==null?void 0:e.ProfileTemplateID,modelValue:l.templateValue,"onUpdate:modelValue":c[0]||(c[0]=a=>l.templateValue=a)},null,8,["label","value","modelValue"])):_("",!0)],64))),256))]),n("div",Le,[(s(!0),f(I,null,H((r=(o=(m=(y=(S=l.getConfig)==null?void 0:S.Profiles)==null?void 0:y.Templates)==null?void 0:m[l.templateValue])==null?void 0:o.Template)==null?void 0:r.Attribs,(e,a)=>(s(),f("div",Me,[n("div",Ne,[e!=null&&e.Title?(s(),f("div",He,[n("h2",Oe,ce(e==null?void 0:e.Title),1)])):_("",!0),(e==null?void 0:e.Type)==="Input"&&(e==null?void 0:e.Check)!=="Phone"?(s(),b(k,{key:1,class:D({"special-form-input":!0,"form-field-error":l.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:l.form[a].value,"onUpdate:modelValue":u=>l.form[a].value=u,pattern:l.getFieldRegex(e==null?void 0:e.Check)},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue","pattern"])):_("",!0),(e==null?void 0:e.Type)==="Input"&&(e==null?void 0:e.Check)==="Phone"?(s(),b(E,{key:2,class:D({"special-form-input":!0,"form-field-error":l.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:l.form[a].value,"onUpdate:modelValue":u=>l.form[a].value=u,pattern:l.getPhoneRegex()},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue","pattern"])):_("",!0),(e==null?void 0:e.Type)==="TextArea"?(s(),b(d,{key:3,class:D({"special-form-input":!0,"form-field-error":l.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:l.form[a].value,"onUpdate:modelValue":u=>l.form[a].value=u},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):(e==null?void 0:e.Type)==="Select"?(s(),b(p,{key:4,class:D({"special-form-input":!0,"form-field-error":l.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,options:e==null?void 0:e.Options,modelValue:l.form[a].value,"onUpdate:modelValue":u=>l.form[a].value=u},null,8,["class","label","placeholder","necessarily","name","options","modelValue","onUpdate:modelValue"])):_("",!0)])]))),256))]),l.templateValue!==0?(s(),f("div",je,[l.fileList.length?(s(),f("div",qe,[n("div",ze,[(s(!0),f(I,null,H(l.fileList,(e,a)=>(s(),f("div",Ge,[n("span",null,[v(B,{class:"file-icon"})]),n("span",null,ce(e==null?void 0:e.name),1),n("button",{class:"close",onClick:u=>l.removeFile(a)},[v(U)],8,Je)]))),256))])])):_("",!0),n("label",Ke,[n("div",Qe,[n("input",{ref:"fileInput",type:"file",onChange:c[1]||(c[1]=(...e)=>l.fileUpload&&l.fileUpload(...e))},null,544),n("div",We,[v(V),Xe])])]),v(w,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:l.agree,"onUpdate:modelValue":c[2]||(c[2]=e=>l.agree=e)},{default:M(()=>[N("Подтверждаю свое согласие на передачу информации в электроной форме (в том числе персональных данных) по открытым каналам связи сети Интернет")]),_:1},8,["modelValue"]),v(w,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:l.agreeHandle,"onUpdate:modelValue":c[3]||(c[3]=e=>l.agreeHandle=e)},{default:M(()=>[N("Я разрешаю передачу своих персональных данных третьим лицам, для выполнения заказанных мною услуг (регистрация доменто и т.п.)")]),_:1},8,["modelValue"])])):_("",!0),l.createProfileErrorMessage?(s(),f("div",{key:1,class:"error-message width-limit",innerHTML:l.formErrorMessage(l.createProfileErrorMessage)},null,8,Ye)):_("",!0),l.templateValue!==0?(s(),b(L,{key:2,class:"width-limit","is-loading":l.createProfileResult==="pending",label:"Зарегистрировать",onClick:c[4]||(c[4]=e=>l.checkForm())},null,8,["is-loading"])):_("",!0)])])],64)}const $e={components:{TextAreaLine:pe,simpleCheckbox:ue,basicInput:fe,SelectLine:_e,PhoneInput:de,IconFile:he,IconClose:ge,BlockBalanceAgreement:ve},setup(){const i=Ve(),c=Pe(),T=ye(),l=xe(),j=Ie(),P=h(!1),C=h(!1),t=h({}),x=h(null),g=h([]),k=h(null),E=h(null),d=h(0),p=te(()=>i.ConfigList),B=te(()=>{var o;return(o=T==null?void 0:T.userInfo)==null?void 0:o.Email}),U=p.value,V={};for(const o in U.Regulars)V[o]=U.Regulars[o];const w=o=>V[o]||null,L=()=>{const o=p.value;return o&&o.Regulars&&o.Regulars.Phone?new RegExp(o.Regulars.Phone):/^[0-9]{10}$/};function F(o){g.value=g.value.filter((r,e)=>e!==o)}function R(){let o=!1;if(Object.keys(t.value).forEach(r=>{t.value[r].value===null&&t.value[r].required?(t.value[r].error=!0,o=!0):t.value[r].error=!1}),!o&&P.value&&C.value){let r=new FormData;Object.keys(t.value).forEach(e=>{var a;r.append(e,(a=t.value[e])==null?void 0:a.value)}),r.append("TemplateID",d.value),r.append("Agree",P.value),r.append("AgreeHandle",C.value),g.value.forEach((e,a)=>{r.append("Document[]",e==null?void 0:e.value)}),k.value="pending",c.createNewContractFormData(r).then(e=>{var a;e.status==="success"?(k.value="success",j.push("/Contracts")):(k.value="error",E.value=(a=e.data)==null?void 0:a.Exception)})}}function S(o){return""+y(o)}function y(o){return o?"<div>"+(o==null?void 0:o.String)+"</div>"+y(o==null?void 0:o.Parent):""}function m(o){var e;let r=((e=o.target.files)==null?void 0:e[0])||null;r&&(x.value.value="",l.sendFile(r).then(a=>{g.value.push({name:r==null?void 0:r.name,value:a.slice(a.lastIndexOf("^")+1,a.length)})}))}return Te(d,()=>{var o,r,e,a,u;t.value={},Object.keys((u=(a=(e=(r=(o=p.value)==null?void 0:o.Profiles)==null?void 0:r.Templates)==null?void 0:e[d.value])==null?void 0:a.Template)==null?void 0:u.Attribs).forEach(A=>{var q,z,G,J,K,Q,W,X,Y,Z,$,ee,le,oe,ae,re,ne,se;t.value[A]={error:!1,value:(((Q=(K=(J=(G=(z=(q=p.value)==null?void 0:q.Profiles)==null?void 0:z.Templates)==null?void 0:G[d.value])==null?void 0:J.Template)==null?void 0:K.Attribs[A])==null?void 0:Q.Value)==="%Email%"?B.value:(ee=($=(Z=(Y=(X=(W=p.value)==null?void 0:W.Profiles)==null?void 0:X.Templates)==null?void 0:Y[d.value])==null?void 0:Z.Template)==null?void 0:$.Attribs[A])==null?void 0:ee.Value)||null,required:((se=(ne=(re=(ae=(oe=(le=p.value)==null?void 0:le.Profiles)==null?void 0:oe.Templates)==null?void 0:ae[d.value])==null?void 0:re.Template)==null?void 0:ne.Attribs[A])==null?void 0:se.IsDuty)==="1"}})}),{getConfig:p,templateValue:d,agreeHandle:C,agree:P,createProfileResult:k,createProfileErrorMessage:E,checkForm:R,formErrorMessage:S,form:t,fileInput:x,fileList:g,removeFile:F,fileUpload:m,getPhoneRegex:L,getFieldRegex:w,fieldRegexMap:V}}},gl=Ce($e,[["render",Ze],["__scopeId","data-v-0f1f98e9"]]);export{gl as default};
