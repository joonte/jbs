import{_ as se}from"./EmptyStateBlock-CV1Zaaf7.js";import{_ as le}from"./DomainItem-Dl3c0jTK.js";import{_ as re}from"./FormInputSearch-DhLeThyA.js";import{_ as ie}from"./ClausesKeeper-DEgaQ2N3.js";import{m as ce}from"./bootstrap-vue-next-CxxkTytZ.js";import{_ as me,a as ue}from"./IconButtonBack-BwlFfJZM.js";import{_ as de}from"./ButtonDefault-eJbeaBtE.js";import{_ as pe}from"./BlockBalanceAgreement-DjWMZ940.js";import{O as _e,E as h,x as ve,r as d,f,c as B,b as a,a as n,D as V,n as fe,I as O,t as D,J as C,w as $,v as De,F as N,j as ge,d as ke,o as p,e as be}from"./index-XtiBO-PZ.js";import{u as Se}from"./contracts-BdlSA9YT.js";import{s as he}from"./multiselect-eqvbz1NV.js";import{u as Oe}from"./globalActions-Tf2FwXht.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IconDots-DWUcOOJk.js";import"./Helper-yVNH7dvZ.js";import"./IconCard-cFowCC2T.js";import"./StatusBadge-DoJSzeeo.js";import"./OrderIDBadge-Kd0drmnW.js";import"./time-DenPiOX5.js";import"./IconPlus-DYth91EZ.js";import"./IconClose-s_NQ_Q4c.js";const we={class:"section"},Ie={class:"container"},ye={class:"title__icon"},Be={class:"btn__group"},Ve={class:"group__several"},$e={class:"list-form"},xe={class:"list-form_col list-form_col--sm"},Le={class:"list-form_select"},Ue={class:"multiselect-option"},Ne={key:0},Pe={__name:"DomainOrders",async setup(Me){let i,c;const x=Oe(),m=_e(),g=Se(),w=ke(),u=ve("emitter");[i,c]=h(()=>m.fetchDomains()),await i,c(),[i,c]=h(()=>m.fetchDomainSchemes()),await i,c(),[i,c]=h(()=>g.fetchContracts()),await i,c(),[i,c]=h(()=>g.fetchProfiles()),await i,c(),u.on("updateDomainsList",()=>{m.fetchDomains()});const k=d("*"),_=d(null),l=d(!1),v=d([]),I=d(null),y=d(!1),P=t=>{v.value=t};async function M(){console.log(v.value);const t=Object.keys(v.value).filter(s=>v.value[s]),e={ServiceID:"20000",ItemsPay:I.value,OrdersIDs:t,...y.value&&{UseBalance:"yes"}};await x.OrdersPay(e).then(s=>{s==="Basket"?(console.log("Success"),w.push("/Basket")):s?.Status==="Ok"&&(l.value=!1,u.emit("open-modal",{component:"BalanceProlong",data:{Message:s?.Message,Count:s?.Count}}))})}function T(){l.value=!0}function j(){l.value=!1}const r=f(()=>Object.keys(m?.domainsList).map(t=>m?.domainsList[t])?.reverse()),A=f(()=>m?.domainSchemes),E=f(()=>g?.contractsList),b=f(()=>q(F(r.value))),L=f(()=>{let t=[{value:"*",name:"Все договора"}];return r.value!==null?(Object.keys(r.value).forEach(e=>{t.find(s=>s.value===r.value[e]?.ContractID)||t.push({value:r.value[e]?.ContractID,name:E.value[r.value[e]?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}});function R(){w.go(0)}function F(t){return k.value!=="*"?t.filter(e=>e?.ContractID===k.value):t}function q(t){return _.value!==null?t.filter(e=>e?.Domain.toLowerCase().includes(_.value.toLowerCase())):t}function z(t){return A.value?.[t]}function H(t){return g?.contractsList?.[t]?.Customer}function J(t){x.OrderManage(t)}function G(){const t=_.value;w.push({path:"/DomainSchemes",query:{DomainName:t}})}function K(t,e){u.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить домен #${e}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function Q(t){u.emit("open-modal",{component:"OrdersTransfer",data:t})}function W(){u.emit("open-modal",{component:"DomainTransfer",data:{}})}function X(t){const e={DomainOrderID:t};u.emit("open-modal",{component:"DomainSelectOwner",data:e})}return(t,e)=>{const s=pe,Y=me,S=de,Z=ue,ee=ce,te=ie,oe=re,ne=le,U=se;return p(),B(N,null,[a(s),n("section",we,[n("div",Ie,[n("div",{class:fe(["section-header",l.value?"column":""])},[n("div",ye,[n("h1",{class:"section-title",onClick:e[0]||(e[0]=o=>R())},D(l.value?"Продление услуг Домена":"Домены"),1),O(a(Y,{onClick:e[1]||(e[1]=o=>j())},null,512),[[C,l.value]])]),O(n("div",Be,[O(a(S,{class:"btn-several",label:"Продлить несколько заказов",onClick:e[2]||(e[2]=o=>T())},null,512),[[C,r.value.length>1]]),a(S,{label:"Заказать",onClick:e[3]||(e[3]=o=>G())}),a(S,{label:"Перенести домен",onClick:e[4]||(e[4]=o=>W())})],512),[[C,!l.value]]),O(n("div",Ve,[a(Z,{class:"contr period",modelValue:I.value,"onUpdate:modelValue":e[5]||(e[5]=o=>I.value=o)},null,8,["modelValue"]),a(ee,{id:"checkbox-balance",modelValue:y.value,"onUpdate:modelValue":e[6]||(e[6]=o=>y.value=o),name:"checkbox-balance"},{default:$(()=>e[10]||(e[10]=[be(" Использовать средства с баланса ",-1)])),_:1,__:[10]},8,["modelValue"]),a(S,{label:"Продлить",onClick:e[7]||(e[7]=o=>M())})],512),[[C,l.value]])],2),a(te,{partition:"Header:/DomainOrders"}),n("div",$e,[n("div",xe,[n("div",Le,[a(De(he),{modelValue:k.value,"onUpdate:modelValue":e[8]||(e[8]=o=>k.value=o),options:L.value,label:"name",disabled:L.value?.length<=1},{singlelabel:$(({value:o})=>[n("span",null," # "+D(o.value.padStart(5,"0"))+" / "+D(o.name),1)]),option:$(({option:o})=>[n("div",Ue,"# "+D(o.value.padStart(5,"0"))+" / "+D(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),a(oe,{modelValue:_.value,"onUpdate:modelValue":e[9]||(e[9]=o=>_.value=o)},null,8,["modelValue"])]),r.value&&r.value?.length>0?(p(),B("div",Ne,[b.value&&b.value?.length>0?(p(!0),B(N,{key:0},ge(b.value,(o,ae)=>(p(),V(ne,{key:o?.OrderID,"item-data":o,"user-name":H(o?.ContractID),scheme:z(o?.SchemeID),"info-link":`/DomainOrders/${o?.OrderID}`,"is-last":ae===b.value.length-1,isSeveral:l.value,"selected-rows":v.value,onUpdateSelectedRows:P,onDelete:K,onTransfer:Q,onDesignateOwner:Te=>X(o?.ID),onManage:J},null,8,["item-data","user-name","scheme","info-link","is-last","isSeveral","selected-rows","onDesignateOwner"]))),128)):(p(),V(U,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(p(),V(U,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}}},st=Ce(Pe,[["__scopeId","data-v-2c73a011"]]);export{st as default};
