import{_ as W,S as K,g as y,j as q,o as D,c as S,a as l,b as c,d as v,t as f,k as H,w as _,F,x as X,y as j,p as Y,l as Z,e as tt,r as z,h as et}from"./index-83b4b7ba.js";import{u as nt}from"./domain-9fbc7ef8.js";import{u as ot}from"./contracts-623ec7a8.js";import{f as R,s as at}from"./useTimeFunction-8602dd60.js";import{I as st}from"./IconSearch-30270af1.js";import{S as it}from"./Select2-963d28df.js";import{s as rt}from"./multiselect-f2568231.js";import{z as lt,k as ct,d as mt}from"./bootstrap-vue-next.es-8f3ae81a.js";import{_ as dt}from"./OrderIDBadge-d89298b0.js";import{_ as ut}from"./IconDots-a66f045d.js";import{_ as _t}from"./IconCard-2cc17a6b.js";import{S as ft}from"./StatusBadge-0d170ac0.js";import{_ as Dt}from"./HelperComponent-df0c894c.js";import{_ as G}from"./ClausesKeeper-55c14b7f.js";import{B as J}from"./BlockBalanceAgreement-c5fad736.js";import{u as ht}from"./globalActions-633eb799.js";import{E as pt}from"./EmptyStateBlock-68a1c33e.js";import{_ as gt}from"./FormInputSearch-48364fb5.js";import{_ as vt}from"./ButtonDefault-dc248ec6.js";import"./IconArrow-80c72216.js";import"./IconClose-86aafc4e.js";import"./IconPlus-07b0a078.js";const It={class:"hosting-item"},bt={class:"hosting-item__row"},kt=["href"],Ot={class:"hosting-item-domains"},wt={class:"hosting-item-domains__window"},yt=["innerHTML"],St={class:"hosting-item__row"},Ct={class:"hosting-item__person"},Lt={class:"hosting-item__date"},Bt={class:"hosting-item__row"},Pt={class:"hosting-item__list"},Mt={key:0},Nt={key:1,class:"bold"},$t={class:"hosting-item__controls"},Tt={class:"btn btn--dots"},xt={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","designateOwner","manage"],setup(a,{emit:s}){const m=a,i=K("emitter"),h=y(()=>{var e,d;if(!((e=m.itemData)!=null&&e.Domain))return"";const n=(d=m.itemData)==null?void 0:d.Domain;return n.startsWith("http://")||n.startsWith("https://")?n:`https://${n}`});function k(n){if(!n)return R(new Date);const e=new Date,d=new Date(e.getTime()+n*24*60*60*1e3);return R(d)}function I(n){i.emit("open-modal",{component:"StatusHistory",data:{modeID:"DomainOrders",rowID:n}})}function u(){var n,e;console.log((n=m.itemData)==null?void 0:n.ID),s("delete",(e=m.itemData)==null?void 0:e.ID)}function O(){var n,e,d;i.emit("open-modal",{component:"SendAuthInfo",data:{DomainOrderID:(n=m.itemData)==null?void 0:n.ID,Domain:(e=m.itemData)==null?void 0:e.Domain,AuthInfo:(d=m.itemData)==null?void 0:d.AuthInfo}})}function C(){var n,e;s("transfer",{ServiceOrderID:(n=m.itemData)==null?void 0:n.ID,ServiceID:(e=m.itemData)==null?void 0:e.ServiceID})}function L(){var n;s("designateOwner",{DomainOrderID:(n=m.itemData)==null?void 0:n.ID})}function B(n){return n.split(",").join("<br>")}return(n,e)=>{var x,A,V,o,r,p,P,M,U,N,E;const d=dt,b=q("router-link"),t=lt,w=ct,T=mt;return D(),S("div",It,[l("div",bt,[c(d,{orderID:(x=a.itemData)==null?void 0:x.OrderID},null,8,["orderID"]),l("a",{class:"hosting-item__name",href:h.value,target:"_blank"},[v(f((A=a.itemData)==null?void 0:A.Domain),1),l("div",Ot,[l("div",wt,[l("div",{class:"hosting-item-domains__text",innerHTML:B(a.itemData.DNSs)},null,8,yt)])])],8,kt),c(ft,{status:(V=a.itemData)==null?void 0:V.StatusID,"status-table":"DomainOrders",onClick:e[0]||(e[0]=g=>{var $;return I(($=a.itemData)==null?void 0:$.ID)})},null,8,["status"])]),l("div",St,[l("div",Ct,f(a.userName),1),l("div",Lt,"Дата окончания "+f(k((o=a.itemData)==null?void 0:o.DaysRemainded))+" | "+f(((r=a.itemData)==null?void 0:r.DaysRemainded)||0)+" дн.",1),c(Dt,{"user-notice":(p=a.itemData)==null?void 0:p.UserNotice,id:(P=a.itemData)==null?void 0:P.OrderID,position:a.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),l("div",Bt,[l("ul",Pt,[(M=a.scheme)!=null&&M.PackageID?(D(),S("li",Mt,f((U=a.scheme)==null?void 0:U.PackageID),1)):H("",!0),(N=a.scheme)!=null&&N.CostProlong?(D(),S("li",Nt,f((E=a.scheme)==null?void 0:E.CostProlong)+" ₽",1)):H("",!0)])]),l("div",$t,[l("button",{class:"btn btn--md btn--bold",onClick:e[1]||(e[1]=g=>{var $;return n.$router.push(`/DomainOrderPay/${($=a.itemData)==null?void 0:$.OrderID}`)})},[c(_t),v("Оплатить")]),c(T,{class:"dropdown-dots",right:""},{"button-content":_(()=>[l("div",Tt,[c(ut)])]),default:_(()=>[c(t,null,{default:_(()=>[c(b,{to:a.infoLink},{default:_(()=>[v("Дополнительная информация")]),_:1},8,["to"])]),_:1}),c(t,null,{default:_(()=>{var g;return[c(b,{to:`/DomainOrderPay/${(g=a.itemData)==null?void 0:g.OrderID}`},{default:_(()=>[v("Оплатить заказ")]),_:1},8,["to"])]}),_:1}),c(t,{onClick:e[2]||(e[2]=g=>L())},{default:_(()=>[v("Определить владельца")]),_:1}),c(t,{onClick:e[3]||(e[3]=g=>C())},{default:_(()=>[v("Передать на другой аккаунт")]),_:1}),c(t,{onClick:e[4]||(e[4]=g=>O())},{default:_(()=>[v("Ввести AuthInfo")]),_:1}),c(w),c(t,{class:"color-red",onClick:e[5]||(e[5]=g=>u())},{default:_(()=>[v("Удалить")]),_:1})]),_:1})])])}}},Q=W(xt,[["__scopeId","data-v-64eb0517"]]),At=a=>(Y("data-v-4ff1d595"),a=a(),Z(),a),Vt={class:"section"},Ut={class:"container"},jt={class:"section-header"},Et=At(()=>l("h1",{class:"section-title"},"Домены",-1)),Ht={class:"btn__group"},Ft={class:"list-form"},zt={class:"list-form_col list-form_col--sm"},Rt={class:"list-form_select"},Wt={class:"multiselect-option"},Kt={key:0};function qt(a,s,m,i,h,k){var e,d,b;const I=J,u=vt,O=G,C=q("Multiselect"),L=gt,B=Q,n=pt;return D(),S(F,null,[c(I),l("div",Vt,[l("div",Ut,[l("div",jt,[Et,l("div",Ht,[c(u,{label:"Заказать",onClick:s[0]||(s[0]=t=>i.navigateToDomainSchemes())}),c(u,{label:"Перенести домен",onClick:s[1]||(s[1]=t=>i.openTransferModal())})])]),c(O,{partition:"Header:/DomainOrders"}),l("div",Ft,[l("div",zt,[l("div",Rt,[c(C,{modelValue:i.select,"onUpdate:modelValue":s[2]||(s[2]=t=>i.select=t),options:i.getUsers,label:"name",disabled:((e=i.getUsers)==null?void 0:e.length)<=1},{singlelabel:_(({value:t})=>[l("span",null,"# "+f(t.value.padStart(5,"0"))+" / "+f(t.name),1)]),option:_(({option:t})=>[l("div",Wt,"# "+f(t.value.padStart(5,"0"))+" / "+f(t.name),1)]),_:1},8,["modelValue","options","disabled"])])]),c(L,{modelValue:i.search,"onUpdate:modelValue":s[3]||(s[3]=t=>i.search=t)},null,8,["modelValue"])]),i.getDomainsList&&((d=i.getDomainsList)==null?void 0:d.length)>0?(D(),S("div",Kt,[i.filterProducts&&((b=i.filterProducts)==null?void 0:b.length)>0?(D(!0),S(F,{key:0},X(i.filterProducts,(t,w)=>(D(),j(B,{"item-data":t,"user-name":i.getUserName(t==null?void 0:t.ContractID),scheme:i.filterDomainScheme(t==null?void 0:t.SchemeID),"info-link":`/DomainOrders/${t==null?void 0:t.OrderID}`,"is-last":w===i.filterProducts.length-1,onDelete:i.deleteItem,onTransfer:i.transferItem,onDesignateOwner:T=>i.designateOwner(t==null?void 0:t.ID),onManage:i.orderManage},null,8,["item-data","user-name","scheme","info-link","is-last","onDelete","onTransfer","onDesignateOwner","onManage"]))),256)):(D(),j(n,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(D(),j(n,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}const Gt={components:{IconSearch:st,DomainItem:Q,Select2:it,Multiselect:rt,ClausesKeeper:G,BlockBalanceAgreement:J},async setup(){const a=ht(),s=nt(),m=ot(),i=tt(),h=K("emitter");h.on("updateDomainsList",()=>{s.fetchDomains()});const k=z("*"),I=z(null),u=y(()=>{var o;return(o=Object.keys(s==null?void 0:s.domainsList).map(r=>s==null?void 0:s.domainsList[r]))==null?void 0:o.reverse()}),O=y(()=>s==null?void 0:s.domainSchemes),C=y(()=>m==null?void 0:m.contractsList),L=y(()=>e(n(u.value))),B=y(()=>{let o=[{value:"*",name:"Все договора"}];return u.value!==null?(Object.keys(u.value).forEach(r=>{var p,P,M;o.find(U=>{var N;return U.value===((N=u.value[r])==null?void 0:N.ContractID)})||o.push({value:(p=u.value[r])==null?void 0:p.ContractID,name:(M=C.value[(P=u.value[r])==null?void 0:P.ContractID])==null?void 0:M.Customer})}),o):{value:"*",name:"Все договора"}});et(()=>{u.value.length<1&&w()});function n(o){return k.value!=="*"?o.filter(r=>(r==null?void 0:r.ContractID)===k.value):o}function e(o){return I.value!==null?o.filter(r=>r==null?void 0:r.Domain.toLowerCase().includes(I.value.toLowerCase())):o}function d(o){var r;return(r=O.value)==null?void 0:r[o]}function b(o){var r,p;return(p=(r=m==null?void 0:m.contractsList)==null?void 0:r[o])==null?void 0:p.Customer}function t(o){a.OrderManage(o)}function w(){i.push({path:"/DomainSchemes"})}function T(o){h.emit("open-modal",{component:"DeleteItem",data:{id:o,message:`Вы действительно хотите удалить домен #${o}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function x(o){h.emit("open-modal",{component:"OrdersTransfer",data:o})}function A(){h.emit("open-modal",{component:"DomainTransfer",data:{}})}function V(o){const r={DomainOrderID:o};h.emit("open-modal",{component:"DomainSelectOwner",data:r})}return await s.fetchDomains(),await s.fetchDomainSchemes(),await m.fetchContracts(),await m.fetchProfiles(),{getDomainsList:u,getDomainsSchemes:O,getUsers:B,select:k,search:I,openTransferModal:A,filterProducts:L,getUserName:b,designateOwner:V,deleteItem:T,orderManage:t,filterDomainScheme:d,navigateToDomainSchemes:w,startFunction:at,transferItem:x}}},pe=W(Gt,[["render",qt],["__scopeId","data-v-4ff1d595"]]);export{pe as default};
