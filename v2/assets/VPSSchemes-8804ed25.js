import{_ as me}from"./ButtonDefault-28022e42.js";import{_ as fe}from"./BlockOrderPayBalance-29672652.js";import{_ as Q,r as f,i as de,o as l,c as r,a as t,m as ce,k as Y,t as _,d as be,F as I,v as w,e as Se,g as N,ag as q,b as j,Y as ue,ae as re,x as z,p as ke,l as ge}from"./index-e8e4a28d.js";import{_ as Ve}from"./ClausesKeeper-cfc0f758.js";import{u as ye}from"./vps-011394b5.js";import{u as Ie}from"./resetServer-4fed1f73.js";import{u as De}from"./contracts-f70de43e.js";import{_ as Pe}from"./BlockSelectContract-ce407fe3.js";import{B as Be}from"./BlockBalanceAgreement-00019440.js";import"./bootstrap-vue-next.es-6aab83a5.js";import"./IconHelp-5d2ceeda.js";import"./globalActions-78d58809.js";import"./BasicInput-fc01a75b.js";import"./component-2fc43b10.js";import"./IconClose-c1bee414.js";import"./multiselect-762d23c8.js";import"./IconArrow-0cda8946.js";const Ce={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},name:{type:String,default:""},type:{type:String,default:"radio"},checked:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(d,{emit:c}){const a=f(null),u=f(!1);function b(){c("update:modelValue",d.data)}function S(){u.value=!0}return de(()=>{a.value=d.modelValue}),{inputValue:a,isIconPressed:u,onMouseEvent:S,updateValue:b}}},xe={class:"form-input_border"},we={class:"form-input_border-label"},Oe=["name","checked"],$e={class:"form-field__data"},Ee={class:"form-field__img"},Ge=["src"],Me={class:"form-field__name"},Ue={class:"form-field__desc"},Ae={class:"form-field__select"};function Fe(d,c,a,u,b,S){return l(),r("div",xe,[t("label",we,[t("input",{name:a.name,type:"radio",checked:a.checked,onInput:c[0]||(c[0]=(...k)=>u.updateValue&&u.updateValue(...k))},null,40,Oe),t("div",$e,[a.data.img?ce(d.$slots,"default",{key:0},()=>[t("div",Ee,[t("img",{src:a.data.img,alt:""},null,8,Ge)])],!0):Y("",!0),t("div",Me,_(a.data.name),1),t("div",Ue,[be(_(a.data.desc)+" ",1),a.data.select?ce(d.$slots,"default",{key:0},()=>[t("div",Ae,[(l(!0),r(I,null,w(a.data.select,(k,n)=>(l(),r("div",{key:n,class:"form-field__select-item"},_(k.text),1))),128))])],!0):Y("",!0)])])])])}const Le=Q(Ce,[["render",Fe],["__scopeId","data-v-d43d44d3"]]);const Ne={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},headers:{type:Array,default:()=>[]},name:{type:String,default:""},checkbox:{type:Boolean,default:!1},checked:{type:Boolean,default:!1}},emits:["update:modelValue","input"],setup(d,{emit:c}){const a=f(null),u=f(!1);function b(){c("update:modelValue",d.data),c("input",d.data)}function S(){u.value=!0}return de(()=>{a.value=d.modelValue}),{inputValue:a,isIconPressed:u,onMouseEvent:S,updateValue:b}}},je={class:"form-input_border"},Te={class:"form-input_border-label"},Re=["name","type","checked"],He={class:"form-field__data"},Ke={class:"form-field_header"};function Ye(d,c,a,u,b,S){return l(),r("div",je,[t("label",Te,[t("input",{name:a.name,type:a.checkbox?"checkbox":"radio",checked:a.checked,onInput:c[0]||(c[0]=(...k)=>u.updateValue&&u.updateValue(...k))},null,40,Re),t("div",He,[(l(!0),r(I,null,w(a.headers,(k,n)=>(l(),r("div",{key:n,class:"form-field__col"},[t("span",Ke,_(k),1),t("span",null,_(a.data[n]),1)]))),128))])])])}const qe=Q(Ne,[["render",Ye],["__scopeId","data-v-a13950e6"]]),ze="/v2/assets/oc-2-8f4c288c.jpg";const E=d=>(ke("data-v-73e85a9d"),d=d(),ge(),d),Je={class:"vps-scheme-page"},Qe={class:"section"},We={class:"container"},Xe=E(()=>t("div",{class:"section-header"},[t("h1",{class:"section-title"},"Заказать VPS/VDS сервер")],-1)),Ze={class:"section"},et={class:"container"},tt=E(()=>t("h2",{class:"section-block_title"},"Конфигурация",-1)),st={class:"form-column"},ot={class:"form-header"},at={class:"form-header_col"},lt={key:0,class:"section"},nt={class:"container"},ct=E(()=>t("h2",{class:"section-block_title"},"Операционная система",-1)),ut={class:"form grid-gorm"},rt={class:"section"},dt={class:"container"},_t=E(()=>t("h2",{class:"section-block_title"},"Регион",-1)),it={class:"form"},vt={class:"section"},pt={class:"container"},ht={class:"total-block"},mt={class:"total-block__row divider-bottom"},ft=E(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),bt={class:"total-block__col"},St={class:"total-block__row no-divider"},kt={class:"total-block__col"},gt={class:"total-block__col"},Vt={class:"total-block__row total-block__row--big economy-line"},yt=E(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),It={class:"total-block__col flex-col"},Dt={class:"red"},Pt={class:"total-block__row total-block__row--big"},Bt={class:"total-block__col"},Ct={class:"total-block__col"},J="Moscow",xt={__name:"VPSSchemes",async setup(d){let c,a;const u=ye(),b=De(),S=Ie(),k=Se(),n=f(null),O=f(null),G=f(null),T=f(!1),v=f(null),_e=f([{img:ze,value:"Moscow",name:"Россия",desc:"Москва"}]),W=f({PackageID:"Тариф",cpu_number:"CPU",ram_mib:"RAM",hdd_mib:"Память",net_in_mbitps:"Канал",CostMonth:"Стоимость"}),R=N(()=>Object.keys(u.vpsSchemes).map(e=>u.vpsSchemes[e])),ie=N(()=>b==null?void 0:b.contractsList),X=N(()=>R.value.find(e=>{var s;return(e==null?void 0:e.ID)===((s=v.value)==null?void 0:s.ID)})),M=N(()=>{var e;return(e=S==null?void 0:S.serverGroupsList)==null?void 0:e.ServersGroups}),$=N(()=>{var e;return(e=X.value)==null?void 0:e.OS.map(s=>({name:s,value:s}))});function H(e){return Number(e).toFixed(2)||0}function Z(){var s,p;let e=0;return(p=(s=n.value)==null?void 0:s.discounts)==null||p.Bonuses.map(i=>{e+=+i.Economy}),e}function ee(e){var s,p,i,V,g,y,h,m;return{ID:e==null?void 0:e.ID,PackageID:e==null?void 0:e.PackageID,ServersGroupID:e==null?void 0:e.ServersGroupID,cpu_number:(p=(s=e==null?void 0:e.SchemeParams)==null?void 0:s.cpu_number)==null?void 0:p.Value,ram_mib:(V=(i=e==null?void 0:e.SchemeParams)==null?void 0:i.ram_mib)==null?void 0:V.Value,hdd_mib:(y=(g=e==null?void 0:e.SchemeParams)==null?void 0:g.hdd_mib)==null?void 0:y.Value,net_in_mbitps:(m=(h=e==null?void 0:e.SchemeParams)==null?void 0:h.net_in_mbitps)==null?void 0:m.Value,CostMonth:e==null?void 0:e.CostMonth}}function ve(){var p,i,V,g,y,h;console.log(v.value);let e=(V=Object.keys((i=M.value)==null?void 0:i[(p=v.value)==null?void 0:p.ServersGroupID]))==null?void 0:V.find(m=>{var D,P,B,C,U,A,F,L;return((C=(B=(P=M.value)==null?void 0:P[(D=v.value)==null?void 0:D.ServersGroupID])==null?void 0:B[m])==null?void 0:C.IsActive)&&((L=(F=(A=M.value)==null?void 0:A[(U=v.value)==null?void 0:U.ServersGroupID])==null?void 0:F[m])==null?void 0:L.IsDefault)}),s=(h=Object.keys((y=M.value)==null?void 0:y[(g=v.value)==null?void 0:g.ServersGroupID]))==null?void 0:h.find(m=>{var D,P,B,C;return(C=(B=(P=M.value)==null?void 0:P[(D=v.value)==null?void 0:D.ServersGroupID])==null?void 0:B[m])==null?void 0:C.IsActive});return e||s}function pe(e){n.value=e}function he(){var e,s;T.value=!0,u.VPSOrder({ContractID:O.value,VPSSchemeID:(e=v.value)==null?void 0:e.ID,ServerID:ve(),DiskTemplate:(s=G.value)==null?void 0:s.value}).then(({result:p,info:i,error:V})=>{var g;p==="SUCCESS"?u.VPSOrderPay({VPSOrderID:i==null?void 0:i.VPSOrderID,DaysPay:(g=n.value)==null?void 0:g.actualDays,IsChange:!0}).then(y=>{let{result:h,error:m}=y;h==="SUCCESS"?k.push("/VPSOrders"):h==="BASKET"&&k.push("/Basket"),T.value=!0}):T.value=!1})}function te(){var e,s;((e=$==null?void 0:$.value)==null?void 0:e.length)>0&&(G.value=(s=$.value)==null?void 0:s[0])}return[c,a]=q(()=>u.fetchVPSSchemes().then(()=>{var e,s;((e=R.value)==null?void 0:e.length)>0&&(v.value=ee((s=R.value)==null?void 0:s[0])),te()})),await c,a(),[c,a]=q(()=>b.fetchContracts()),await c,a(),[c,a]=q(()=>S.fetchServerGroups()),await c,a(),(e,s)=>{var h,m,D,P,B,C,U,A,F,L,se,oe,ae,le,ne;const p=Ve,i=qe,V=Le,g=fe,y=me;return l(),r(I,null,[j(Be),t("div",Je,[t("div",Qe,[t("div",We,[Xe,j(p)])]),t("div",Ze,[t("div",et,[tt,t("div",st,[t("div",ot,[(l(!0),r(I,null,w(W.value,o=>(l(),r("div",at,_(o),1))),256))]),(l(!0),r(I,null,w(R.value,o=>{var x;return l(),z(i,{data:ee(o),type:"",modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=K=>v.value=K),name:"config",checked:((x=v.value)==null?void 0:x.ID)===(o==null?void 0:o.ID),headers:W.value,onInput:s[1]||(s[1]=K=>te())},null,8,["data","modelValue","checked","headers"])}),256))])])]),$.value?(l(),r("div",lt,[t("div",nt,[ct,t("div",ut,[(l(!0),r(I,null,w($.value,o=>{var x;return l(),z(V,{data:o,modelValue:G.value,"onUpdate:modelValue":s[2]||(s[2]=K=>G.value=K),checked:(o==null?void 0:o.value)===((x=G.value)==null?void 0:x.value),type:"",name:"operating_system"},null,8,["data","modelValue","checked"])}),256))])])])):Y("",!0),t("div",rt,[t("div",dt,[_t,t("div",it,[(l(!0),r(I,null,w(_e.value,o=>(l(),z(V,{data:o,checked:(o==null?void 0:o.value)===J,modelValue:J,"onUpdate:modelValue":s[3]||(s[3]=x=>J=x),type:"",name:"region"},null,8,["data","checked"]))),256))])])]),j(Pe,{title:"Информация о сервере",modelValue:O.value,"onUpdate:modelValue":s[4]||(s[4]=o=>O.value=o)},null,8,["modelValue"]),j(g,{contractID:O.value,scheme:X.value,serviceID:"30000",isOrderID:!1,onSelect:pe},null,8,["contractID","scheme"]),t("div",vt,[t("div",pt,[t("div",ht,[((D=(m=(h=n.value)==null?void 0:h.discounts)==null?void 0:m.Bonuses)==null?void 0:D.length)>0?(l(),r(I,{key:0},[t("div",mt,[ft,t("div",bt,_(H((P=n.value)==null?void 0:P.price))+" ₽",1)]),(l(!0),r(I,null,w((C=(B=n.value)==null?void 0:B.discounts)==null?void 0:C.Bonuses,o=>(l(),r("div",St,[t("div",kt,"Скидка "+_(o==null?void 0:o.Discount)+"% на "+_(o==null?void 0:o.Days)+" дней",1),t("div",gt,"-"+_(H(o==null?void 0:o.Economy))+" ₽",1)]))),256))],64)):Y("",!0),ue(t("div",Vt,[yt,t("div",It,[t("span",null,[t("s",null,_(H((U=n.value)==null?void 0:U.price))+" ₽",1)]),t("span",Dt,"-"+_(Z())+" ₽",1)])],512),[[re,((L=(F=(A=n.value)==null?void 0:A.discounts)==null?void 0:F.Bonuses)==null?void 0:L.length)>0]]),ue(t("div",Pt,[t("div",Bt,"Итого за "+_((se=n.value)==null?void 0:se.label),1),t("div",Ct,_(H(((oe=n.value)==null?void 0:oe.price)-Z()))+" ₽",1)],512),[[re,(ae=n.value)==null?void 0:ae.price]])]),j(y,{class:"btn--wide",label:((le=ie.value[O.value])==null?void 0:le.Balance)>((ne=n.value)==null?void 0:ne.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:n.value===null||O.value===null,"is-loading":T.value,onClick:s[5]||(s[5]=o=>he())},null,8,["label","disabled","is-loading"])])])])],64)}}},qt=Q(xt,[["__scopeId","data-v-73e85a9d"]]);export{qt as default};
