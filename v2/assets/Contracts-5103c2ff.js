import{_ as Q}from"./FormInputSearch-2aef6046.js";import{_ as W}from"./ClausesKeeper-a152fc61.js";import{_ as X}from"./ButtonDefault-598fef28.js";import{_ as P,o as D,c as x,a as e,m as U,b as c,r as g,h as R,w as n,t as v,L as $,k as Y,p as O,l as A,e as M,g as L,j as Z,ao as z,d as B,u as ee,R as te,a7 as se,ag as q,x as G,F as oe}from"./index-eaeb1281.js";import{u as j}from"./contracts-ac470ffa.js";import{F as ae}from"./FormTabs-035ec3ec.js";import{F as ne,z as le,d as re,C as H}from"./bootstrap-vue-next.es-f4c478af.js";import{_ as ce}from"./IconDots-2acbefc2.js";import{f as _e,a as ie}from"./useTimeFunction-8602dd60.js";import{_ as ue}from"./IconCard-6f1a0464.js";import{s as pe}from"./multiselect-92d0918e.js";import{S as de}from"./StatusBadge-e3643114.js";import{B as me}from"./BlockBalanceAgreement-11afb494.js";import"./IconPlus-b5e68f37.js";import"./IconSearch-77d111a7.js";import"./IconClose-e8029cfe.js";import"./IconArrow-ce1bc7b6.js";const ve={},fe={class:"page-title"},be={class:"page-title__title"},ge={class:"page-title__buttons"};function ye(r,d){return D(),x("div",fe,[e("div",be,[U(r.$slots,"title",{},void 0,!0)]),e("div",ge,[U(r.$slots,"buttons",{},void 0,!0)])])}const he=P(ve,[["render",ye],["__scopeId","data-v-b876c21b"]]),Ce=[{key:"ID",label:"Номер",variant:"td-gray td-order",sortable:!0},{key:"CreateDate",label:"Дата Создания",variant:"td-gray td-order",sortable:!0},{key:"Customer",label:"Договор"},{key:"Orders",label:"Количество подключенных услуг",sortable:!0,variant:"td-gray td-order"},{key:"Balance",label:"Баланс",sortable:!0,variant:"td-gray td-order"},{key:"controls",label:"",variant:"td-controls"}];const Ie={class:"button-payment"},De={class:"button-payment__text"},ke={__name:"FormButtonPayment",setup(r){return(d,u)=>(D(),x("button",Ie,[c(ue,{class:"button-payment__icon"}),e("span",De,[U(d.$slots,"default",{},void 0,!0)])]))}},$e=P(ke,[["__scopeId","data-v-fcb8fa3c"]]);const J=r=>(O("data-v-64d83888"),r=r(),A(),r),Te={key:0,class:"table-controls"},we=J(()=>e("span",{class:"text-success"},"First",-1)),Le=J(()=>e("span",{class:"text-info"},"Last",-1)),Pe={class:"multiselect-multiple-label"},xe={class:"multiselect-option"},Be={__name:"PaginationBlock",props:["modelValue","total_rows"],emits:["update:modelValue","updatePage"],setup(r,{emit:d}){const u=r,i=[10,25,50,100],_=g({current_page:1,per_page:10});return R(_.value,()=>{d("updatePage",_.value)}),(h,f)=>{const C=ne;return u.total_rows>0?(D(),x("div",Te,[c(C,{modelValue:_.value.current_page,"onUpdate:modelValue":f[0]||(f[0]=a=>_.value.current_page=a),"total-rows":u.total_rows,"per-page":_.value.per_page,"first-number":"","last-number":""},{"first-text":n(()=>[we]),"last-text":n(()=>[Le]),page:n(({page:a,active:y})=>[e("span",null,v((a-1)*_.value.per_page+1)+"-"+v(a*_.value.per_page),1)]),_:1},8,["modelValue","total-rows","per-page"]),c($(pe),{class:"multiselect--white",modelValue:_.value.per_page,"onUpdate:modelValue":f[1]||(f[1]=a=>_.value.per_page=a),options:i,label:"name",openDirection:"top",onInput:f[2]||(f[2]=a=>_.value.current_page=1)},{singlelabel:n(({value:a})=>[e("div",Pe,[e("span",null,"Отображать "+v(a.value)+" строк",1)])]),option:n(({option:a})=>[e("div",xe,"Отображать "+v(a.name)+" строк",1)]),_:1},8,["modelValue"])])):Y("",!0)}}},K=P(Be,[["__scopeId","data-v-64d83888"]]);const S=r=>(O("data-v-3eda493e"),r=r(),A(),r),Se={class:"contracts-list"},Ve=S(()=>e("span",{class:"td-mobile"},"Номер",-1)),Fe={class:"td-column-heavy"},Ne={class:"table-td-gray"},Ee=S(()=>e("span",{class:"td-mobile"},"Дата Создания",-1)),Ue={class:"d-block"},Re=S(()=>e("span",{class:"td-mobile"},"Договор",-1)),Oe={class:"td-column-heavy"},Ae={class:"table-td-blue"},Me=S(()=>e("span",{class:"td-mobile"},"Баланс",-1)),je=S(()=>e("span",{class:"td-mobile"},"Количество подключенных услуг",-1)),qe={class:"btn__group"},Ge={class:"dropdown-button"},ze={class:"btn btn--dots"},He={__name:"ContractsList",props:{search:{type:String,default:""}},setup(r){const d=r,u=M(),i=j(),_=g("CreateDate"),h=g(!0),f=g("desc"),C=g(10),a=g(1),y=L(()=>{var l,b;return(b=(l=Object.keys(i==null?void 0:i.contractsList))==null?void 0:l.map(o=>i==null?void 0:i.contractsList[o]))==null?void 0:b.reverse()}),T=L(()=>{var l;return(l=y.value.filter(b=>{var o;return b.Customer.toLowerCase().includes(((o=d.search)==null?void 0:o.toLowerCase())||"")}))==null?void 0:l.length});function k(l){u.push(`/Balance/${l}`)}function w(l={}){C.value=l==null?void 0:l.per_page,a.value=l==null?void 0:l.current_page}function F(l){i==null||i.contractDownload({ContractID:l})}return R(()=>d,()=>{console.log("123"),a.value=1}),(l,b)=>{const o=ce,p=Z("router-link"),m=le,N=re,E=H;return D(),x("div",Se,[c(E,{class:"basic-table",items:y.value,fields:$(Ce),"show-empty":!0,filterable:[],filter:d.search,"per-page":C.value,"sort-desc":h.value,"onUpdate:sortDesc":b[0]||(b[0]=s=>h.value=s),"sort-by":_.value,"onUpdate:sortBy":b[1]||(b[1]=s=>_.value=s),"sort-direction":f.value,"current-page":a.value,"empty-text":"У вас пока нет договоров.","empty-filtered-text":"Договора не найдены."},{"cell(ID)":n(s=>{var t;return[Ve,e("div",Fe,[e("div",Ne,v($(z).transformContractNumber((t=s.item)==null?void 0:t.ID)),1)])]}),"cell(CreateDate)":n(s=>{var t;return[Ee,e("span",Ue,v($(_e)($(ie)((t=s.item)==null?void 0:t.CreateDate))),1)]}),"cell(Customer)":n(s=>{var t;return[Re,e("div",Oe,[e("div",Ae,v((t=s.item)==null?void 0:t.Customer),1)])]}),"cell(Balance)":n(s=>{var t;return[Me,e("span",null,v((t=s.item)==null?void 0:t.Balance)+" ₽",1)]}),"cell(Orders)":n(s=>{var t;return[je,e("span",null,v((t=s.item)==null?void 0:t.Orders),1)]}),"cell(controls)":n(s=>[e("div",qe,[c($e,{onClick:t=>{var I;return k((I=s.item)==null?void 0:I.ID)}},{default:n(()=>[B("Пополнить баланс")]),_:2},1032,["onClick"]),e("div",Ge,[c(N,{class:"dropdown-dots",right:""},{"button-content":n(()=>[e("div",ze,[c(o)])]),default:n(()=>[c(m,null,{default:n(()=>{var t;return[c(p,{to:`/ContractScheme/${(t=s.item)==null?void 0:t.ID}`},{default:n(()=>[B("Открыть")]),_:2},1032,["to"])]}),_:2},1024),c(m,null,{default:n(()=>{var t;return[c(p,{to:`/ContractSettings/${(t=s.item)==null?void 0:t.ID}`},{default:n(()=>[B("Изменить тип учёта")]),_:2},1032,["to"])]}),_:2},1024),c(m,{onClick:t=>{var I;return F((I=s.item)==null?void 0:I.ID)}},{default:n(()=>[B("Загрузить договор")]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["items","fields","filter","per-page","sort-desc","sort-by","sort-direction","current-page"]),c(K,{total_rows:T.value,onUpdatePage:w},null,8,["total_rows"])])}}},Je=P(He,[["__scopeId","data-v-3eda493e"]]),Ke=[{key:"ID",label:"Номер",variant:"td-gray td-order",sortable:!0},{key:"Name",label:"Профиль",variant:"td-blue"},{key:"TemplateID",label:"Тип",variant:"td-gray td-order"},{key:"StatusID",label:"Статус",sortable:!0,variant:"td-gray td-order"},{key:"StatusDate",label:"От статуса",sortable:!0,variant:"td-default td-order"}];const V=r=>(O("data-v-aab722c9"),r=r(),A(),r),Qe={class:"contracts-profile-list"},We=V(()=>e("span",{class:"td-mobile"},"Номер",-1)),Xe={class:"d-block"},Ye=V(()=>e("span",{class:"td-mobile"},"Номер",-1)),Ze=V(()=>e("span",{class:"td-mobile"},"От статуса",-1)),et={class:"d-block"},tt=V(()=>e("span",{class:"td-mobile"},"Тип",-1)),st=V(()=>e("span",{class:"td-mobile"},"Статус",-1)),ot={__name:"ContractsProfileList",props:["search"],setup(r){const d=r;M();const u=j(),i=ee(),_=te("emitter"),h=g("ID"),f=g(!0),C=g("desc"),a=g(10),y=g(1),T=L(()=>{var o,p;return(p=(o=Object==null?void 0:Object.keys(u==null?void 0:u.profileList))==null?void 0:o.map(m=>u==null?void 0:u.profileList[m]))==null?void 0:p.reverse()}),k=L(()=>{var o,p;return(p=(o=i.ConfigList)==null?void 0:o.Profiles)==null?void 0:p.Templates}),w=L(()=>{var o;return(o=T.value.filter(p=>{var m;return p.Name.toLowerCase().includes(((m=d.search)==null?void 0:m.toLowerCase())||"")}))==null?void 0:o.length});function F(o={}){a.value=o==null?void 0:o.per_page,y.value=o==null?void 0:o.current_page}function l(o){_.emit("open-modal",{component:"ProfileInfo",data:{data:o,template:k.value[o.TemplateID]}})}function b(o){return Math.floor((new Date().getTime()-o*1e3)/(1e3*60*60*24))}return(o,p)=>{const m=de,N=H,E=K;return D(),x("div",Qe,[c(N,{class:"basic-table",items:T.value,fields:$(Ke),"show-empty":!0,filterable:[],filter:d.search,"per-page":a.value,"sort-desc":f.value,"onUpdate:sortDesc":p[0]||(p[0]=s=>f.value=s),"sort-by":h.value,"onUpdate:sortBy":p[1]||(p[1]=s=>h.value=s),"sort-direction":C.value,"current-page":y.value,"empty-text":"У вас пока нет профилей.","empty-filtered-text":"Профили не найдены.",onRowClicked:l},{"cell(ID)":n(s=>{var t;return[We,e("span",Xe,v($(z).transformContractNumber((t=s.item)==null?void 0:t.ID)),1)]}),"cell(Name)":n(s=>{var t;return[Ye,e("span",null,v((t=s.item)==null?void 0:t.Name),1)]}),"cell(StatusDate)":n(s=>{var t;return[Ze,e("span",et,v(b((t=s.item)==null?void 0:t.StatusDate))+" дн.",1)]}),"cell(TemplateID)":n(s=>{var t,I;return[tt,e("span",null,v((I=k.value[(t=s.item)==null?void 0:t.TemplateID])==null?void 0:I.Name),1)]}),"cell(StatusID)":n(s=>[st,c(m,{status:s.value,"status-table":"Profiles"},null,8,["status"])]),_:1},8,["items","fields","filter","per-page","sort-desc","sort-by","sort-direction","current-page"]),c(E,{total_rows:w.value,onUpdatePage:F},null,8,["total_rows"])])}}},at=P(ot,[["__scopeId","data-v-aab722c9"]]);const nt={class:"section"},lt={class:"container"},rt={class:"list-form"},ct={class:"contracts__page"},_t={__name:"Contracts",async setup(r){var k,w;let d,u;const i=se(),_=M(),h=j(),f=[{value:"Contracts",name:"Договора"},{value:"Profiles",name:"Профили"}],C=L(()=>a.value==="Contracts"?"Договора":"Профили"),a=g("Contracts"),y=g("");function T(){a.value==="Contracts"?_.push({path:"/ContractMake"}):_.push({path:"/ProfileMake"})}return(k=i==null?void 0:i.query)!=null&&k.section?a.value=(w=i.query)==null?void 0:w.section:_.replace({query:{section:"Contracts"}}),R(a,()=>{_.replace({query:{section:a.value}})}),[d,u]=q(()=>h.fetchContracts()),await d,u(),[d,u]=q(()=>h.fetchProfiles()),await d,u(),(F,l)=>{const b=X,o=W,p=Q;return D(),x(oe,null,[c(me),e("div",nt,[e("div",lt,[c(ae,{tabs:f,modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=m=>a.value=m)},null,8,["modelValue"]),c(he,null,{title:n(()=>[B(v(C.value),1)]),buttons:n(()=>[c(b,{label:a.value==="Contracts"?"Создать договор":"Создать профиль",onClick:T},null,8,["label"])]),_:1}),c(o),e("div",rt,[c(p,{modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=m=>y.value=m)},null,8,["modelValue"])]),e("div",ct,[a.value==="Contracts"?(D(),G(Je,{key:0,search:y.value},null,8,["search"])):(D(),G(at,{key:1,search:y.value},null,8,["search"]))])])])],64)}}},wt=P(_t,[["__scopeId","data-v-2a04373f"]]);export{wt as default};
