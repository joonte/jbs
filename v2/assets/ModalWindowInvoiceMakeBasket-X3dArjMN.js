import{c as r,o as m,a as I,i as C,F as g,j as M,n as A,t as k,am as w,x as j,r as h,d as x,f as P}from"./index-XtiBO-PZ.js";import{u as b}from"./invoices-DnpA41Eo.js";import{u as F}from"./postings-D5DA40Zz.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const V={props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(l,{emit:s}){const y=w(),o=b(),v=F(),f=j("emitter"),a=h(null),D=x(),_=P(()=>y.data),t=h(null),N=P(()=>{const c=_.value,e=l.data?.ContractPaymentSystems;if(c?.PaymentSystems&&e){const n=new Set(e);return Object.keys(c.PaymentSystems).filter(i=>n.has(i)).map(i=>{const u=c.PaymentSystems[i];return String(u?.IsActive)==="1"?u.Collations:null}).filter(i=>i!==null).flat().slice().sort((i,u)=>{const S=parseInt(i.SortID,10),p=parseInt(u.SortID,10);return isNaN(S)?1:isNaN(p)?-1:S-p})}else return null});function B(c){t.value={id:c?.ID,type:c?.Source},t.value!==null&&(l.data?.ProfileID===null?t.value?.type==="Natural"||t.value?.type==="Juridical"||t.value?.type==="Individual"?(D.push(`/ProfileMake?ContractNew=${l.data?.ItemID}&TemplateID=${t.value?.type}`),s("modalClose")):o.InvoiceMake({ContractID:l.data?.ItemID,PaymentSystemID:t.value?.type}).then(e=>{if(e.status==="success"&&e.data&&e.data.InvoiceID){s("modalClose");const n=e.data.InvoiceID;v.InvoiceDocument({InvoiceID:n}).then(d=>{f.emit("open-modal",{component:"InvoiceDocumentBasket",data:{html:d,ID:n}})})}else s("modalClose")}):o.InvoiceMake({ContractID:l.data?.ItemID,PaymentSystemID:t.value?.type}).then(e=>{if(e.status==="success"&&e.data&&e.data.InvoiceID){s("modalClose");const n=e.data.InvoiceID;v.InvoiceDocument({InvoiceID:n}).then(d=>{f.emit("open-modal",{component:"InvoiceDocumentBasket",data:{html:d,ID:n}})})}else s("modalClose")}))}return{getConfig:_,errorMessage:a,filterActiveSystems:N,selectPaymentSystem:B,paymentSystem:t}}},$={class:"list-part"},z={key:0,class:"list-row grid-net"},E=["onClick"],J=["src"],L={class:"list-item__image-title"},R={class:"modal__error"};function T(l,s,y,o,v,f){return m(),r("div",$,[s[0]||(s[0]=I("div",{class:"list-item__title"},"Выбрать платёжную систему",-1)),o.filterActiveSystems?(m(),r("div",z,[(m(!0),r(g,null,M(o.filterActiveSystems,a=>(m(),r(g,{key:a?.ID},[a?.IsActive?(m(),r("div",{key:0,class:A(["list-item",{"list-item_active":o.paymentSystem?.id===a?.ID}]),onClick:D=>o.selectPaymentSystem(a)},[I("img",{class:"list-item__image",src:a?.Image},null,8,J),I("div",L,k(a?.Description),1)],10,E)):C("",!0)],64))),128))])):C("",!0),I("div",R,k(o.errorMessage),1)])}const Q=O(V,[["render",T],["__scopeId","data-v-4a8cabf7"]]);export{Q as default};
