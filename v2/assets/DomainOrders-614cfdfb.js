import{_ as j,j as E,o as u,c as v,a as m,b as i,w as d,d as h,t as L,k as V,F as z,v as R,x as $,p as H,l as K,e as W,R as q,r as U,g as S}from"./index-1c309346.js";import{u as G}from"./domain-89453842.js";import{u as J}from"./contracts-7b919c67.js";import{s as Q}from"./useTimeFunction-8602dd60.js";import{I as X}from"./IconSearch-373e7b4f.js";import{S as Y}from"./Select2-bf57061c.js";import{s as Z}from"./multiselect-b7ad6876.js";import{z as ee,k as te,d as oe}from"./bootstrap-vue-next.es-b799f76d.js";import{_ as ne}from"./OrderIDBadge-afd00b65.js";import{_ as se}from"./IconDots-391abd93.js";import{_ as ae}from"./IconCard-ee273855.js";import{S as re}from"./StatusBadge-a49537d5.js";import{_ as ie}from"./HelperComponent-3eb94393.js";import{_ as M}from"./ClausesKeeper-b9906182.js";import{E as le}from"./EmptyStateBlock-5a6a4cd4.js";import{_ as ce}from"./FormInputSearch-de4e3004.js";import{_ as me}from"./ButtonDefault-cd183bf8.js";import"./IconArrow-6927efe5.js";import"./IconClose-7cf50ca7.js";import"./IconPlus-ea6f8c21.js";const de={class:"hosting-item"},ue={class:"hosting-item__row"},_e={class:"hosting-item__row"},fe={class:"hosting-item__person"},De={class:"hosting-item__row"},pe={class:"hosting-item__list"},ge={key:0},he={key:1,class:"bold"},ve={class:"hosting-item__controls"},Ie={class:"btn btn--dots"},be={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","designateOwner"],setup(e,{emit:r}){const f=e;function t(){var a,l;console.log((a=f.itemData)==null?void 0:a.ID),r("delete",(l=f.itemData)==null?void 0:l.ID)}function I(){var a,l;r("transfer",{ServiceOrderID:(a=f.itemData)==null?void 0:a.ID,ServiceID:(l=f.itemData)==null?void 0:l.ServiceID})}function b(){var a;r("designateOwner",{DomainOrderID:(a=f.itemData)==null?void 0:a.ID})}return(a,l)=>{var p,g,n,y,P,B,N,o,s;const C=ne,D=E("router-link"),_=ee,k=te,O=oe;return u(),v("div",de,[m("div",ue,[i(C,{orderID:(p=e.itemData)==null?void 0:p.OrderID},null,8,["orderID"]),i(D,{class:"hosting-item__name",to:e.infoLink},{default:d(()=>{var c;return[h(L((c=e.itemData)==null?void 0:c.Domain),1)]}),_:1},8,["to"]),i(re,{status:(g=e.itemData)==null?void 0:g.StatusID,"status-table":"DomainOrders"},null,8,["status"])]),m("div",_e,[m("div",fe,L(e.userName),1),i(ie,{"user-notice":(n=e.itemData)==null?void 0:n.UserNotice,id:(y=e.itemData)==null?void 0:y.OrderID,position:e.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),m("div",De,[m("ul",pe,[(P=e.scheme)!=null&&P.PackageID?(u(),v("li",ge,L((B=e.scheme)==null?void 0:B.PackageID),1)):V("",!0),(N=e.scheme)!=null&&N.CostProlong?(u(),v("li",he,L((o=e.scheme)==null?void 0:o.CostProlong)+" ₽",1)):V("",!0)])]),m("div",ve,[((s=e.itemData)==null?void 0:s.StatusID)==="Waiting"?(u(),v("button",{key:0,class:"btn btn--md btn--bold",onClick:l[0]||(l[0]=c=>{var w;return a.$router.push(`/DomainOrderPay/${(w=e.itemData)==null?void 0:w.OrderID}`)})},[i(ae),h("Оплатить")])):V("",!0),i(O,{class:"dropdown-dots",right:""},{"button-content":d(()=>[m("div",Ie,[i(se)])]),default:d(()=>[i(_,null,{default:d(()=>[i(D,{to:e.infoLink},{default:d(()=>[h("Дополнительная информация")]),_:1},8,["to"])]),_:1}),i(_,null,{default:d(()=>{var c;return[i(D,{to:`/DomainOrderPay/${(c=e.itemData)==null?void 0:c.OrderID}`},{default:d(()=>[h("Оплатить заказ")]),_:1},8,["to"])]}),_:1}),i(_,{onClick:l[1]||(l[1]=c=>b())},{default:d(()=>[h("Определить владельца")]),_:1}),i(_,{onClick:l[2]||(l[2]=c=>I())},{default:d(()=>[h("Передать на другой аккаунт")]),_:1}),i(k),i(_,{class:"color-red",onClick:l[3]||(l[3]=c=>t())},{default:d(()=>[h("Удалить")]),_:1})]),_:1})])])}}},A=j(be,[["__scopeId","data-v-2809dd0e"]]),ke=e=>(H("data-v-9bfeaa91"),e=e(),K(),e),Oe={class:"section"},ye={class:"container"},Ce={class:"section-header"},we=ke(()=>m("h1",{class:"section-title"},"Домены",-1)),Se={class:"btn__group"},Le={class:"list-form"},Pe={class:"list-form_col list-form_col--sm"},Be={class:"list-form_select"},Ne={class:"multiselect-option"},Ve={key:0};function $e(e,r,f,t,I,b){var O,p,g;const a=me,l=M,C=E("Multiselect"),D=ce,_=A,k=le;return u(),v("div",Oe,[m("div",ye,[m("div",Ce,[we,m("div",Se,[i(a,{label:"Заказать",onClick:r[0]||(r[0]=n=>t.navigateToDomainSchemes())}),i(a,{label:"Перенести домен",onClick:r[1]||(r[1]=n=>t.openTransferModal())})])]),i(l,{partition:"Header:/DomainOrders"}),m("div",Le,[m("div",Pe,[m("div",Be,[i(C,{modelValue:t.select,"onUpdate:modelValue":r[2]||(r[2]=n=>t.select=n),options:t.getUsers,label:"name",disabled:((O=t.getUsers)==null?void 0:O.length)<=1},{option:d(({option:n})=>[m("div",Ne,L(n.name),1)]),_:1},8,["modelValue","options","disabled"])])]),i(D,{modelValue:t.search,"onUpdate:modelValue":r[3]||(r[3]=n=>t.search=n)},null,8,["modelValue"])]),t.getDomainsList&&((p=t.getDomainsList)==null?void 0:p.length)>0?(u(),v("div",Ve,[t.filterProducts&&((g=t.filterProducts)==null?void 0:g.length)>0?(u(!0),v(z,{key:0},R(t.filterProducts,(n,y)=>(u(),$(_,{"item-data":n,"user-name":t.getUserName(n==null?void 0:n.ContractID),scheme:t.filterDomainScheme(n==null?void 0:n.SchemeID),"info-link":`/DomainOrders/${n==null?void 0:n.OrderID}`,"is-last":y===t.filterProducts.length-1,onDelete:t.deleteItem,onTransfer:t.transferItem,onDesignateOwner:t.designateOwner},null,8,["item-data","user-name","scheme","info-link","is-last","onDelete","onTransfer","onDesignateOwner"]))),256)):(u(),$(k,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(u(),$(k,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])}const Te={components:{IconSearch:X,DomainItem:A,Select2:Y,Multiselect:Z,ClausesKeeper:M},async setup(){const e=G(),r=J(),f=W(),t=q("emitter");t.on("updateDomainsList",()=>{e.fetchDomains()});const I=U("*"),b=U(null),a=S(()=>{var o;return(o=Object.keys(e==null?void 0:e.domainsList).map(s=>e==null?void 0:e.domainsList[s]))==null?void 0:o.reverse()}),l=S(()=>e==null?void 0:e.domainSchemes),C=S(()=>r==null?void 0:r.contractsList),D=S(()=>O(k(a.value))),_=S(()=>{let o=[{value:"*",name:"Все договора"}];return a.value!==null?(Object.keys(a.value).forEach(s=>{var c,w,T;o.find(F=>{var x;return F.value===((x=a.value[s])==null?void 0:x.ContractID)})||o.push({value:(c=a.value[s])==null?void 0:c.ContractID,name:(T=C.value[(w=a.value[s])==null?void 0:w.ContractID])==null?void 0:T.Customer})}),o):{value:"*",name:"Все договора"}});function k(o){return I.value!=="*"?o.filter(s=>(s==null?void 0:s.ContractID)===I.value):o}function O(o){return b.value!==null?o.filter(s=>s==null?void 0:s.Domain.toLowerCase().includes(b.value.toLowerCase())):o}function p(o){var s;return(s=l.value)==null?void 0:s[o]}function g(o){var s,c;return(c=(s=r==null?void 0:r.contractsList)==null?void 0:s[o])==null?void 0:c.Customer}function n(){f.push({path:"/DomainSchemes"})}function y(o){t.emit("open-modal",{component:"DeleteItem",data:{id:o,message:`Вы действительно хотите удалить домен #${o}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function P(o){t.emit("open-modal",{component:"OrdersTransfer",data:o})}function B(){t.emit("open-modal",{component:"DomainTransfer",data:{}})}function N(o){t.emit("open-modal",{component:"DomainSelectOwner",data:o})}return await e.fetchDomains(),await e.fetchDomainSchemes(),await r.fetchContracts(),{getDomainsList:a,getDomainsSchemes:l,getUsers:_,select:I,search:b,openTransferModal:B,filterProducts:D,getUserName:g,designateOwner:N,deleteItem:y,filterDomainScheme:p,navigateToDomainSchemes:n,startFunction:Q,transferItem:P}}},tt=j(Te,[["render",$e],["__scopeId","data-v-9bfeaa91"]]);export{tt as default};
