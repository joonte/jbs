import{_ as R}from"./ButtonDefault-eJbeaBtE.js";import{_ as w}from"./BlockSelectProfile-CryEnOWq.js";import{_ as F}from"./SimpleCheckbox-D0eZf19C.js";import{_ as j}from"./ClausesKeeper-DEgaQ2N3.js";import{_ as M}from"./BlockBalanceAgreement-DjWMZ940.js";import{u as O}from"./contracts-BdlSA9YT.js";import{am as U,r as d,f as u,h as D,s as A,m as K,d as G,g as J,E as q,c as f,b as r,a as n,w as z,G as H,F as v,j as Q,x as W,o as i,e as X,D as Y,i as Z}from"./index-XtiBO-PZ.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./multiselect-eqvbz1NV.js";import"./IconClose-s_NQ_Q4c.js";const te={class:"section"},oe={class:"container"},ae={class:"section-header"},ne={class:"form"},le={class:"container-limited"},se={__name:"ContractCreateContract",async setup(re){let k,g;const y=U(),m=O(),s=G(),h=J(),T=W("emitter"),p=d(!1),c=d("Natural"),o=d(null),V=u(()=>y.data),a=u(()=>m?.profileList),_=u(()=>Object.keys(a.value).map(e=>{if(a.value[e].TemplateID==="Natural"||a.value[e].TemplateID==="Juridical"||a.value[e].TemplateID==="Individual"||a.value[e].TemplateID==="NaturalPartner")return{value:a.value[e].ID,name:a.value[e].Name,contractID:a.value[e].ContractID}}).filter(e=>e.contractID===0)),I=e=>{e.key==="Enter"&&e.ctrlKey&&!P.value&&C()},P=u(()=>o.value===null||o.value===void 0);D(()=>{document.addEventListener("keyup",I)}),A(()=>{document.removeEventListener("keyup",I)});function C(){p.value=!0,m.contractMake({ProfileID:o.value,TypeID:c.value}).then(e=>{console.log(e),e.status==="success"&&(T.emit("open-modal",{component:"SuccessContract",data:"Договор успешно создан!"}),s.push("/Contracts")),p.value=!1})}function b(){o.value=_.value?.[0]?.value||null}return K(c,()=>{b()}),D(()=>{_.value.length<1&&s.push(`/ProfileMake?ProfileEmpty=true&Redirect=${s.options.history.state.back}`),console.log(h,"route contracts"),console.log(s.options,"options"),console.log(s.options.history.state.back,"full path"),b()}),[k,g]=q(()=>m.fetchProfiles()),await k,g(),(e,t)=>{const E=M,L=H("router-link"),N=j,S=F,$=w,x=R;return i(),f(v,null,[r(E),n("section",te,[n("div",oe,[n("div",ae,[r(L,{to:"/Contracts",class:"section-label"},{default:z(()=>t[2]||(t[2]=[X("Мои договора",-1)])),_:1,__:[2]}),t[3]||(t[3]=n("h1",{class:"section-title"},"Создать договор",-1))]),r(N),t[4]||(t[4]=n("div",{class:"section-header"},[n("h2",{class:"section-block_title"},"Шаблон")],-1)),n("form",ne,[(i(!0),f(v,null,Q(V.value?.Contracts?.Types,l=>(i(),f(v,{key:l?.ProfileTemplateID},[l?.ProfileTemplateID!==""?(i(),Y(S,{key:0,label:l?.Name,value:l?.ProfileTemplateID,modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=B=>c.value=B)},null,8,["label","value","modelValue"])):Z("",!0)],64))),128))]),n("div",le,[r($,{title:"Использовать профиль",items:_.value,modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=l=>o.value=l)},null,8,["items","modelValue"]),r(x,{onClick:C,disabled:o.value===null||o.value===void 0,"is-loading":p.value,label:"Зарегистрировать"},null,8,["disabled","is-loading"])])])])],64)}}},ge=ee(se,[["__scopeId","data-v-be4719ab"]]);export{ge as default};
