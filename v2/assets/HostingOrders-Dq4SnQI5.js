import{_ as ae}from"./EmptyStateBlock-BaR9js3E.js";import{_ as re}from"./HostingCard-DpgT2eeZ.js";import{_ as le}from"./FormInputSearch-BN5nl3dB.js";import{_ as ie}from"./ClausesKeeper-CTja-fCz.js";import{_ as ue}from"./ButtonDefault-BIBStZbJ.js";import{m as me}from"./bootstrap-vue-next-DwS3lKQb.js";import{_ as ce,a as pe}from"./IconButtonBack-yE5ZfOaf.js";import{_ as de}from"./BlueButton.vue_vue_type_script_setup_true_lang-CnzqAS80.js";import{_ as _e,f as fe}from"./BlockBalanceAgreement-qtspRQ_B.js";import{u as ve,r as c,D,x as ge,f as O,H as we,c as _,b as l,a,C as p,h as x,t as f,w as v,P as Se,v as H,F as M,i as he,d as ke,o as s,e as $}from"./index-CmCGXBst.js";import{s as xe}from"./multiselect-DhoC9bwZ.js";import{u as be}from"./hosting-CzUiTaaD.js";import{u as ye}from"./contracts-P7YPBhEI.js";import{u as Ce}from"./testTransforms-CtLjUrql.js";import{u as Ie}from"./global-5eUCDNCu.js";import{_ as Be}from"./WhiteButton-B0VC5rKo.js";import{_ as De}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StatusBadge-CjHHKSUG.js";import"./IconLink-YgoSh8il.js";import"./CardButton-D2yx9NRX.js";import"./ServerStatusBadge.vue_vue_type_script_setup_true_lang-Cxfq-4-V.js";import"./IconDots-hRD0_8ej.js";import"./UserNote-8i0DdDDd.js";import"./IconCard-_anr564X.js";import"./time-DenPiOX5.js";import"./IconPlus-BicE38kO.js";import"./IconClose-B_k4TzXM.js";const Oe={class:"tw-px-4 md:tw-px-8"},He={class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-2 tw-mb-4"},$e={class:"tw-flex tw-items-center tw-gap-2"},Ve={key:0,class:"tw-flex tw-items-center tw-gap-2"},Pe={key:1,class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-4 tw-my-4"},Le={class:"list-form"},Ne={class:"list-form_col list-form_col--sm"},Me={class:"list-form_select"},Ue={class:"multiselect-option"},Te={key:0,class:"tw-my-6 tw-space-y-4"},je={__name:"HostingOrders",async setup(Ae){let u,m;const d=be(),U=ve(),b=ye(),V=Ie(),y=ke(),{formDescriptionLine:C}=Ce(),g=c("*"),w=c(null),r=c(!1),S=c([]),I=c(null),B=c(!1),h=ge("emitter");[u,m]=D(()=>d.fetchHostingOrders()),await u,m(),[u,m]=D(()=>d.fetchHostingSchemes()),await u,m(),[u,m]=D(()=>b.fetchContracts()),await u,m(),h.on("updateHostingList",()=>{d.fetchHostingOrders()});const i=O(()=>Object.values(d.hostingList).reverse()),P=O(()=>{let t=[{value:"*",name:"Все договора"}];return i.value!==null?(i.value.forEach(e=>{t.find(n=>n.value===e.ContractID)||t.push({value:e.ContractID,name:b.contractsList?.[e?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}}),k=O(()=>z(K(i.value))),T=t=>{S.value=t};async function j(){const t=Object.keys(S.value).filter(n=>S.value[n]),e={ServiceID:1e4,ItemsPay:I.value,OrdersIDs:t,...B.value&&{UseBalance:"yes"}};await V.OrdersPay(e).then(n=>{n==="Basket"?y.push("/Basket"):n?.Status==="Ok"&&(r.value=!1,h.emit("open-modal",{component:"BalanceProlong",data:{Message:n?.Message,Count:n?.Count}}))})}function A(){r.value=!0}function R(){r.value=!1}function E(){y.go(0)}function L(){y.push("/HostingSchemes")}function F(t,e){h.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить хостинг #${e}?`,tableID:"HostingOrders",successEmit:"updateHostingList"}})}function q(t){h.emit("open-modal",{component:"OrdersTransfer",data:t})}function G(t){V.OrderManageHosting(t)}function K(t){return g.value!=="*"?t.filter(e=>e?.ContractID===g.value):t}function z(t){return w.value!==null?t.filter(e=>e?.Domain.toLowerCase().includes(w.value.toLowerCase())):t}function J(t){const e=Q(t?.SchemeID);return[{text:e?.Name},{text:C(e?.SchemeParams?.limit_webdomains)},{text:C(e?.SchemeParams?.limit_quota)},{text:C(e?.SchemeParams?.limit_emails)},{text:`${fe(e?.CostMonth)} в месяц`,bold:!0}]}function Q(t){return d.hostingSchemes?.[t]}return we(()=>{i.value.length<1&&L()}),(t,e)=>{const n=_e,W=ce,X=de,Y=pe,Z=me,ee=ue,te=ie,oe=le,se=re,N=ae;return s(),_(M,null,[l(n),a("div",Oe,[a("div",He,[a("div",$e,[r.value?(s(),p(W,{key:0,onClick:e[0]||(e[0]=o=>R()),class:"tw-cursor-pointer"})):x("",!0),a("h1",{class:"tw-text-xl sm:tw-text-4xl tw-cursor-pointer",onClick:e[1]||(e[1]=o=>E())},f(r.value?"Продление услуг Хостинга":"Хостинг"),1)]),r.value?x("",!0):(s(),_("div",Ve,[i.value.length?(s(),p(Be,{key:0,onClick:e[2]||(e[2]=o=>A())},{default:v(()=>e[9]||(e[9]=[$("Продлить несколько заказов ",-1)])),_:1,__:[9]})):x("",!0),l(X,{onClick:e[3]||(e[3]=o=>L())},{default:v(()=>e[10]||(e[10]=[$("Заказать",-1)])),_:1,__:[10]})])),r.value?(s(),_("div",Pe,[l(Y,{class:"contr period",modelValue:I.value,"onUpdate:modelValue":e[4]||(e[4]=o=>I.value=o)},null,8,["modelValue"]),l(Z,{id:"checkbox-balance",modelValue:B.value,"onUpdate:modelValue":e[5]||(e[5]=o=>B.value=o),name:"checkbox-balance"},{default:v(()=>e[11]||(e[11]=[$(" Использовать средства с баланса ",-1)])),_:1,__:[11]},8,["modelValue"]),l(ee,{label:"Продлить",onClick:e[6]||(e[6]=o=>j())})])):x("",!0)]),(s(),p(Se,null,[l(te)],1024)),a("div",Le,[a("div",Ne,[a("div",Me,[l(H(xe),{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=o=>g.value=o),options:P.value,disabled:P.value?.length<=1,label:"name"},{singlelabel:v(({value:o})=>[a("span",null,"# "+f(String(o.value).padStart(5,"0"))+" / "+f(o.name),1)]),option:v(({option:o})=>[a("span",Ue,"# "+f(String(o.value).padStart(5,"0"))+" / "+f(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l(oe,{modelValue:w.value,"onUpdate:modelValue":e[8]||(e[8]=o=>w.value=o)},null,8,["modelValue"])]),i.value&&i.value.length>0?(s(),_("div",Te,[k.value&&k.value?.length>0?(s(!0),_(M,{key:0},he(k.value,(o,ne)=>(s(),p(se,{key:o.OrderID,hosting:o,"user-name":`${H(U).userInfo?.Name} - ${H(b).contractsList?.[o?.ContractID]?.Customer}`,params:J(o),"info-link":`/HostingOrders/${o?.OrderID}`,"is-last":ne===k.value.length-1,isSeveral:r.value,"selected-rows":S.value,onUpdateSelectedRows:T,onDelete:F,onTransfer:q,onManage:G},null,8,["hosting","user-name","params","info-link","is-last","isSeveral","selected-rows"]))),128)):(s(),p(N,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(s(),p(N,{key:1,class:"no-margin",label:"У Вас нет заказов на хостинг"}))])],64)}}},_t=De(je,[["__scopeId","data-v-77706c6e"]]);export{_t as default};
