import{_ as R,S as W,g as S,j as K,o as h,c as C,a as l,b as c,d as v,t as D,k as E,w as _,F,x as Q,y as U,p as X,l as Y,e as Z,r as H,h as tt}from"./index-642cdac5.js";import{u as et}from"./domain-a475aef2.js";import{u as nt}from"./contracts-16ef7000.js";import{f as z,s as ot}from"./useTimeFunction-8602dd60.js";import{I as at}from"./IconSearch-f354c728.js";import{S as st}from"./Select2-28406c99.js";import{s as it}from"./multiselect-bb2ec7ab.js";import{z as rt,k as lt,d as ct}from"./bootstrap-vue-next.es-9ff54498.js";import{_ as mt}from"./OrderIDBadge-d3607d65.js";import{_ as dt}from"./IconDots-24f2aa45.js";import{_ as ut}from"./IconCard-b302365f.js";import{S as _t}from"./StatusBadge-52b4bbab.js";import{_ as ft}from"./HelperComponent-73967625.js";import{_ as q}from"./ClausesKeeper-12bc5d50.js";import{B as G}from"./BlockBalanceAgreement-ccba2ab2.js";import{u as Dt}from"./globalActions-c9fc22a3.js";import{E as ht}from"./EmptyStateBlock-1861cff5.js";import{_ as pt}from"./FormInputSearch-7a23b402.js";import{_ as gt}from"./ButtonDefault-eb076df2.js";import"./IconArrow-c0196cbe.js";import"./IconClose-f1b85910.js";import"./IconPlus-08c75518.js";const vt={class:"hosting-item"},It={class:"hosting-item__row"},bt=["href"],kt={class:"hosting-item-domains"},Ot={class:"hosting-item-domains__window"},wt=["innerHTML"],yt={class:"hosting-item__date"},St={class:"hosting-item__row"},Ct={class:"hosting-item__person"},Lt={class:"hosting-item__row"},Bt={class:"hosting-item__list"},Pt={key:0},Mt={key:1,class:"bold"},Nt={class:"hosting-item__controls"},Tt={class:"btn btn--dots"},$t={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","designateOwner","manage"],setup(a,{emit:s}){const m=a,i=W("emitter"),p=S(()=>{var t,d;if(!((t=m.itemData)!=null&&t.Domain))return"";const o=(d=m.itemData)==null?void 0:d.Domain;return o.startsWith("http://")||o.startsWith("https://")?o:`https://${o}`});function O(o){if(!o)return z(new Date);const t=new Date,d=new Date(t.getTime()+o*24*60*60*1e3);return z(d)}function I(){var o,t;console.log((o=m.itemData)==null?void 0:o.ID),s("delete",(t=m.itemData)==null?void 0:t.ID)}function u(){var o,t,d;i.emit("open-modal",{component:"SendAuthInfo",data:{DomainOrderID:(o=m.itemData)==null?void 0:o.ID,Domain:(t=m.itemData)==null?void 0:t.Domain,AuthInfo:(d=m.itemData)==null?void 0:d.AuthInfo}})}function w(){var o,t;s("transfer",{ServiceOrderID:(o=m.itemData)==null?void 0:o.ID,ServiceID:(t=m.itemData)==null?void 0:t.ServiceID})}function L(){var o;s("designateOwner",{DomainOrderID:(o=m.itemData)==null?void 0:o.ID})}function B(o){return o.split(",").join("<br>")}return(o,t)=>{var P,$,x,A,n,r,g,M,N,V,T;const d=mt,b=K("router-link"),f=rt,e=lt,y=ct;return h(),C("div",vt,[l("div",It,[c(d,{orderID:(P=a.itemData)==null?void 0:P.OrderID},null,8,["orderID"]),l("a",{class:"hosting-item__name",href:p.value,target:"_blank"},[v(D(($=a.itemData)==null?void 0:$.Domain),1),l("div",kt,[l("div",Ot,[l("div",{class:"hosting-item-domains__text",innerHTML:B(a.itemData.DNSs)},null,8,wt)])])],8,bt),c(_t,{status:(x=a.itemData)==null?void 0:x.StatusID,"status-table":"DomainOrders"},null,8,["status"]),l("div",yt,"Дата окончания "+D(O((A=a.itemData)==null?void 0:A.DaysRemainded))+" | "+D(((n=a.itemData)==null?void 0:n.DaysRemainded)||0)+" дн.",1)]),l("div",St,[l("div",Ct,D(a.userName),1),c(ft,{"user-notice":(r=a.itemData)==null?void 0:r.UserNotice,id:(g=a.itemData)==null?void 0:g.OrderID,position:a.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),l("div",Lt,[l("ul",Bt,[(M=a.scheme)!=null&&M.PackageID?(h(),C("li",Pt,D((N=a.scheme)==null?void 0:N.PackageID),1)):E("",!0),(V=a.scheme)!=null&&V.CostProlong?(h(),C("li",Mt,D((T=a.scheme)==null?void 0:T.CostProlong)+" ₽",1)):E("",!0)])]),l("div",Nt,[l("button",{class:"btn btn--md btn--bold",onClick:t[0]||(t[0]=k=>{var j;return o.$router.push(`/DomainOrderPay/${(j=a.itemData)==null?void 0:j.OrderID}`)})},[c(ut),v("Оплатить")]),c(y,{class:"dropdown-dots",right:""},{"button-content":_(()=>[l("div",Tt,[c(dt)])]),default:_(()=>[c(f,null,{default:_(()=>[c(b,{to:a.infoLink},{default:_(()=>[v("Дополнительная информация")]),_:1},8,["to"])]),_:1}),c(f,null,{default:_(()=>{var k;return[c(b,{to:`/DomainOrderPay/${(k=a.itemData)==null?void 0:k.OrderID}`},{default:_(()=>[v("Оплатить заказ")]),_:1},8,["to"])]}),_:1}),c(f,{onClick:t[1]||(t[1]=k=>L())},{default:_(()=>[v("Определить владельца")]),_:1}),c(f,{onClick:t[2]||(t[2]=k=>w())},{default:_(()=>[v("Передать на другой аккаунт")]),_:1}),c(f,{onClick:t[3]||(t[3]=k=>u())},{default:_(()=>[v("Ввести AuthInfo")]),_:1}),c(e),c(f,{class:"color-red",onClick:t[4]||(t[4]=k=>I())},{default:_(()=>[v("Удалить")]),_:1})]),_:1})])])}}},J=R($t,[["__scopeId","data-v-5ea5f5bc"]]),xt=a=>(X("data-v-4ff1d595"),a=a(),Y(),a),At={class:"section"},Vt={class:"container"},Ut={class:"section-header"},jt=xt(()=>l("h1",{class:"section-title"},"Домены",-1)),Et={class:"btn__group"},Ft={class:"list-form"},Ht={class:"list-form_col list-form_col--sm"},zt={class:"list-form_select"},Rt={class:"multiselect-option"},Wt={key:0};function Kt(a,s,m,i,p,O){var d,b,f;const I=G,u=gt,w=q,L=K("Multiselect"),B=pt,o=J,t=ht;return h(),C(F,null,[c(I),l("div",At,[l("div",Vt,[l("div",Ut,[jt,l("div",Et,[c(u,{label:"Заказать",onClick:s[0]||(s[0]=e=>i.navigateToDomainSchemes())}),c(u,{label:"Перенести домен",onClick:s[1]||(s[1]=e=>i.openTransferModal())})])]),c(w,{partition:"Header:/DomainOrders"}),l("div",Ft,[l("div",Ht,[l("div",zt,[c(L,{modelValue:i.select,"onUpdate:modelValue":s[2]||(s[2]=e=>i.select=e),options:i.getUsers,label:"name",disabled:((d=i.getUsers)==null?void 0:d.length)<=1},{singlelabel:_(({value:e})=>[l("span",null,"# "+D(e.value.padStart(5,"0"))+" / "+D(e.name),1)]),option:_(({option:e})=>[l("div",Rt,"# "+D(e.value.padStart(5,"0"))+" / "+D(e.name),1)]),_:1},8,["modelValue","options","disabled"])])]),c(B,{modelValue:i.search,"onUpdate:modelValue":s[3]||(s[3]=e=>i.search=e)},null,8,["modelValue"])]),i.getDomainsList&&((b=i.getDomainsList)==null?void 0:b.length)>0?(h(),C("div",Wt,[i.filterProducts&&((f=i.filterProducts)==null?void 0:f.length)>0?(h(!0),C(F,{key:0},Q(i.filterProducts,(e,y)=>(h(),U(o,{"item-data":e,"user-name":i.getUserName(e==null?void 0:e.ContractID),scheme:i.filterDomainScheme(e==null?void 0:e.SchemeID),"info-link":`/DomainOrders/${e==null?void 0:e.OrderID}`,"is-last":y===i.filterProducts.length-1,onDelete:i.deleteItem,onTransfer:i.transferItem,onDesignateOwner:P=>i.designateOwner(e==null?void 0:e.ID),onManage:i.orderManage},null,8,["item-data","user-name","scheme","info-link","is-last","onDelete","onTransfer","onDesignateOwner","onManage"]))),256)):(h(),U(t,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(h(),U(t,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}const qt={components:{IconSearch:at,DomainItem:J,Select2:st,Multiselect:it,ClausesKeeper:q,BlockBalanceAgreement:G},async setup(){const a=Dt(),s=et(),m=nt(),i=Z(),p=W("emitter");p.on("updateDomainsList",()=>{s.fetchDomains()});const O=H("*"),I=H(null),u=S(()=>{var n;return(n=Object.keys(s==null?void 0:s.domainsList).map(r=>s==null?void 0:s.domainsList[r]))==null?void 0:n.reverse()}),w=S(()=>s==null?void 0:s.domainSchemes),L=S(()=>m==null?void 0:m.contractsList),B=S(()=>d(t(u.value))),o=S(()=>{let n=[{value:"*",name:"Все договора"}];return u.value!==null?(Object.keys(u.value).forEach(r=>{var g,M,N;n.find(V=>{var T;return V.value===((T=u.value[r])==null?void 0:T.ContractID)})||n.push({value:(g=u.value[r])==null?void 0:g.ContractID,name:(N=L.value[(M=u.value[r])==null?void 0:M.ContractID])==null?void 0:N.Customer})}),n):{value:"*",name:"Все договора"}});tt(()=>{u.value.length<1&&y()});function t(n){return O.value!=="*"?n.filter(r=>(r==null?void 0:r.ContractID)===O.value):n}function d(n){return I.value!==null?n.filter(r=>r==null?void 0:r.Domain.toLowerCase().includes(I.value.toLowerCase())):n}function b(n){var r;return(r=w.value)==null?void 0:r[n]}function f(n){var r,g;return(g=(r=m==null?void 0:m.contractsList)==null?void 0:r[n])==null?void 0:g.Customer}function e(n){a.OrderManage(n)}function y(){i.push({path:"/DomainSchemes"})}function P(n){p.emit("open-modal",{component:"DeleteItem",data:{id:n,message:`Вы действительно хотите удалить домен #${n}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function $(n){p.emit("open-modal",{component:"OrdersTransfer",data:n})}function x(){p.emit("open-modal",{component:"DomainTransfer",data:{}})}function A(n){const r={DomainOrderID:n};p.emit("open-modal",{component:"DomainSelectOwner",data:r})}return await s.fetchDomains(),await s.fetchDomainSchemes(),await m.fetchContracts(),await m.fetchProfiles(),{getDomainsList:u,getDomainsSchemes:w,getUsers:o,select:O,search:I,openTransferModal:x,filterProducts:B,getUserName:f,designateOwner:A,deleteItem:P,orderManage:e,filterDomainScheme:b,navigateToDomainSchemes:y,startFunction:ot,transferItem:$}}},he=R(qt,[["render",Kt],["__scopeId","data-v-4ff1d595"]]);export{he as default};
