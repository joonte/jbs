import{j as y,o as m,c as h,a as r,b as u,w as k,d as O,t as x,F as T,v as F,n as W,k as X,_ as z,r as L,x as C,p as Y,l as Z,R as $,g as P}from"./index-1c309346.js";import{I as tt}from"./IconSearch-373e7b4f.js";import{u as K}from"./vps-558acddc.js";import{_ as et}from"./HelperComponent-3eb94393.js";import{S as q}from"./StatusBadge-a49537d5.js";import{I as G}from"./IconRotate-3c438b58.js";import{v as st}from"./vpsStatuses-32ffaaf5.js";import{_ as at}from"./OrderIDBadge-afd00b65.js";import{S as ot}from"./Select2-bf57061c.js";import{s as nt}from"./multiselect-b7ad6876.js";import{_ as J}from"./ClausesKeeper-b9906182.js";import{u as rt}from"./contracts-7b919c67.js";import{E as it}from"./EmptyStateBlock-5a6a4cd4.js";import{_ as lt}from"./FormInputSearch-de4e3004.js";import"./ButtonDefault-cd183bf8.js";import"./IconArrow-6927efe5.js";import"./IconClose-7cf50ca7.js";import"./IconPlus-ea6f8c21.js";const ct={class:"hosting-item"},dt={class:"hosting-item__row"},_t={class:"hosting-item__row"},mt={class:"hosting-item__person"},ut={class:"hosting-item__row"},ft={class:"hosting-item__list"},pt=["innerHTML"],vt={key:0,class:"hosting-item__controls"},ht={class:"ico"};function gt(n,i,s,e,S,c){var p,v,a,t,o,d,l;const f=at,b=y("router-link"),g=q,I=y("Helper"),V=G;return m(),h("div",ct,[r("div",dt,[u(f,{orderID:(p=s.itemData)==null?void 0:p.OrderID},null,8,["orderID"]),u(b,{class:"hosting-item__name",to:`/VPSOrders/${s.itemData.OrderID}`},{default:k(()=>[O(x(s.itemData.IP||s.itemData.Domain),1)]),_:1},8,["to"]),u(g,{status:(v=s.itemData)==null?void 0:v.StatusID,DaysRemainded:(a=s.itemData)==null?void 0:a.DaysRemainded,"status-table":"VPSOrders"},null,8,["status","DaysRemainded"])]),r("div",_t,[r("div",mt,x(s.userName),1),u(I,{"user-notice":(t=s.itemData)==null?void 0:t.UserNotice,id:(o=s.itemData)==null?void 0:o.OrderID,position:s.isLast?"bottom":"top",emit:"updateVPSList"},null,8,["user-notice","id","position"])]),r("div",ut,[r("ul",ft,[(m(!0),h(T,null,F(s.params,_=>(m(),h("li",{innerHTML:_==null?void 0:_.text},null,8,pt))),256))])]),((d=s.itemData)==null?void 0:d.StatusID)==="Active"?(m(),h("div",vt,[r("div",{class:W(["btn btn--md btn--border btn--rotate btn--rotate_green button-large",{"btn--rotate_gray":((l=s.itemData)==null?void 0:l.StatusID)!=="Active"||e.isReloading,"btn--rotate_loading":e.isReloading}]),title:"Перезагрузить выделенный сервер",onClick:i[0]||(i[0]=(..._)=>e.reloadItem&&e.reloadItem(..._))},[O("Включен"),r("button",null,[r("div",ht,[u(V)])])],2)])):X("",!0)])}const bt={components:{StatusBadge:q,IconRotate:G,Helper:et},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1},userName:{type:String,default:""}},setup(n,{emit:i}){const s=K(),e=L(!1);function S(c){var f;e.value=!0,s.VPSReboot({VPSOrderID:(f=n.itemData)==null?void 0:f.ID}).then(()=>{setTimeout(()=>{e.value=!1},1e3)})}return{vpsStatuses:st,reloadItem:S,isReloading:e}}},Q=z(bt,[["render",gt],["__scopeId","data-v-d4eb11e0"]]),It=n=>(Y("data-v-ca085fd2"),n=n(),Z(),n),Vt={class:"section"},Dt={class:"container"},Pt={class:"section-header"},St=It(()=>r("h1",{class:"section-title"},"VPS/VDS серверы",-1)),yt={class:"list-form"},Ct={class:"list-form_col list-form_col--sm"},kt={class:"list-form_select"},Ot={class:"multiselect-option"},xt={key:0};function Lt(n,i,s,e,S,c){var v,a,t;const f=y("router-link"),b=J,g=y("Multiselect"),I=lt,V=Q,p=it;return m(),h("div",Vt,[r("div",Dt,[r("div",Pt,[St,u(f,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:k(()=>[O("Заказать")]),_:1})]),u(b,{partition:"Header:/VPSOrders"}),r("div",yt,[r("div",Ct,[r("div",kt,[u(g,{modelValue:e.select,"onUpdate:modelValue":i[0]||(i[0]=o=>e.select=o),options:e.getUsers,disabled:((v=e.getUsers)==null?void 0:v.length)<=1,label:"name"},{option:k(({option:o})=>[r("div",Ot,x(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),u(I,{modelValue:e.search,"onUpdate:modelValue":i[1]||(i[1]=o=>e.search=o)},null,8,["modelValue"])]),e.getVpsOrders&&((a=e.getVpsOrders)==null?void 0:a.length)>0?(m(),h("div",xt,[e.filterProducts&&((t=e.filterProducts)==null?void 0:t.length)>0?(m(!0),h(T,{key:0},F(e.filterProducts,(o,d)=>{var l;return m(),C(V,{"item-data":o,"is-last":d===e.filterProducts.length-1,"user-name":(l=e.getContracts[o==null?void 0:o.ContractID])==null?void 0:l.Customer,params:e.formItemParamList(o)},null,8,["item-data","is-last","user-name","params"])}),256)):(m(),C(p,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(m(),C(p,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])}const wt={components:{IconSearch:tt,Select2:ot,ClausesKeeper:J,Multiselect:nt,VpsItem:Q},async setup(){const n=K(),i=rt(),s=L(null),e=L("*");$("emitter").on("updateVPSList",()=>{n.fetchVPS()});const c=P(()=>{var a;return(a=Object.keys(n==null?void 0:n.vpsList).map(t=>n==null?void 0:n.vpsList[t]))==null?void 0:a.reverse()}),f=P(()=>n.vpsSchemes),b=P(()=>V(I(c.value))),g=P(()=>i==null?void 0:i.contractsList);function I(a){return e.value!=="*"?a.filter(t=>(t==null?void 0:t.ContractID)===e.value):a}function V(a){return s.value!==null?a.filter(t=>t==null?void 0:t.IP.toLowerCase().includes(s.value.toLowerCase())):a}const p=P(()=>{let a=[{value:"*",name:"Все договора"}];return c.value!==null?(Object.keys(c.value).forEach(t=>{var o,d,l;a.find(_=>{var D;return _.value===((D=c.value[t])==null?void 0:D.ContractID)})||a.push({value:(o=c.value[t])==null?void 0:o.ContractID,name:(l=g.value[(d=c.value[t])==null?void 0:d.ContractID])==null?void 0:l.Customer})}),a):{value:"*",name:"Все договора"}});function v(a){var o,d,l,_,D,w,B,R,N,U,H,M,j,A,E;const t=(o=f.value)==null?void 0:o[a.SchemeID];return[{text:`${t==null?void 0:t.Name}`},{text:`${(l=(d=t==null?void 0:t.SchemeParams)==null?void 0:d.hdd_mib)==null?void 0:l.InternalName} ${(D=(_=t==null?void 0:t.SchemeParams)==null?void 0:_.hdd_mib)==null?void 0:D.Value} ${(B=(w=t==null?void 0:t.SchemeParams)==null?void 0:w.hdd_mib)==null?void 0:B.Unit}`},{text:`RAM ${(N=(R=t==null?void 0:t.SchemeParams)==null?void 0:R.ram_mib)==null?void 0:N.Value} ${(H=(U=t==null?void 0:t.SchemeParams)==null?void 0:U.ram_mib)==null?void 0:H.Unit}`},{text:`Канал ${(j=(M=t==null?void 0:t.SchemeParams)==null?void 0:M.net_bandwidth_mbitps)==null?void 0:j.Value} ${(E=(A=t==null?void 0:t.SchemeParams)==null?void 0:A.net_bandwidth_mbitps)==null?void 0:E.Unit}`}]}return await n.fetchVPS(),await n.fetchVPSSchemes(),await i.fetchContracts(),{getVpsOrders:c,search:s,getContracts:g,select:e,formItemParamList:v,getUsers:p,filterProducts:b}}},Xt=z(wt,[["render",Lt],["__scopeId","data-v-ca085fd2"]]);export{Xt as default};
