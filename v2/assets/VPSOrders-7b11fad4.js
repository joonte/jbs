import{j as M,o as D,c as O,a as i,b as l,w as f,d as C,t as b,F as A,v as J,n as at,k as ot,_ as Q,R as W,r as U,x as N,p as nt,l as st,e as rt,g as L,i as it}from"./index-01c72474.js";import{I as lt}from"./IconSearch-411bb244.js";import{u as X}from"./vps-89a4e6c6.js";import{_ as ct}from"./HelperComponent-266443ae.js";import{S as Y}from"./StatusBadge-1436ac85.js";import{I as Z}from"./IconRotate-7479c925.js";import{f as G}from"./useTimeFunction-8602dd60.js";import{v as dt}from"./vpsStatuses-32ffaaf5.js";import{z as mt,d as _t}from"./bootstrap-vue-next.es-44eeb912.js";import{_ as ut}from"./IconDots-b90ab2cc.js";import{_ as ft}from"./IconCard-35ff8a4a.js";import{_ as Dt}from"./OrderIDBadge-31863a40.js";import{S as gt}from"./Select2-626bec96.js";import{s as vt}from"./multiselect-b3bc32a2.js";import{_ as $}from"./ClausesKeeper-39926d40.js";import{u as pt}from"./contracts-b8a59bf1.js";import{B as tt}from"./BlockBalanceAgreement-89ea0555.js";import{u as ht}from"./globalActions-8f995eb9.js";import{E as It}from"./EmptyStateBlock-453d542f.js";import{_ as bt}from"./FormInputSearch-45daa112.js";import"./ButtonDefault-6f60da99.js";import"./IconArrow-669aa41b.js";import"./IconClose-6051fe98.js";import"./IconPlus-404a795f.js";const St={class:"hosting-item"},Vt={class:"hosting-item__row"},Pt={class:"hosting-item__date"},yt={class:"hosting-item__row"},Ct={class:"hosting-item__person"},Ot={class:"hosting-item__row"},kt={class:"hosting-item__list"},wt=["innerHTML"],xt={class:"hosting-item__controls"},Bt={class:"ico"},Rt={class:"btn btn--dots"};function Lt(a,s,o,e,S,V){var P,r,n,t,v,p,h,y,I;const k=Dt,m=M("router-link"),c=Y,d=M("Helper"),u=Z,w=ft,x=ut,g=mt,B=_t;return D(),O("div",St,[i("div",Vt,[l(k,{orderID:(P=o.itemData)==null?void 0:P.OrderID},null,8,["orderID"]),l(m,{class:"hosting-item__name",to:`/VPSOrders/${o.itemData.OrderID}`},{default:f(()=>[C(b(o.itemData.IP||o.itemData.Domain),1)]),_:1},8,["to"]),l(c,{status:(r=o.itemData)==null?void 0:r.StatusID,DaysRemainded:(n=o.itemData)==null?void 0:n.DaysRemainded,"status-table":"VPSOrders"},null,8,["status","DaysRemainded"]),i("div",Pt,"Дата окончания "+b(e.calculateExpirationDate((t=o.itemData)==null?void 0:t.DaysRemainded))+" | "+b(((v=o.itemData)==null?void 0:v.DaysRemainded)||0)+" дн.",1)]),i("div",yt,[i("div",Ct,b(o.userName),1),l(d,{"user-notice":(p=o.itemData)==null?void 0:p.UserNotice,id:(h=o.itemData)==null?void 0:h.OrderID,position:o.isLast?"bottom":"top",emit:"updateVPSList"},null,8,["user-notice","id","position"])]),i("div",Ot,[i("ul",kt,[(D(!0),O(A,null,J(o.params,_=>(D(),O("li",{innerHTML:_==null?void 0:_.text},null,8,wt))),256))])]),i("div",xt,[((y=o.itemData)==null?void 0:y.StatusID)==="Active"?(D(),O("div",{key:0,class:at(["btn btn--md btn--border btn--rotate btn--rotate_green button-large",{"btn--rotate_gray":((I=o.itemData)==null?void 0:I.StatusID)!=="Active"||e.isReloading,"btn--rotate_loading":e.isReloading}]),title:"Перезагрузить выделенный сервер",onClick:s[0]||(s[0]=(..._)=>e.reloadItem&&e.reloadItem(..._))},[C("Включен"),i("button",null,[i("div",Bt,[l(u)])])],2)):ot("",!0),i("div",{class:"btn btn--md btn--bold",onClick:s[1]||(s[1]=_=>{var R;return a.$router.push(`/VPSOrderPay/${(R=o.itemData)==null?void 0:R.OrderID}`)})},[l(w),C("Оплатить")]),l(B,{class:"dropdown-dots",right:""},{"button-content":f(()=>[i("div",Rt,[l(x)])]),default:f(()=>[l(g,{onClick:s[2]||(s[2]=_=>e.orderManage())},{default:f(()=>[C("Управлять заказом")]),_:1}),l(g,{onClick:s[3]||(s[3]=_=>e.transferAccount())},{default:f(()=>[C("Передать на другой аккаунт")]),_:1}),l(g,null,{default:f(()=>{var _;return[l(m,{to:`/VPSOrders/${(_=o.itemData)==null?void 0:_.OrderID}/SchemeChange`},{default:f(()=>[C("Изменить тариф")]),_:1},8,["to"])]}),_:1})]),_:1})])])}const Mt={components:{StatusBadge:Y,IconRotate:Z,Helper:ct},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1},userName:{type:String,default:""}},emits:["manage","transfer"],setup(a,{emit:s}){X();const o=W("emitter"),e=U(!1);function S(c){if(!c)return G(new Date);const d=new Date,u=new Date(d.getTime()+c*24*60*60*1e3);return G(u)}function V(){var c,d;o.emit("open-modal",{component:"OrdersTransfer",data:{ServiceOrderID:(c=a.itemData)==null?void 0:c.ID,ServiceID:(d=a.itemData)==null?void 0:d.ServiceID}})}function k(){var d;function c(u){e.value=u}o.emit("open-modal",{component:"ReloadVPS",data:{VPSOrderID:(d=a.itemData)==null?void 0:d.ID,isReloading:e.value,onReloadStatusChange:c}})}function m(){var c,d,u;s("manage",{ServiceOrderID:(c=a.itemData)==null?void 0:c.ID,ServiceID:(d=a.itemData)==null?void 0:d.ServiceID,OrderID:(u=a.itemData)==null?void 0:u.OrderID})}return{vpsStatuses:dt,reloadItem:k,isReloading:e,orderManage:m,calculateExpirationDate:S,isReloading:e,transferAccount:V}}},et=Q(Mt,[["render",Lt],["__scopeId","data-v-9c071480"]]),Nt=a=>(nt("data-v-2ebf1902"),a=a(),st(),a),At={class:"section"},Ut={class:"container"},Et={class:"section-header"},Tt=Nt(()=>i("h1",{class:"section-title"},"VPS/VDS серверы",-1)),jt={class:"list-form"},Ht={class:"list-form_col list-form_col--sm"},zt={class:"list-form_select"},Ft={class:"multiselect-option"},Kt={key:0};function qt(a,s,o,e,S,V){var g,B,P;const k=tt,m=M("router-link"),c=$,d=M("Multiselect"),u=bt,w=et,x=It;return D(),O(A,null,[l(k),i("div",At,[i("div",Ut,[i("div",Et,[Tt,l(m,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:f(()=>[C("Заказать")]),_:1})]),l(c),i("div",jt,[i("div",Ht,[i("div",zt,[l(d,{modelValue:e.select,"onUpdate:modelValue":s[0]||(s[0]=r=>e.select=r),options:e.getUsers,disabled:((g=e.getUsers)==null?void 0:g.length)<=1,label:"name"},{singlelabel:f(({value:r})=>[i("span",null,"# "+b(r.value.padStart(5,"0"))+" / "+b(r.name),1)]),option:f(({option:r})=>[i("div",Ft,"# "+b(r.value.padStart(5,"0"))+" / "+b(r.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l(u,{modelValue:e.search,"onUpdate:modelValue":s[1]||(s[1]=r=>e.search=r)},null,8,["modelValue"])]),e.getVpsOrders&&((B=e.getVpsOrders)==null?void 0:B.length)>0?(D(),O("div",Kt,[e.filterProducts&&((P=e.filterProducts)==null?void 0:P.length)>0?(D(!0),O(A,{key:0},J(e.filterProducts,(r,n)=>{var t;return D(),N(w,{"item-data":r,"is-last":n===e.filterProducts.length-1,"user-name":(t=e.getContracts[r==null?void 0:r.ContractID])==null?void 0:t.Customer,params:e.formItemParamList(r),onManage:e.orderManage},null,8,["item-data","is-last","user-name","params","onManage"])}),256)):(D(),N(x,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(D(),N(x,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])],64)}const Gt={components:{IconSearch:lt,Select2:gt,ClausesKeeper:$,Multiselect:vt,VpsItem:et,BlockBalanceAgreement:tt},async setup(){const a=X(),s=pt(),o=ht(),e=rt(),S=U(null),V=U("*");W("emitter").on("updateVPSList",()=>{a.fetchVPS()});const m=L(()=>{var n;return(n=Object.keys(a==null?void 0:a.vpsList).map(t=>a==null?void 0:a.vpsList[t]))==null?void 0:n.reverse()}),c=L(()=>a.vpsSchemes),d=L(()=>B(x(m.value))),u=L(()=>s==null?void 0:s.contractsList);it(()=>{m.value.length<1&&w()});function w(){e.push({path:"/VPSSchemes"})}function x(n){return V.value!=="*"?n.filter(t=>(t==null?void 0:t.ContractID)===V.value):n}function g(n){o.OrderManage(n)}function B(n){return S.value!==null?n.filter(t=>t==null?void 0:t.IP.toLowerCase().includes(S.value.toLowerCase())):n}const P=L(()=>{let n=[{value:"*",name:"Все договора"}];return m.value!==null?(Object.keys(m.value).forEach(t=>{var v,p,h;n.find(y=>{var I;return y.value===((I=m.value[t])==null?void 0:I.ContractID)})||n.push({value:(v=m.value[t])==null?void 0:v.ContractID,name:(h=u.value[(p=m.value[t])==null?void 0:p.ContractID])==null?void 0:h.Customer})}),n):{value:"*",name:"Все договора"}});function r(n){var v,p,h,y,I,_,R,E,T,j,H,z,F,K,q;const t=(v=c.value)==null?void 0:v[n.SchemeID];return[{text:`${t==null?void 0:t.Name}`},{text:`${(h=(p=t==null?void 0:t.SchemeParams)==null?void 0:p.hdd_mib)==null?void 0:h.InternalName} ${(I=(y=t==null?void 0:t.SchemeParams)==null?void 0:y.hdd_mib)==null?void 0:I.Value} ${(R=(_=t==null?void 0:t.SchemeParams)==null?void 0:_.hdd_mib)==null?void 0:R.Unit}`},{text:`RAM ${(T=(E=t==null?void 0:t.SchemeParams)==null?void 0:E.ram_mib)==null?void 0:T.Value} ${(H=(j=t==null?void 0:t.SchemeParams)==null?void 0:j.ram_mib)==null?void 0:H.Unit}`},{text:`Канал ${(F=(z=t==null?void 0:t.SchemeParams)==null?void 0:z.net_bandwidth_mbitps)==null?void 0:F.Value} ${(q=(K=t==null?void 0:t.SchemeParams)==null?void 0:K.net_bandwidth_mbitps)==null?void 0:q.Unit}`}]}return await a.fetchVPS(),await a.fetchVPSSchemes(),await s.fetchContracts(),{getVpsOrders:m,search:S,getContracts:u,select:V,orderManage:g,formItemParamList:r,getUsers:P,filterProducts:d,navigateToVPSSchemes:w}}},ve=Q(Gt,[["render",qt],["__scopeId","data-v-2ebf1902"]]);export{ve as default};
