import{o as n,c as a,F as d,y as f,n as b,a as u,t as g,l as D,p as A,m as w,_ as x,u as B,U as j,r as h,e as F,f as L,h as C}from"./index-5b1b768e.js";import{_ as N}from"./ButtonDefault-e9d3cb95.js";import{u as O}from"./invoices-4e5982e6.js";import{u as R}from"./postings-c0edd6b0.js";const V=c=>(A("data-v-238d17ab"),c=c(),w(),c),W={class:"list-part"},z=V(()=>u("div",{class:"list-item__title"},"Выбрать платёжную систему",-1)),E={key:0,class:"list-row grid-net"},U=["onClick"],q=["src"],G={class:"list-item__image-title"},H={class:"modal__error"};function J(c,_,m,s,v,I){return n(),a("div",W,[z,s.filterActiveSystems?(n(),a("div",E,[(n(!0),a(d,null,f(s.filterActiveSystems,p=>(n(),a(d,null,[(n(!0),a(d,null,f(p,e=>{var r;return n(),a(d,null,[e!=null&&e.IsActive?(n(),a("div",{key:0,class:b(["list-item",{"list-item_active":((r=s.paymentSystem)==null?void 0:r.id)===(e==null?void 0:e.ID)}]),onClick:y=>{s.paymentSystem={id:e==null?void 0:e.ID,type:e==null?void 0:e.Source},s.selectPaymentSystem()}},[u("img",{class:"list-item__image",src:e==null?void 0:e.Image},null,8,q),u("div",G,g(e==null?void 0:e.Description),1)],10,U)):D("",!0)],64)}),256))],64))),256))])):D("",!0),u("div",H,g(s.errorMessage),1)])}const K={components:{ButtonDefault:N},props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(c,{emit:_}){const m=B(),s=O(),v=R(),I=j("emitter"),p=h(null);F(),L();const e=C(()=>m.ConfigList),r=h(null),y=C(()=>{const o=e.value;return o!=null&&o.PaymentSystems?Object.keys(o.PaymentSystems).map(l=>{var i;const t=o.PaymentSystems[l];return String(t==null?void 0:t.IsActive)==="1"?(i=t.Collations)==null?void 0:i.slice().sort((M,P)=>parseInt(M.SortID)-parseInt(P.SortID)):null}).filter(l=>l!==null):null});function k(){var o,l;r.value!==null&&s.InvoiceMake({ContractID:(o=c.data)==null?void 0:o.ItemID,PaymentSystemID:(l=r.value)==null?void 0:l.type}).then(t=>{if(t.status==="success"&&t.data&&t.data.InvoiceID){_("modalClose");const i=t.data.InvoiceID;v.InvoiceDocument({InvoiceID:i}).then(S=>{I.emit("open-modal",{component:"InvoiceDocument",data:{html:S,ID:i}})})}else _("modalClose")})}return{getConfig:e,errorMessage:p,filterActiveSystems:y,selectPaymentSystem:k,paymentSystem:r}}},Z=x(K,[["render",J],["__scopeId","data-v-238d17ab"]]);export{Z as default};
