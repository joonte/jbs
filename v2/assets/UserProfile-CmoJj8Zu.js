import{_ as p}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{o as l,c as a,ap as de,a as t,u as Oe,ao as je,r as h,f as L,I as Re,b as i,h as V,t as D,C as w,as as O,n as q,v as ie,F as S,g as ae,w as g,e as E,x as Ke,W as ze,aa as Ge}from"./index-Codq73aV.js";import{m as Je,L as We,v as qe,r as Xe}from"./bootstrap-vue-next-W16P-SAV.js";import{_ as Ye}from"./UserNote-9g0f9gxP.js";import{_ as Qe}from"./IconSettings-Pwo5dDjN.js";import{_ as re}from"./BasicInput-DeQAeyXe.js";import{_ as e1}from"./BlockAuthEnter-Z7ZQz42c.js";import{_ as t1}from"./IconCopy-CvpXMuV2.js";import{_ as n1}from"./IconUpload-DmhfICPy.js";import{_ as o1}from"./ClausesKeeper-iUM0yapS.js";import{_ as s1}from"./ButtonDefault-CMw2aBy6.js";import{_ as l1}from"./BlockBalanceAgreement-v_bWuiVT.js";import{_ as i1}from"./user-placeholder-CyUFSnNp.js";import{u as a1}from"./files-B5cKv3cM.js";import{u as r1}from"./global-CdY51QQZ.js";import{s as d1}from"./multiselect-DElL0Rlw.js";import"./component-DqcwA9JN.js";import"./common-DyknwSqv.js";import"./IconClose-Dia1noy8.js";import"./index-BO2gwtUe.js";const c1={},u1={fill:"none",height:"18",viewBox:"0 0 18 18",width:"18",xmlns:"http://www.w3.org/2000/svg"};function _1(f,s){return l(),a("svg",u1,s[0]||(s[0]=[de('<g clip-path="url(#clip0_2792_12361)"><path d="M3.7338 17H14.2644C16.0876 17 16.9904 16.0971 16.9904 14.3086V3.70859C16.9904 1.92021 16.0876 1.01733 14.2644 1.01733H3.7338C1.91937 1.01733 1.00781 1.91153 1.00781 3.70859V14.3086C1.00781 16.1057 1.91937 17 3.7338 17Z" fill="#28A745"></path><path d="M4.76758 9.00436C4.76758 8.55291 5.08011 8.24038 5.53155 8.24038H8.24885V5.52308C8.24885 5.07164 8.55271 4.75043 8.99542 4.75043C9.44688 4.75043 9.75943 5.07164 9.75943 5.52308V8.24038H12.4854C12.9281 8.24038 13.2494 8.55291 13.2494 9.00436C13.2494 9.44707 12.9281 9.74229 12.4854 9.74229H9.75943V12.4683C9.75943 12.9197 9.44688 13.2322 8.99542 13.2322C8.55271 13.2322 8.24885 12.911 8.24885 12.4683V9.74229H5.53155C5.08011 9.74229 4.76758 9.44707 4.76758 9.00436Z" fill="white"></path></g><defs><clipPath id="clip0_2792_12361"><rect fill="white" height="16" transform="translate(1.00781 1)" width="15.9826"></rect></clipPath></defs>',2)]))}const m1=p(c1,[["render",_1]]),p1={},f1={fill:"none",height:"14",viewBox:"0 0 16 14",width:"16",xmlns:"http://www.w3.org/2000/svg"};function v1(f,s){return l(),a("svg",f1,s[0]||(s[0]=[t("path",{d:"M13.6737 13.6C15.2161 13.6 15.9908 12.8399 15.9908 11.3124V2.30234C15.9908 0.774835 15.2161 0.0147705 13.6737 0.0147705H7.26116C6.39784 0.0147705 5.65251 0.236148 5.04741 0.878143L0.701029 5.39425C0.221377 5.88866 0 6.33142 0 6.79633C0 7.2538 0.213999 7.70397 0.701029 8.19835L5.05479 12.6923C5.66727 13.327 6.40521 13.5926 7.26859 13.5926L13.6737 13.6Z",fill:"#A7A2A2"},null,-1),t("path",{d:"M6.87032 9.90301C6.53085 9.90301 6.25781 9.62998 6.25781 9.28314C6.25781 9.1208 6.32425 8.9732 6.43495 8.85514L8.48637 6.81108L6.43495 4.75965C6.32425 4.64158 6.25781 4.494 6.25781 4.33165C6.25781 3.9922 6.53085 3.72655 6.87032 3.72655C7.04002 3.72655 7.17283 3.79297 7.29089 3.90365L9.34975 5.95509L11.4233 3.89627C11.5487 3.77083 11.6816 3.71179 11.8439 3.71179C12.1834 3.71179 12.449 3.98482 12.449 4.31689C12.449 4.48662 12.4047 4.61944 12.2719 4.75227L10.2205 6.81108L12.2646 8.84777C12.39 8.96584 12.4416 9.11344 12.4416 9.28314C12.4416 9.62998 12.176 9.90301 11.8292 9.90301C11.6594 9.90301 11.5044 9.83658 11.3938 9.72588L9.34975 7.66709L7.31306 9.72588C7.19499 9.83658 7.04002 9.90301 6.87032 9.90301Z",fill:"white"},null,-1)]))}const C1=p(p1,[["render",v1]]),h1={},g1={fill:"none",height:"15",viewBox:"0 0 17 15",width:"17",xmlns:"http://www.w3.org/2000/svg"};function w1(f,s){return l(),a("svg",g1,s[0]||(s[0]=[de('<g clip-path="url(#clip0_2792_18607)"><path d="M1.94907 13.7348H15.5478C15.8979 13.7348 16.1843 13.4484 16.1843 13.0982C16.1843 12.7482 15.8979 12.4537 15.5478 12.4537H1.94907C1.59895 12.4537 1.3125 12.7482 1.3125 13.0982C1.3125 13.4484 1.59895 13.7348 1.94907 13.7348Z" fill="#A7A2A2"></path><path d="M3.86656 13.9418L14.2267 3.62143C15.0622 2.79389 15.0701 1.67989 14.2904 0.892141L14.0198 0.61364C13.248 -0.18207 12.126 -0.142284 11.2905 0.66934L0.954261 10.9897L0.102854 12.963C-0.342744 14.0213 0.739423 15.1353 1.81363 14.7216L3.86656 13.9418Z" fill="white"></path><path d="M3.26897 13.0028L11.9581 4.32962L10.5577 2.92917L1.87648 11.6024L1.1126 13.3768C1.04098 13.5678 1.23991 13.7906 1.43088 13.711L3.26897 13.0028ZM12.6504 3.6453L13.454 2.85755C13.8678 2.45174 13.8917 2.0141 13.5177 1.64807L13.2551 1.37753C12.8891 1.01946 12.4515 1.05129 12.0536 1.44914L11.242 2.24485L12.6504 3.6453Z" fill="#A7A2A2"></path></g><defs><clipPath id="clip0_2792_18607"><rect fill="white" height="14.81" width="16.1842"></rect></clipPath></defs>',2)]))}const b1=p(h1,[["render",w1]]),I1={},y1={fill:"none",height:"14",viewBox:"0 0 14 14",width:"14",xmlns:"http://www.w3.org/2000/svg"};function k1(f,s){return l(),a("svg",y1,s[0]||(s[0]=[t("path",{d:"M0.333984 7.00004C0.333984 3.85734 0.333984 2.286 1.3103 1.30968C2.28661 0.333374 3.85795 0.333374 7.00065 0.333374C10.1433 0.333374 11.7147 0.333374 12.691 1.30968C13.6673 2.286 13.6673 3.85734 13.6673 7.00004C13.6673 10.1427 13.6673 11.7141 12.691 12.6904C11.7147 13.6667 10.1433 13.6667 7.00065 13.6667C3.85795 13.6667 2.28661 13.6667 1.3103 12.6904C0.333984 11.7141 0.333984 10.1427 0.333984 7.00004Z",fill:"#A7A2A2"},null,-1),t("path",{d:"M4.19336 7.35092L5.94775 9.1053L9.80739 4.89478",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"},null,-1)]))}const L1=p(I1,[["render",k1]]),V1={},D1={fill:"none",height:"18",viewBox:"0 0 18 18",width:"18",xmlns:"http://www.w3.org/2000/svg"};function M1(f,s){return l(),a("svg",D1,s[0]||(s[0]=[t("path",{d:"M8.20376 17.9914H9.78765C10.2353 17.9914 10.5624 17.7245 10.6571 17.2855L11.1047 15.3917C11.4404 15.2798 11.7676 15.1506 12.0516 15.0129L13.7131 16.0287C14.0832 16.2611 14.505 16.2267 14.8149 15.9168L15.9254 14.8149C16.2353 14.505 16.2784 14.0574 16.0287 13.6872L15.0129 12.043C15.1592 11.7418 15.2884 11.4319 15.3831 11.1219L17.2941 10.6657C17.7331 10.571 17.9914 10.2439 17.9914 9.79624V8.23813C17.9914 7.79915 17.7331 7.47204 17.2941 7.37736L15.4003 6.9211C15.2884 6.56815 15.1506 6.24964 15.0301 5.98278L16.046 4.31277C16.287 3.94261 16.2611 3.52081 15.9426 3.2109L14.8149 2.10043C14.4964 1.80775 14.1177 1.75609 13.7389 1.9713L12.0516 3.01291C11.7761 2.86657 11.4577 2.73745 11.1047 2.62554L10.6571 0.705883C10.5624 0.266858 10.2353 0 9.78765 0H8.20376C7.7561 0 7.429 0.266858 7.32569 0.705883L6.87805 2.60832C6.54233 2.72023 6.21521 2.84936 5.92253 3.0043L4.25251 1.9713C3.87375 1.75609 3.48637 1.79914 3.16786 2.10043L2.04878 3.2109C1.73027 3.52081 1.69584 3.94261 1.94548 4.31277L2.95265 5.98278C2.84075 6.24964 2.70302 6.56815 2.5911 6.9211L0.697274 7.37736C0.258249 7.47204 0 7.79915 0 8.23813V9.79624C0 10.2439 0.258249 10.571 0.697274 10.6657L2.60832 11.1219C2.70302 11.4319 2.83214 11.7418 2.96987 12.043L1.9627 13.6872C1.70445 14.0574 1.75609 14.505 2.066 14.8149L3.16786 15.9168C3.47777 16.2267 3.90818 16.2611 4.27834 16.0287L5.93114 15.0129C6.22382 15.1506 6.54233 15.2798 6.87805 15.3917L7.32569 17.2855C7.429 17.7245 7.7561 17.9914 8.20376 17.9914ZM8.9957 12.0344C7.32569 12.0344 5.95696 10.6571 5.95696 8.98711C5.95696 7.32569 7.32569 5.95696 8.9957 5.95696C10.6657 5.95696 12.0344 7.32569 12.0344 8.98711C12.0344 10.6571 10.6657 12.0344 8.9957 12.0344Z",fill:"#A7A2A2"},null,-1)]))}const $1=p(V1,[["render",M1]]),A1={},x1={fill:"#A7A2A2",height:"19",viewBox:"0 0 19 19",width:"19",xmlns:"http://www.w3.org/2000/svg"};function S1(f,s){return l(),a("svg",x1,s[0]||(s[0]=[t("path",{d:"M9.38319 18.0549C14.245 18.0549 18.2703 14.0209 18.2703 9.16787C18.2703 4.30609 14.2362 0.280762 9.37449 0.280762C4.52139 0.280762 0.496094 4.30609 0.496094 9.16787C0.496094 14.0209 4.53017 18.0549 9.38319 18.0549ZM9.37449 16.7306C7.37924 16.7306 5.35783 15.9116 4.02481 14.4914C4.96578 13.0103 7.01329 12.139 9.37449 12.139C11.7182 12.139 13.7832 12.9928 14.7329 14.4914C13.3911 15.9116 11.3784 16.7306 9.37449 16.7306ZM9.37449 10.6578C7.70162 10.6403 6.38601 9.24623 6.38601 7.373C6.37723 5.61302 7.71032 4.14926 9.37449 4.14926C11.0474 4.14926 12.363 5.61302 12.363 7.373C12.363 9.24623 11.0561 10.6752 9.37449 10.6578Z"},null,-1)]))}const E1=p(A1,[["render",S1]]),U1={},B1={fill:"#A7A2A2",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg"};function T1(f,s){return l(),a("svg",B1,s[0]||(s[0]=[t("path",{d:"M1.97587 12.952H14.0234C14.7378 12.952 15.1711 12.5871 15.1711 12.0323C15.1711 11.2722 14.3958 10.5881 13.7422 9.9116C13.2404 9.38719 13.1037 8.30783 13.0428 7.4337C12.9896 4.51496 12.2143 2.50831 10.1925 1.77862C9.90366 0.782896 9.12078 0 7.99582 0C6.87847 0 6.08798 0.782896 5.80674 1.77862C3.78489 2.50831 3.00959 4.51496 2.95639 7.4337C2.89558 8.30783 2.75876 9.38719 2.2571 9.9116C1.59582 10.5881 0.828125 11.2722 0.828125 12.0323C0.828125 12.5871 1.25378 12.952 1.97587 12.952ZM7.99582 16C9.28799 16 10.2305 15.0574 10.3293 13.9933H5.66992C5.76874 15.0574 6.71125 16 7.99582 16Z"},null,-1)]))}const H1=p(U1,[["render",T1]]),N1={},Z1={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function P1(f,s){return l(),a("svg",Z1,s[0]||(s[0]=[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19 6V18.5C19 19.8807 17.8807 21 16.5 21H7.5C6.11929 21 5 19.8807 5 18.5V6H4.5C4.22386 6 4 5.77614 4 5.5C4 5.22386 4.22386 5 4.5 5H9V4.5C9 3.67157 9.67157 3 10.5 3H13.5C14.3284 3 15 3.67157 15 4.5V5H19.5C19.7761 5 20 5.22386 20 5.5C20 5.77614 19.7761 6 19.5 6H19ZM6 6V18.5C6 19.3284 6.67157 20 7.5 20H16.5C17.3284 20 18 19.3284 18 18.5V6H6ZM14 4.5V5H10V4.5C10 4.22386 10.2239 4 10.5 4H13.5C13.7761 4 14 4.22386 14 4.5ZM14 9.5C14 9.22386 14.2239 9 14.5 9C14.7761 9 15 9.22386 15 9.5V16.5C15 16.7761 14.7761 17 14.5 17C14.2239 17 14 16.7761 14 16.5V9.5ZM9.5 9C9.22386 9 9 9.22386 9 9.5V16.5C9 16.7761 9.22386 17 9.5 17C9.77614 17 10 16.7761 10 16.5V9.5C10 9.22386 9.77614 9 9.5 9Z",fill:"#B92519"},null,-1)]))}const F1=p(N1,[["render",P1]]),O1={},j1={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function R1(f,s){return l(),a("svg",j1,s[0]||(s[0]=[t("path",{d:"M10.5 14.7929L17.1464 8.14645C17.3417 7.95118 17.6583 7.95118 17.8536 8.14645C18.0488 8.34171 18.0488 8.65829 17.8536 8.85355L10.8536 15.8536C10.6583 16.0488 10.3417 16.0488 10.1464 15.8536L7.14645 12.8536C6.95118 12.6583 6.95118 12.3417 7.14645 12.1464C7.34171 11.9512 7.65829 11.9512 7.85355 12.1464L10.5 14.7929Z",fill:"white"},null,-1)]))}const K1=p(O1,[["render",R1]]),z1={},G1={width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function J1(f,s){return l(),a("svg",G1,s[0]||(s[0]=[t("rect",{width:"18",height:"18",fill:"#F7F9FF"},null,-1),t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.7869 1.56194C11.182 1.16685 11.768 1.16685 12.1631 1.56194L14.1881 3.58694C14.5831 3.98202 14.5831 4.56798 14.1881 4.96306L5.79175 13.3594H2.39062V9.95825L10.7869 1.56194ZM13.6989 4.275L11.475 2.05113L9.58863 3.9375L11.8125 6.16137L13.6989 4.275ZM11.2239 6.75L9 4.52613L3.23438 10.2918V12.5156H5.45825L11.2239 6.75Z",fill:"#57699B"},null,-1),t("path",{d:"M1.26562 15.6094V14.7656H16.7344V15.6094H1.26562Z",fill:"#57699B"},null,-1)]))}const W1=p(z1,[["render",J1]]),q1={},X1={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Y1(f,s){return l(),a("svg",X1,s[0]||(s[0]=[t("path",{d:"M12 11.1515L16.9757 6.17574C17.2101 5.94142 17.59 5.94142 17.8243 6.17574C18.0586 6.41005 18.0586 6.78995 17.8243 7.02426L12.8485 12L17.8243 16.9757C18.0586 17.2101 18.0586 17.59 17.8243 17.8243C17.59 18.0586 17.2101 18.0586 16.9757 17.8243L12 12.8485L7.02426 17.8243C6.78995 18.0586 6.41005 18.0586 6.17574 17.8243C5.94142 17.59 5.94142 17.2101 6.17574 16.9757L11.1515 12L6.17574 7.02426C5.94142 6.78995 5.94142 6.41005 6.17574 6.17574C6.41005 5.94142 6.78995 5.94142 7.02426 6.17574L12 11.1515Z",fill:"#B92519"},null,-1)]))}const Q1=p(q1,[["render",Y1]]),et=[{key:"Type",label:"Тип",variant:"td-gray"},{key:"Contact",label:"Контакт",variant:"td-gray"},{key:"Login",label:"Логин",variant:"td-gray"},{key:"Note",label:"Заметка",variant:"td-gray"},{key:"controls",label:"",variant:"td-controls"}],tt={class:"tw-w-full"},nt={class:"container"},ot={class:"section-header"},st={class:"btn__group none"},lt={class:"profile"},it={class:"profile-rows"},at={class:"profile-col"},rt={class:"profile-avatar img"},dt=["src"],ct={key:1,src:i1,alt:""},ut={class:"profile-avatar_upload"},_t={class:"profile-col col-max-width"},mt={class:"profile-info"},pt={class:"profile-info__wrap-e"},ft={class:"profile-info__item top-edit"},vt={class:"profile-info__item-top"},Ct={key:0,class:"profile-info__item-value"},ht={class:"profile-info__item top-edit"},gt={class:"profile-info__item-top"},wt={key:0,class:"profile-info__item-value"},bt={class:"profile-info__item top-edit"},It={class:"profile-info__item-top"},yt={key:0,class:"profile-info__item-value"},kt={class:"profile-info__item"},Lt={class:"profile-info__item-value"},Vt={key:0,class:"profile-col"},Dt={class:"profile-info"},Mt={class:"profile-info__wrap-e"},$t={class:"profile-info__item top-edit"},At={class:"top-edit__icon"},xt={class:"profile-info__item top-edit"},St={class:"top-edit__icon"},Et={class:"profile-info__item top-edit"},Ut={class:"top-edit__icon"},Bt={class:"profile-info__wrap contact-item"},Tt={class:"profile-info__item"},Ht={class:"profile-info__item wrap-item"},Nt={class:"profile-info__item"},Zt={class:"profile-info__wrap"},Pt={class:"profile-info__contact-label"},Ft={class:"profile-info__wrap edited-items"},Ot={class:"profile-info__item profile-info__contact"},jt={class:"profile-info__item"},Rt=["onClick"],Kt={class:"profile-info__item mark"},zt={class:"profile-info__item"},Gt=["onClick"],Jt={class:"profile-info__item tw-mb-8"},Wt=["src","alt"],qt={class:"type-contact tw-gap-2"},Xt=["onClick"],Yt={class:"type-contact__btns"},Qt={key:0,class:"btn btn--switch"},en=["checked","onChange"],tn={class:"dropdown-button"},nn={class:"btn btn--dots"},on={class:"profile-add"},sn={class:"tw-flex tw-flex-wrap tw-gap-2"},ln=["onClick"],an=["src","alt"],rn={__name:"UserProfile",setup(f){const s=Oe(),X=a1(),Y=je(),j=r1(),U=Ke("emitter");U.on("updateContacts",()=>{s.fetchUserData().then(()=>{v()})});const M=h(!1),R=h(null),B=h(!1),K=h(!1),ce=n=>{n.editing=!0,n.editedAddress=n.Address},ue=async n=>{const e=!n.IsPrimary,d=n.IsPrimary;n.IsPrimary=e;try{const m={MethodID:n?.MethodID,Address:n?.Address,TimeBegin:n?.TimeBegin,TimeEnd:n?.TimeEnd,IsActive:n?.IsActive,IsPrimary:e?"yes":void 0,ContactID:n?.ID};if((await s.userEditContact(m)).response!=="SUCCESS")throw new Error("Update failed");await s.fetchUserData(),v(),n.editing=!1}catch(m){n.IsPrimary=d,console.error("Update failed:",m)}},Q=n=>{n.Address=n.editedAddress;const e={MethodID:n?.MethodID,Address:n?.Address,TimeBegin:n?.TimeBegin,TimeEnd:n?.TimeEnd,IsActive:n?.IsActive,ContactID:n?.ID};s.userEditContact(e).then(d=>{d.response==="SUCCESS"&&(s.fetchUserData().then(()=>{v()}),n.editing=!1)})},_e=L(()=>s.authorizationTypes),T=L(()=>Y.data.Notifies?.Methods),b=L(()=>Y.data.Messages?.Prompts),ee=L(()=>`${ze}/UserFoto?UserID=${r.value?.ID}?${R.value}`),r=L(()=>s.userInfo),c=h({name:!1,email:!1,sign:!1}),_=h({name:r.value?.Name||"",email:r.value?.Email||"",sign:r.value?.Sign||""}),z=n=>{if(Object.keys(c.value).forEach(e=>{c.value[e]=!1}),c.value[n]=!c.value[n],c.value[n]){const e=n.charAt(0).toUpperCase()+n.slice(1);_.value[n]=r.value?.[e]||""}},x=async n=>{try{const e={Name:_.value.name,Email:_.value.email,Sign:_.value.sign};await s.UserPersonalDataChange(e).then(()=>s.fetchUserData()).then(()=>{v(),c.value[n]=!1})}catch(e){console.error("Ошибка при сохранении:",e)}},me=L(()=>r.value?.Files?.[Object.keys(r.value?.Files)?.[0]]?.Name),$=L(()=>Object.keys(r.value?.Contacts).map(n=>{if(!r.value?.Contacts?.[n]?.IsHidden)return r.value?.Contacts?.[n]}).filter(Boolean)),I=h(null),y=h({Name:"",Sign:""}),H=h(""),G=h(""),te=L(()=>Object.keys(T.value).filter(n=>T.value[n].IsActive==="1").map(n=>({name:T.value[n].Name,value:n}))),N=h({}),pe=n=>{switch(n){case"Email":const e=b.value.Email,d=/<B>Например:<\/B>\s*([^<]+)/,m=e.match(d);return m&&m[1]?`${m[1]}`:e;case"SMS":const Z=b.value.SMS,J=/<B>Например:<\/B>\s*([^<]+)/,P=Z.match(J);return P&&P[1]?`${P[1]}`:Z;case"Jabber":const C=b.value.Jabber,k=/<B>Например:<\/B>\s*([^<]+)/,A=C.match(k);return A&&A[1]?`${A[1]}`:C;default:return"Ссылка или id"}},fe=n=>{switch(n){case"Email":return b.value.Email;case"SMS":return b.value.SMS;case"Jabber":return b.value.Jabber;case"Telegram":return b.value.Telegram;case"Viber":return b.value.Viber;case"VKontakte":return b.value.VKontakte;default:return"Ссылка или id"}};function v(){let n={};$.value.forEach((e,d)=>{n[d]={...e,oldValue:e.Address}}),N.value=n,ve()}function ve(){y.value={Name:r.value?.Name,Email:r.value?.Email,Sign:r.value?.Sign}}v();function Ce(){const n={MethodID:H.value,Address:G.value,TimeBegin:"00",TimeEnd:"00",IsActive:"yes",ContactID:"0"};s.userEditContact(n).then(e=>{e.response==="SUCCESS"&&(s.fetchUserData().then(()=>{v()}),se())})}const he=async n=>{const{result:e,error:d}=await j.deleteItem({TableID:"Contacts",RowsIDs:n});e==="SUCCESS"?(s.removeContact(n),s.fetchUserData().then(()=>{v()})):console.error("Error deleting contact on server:",d)},ge=async n=>{const e=$.value[n]?.ID,{result:d,error:m}=await j.deleteItem({TableID:"Contacts",RowsIDs:e});d==="SUCCESS"||d==="Ok"?(s.removeContact(e),s.fetchUserData().then(()=>{v()})):console.error("Error deleting contact on server:",m)};Re(()=>{s.OAuth()});function we(n){window.open(n,"_self").focus()}async function be(){if(K.value=!0,M.value){for(const n of Object.keys(N.value)){let e=N.value?.[n];e.Address!==e.oldValue&&await s.userEditContact({MethodID:e.MethodID,Address:e.Address,TimeBegin:"00",TimeEnd:"00",IsActive:"yes",IsImmediately:"yes",IsSendFiles:"yes",ContactID:e.ID}).then(({response:d})=>{d==="SUCCESS"&&j.deleteItem({TableID:"Contacts",RowsIDs:e.ID})})}I.value?await X.sendFile(I.value).then(n=>{s.UserPersonalDataChange({...y.value,IsClear:B.value?"yes":"","UserFoto[]":n.slice(n.lastIndexOf("^")+1,n.length)}).then(()=>{s.fetchUserData().then(()=>{oe(),R.value=new Date().getMilliseconds()})})}):await s.UserPersonalDataChange({...y.value,IsClear:B.value?"yes":""}).then(()=>{s.fetchUserData().then(()=>{result=!1,I.value=null,v()})})}}function Ie(){U.emit("open-modal",{component:"CreateContact"})}function ye(){navigator.clipboard.writeText(`http://www.host-food.ru/p/${r.value?.ID}/`)}function ke(n){s.confirmContact({Method:n.MethodID,Value:n.Address,ContactID:n.ID,XMLHttpRequest:"yes"}).then(e=>{e?.data?.Status==="Ok"&&U.emit("open-modal",{component:"ConfirmContact",data:{Method:n.MethodID,Value:n.Address,ContactID:n.ID}})})}async function Le(n){if(I.value=n.target.files?.[0],I.value)try{const e=await X.sendFile(I.value),d={Name:r.value?.Name||"",Email:r.value?.Email||"",Sign:r.value?.Sign||"",IsClear:"","UserFoto[]":e.slice(e.lastIndexOf("^")+1)};await s.UserPersonalDataChange(d),await s.fetchUserData(),R.value=new Date().getMilliseconds()}catch(e){console.error("Error uploading avatar:",e)}}async function Ve(){const n={Name:_.value.name,Email:_.value.email,Sign:_.value.sign};await s.UserPersonalDataChange({...n,IsClear:"yes"}).then(()=>{s.fetchUserData().then(()=>{I.value=null,v()})})}function ne(n){n?.IsActive||n?.confirmed?U.emit("open-modal",{component:"EditContact",data:n}):U.emit("open-error-modal",{component:"ExclusionWindow",data:{message:'Уведомления для этого адреса отключены. Для включения уведомлений подтвердите адрес и поставьте галочку "Использовать для уведомлений"'}})}function oe(){M.value=!1,I.value=null,B.value=!1,v()}function se(){M.value=!M.value,K.value=!1}return(n,e)=>{const d=l1,m=s1,Z=o1,J=n1,P=Q1,C=re,k=W1,A=K1,De=t1,Me=e1,$e=re,Ae=Qe,le=Ye,xe=F1,Se=Je,Ee=H1,Ue=E1,Be=$1,Te=L1,W=Xe,He=b1,Ne=C1,Ze=qe,Pe=We,Fe=m1;return l(),a("div",tt,[i(d),t("div",nt,[t("div",ot,[e[20]||(e[20]=t("h1",{class:"section-title"},"Профиль",-1)),t("div",st,[M.value?(l(),a("button",{key:0,class:"btn btn--blue btn-default static-button delete",onClick:oe}," Отменить ")):V("",!0),i(m,{class:"static-button","is-loading":K.value,label:M.value?"Сохранить изменения":"Редактировать профиль",onClick:e[0]||(e[0]=o=>be().then(()=>se()))},null,8,["is-loading","label"])])]),i(Z),t("div",lt,[t("div",it,[t("div",at,[t("div",rt,[me.value?(l(),a("img",{key:0,src:ee.value,alt:""},null,8,dt)):(l(),a("img",ct))]),t("label",ut,[t("input",{type:"file",onInput:Le,title:" "},null,32),i(J),t("span",null,D(I.value?.name||"Загрузить аватарку"),1)]),ee.value?(l(),a("label",{key:0,class:"profile-avatar_upload",onClick:e[1]||(e[1]=o=>Ve())},[i(P),e[21]||(e[21]=t("span",null,"Удалить аватарку",-1))])):V("",!0)]),t("div",_t,[t("div",mt,[t("div",pt,[t("div",ft,[t("div",vt,[e[22]||(e[22]=t("div",{class:"profile-info__item-label"},"ФИО",-1)),c.value.name?(l(),w(C,{key:1,name:"name",vertical:"",modelValue:_.value.name,"onUpdate:modelValue":e[2]||(e[2]=o=>_.value.name=o),class:"profile-edit-input",onKeyup:e[3]||(e[3]=O(o=>x("name"),["enter"]))},null,8,["modelValue"])):(l(),a("div",Ct,D(r.value?.Name),1))]),t("div",{class:q(["top-edit__icon",c.value.name?"editing":""]),onClick:e[5]||(e[5]=o=>z("name"))},[c.value.name?(l(),w(A,{key:1,onClick:e[4]||(e[4]=o=>x("name"))})):(l(),w(k,{key:0}))],2)]),t("div",ht,[t("div",gt,[e[23]||(e[23]=t("div",{class:"profile-info__item-label"},"Почта",-1)),c.value.email?(l(),w(C,{key:1,name:"email",vertical:"",modelValue:_.value.email,"onUpdate:modelValue":e[6]||(e[6]=o=>_.value.email=o),class:"profile-edit-input",onKeyup:e[7]||(e[7]=O(o=>x("email"),["enter"]))},null,8,["modelValue"])):(l(),a("div",wt,D(r.value?.Email),1))]),t("div",{class:q(["top-edit__icon",c.value.email?"editing":""]),onClick:e[9]||(e[9]=o=>z("email"))},[c.value.email?(l(),w(A,{key:1,onClick:e[8]||(e[8]=o=>x("email"))})):(l(),w(k,{key:0}))],2)]),t("div",bt,[t("div",It,[e[24]||(e[24]=t("div",{class:"profile-info__item-label"},"Подпись",-1)),c.value.sign?(l(),w(C,{key:1,name:"sign",vertical:"",modelValue:_.value.sign,"onUpdate:modelValue":e[10]||(e[10]=o=>_.value.sign=o),class:"profile-edit-input",onKeyup:e[11]||(e[11]=O(o=>x("sign"),["enter"]))},null,8,["modelValue"])):(l(),a("div",yt,D(r.value?.Sign),1))]),t("div",{class:q(["top-edit__icon",c.value.sign?"editing":""]),onClick:e[13]||(e[13]=o=>z("sign"))},[c.value.sign?(l(),w(A,{key:1,onClick:e[12]||(e[12]=o=>x("sign"))})):(l(),w(k,{key:0}))],2)])]),t("div",kt,[e[25]||(e[25]=t("div",{class:"profile-info__item-label"},"Реферальная ссылка",-1)),t("div",Lt,[t("div",{class:"profile-info__item-referral",ref:"message"},D(`http://www.host-food.ru/p/${r.value?.ID}/`),513),t("button",{class:"btn profile-info__item-referral_copy",onClick:ye},[i(De,{class:"tw-size-5"})])])])])]),M.value?(l(),a("div",Vt,[t("div",Dt,[t("div",Mt,[t("div",$t,[i(C,{label:"ФИО",name:"name",placeholder:"Крылов Евгений",vertical:"",modelValue:y.value.Name,"onUpdate:modelValue":e[14]||(e[14]=o=>y.value.Name=o)},null,8,["modelValue"]),t("div",At,[i(k)])]),t("div",xt,[i(C,{label:"Почта",name:"email",placeholder:"hosting@nopreset.ru",vertical:"",disabled:"",modelValue:y.value.Email,"onUpdate:modelValue":e[15]||(e[15]=o=>y.value.Email=o)},null,8,["modelValue"]),t("div",St,[i(k)])]),t("div",Et,[i(C,{label:"Подпись",name:"name",placeholder:"С уважением, Евгений Крылов",vertical:"",modelValue:y.value.Sign,"onUpdate:modelValue":e[16]||(e[16]=o=>y.value.Sign=o)},null,8,["modelValue"]),t("div",Ut,[i(k)])])]),e[26]||(e[26]=t("div",{class:"profile-info__item none"},[t("div",{class:"profile-info__item-title"},"Новый контакт")],-1)),t("div",Bt,[t("div",Tt,[i(ie(d1),{modelValue:H.value,"onUpdate:modelValue":e[17]||(e[17]=o=>H.value=o),options:te.value,disabled:te.value.length<=1,label:"name",placeholder:"Тип адреса"},null,8,["modelValue","options","disabled"])]),t("div",Ht,[i(C,{name:"name",placeholder:pe(H.value),vertical:"",modelValue:G.value,"onUpdate:modelValue":e[18]||(e[18]=o=>G.value=o),title:fe(H.value)},null,8,["placeholder","modelValue","title"])]),t("div",Nt,[i(m,{class:"profile-info__add-button",label:"Добавить контакт",onClick:Ce})])]),t("div",Zt,[i(Me,{label:"Добавить контакт с помощью"})])]),e[29]||(e[29]=t("div",{class:"profile-info__item none"},[t("div",{class:"profile-info__item-title"},"Контактные данные")],-1)),(l(!0),a(S,null,ae($.value,(o,u)=>(l(),a(S,{key:u},[t("div",Pt,D(o?.MethodID),1),t("div",Ft,[t("div",Ot,[i($e,{name:n.name,disabled:"",modelValue:N.value[u].Address,"onUpdate:modelValue":F=>N.value[u].Address=F,vertical:""},null,8,["name","modelValue","onUpdate:modelValue"])]),t("div",jt,[t("div",{class:"profile-info__item-settings",onClick:F=>ne(o)},[i(Ae),e[27]||(e[27]=E(" Настройки ",-1))],8,Rt)]),t("div",Kt,[i(le,{text:o.UserNotice,"order-id":o.ID,noteTable:"Contacts",emit:"updateContacts"},null,8,["text","order-id"])]),t("div",zt,[t("a",{class:"profile-info__item-close",onClick:F=>ge(u)},[i(xe)],8,Gt)])])],64))),128)),i(Se,{id:"checkbox-1",modelValue:B.value,"onUpdate:modelValue":e[19]||(e[19]=o=>B.value=o),name:"checkbox-1",value:!0,"unchecked-value":!1},{default:g(()=>e[28]||(e[28]=[E(" Удалить аватарку ",-1)])),_:1,__:[28]},8,["modelValue"])])):V("",!0)]),t("div",Jt,[e[39]||(e[39]=t("div",{class:"profile-info__item-title"},"Контактные данные",-1)),$.value&&$.value.length>0?(l(),a(S,{key:0},[$.value?(l(),w(Pe,{key:0,class:"basic-table","foot-clone":!1,fields:ie(et),items:$.value,"show-empty":!0,"empty-text":"Контактных данных пока нет.","empty-filtered-text":"Контактные данные не найдены."},{"cell(Type)":g(o=>[e[30]||(e[30]=t("span",{class:"td-mobile"},"Тип",-1)),T.value?.[o.item?.MethodID]?.IMG?(l(),a("img",{key:0,src:T.value[o.item?.MethodID].IMG,alt:o.item?.MethodID,class:"method-icon"},null,8,Wt)):V("",!0)]),"cell(Contact)":g(o=>[e[31]||(e[31]=t("span",{class:"td-mobile"},"Контакт",-1)),t("div",qt,[o.item.editing?(l(),a(S,{key:0},[i(C,{class:"edit-input",vertical:"",modelValue:o.item.editedAddress,"onUpdate:modelValue":u=>o.item.editedAddress=u,onKeyup:O(u=>Q(o.item),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"]),t("button",{onClick:u=>Q(o.item),class:"save-btn"}," Сохранить ",8,Xt)],64)):(l(),a(S,{key:1},[t("span",null,D(o.item?.Address),1),t("div",Yt,[i(Ee,{onClick:u=>ne(o.item),class:"bell"},null,8,["onClick"]),i(Ue,{style:Ge({fill:Number(o.item?.Confirmed)!==0?"#28A745":"#A7A2A2"})},null,8,["style"])])],64))])]),"cell(Login)":g(o=>[e[33]||(e[33]=t("span",{class:"td-mobile"},"Логин",-1)),o.item?.MethodID==="Email"?(l(),a("label",Qt,[t("input",{type:"checkbox",checked:o.item&&o.item.IsPrimary,onChange:u=>ue(o.item)},null,40,en),e[32]||(e[32]=t("span",{class:"btn-switch__toggle"},null,-1))])):V("",!0)]),"cell(Note)":g(o=>[e[34]||(e[34]=t("span",{class:"td-mobile"},"Заметка",-1)),i(le,{text:o.item?.UserNotice,"order-id":o.item?.ID,noteTable:"Contacts",emit:"updateContacts"},null,8,["text","order-id"])]),"cell(controls)":g(o=>[t("div",tn,[i(Ze,{class:"dropdown-dots",right:""},{"button-content":g(()=>[t("span",nn,[i(Be)])]),default:g(()=>[i(W,{onClick:u=>ke(o.item)},{default:g(()=>[i(Te),e[35]||(e[35]=E(" Подтвердить ",-1))]),_:2,__:[35]},1032,["onClick"]),i(W,{onClick:u=>ce(o.item)},{default:g(()=>[i(He),e[36]||(e[36]=E(" Редактировать ",-1))]),_:2,__:[36]},1032,["onClick"]),i(W,{onClick:u=>he(o.item.ID)},{default:g(()=>[i(Ne),e[37]||(e[37]=E(" Удалить ",-1))]),_:2,__:[37]},1032,["onClick"])]),_:2},1024)])]),_:1},8,["fields","items"])):V("",!0),t("div",on,[t("div",{class:"profile-add__new",onClick:Ie},[i(Fe),e[38]||(e[38]=E(" Добавить контакт ",-1))]),t("div",sn,[(l(!0),a(S,null,ae(_e.value,(o,u)=>(l(),a("div",{key:u,class:"tw-flex tw-items-center tw-gap-1 tw-bg-sky-100 tw-rounded tw-p-2 tw-cursor-pointer",onClick:F=>we(o.OauthURL)},[o.IMG?(l(),a("img",{key:0,src:o.IMG,alt:o.Name,class:"oauth-icon-img"},null,8,an)):V("",!0),t("div",null,D(o.Name),1)],8,ln))),128))])])],64)):V("",!0)])])])])}}},$n=p(rn,[["__scopeId","data-v-e9383ffb"]]);export{$n as default};
