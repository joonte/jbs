import{_ as ae}from"./EmptyStateBlock-D6U_EDq6.js";import{_ as se}from"./DomainCard-CC0OmVdk.js";import{_ as le}from"./FormInputSearch-D7D7Vqhf.js";import{_ as re}from"./ClausesKeeper-DVJgfLR3.js";import{m as ie}from"./bootstrap-vue-next-3DpAa4tb.js";import{_ as me,a as ce}from"./IconButtonBack-D0IRTKQ9.js";import{_ as ue}from"./ButtonDefault-CghIUDY0.js";import{_ as de}from"./BlockBalanceAgreement-2iQbaweR.js";import{Q as pe,D as y,x as fe,r as p,f as _,c as v,b as a,a as l,C as h,h as I,I as _e,J as ve,t as w,w as B,v as we,F as N,i as ge,d as De,o as r,e as ke}from"./index-CipWZKo_.js";import{u as Se}from"./contracts-CILh9uSu.js";import{s as be}from"./multiselect-DWCHRlfT.js";import{u as ye}from"./global-Fil99La8.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StatusBadge-B65ys1I-.js";import"./IconLink--V9HJ_tV.js";import"./CardButton-Ym2KFbPf.js";import"./IconDots-BE2XsWZ6.js";import"./Helper-BWCpStXX.js";import"./IconCard-jY7IitfY.js";import"./time-DenPiOX5.js";import"./IconPlus-bAw7b_ly.js";import"./IconClose-ChC2G6HM.js";const Ce={class:"tw-px-4 md:tw-px-8"},Oe={class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-2 tw-mb-4"},xe={class:"tw-flex tw-items-center tw-gap-2"},Ie={key:0,class:"tw-flex tw-flex-wrap tw-items-center tw-gap-2"},Be={key:1,class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-4 tw-my-4"},Ve={class:"list-form"},$e={class:"list-form_col list-form_col--sm"},Le={class:"list-form_select"},Ne={class:"multiselect-option"},Pe={key:0,class:"tw-my-6 tw-space-y-4"},Ue={__name:"DomainOrders",async setup(je){let i,m;const V=ye(),u=pe(),g=Se(),C=De(),d=fe("emitter");[i,m]=y(()=>u.fetchDomainOrders()),await i,m(),[i,m]=y(()=>u.fetchDomainSchemes()),await i,m(),[i,m]=y(()=>g.fetchContracts()),await i,m(),[i,m]=y(()=>g.fetchProfiles()),await i,m(),d.on("updateDomainsList",()=>{u.fetchDomainOrders()});const D=p("*"),f=p(null),c=p(!1),k=p([]),O=p(null),x=p(!1),P=t=>{k.value=t};async function U(){const t=Object.keys(k.value).filter(n=>k.value[n]),e={ServiceID:"20000",ItemsPay:O.value,OrdersIDs:t,...x.value&&{UseBalance:"yes"}};await V.OrdersPay(e).then(n=>{n==="Basket"?C.push("/Basket"):n?.Status==="Ok"&&(c.value=!1,d.emit("open-modal",{component:"BalanceProlong",data:{Message:n?.Message,Count:n?.Count}}))})}function j(){c.value=!0}function M(){c.value=!1}const s=_(()=>Object.keys(u?.domainsList).map(t=>u?.domainsList[t])?.reverse()),T=_(()=>u?.domainSchemes),E=_(()=>g?.contractsList),S=_(()=>F(A(s.value))),$=_(()=>{let t=[{value:"*",name:"Все договора"}];return s.value!==null?(Object.keys(s.value).forEach(e=>{t.find(n=>n.value==s.value[e]?.ContractID)||t.push({value:s.value[e]?.ContractID,name:E.value[s.value[e]?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}});function R(){C.go(0)}function A(t){return D.value!=="*"?t.filter(e=>e?.ContractID==D.value):t}function F(t){return f.value!==null?t.filter(e=>e?.Domain.toLowerCase().includes(f.value.toLowerCase())):t}function q(t){return T.value?.[t]}function G(t){return g?.contractsList?.[t]?.Customer}function H(t){V.OrderManage(t)}function J(){const t=f.value;C.push({path:"/DomainSchemes",query:{DomainName:t}})}function Q(t,e){d.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить домен #${e}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function z(t){d.emit("open-modal",{component:"OrdersTransfer",data:t})}function K(){d.emit("open-modal",{component:"DomainTransfer",data:{}})}function W(t){const e={DomainOrderID:t};d.emit("open-modal",{component:"DomainSelectOwner",data:e})}return(t,e)=>{const n=de,X=me,b=ue,Y=ce,Z=ie,ee=re,te=le,oe=se,L=ae;return r(),v(N,null,[a(n),l("div",Ce,[l("div",Oe,[l("div",xe,[_e(a(X,{onClick:e[0]||(e[0]=o=>M())},null,512),[[ve,c.value]]),l("h1",{class:"tw-text-xl sm:tw-text-4xl tw-cursor-pointer",onClick:e[1]||(e[1]=o=>R())},w(c.value?"Продление услуг Домена":"Домены"),1)]),c.value?I("",!0):(r(),v("div",Ie,[s.value.length>1?(r(),h(b,{key:0,class:"btn-several",label:"Продлить несколько заказов",onClick:e[2]||(e[2]=o=>j())})):I("",!0),a(b,{label:"Заказать",onClick:e[3]||(e[3]=o=>J())}),a(b,{label:"Перенести домен",onClick:e[4]||(e[4]=o=>K())})])),c.value?(r(),v("div",Be,[a(Y,{class:"contr period",modelValue:O.value,"onUpdate:modelValue":e[5]||(e[5]=o=>O.value=o)},null,8,["modelValue"]),a(Z,{id:"checkbox-balance",modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=o=>x.value=o),name:"checkbox-balance"},{default:B(()=>e[10]||(e[10]=[ke(" Использовать средства с баланса ",-1)])),_:1,__:[10]},8,["modelValue"]),a(b,{label:"Продлить",onClick:e[7]||(e[7]=o=>U())})])):I("",!0)]),a(ee,{partition:"Header:/DomainOrders"}),l("div",Ve,[l("div",$e,[l("div",Le,[a(we(be),{modelValue:D.value,"onUpdate:modelValue":e[8]||(e[8]=o=>D.value=o),options:$.value,label:"name",disabled:$.value?.length<=1},{singlelabel:B(({value:o})=>[l("span",null," # "+w(String(o.value).padStart(5,"0"))+" / "+w(o.name),1)]),option:B(({option:o})=>[l("div",Ne,"# "+w(String(o.value).padStart(5,"0"))+" / "+w(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),a(te,{modelValue:f.value,"onUpdate:modelValue":e[9]||(e[9]=o=>f.value=o)},null,8,["modelValue"])]),s.value&&s.value?.length>0?(r(),v("div",Pe,[S.value&&S.value?.length>0?(r(!0),v(N,{key:0},ge(S.value,(o,ne)=>(r(),h(oe,{key:o?.OrderID,domain:o,"user-name":G(o?.ContractID),scheme:q(o?.SchemeID),"info-link":`/DomainOrders/${o?.OrderID}`,"is-last":ne===S.value.length-1,isSeveral:c.value,"selected-rows":k.value,onUpdateSelectedRows:P,onDelete:Q,onTransfer:z,onDesignateOwner:Me=>W(o?.ID),onManage:H},null,8,["domain","user-name","scheme","info-link","is-last","isSeveral","selected-rows","onDesignateOwner"]))),128)):(r(),h(L,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(r(),h(L,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])],64)}}},lt=he(Ue,[["__scopeId","data-v-4fb5819f"]]);export{lt as default};
