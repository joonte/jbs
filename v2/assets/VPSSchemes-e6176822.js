import{_ as be}from"./ButtonDefault-7c216fc6.js";import{_ as ge}from"./BlockOrderPayBalance-e0feb4e8.js";import{_ as W,r as k,h as X,o as l,c,a as t,m as de,k as T,t as v,d as ke,F as I,x as O,e as Se,g as E,O as ye,ag as z,b as j,Z as _e,ae as ie,y as J,w as Ve,p as Ie,l as De}from"./index-5e313302.js";import{_ as Pe}from"./ClausesKeeper-eb954229.js";import{u as Be}from"./vps-80bde7d9.js";import{u as Ce}from"./resetServer-2f6a71c3.js";import{u as we}from"./contracts-3351d68f.js";import{_ as xe}from"./BlockSelectContract-65c747e2.js";import{B as Oe}from"./BlockBalanceAgreement-bb87adc1.js";import"./bootstrap-vue-next.es-a19a8b41.js";import"./IconHelp-37cb81ff.js";import"./globalActions-a7429ad5.js";import"./BasicInput-be1c88a0.js";import"./component-6a5a025c.js";import"./IconClose-1f889a2e.js";import"./multiselect-bfc29db8.js";import"./IconArrow-555f9d45.js";const $e={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},name:{type:String,default:""},type:{type:String,default:"radio"},checked:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(_,{emit:u}){const o=k(null),r=k(!1);function S(){u("update:modelValue",_.data)}function y(){r.value=!0}return X(()=>{o.value=_.modelValue}),{inputValue:o,isIconPressed:r,onMouseEvent:y,updateValue:S}}},Ee={class:"form-input_border"},Ue={class:"form-input_border-label"},Ge=["name","checked"],Le={class:"form-field__data"},Me={key:0,class:"form-field__img"},Ne=["src"],Ae={class:"form-field__name"},Fe={class:"form-field__desc"},je={class:"form-field__select"};function Te(_,u,o,r,S,y){return l(),c("div",Ee,[t("label",Ue,[t("input",{name:o.name,type:"radio",checked:o.checked,onInput:u[0]||(u[0]=(...V)=>r.updateValue&&r.updateValue(...V))},null,40,Ge),t("div",Le,[de(_.$slots,"default",{},()=>[o.data.img?(l(),c("div",Me,[t("img",{src:o.data.img,alt:""},null,8,Ne)])):T("",!0)],!0),t("div",Ae,v(o.data.name),1),t("div",Fe,[ke(v(o.data.desc)+" ",1),o.data.select?de(_.$slots,"default",{key:0},()=>[t("div",je,[(l(!0),c(I,null,O(o.data.select,(V,n)=>(l(),c("div",{key:n,class:"form-field__select-item"},v(V.text),1))),128))])],!0):T("",!0)])])])])}const Ke=W($e,[["render",Te],["__scopeId","data-v-6ee6abfb"]]);const Re={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},headers:{type:Array,default:()=>[]},name:{type:String,default:""},checkbox:{type:Boolean,default:!1},checked:{type:Boolean,default:!1}},emits:["update:modelValue","input"],setup(_,{emit:u}){const o=k(null),r=k(!1);function S(){u("update:modelValue",_.data),u("input",_.data)}function y(){r.value=!0}return X(()=>{o.value=_.modelValue}),{inputValue:o,isIconPressed:r,onMouseEvent:y,updateValue:S}}},He={class:"form-input_border"},Ze={class:"form-input_border-label"},qe=["name","type","checked"],ze={class:"form-field__data"},Je={class:"form-field_header"};function Qe(_,u,o,r,S,y){return l(),c("div",He,[t("label",Ze,[t("input",{name:o.name,type:o.checkbox?"checkbox":"radio",checked:o.checked,onInput:u[0]||(u[0]=(...V)=>r.updateValue&&r.updateValue(...V))},null,40,qe),t("div",ze,[(l(!0),c(I,null,O(o.headers,(V,n)=>(l(),c("div",{key:n,class:"form-field__col"},[t("span",Je,v(V),1),t("span",null,v(o.data[n]),1)]))),128))])])])}const We=W(Re,[["render",Qe],["__scopeId","data-v-a13950e6"]]),Xe="/v2/assets/oc-2-8f4c288c.jpg";const U=_=>(Ie("data-v-cfe7bc5f"),_=_(),De(),_),Ye={class:"vps-scheme-page"},et={class:"section"},tt={class:"container"},st=U(()=>t("div",{class:"section-header"},[t("h1",{class:"section-title"},"Заказать VPS/VDS сервер")],-1)),at={class:"section"},ot={class:"container"},lt=U(()=>t("h2",{class:"section-block_title"},"Конфигурация",-1)),nt={class:"form-column"},ct={class:"form-header"},ut={class:"form-header_col"},rt={key:0,class:"section"},dt={class:"container"},_t=U(()=>t("h2",{class:"section-block_title"},"Операционная система",-1)),it={class:"form grid-gorm"},vt=["src","alt"],pt={class:"section"},mt={class:"container"},ht=U(()=>t("h2",{class:"section-block_title"},"Регион",-1)),ft={class:"form"},bt={class:"section"},gt={class:"container"},kt={class:"total-block"},St={class:"total-block__row divider-bottom"},yt=U(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),Vt={class:"total-block__col"},It={class:"total-block__row no-divider"},Dt={class:"total-block__col"},Pt={class:"total-block__col"},Bt={class:"total-block__row total-block__row--big economy-line"},Ct=U(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),wt={class:"total-block__col flex-col"},xt={class:"red"},Ot={class:"total-block__row total-block__row--big"},$t={class:"total-block__col"},Et={class:"total-block__col"},Q="Moscow",Ut={__name:"VPSSchemes",async setup(_){let u,o;const r=Be(),S=we(),y=Ce(),V=Se(),n=k(null),w=k(null),G=k(null),K=k(!1),h=k(null),ve=k([{img:Xe,value:"Moscow",name:"Россия",desc:"Москва"}]),Y=k({PackageID:"Тариф",cpu_number:"CPU",ram_mib:"RAM",hdd_mib:"Память",net_in_mbitps:"Канал",CostMonth:"Стоимость"}),R=E(()=>Object.keys(r.vpsSchemes).map(e=>r.vpsSchemes[e])),pe=E(()=>S==null?void 0:S.contractsList),q=E(()=>R.value.find(e=>{var s;return(e==null?void 0:e.ID)===((s=h.value)==null?void 0:s.ID)})),L=E(()=>{var e;return(e=y==null?void 0:y.serverGroupsList)==null?void 0:e.ServersGroups}),$=E(()=>{var i,d;const e=((i=q.value)==null?void 0:i.OS)||[],s=((d=q.value)==null?void 0:d.OSs)||[];return e.map(p=>{const m=s.find(f=>f.Name===p);return{name:p,value:p,imageUrl:m?m.Image:""}})}),ee=e=>{e.key==="Enter"&&e.ctrlKey&&!me.value&&ae()},me=E(()=>n.value===null||w.value===null);X(()=>{document.addEventListener("keyup",ee)}),ye(()=>{document.removeEventListener("keyup",ee)});function H(e){return Number(e).toFixed(2)||0}function te(){var s,i;let e=0;return(i=(s=n.value)==null?void 0:s.discounts)==null||i.Bonuses.map(d=>{e+=+d.Economy}),e}function se(e){var s,i,d,p,m,f,b,g;return{ID:e==null?void 0:e.ID,PackageID:e==null?void 0:e.PackageID,ServersGroupID:e==null?void 0:e.ServersGroupID,cpu_number:(i=(s=e==null?void 0:e.SchemeParams)==null?void 0:s.cpu_number)==null?void 0:i.Value,ram_mib:(p=(d=e==null?void 0:e.SchemeParams)==null?void 0:d.ram_mib)==null?void 0:p.Value,hdd_mib:(f=(m=e==null?void 0:e.SchemeParams)==null?void 0:m.hdd_mib)==null?void 0:f.Value,net_in_mbitps:(g=(b=e==null?void 0:e.SchemeParams)==null?void 0:b.net_in_mbitps)==null?void 0:g.Value,CostMonth:e==null?void 0:e.CostMonth}}function he(){var i,d,p,m,f,b;console.log(h.value);let e=(p=Object.keys((d=L.value)==null?void 0:d[(i=h.value)==null?void 0:i.ServersGroupID]))==null?void 0:p.find(g=>{var D,P,B,C,M,N,A,F;return((C=(B=(P=L.value)==null?void 0:P[(D=h.value)==null?void 0:D.ServersGroupID])==null?void 0:B[g])==null?void 0:C.IsActive)&&((F=(A=(N=L.value)==null?void 0:N[(M=h.value)==null?void 0:M.ServersGroupID])==null?void 0:A[g])==null?void 0:F.IsDefault)}),s=(b=Object.keys((f=L.value)==null?void 0:f[(m=h.value)==null?void 0:m.ServersGroupID]))==null?void 0:b.find(g=>{var D,P,B,C;return(C=(B=(P=L.value)==null?void 0:P[(D=h.value)==null?void 0:D.ServersGroupID])==null?void 0:B[g])==null?void 0:C.IsActive});return e||s}function fe(e){n.value=e}function ae(){var e,s;K.value=!0,r.VPSOrder({ContractID:w.value,VPSSchemeID:(e=h.value)==null?void 0:e.ID,ServerID:he(),DiskTemplate:(s=G.value)==null?void 0:s.value}).then(({result:i,info:d,error:p})=>{var m;i==="SUCCESS"?r.VPSOrderPay({VPSOrderID:d==null?void 0:d.VPSOrderID,DaysPay:(m=n.value)==null?void 0:m.actualDays,IsChange:!0}).then(f=>{let{result:b,error:g}=f;b==="SUCCESS"?V.push("/VPSOrders"):b==="BASKET"&&V.push("/Basket"),K.value=!0}):K.value=!1})}function oe(){var e,s;((e=$==null?void 0:$.value)==null?void 0:e.length)>0&&(G.value=(s=$.value)==null?void 0:s[0])}return[u,o]=z(()=>r.fetchVPSSchemes().then(()=>{var e,s;((e=R.value)==null?void 0:e.length)>0&&(h.value=se((s=R.value)==null?void 0:s[0])),oe()})),await u,o(),[u,o]=z(()=>S.fetchContracts()),await u,o(),[u,o]=z(()=>y.fetchServerGroups()),await u,o(),(e,s)=>{var b,g,D,P,B,C,M,N,A,F,le,ne,ce,ue,re;const i=Pe,d=We,p=Ke,m=ge,f=be;return l(),c(I,null,[j(Oe),t("div",Ye,[t("div",et,[t("div",tt,[st,j(i)])]),t("div",at,[t("div",ot,[lt,t("div",nt,[t("div",ct,[(l(!0),c(I,null,O(Y.value,a=>(l(),c("div",ut,v(a),1))),256))]),(l(!0),c(I,null,O(R.value,a=>{var x;return l(),J(d,{data:se(a),type:"",modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=Z=>h.value=Z),name:"config",checked:((x=h.value)==null?void 0:x.ID)===(a==null?void 0:a.ID),headers:Y.value,onInput:s[1]||(s[1]=Z=>oe())},null,8,["data","modelValue","checked","headers"])}),256))])])]),$.value?(l(),c("div",rt,[t("div",dt,[_t,t("div",it,[(l(!0),c(I,null,O($.value,a=>{var x;return l(),J(p,{data:a,modelValue:G.value,"onUpdate:modelValue":s[2]||(s[2]=Z=>G.value=Z),checked:(a==null?void 0:a.value)===((x=G.value)==null?void 0:x.value),type:"",name:"operating_system"},{default:Ve(()=>[a.imageUrl?(l(),c("img",{key:0,src:a.imageUrl,alt:a.name},null,8,vt)):T("",!0)]),_:2},1032,["data","modelValue","checked"])}),256))])])])):T("",!0),t("div",pt,[t("div",mt,[ht,t("div",ft,[(l(!0),c(I,null,O(ve.value,a=>(l(),J(p,{data:a,checked:(a==null?void 0:a.value)===Q,modelValue:Q,"onUpdate:modelValue":s[3]||(s[3]=x=>Q=x),type:"",name:"region"},null,8,["data","checked"]))),256))])])]),j(xe,{title:"Информация о сервере",modelValue:w.value,"onUpdate:modelValue":s[4]||(s[4]=a=>w.value=a)},null,8,["modelValue"]),j(m,{contractID:w.value,scheme:q.value,serviceID:"30000",isOrderID:!1,onSelect:fe},null,8,["contractID","scheme"]),t("div",bt,[t("div",gt,[t("div",kt,[((D=(g=(b=n.value)==null?void 0:b.discounts)==null?void 0:g.Bonuses)==null?void 0:D.length)>0?(l(),c(I,{key:0},[t("div",St,[yt,t("div",Vt,v(H((P=n.value)==null?void 0:P.price))+" ₽",1)]),(l(!0),c(I,null,O((C=(B=n.value)==null?void 0:B.discounts)==null?void 0:C.Bonuses,a=>(l(),c("div",It,[t("div",Dt,"Скидка "+v(a==null?void 0:a.Discount)+"% на "+v(a==null?void 0:a.Days)+" дней",1),t("div",Pt,"-"+v(H(a==null?void 0:a.Economy))+" ₽",1)]))),256))],64)):T("",!0),_e(t("div",Bt,[Ct,t("div",wt,[t("span",null,[t("s",null,v(H((M=n.value)==null?void 0:M.price))+" ₽",1)]),t("span",xt,"-"+v(te())+" ₽",1)])],512),[[ie,((F=(A=(N=n.value)==null?void 0:N.discounts)==null?void 0:A.Bonuses)==null?void 0:F.length)>0]]),_e(t("div",Ot,[t("div",$t,"Итого за "+v((le=n.value)==null?void 0:le.label),1),t("div",Et,v(H(((ne=n.value)==null?void 0:ne.price)-te()))+" ₽",1)],512),[[ie,(ce=n.value)==null?void 0:ce.price]])]),j(f,{class:"btn--wide",label:((ue=pe.value[w.value])==null?void 0:ue.Balance)>((re=n.value)==null?void 0:re.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:n.value===null||w.value===null,"is-loading":K.value,onClick:s[5]||(s[5]=a=>ae())},null,8,["label","disabled","is-loading"])])])])],64)}}},Xt=W(Ut,[["__scopeId","data-v-cfe7bc5f"]]);export{Xt as default};
