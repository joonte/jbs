import{_ as F,j as R,o as p,c as L,a as c,b as i,w as u,d as I,t as g,k as U,F as A,v as G,x as T,p as J,l as Q,e as W,R as X,r as E,g as M}from"./index-b105c350.js";import{u as Y}from"./domain-7ab15612.js";import{u as Z}from"./contracts-b62777f8.js";import{f as j,s as ee}from"./useTimeFunction-8602dd60.js";import{I as te}from"./IconSearch-3b738ce1.js";import{S as ne}from"./Select2-7e3e51ce.js";import{s as oe}from"./multiselect-34394f38.js";import{z as ae,k as se,d as re}from"./bootstrap-vue-next.es-31cfcab6.js";import{_ as ie}from"./OrderIDBadge-87b3acf9.js";import{_ as le}from"./IconDots-71cfee45.js";import{_ as ce}from"./IconCard-f1b3f450.js";import{S as me}from"./StatusBadge-137b1c8f.js";import{_ as de}from"./HelperComponent-4c4a503a.js";import{_ as z}from"./ClausesKeeper-d7dcbabd.js";import{B as H}from"./BlockBalanceAgreement-19657f3d.js";import{u as ue}from"./globalActions-38f815a9.js";import{E as _e}from"./EmptyStateBlock-197e75e2.js";import{_ as fe}from"./FormInputSearch-15711181.js";import{_ as De}from"./ButtonDefault-d83beda7.js";import"./IconArrow-27665727.js";import"./IconClose-0ba84d64.js";import"./IconPlus-745c2bd0.js";const ge={class:"hosting-item"},pe={class:"hosting-item__row"},ve={class:"hosting-item__date"},he={class:"hosting-item__row"},Ie={class:"hosting-item__person"},be={class:"hosting-item__row"},ke={class:"hosting-item__list"},Oe={key:0},we={key:1,class:"bold"},ye={class:"hosting-item__controls"},Ce={class:"btn btn--dots"},Se={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","designateOwner","manage"],setup(o,{emit:n}){const m=o;function s(l){if(!l)return j(new Date);const a=new Date,D=new Date(a.getTime()+l*24*60*60*1e3);return j(D)}function v(){var l,a;console.log((l=m.itemData)==null?void 0:l.ID),n("delete",(a=m.itemData)==null?void 0:a.ID)}function w(){var l,a;n("transfer",{ServiceOrderID:(l=m.itemData)==null?void 0:l.ID,ServiceID:(a=m.itemData)==null?void 0:a.ServiceID})}function b(){var l;n("designateOwner",{DomainOrderID:(l=m.itemData)==null?void 0:l.ID})}function _(){var l,a,D;n("manage",{ServiceOrderID:(l=m.itemData)==null?void 0:l.ID,ServiceID:(a=m.itemData)==null?void 0:a.ServiceID,OrderID:(D=m.itemData)==null?void 0:D.OrderID})}return(l,a)=>{var O,e,S,B,N,$,x,t,r,h;const D=ie,k=R("router-link"),f=ae,y=se,C=re;return p(),L("div",ge,[c("div",pe,[i(D,{orderID:(O=o.itemData)==null?void 0:O.OrderID},null,8,["orderID"]),i(k,{class:"hosting-item__name",to:o.infoLink},{default:u(()=>{var d;return[I(g((d=o.itemData)==null?void 0:d.Domain),1)]}),_:1},8,["to"]),i(me,{status:(e=o.itemData)==null?void 0:e.StatusID,"status-table":"DomainOrders"},null,8,["status"]),c("div",ve,"Дата окончания "+g(s((S=o.itemData)==null?void 0:S.DaysRemainded))+" | "+g(((B=o.itemData)==null?void 0:B.DaysRemainded)||0)+" дн.",1)]),c("div",he,[c("div",Ie,g(o.userName),1),i(de,{"user-notice":(N=o.itemData)==null?void 0:N.UserNotice,id:($=o.itemData)==null?void 0:$.OrderID,position:o.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),c("div",be,[c("ul",ke,[(x=o.scheme)!=null&&x.PackageID?(p(),L("li",Oe,g((t=o.scheme)==null?void 0:t.PackageID),1)):U("",!0),(r=o.scheme)!=null&&r.CostProlong?(p(),L("li",we,g((h=o.scheme)==null?void 0:h.CostProlong)+" ₽",1)):U("",!0)])]),c("div",ye,[c("button",{class:"btn btn--md btn--bold",onClick:a[0]||(a[0]=d=>{var P;return l.$router.push(`/DomainOrderPay/${(P=o.itemData)==null?void 0:P.OrderID}`)})},[i(ce),I("Оплатить")]),i(C,{class:"dropdown-dots",right:""},{"button-content":u(()=>[c("div",Ce,[i(le)])]),default:u(()=>[i(f,null,{default:u(()=>[i(k,{to:o.infoLink},{default:u(()=>[I("Дополнительная информация")]),_:1},8,["to"])]),_:1}),i(f,null,{default:u(()=>{var d;return[i(k,{to:`/DomainOrderPay/${(d=o.itemData)==null?void 0:d.OrderID}`},{default:u(()=>[I("Оплатить заказ")]),_:1},8,["to"])]}),_:1}),i(f,{onClick:a[1]||(a[1]=d=>b())},{default:u(()=>[I("Определить владельца")]),_:1}),i(f,{onClick:a[2]||(a[2]=d=>w())},{default:u(()=>[I("Передать на другой аккаунт")]),_:1}),i(f,{onClick:a[3]||(a[3]=d=>_())},{default:u(()=>[I("Управлять заказом")]),_:1}),i(y),i(f,{class:"color-red",onClick:a[4]||(a[4]=d=>v())},{default:u(()=>[I("Удалить")]),_:1})]),_:1})])])}}},K=F(Se,[["__scopeId","data-v-bacabddf"]]),Le=o=>(J("data-v-6e1eebeb"),o=o(),Q(),o),Be={class:"section"},Pe={class:"container"},Me={class:"section-header"},Ne=Le(()=>c("h1",{class:"section-title"},"Домены",-1)),$e={class:"btn__group"},xe={class:"list-form"},Te={class:"list-form_col list-form_col--sm"},Ve={class:"list-form_select"},Ue={class:"multiselect-option"},Ae={key:0};function Ee(o,n,m,s,v,w){var y,C,O;const b=H,_=De,l=z,a=R("Multiselect"),D=fe,k=K,f=_e;return p(),L(A,null,[i(b),c("div",Be,[c("div",Pe,[c("div",Me,[Ne,c("div",$e,[i(_,{label:"Заказать",onClick:n[0]||(n[0]=e=>s.navigateToDomainSchemes())}),i(_,{label:"Перенести домен",onClick:n[1]||(n[1]=e=>s.openTransferModal())})])]),i(l,{partition:"Header:/DomainOrders"}),c("div",xe,[c("div",Te,[c("div",Ve,[i(a,{modelValue:s.select,"onUpdate:modelValue":n[2]||(n[2]=e=>s.select=e),options:s.getUsers,label:"name",disabled:((y=s.getUsers)==null?void 0:y.length)<=1},{singlelabel:u(({value:e})=>[c("span",null,"# "+g(e.value.padStart(5,"0"))+" / "+g(e.name),1)]),option:u(({option:e})=>[c("div",Ue,"# "+g(e.value.padStart(5,"0"))+" / "+g(e.name),1)]),_:1},8,["modelValue","options","disabled"])])]),i(D,{modelValue:s.search,"onUpdate:modelValue":n[3]||(n[3]=e=>s.search=e)},null,8,["modelValue"])]),s.getDomainsList&&((C=s.getDomainsList)==null?void 0:C.length)>0?(p(),L("div",Ae,[s.filterProducts&&((O=s.filterProducts)==null?void 0:O.length)>0?(p(!0),L(A,{key:0},G(s.filterProducts,(e,S)=>(p(),T(k,{"item-data":e,"user-name":s.getUserName(e==null?void 0:e.ContractID),scheme:s.filterDomainScheme(e==null?void 0:e.SchemeID),"info-link":`/DomainOrders/${e==null?void 0:e.OrderID}`,"is-last":S===s.filterProducts.length-1,onDelete:s.deleteItem,onTransfer:s.transferItem,onDesignateOwner:B=>s.designateOwner(e==null?void 0:e.ID),onManage:s.orderManage},null,8,["item-data","user-name","scheme","info-link","is-last","onDelete","onTransfer","onDesignateOwner","onManage"]))),256)):(p(),T(f,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(p(),T(f,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}const je={components:{IconSearch:te,DomainItem:K,Select2:ne,Multiselect:oe,ClausesKeeper:z,BlockBalanceAgreement:H},async setup(){const o=ue(),n=Y(),m=Z(),s=W(),v=X("emitter");v.on("updateDomainsList",()=>{n.fetchDomains()});const w=E("*"),b=E(null),_=M(()=>{var t;return(t=Object.keys(n==null?void 0:n.domainsList).map(r=>n==null?void 0:n.domainsList[r]))==null?void 0:t.reverse()}),l=M(()=>n==null?void 0:n.domainSchemes),a=M(()=>m==null?void 0:m.contractsList),D=M(()=>y(f(_.value))),k=M(()=>{let t=[{value:"*",name:"Все договора"}];return _.value!==null?(Object.keys(_.value).forEach(r=>{var h,d,P;t.find(q=>{var V;return q.value===((V=_.value[r])==null?void 0:V.ContractID)})||t.push({value:(h=_.value[r])==null?void 0:h.ContractID,name:(P=a.value[(d=_.value[r])==null?void 0:d.ContractID])==null?void 0:P.Customer})}),t):{value:"*",name:"Все договора"}});function f(t){return w.value!=="*"?t.filter(r=>(r==null?void 0:r.ContractID)===w.value):t}function y(t){return b.value!==null?t.filter(r=>r==null?void 0:r.Domain.toLowerCase().includes(b.value.toLowerCase())):t}function C(t){var r;return(r=l.value)==null?void 0:r[t]}function O(t){var r,h;return(h=(r=m==null?void 0:m.contractsList)==null?void 0:r[t])==null?void 0:h.Customer}function e(t){o.OrderManage(t)}function S(){s.push({path:"/DomainSchemes"})}function B(t){v.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить домен #${t}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function N(t){v.emit("open-modal",{component:"OrdersTransfer",data:t})}function $(){v.emit("open-modal",{component:"DomainTransfer",data:{}})}function x(t){const r={DomainOrderID:t};v.emit("open-modal",{component:"DomainSelectOwner",data:r})}return await n.fetchDomains(),await n.fetchDomainSchemes(),await m.fetchContracts(),await m.fetchProfiles(),{getDomainsList:_,getDomainsSchemes:l,getUsers:k,select:w,search:b,openTransferModal:$,filterProducts:D,getUserName:O,designateOwner:x,deleteItem:B,orderManage:e,filterDomainScheme:C,navigateToDomainSchemes:S,startFunction:ee,transferItem:N}}},ct=F(je,[["render",Ee],["__scopeId","data-v-6e1eebeb"]]);export{ct as default};
