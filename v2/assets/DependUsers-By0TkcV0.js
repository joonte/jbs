import{_ as W}from"./EmptyStateBlock-Ad1AmtSS.js";import{L as X}from"./bootstrap-vue-next-BglOzul_.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as p,o,a as t,u as ee,r as c,D as b,f as k,b as f,h as v,C,F as U,t as a,v as _,w as i,d as te}from"./index-C9dBN6m4.js";import{_ as se}from"./FormInputSearch-B6VLZUqq.js";import{_ as re}from"./IconCopy-CTfDC5Bz.js";import{_ as oe}from"./ButtonDefault-B1FApUky.js";import{_ as le}from"./ClausesKeeper-gPyacQ05.js";import{_ as ae}from"./FormTabs-Dzkmm4gJ.js";import{_ as ne}from"./BlockBalanceAgreement-DSLTUOoQ.js";import{u as ie}from"./contracts-BEc0DZS2.js";import{f as $,s as h}from"./time-DenPiOX5.js";import"./IconPlus-aXPVPivX.js";import"./IconClose-CgjzG0Yf.js";import"./index-D0iqQ1zq.js";const ue={},pe={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function de(H,l){return o(),p("svg",pe,l[0]||(l[0]=[t("path",{d:"M14.2929 12H3.5C3.22386 12 3 11.7761 3 11.5C3 11.2239 3.22386 11 3.5 11H14.2929L11.1464 7.85355C10.9512 7.65829 10.9512 7.34171 11.1464 7.14645C11.3417 6.95118 11.6583 6.95118 11.8536 7.14645L15.8536 11.1464C16.0488 11.3417 16.0488 11.6583 15.8536 11.8536L11.8536 15.8536C11.6583 16.0488 11.3417 16.0488 11.1464 15.8536C10.9512 15.6583 10.9512 15.3417 11.1464 15.1464L14.2929 12ZM10.5 4C10.2239 4 10 3.77614 10 3.5C10 3.22386 10.2239 3 10.5 3H18.5C19.8807 3 21 4.11929 21 5.5V18.5C21 19.8807 19.8807 21 18.5 21H10.5C10.2239 21 10 20.7761 10 20.5C10 20.2239 10.2239 20 10.5 20H18.5C19.3284 20 20 19.3284 20 18.5V5.5C20 4.67157 19.3284 4 18.5 4H10.5Z"},null,-1)]))}const ce=Y(ue,[["render",de]]),me=[{key:"RegisterDate",label:"Дата Создания",variant:"td-gray",sortable:!0},{key:"Name",label:"Реферал",variant:"td-blue"},{key:"aInvoices",label:"Всего",variant:"td-gray"},{key:"EnterDate",label:"Дата Входа",variant:"td-gray",sortable:!0},{key:"controls",label:"",variant:"td-controls"}],fe=[{key:"Year",label:"Год",variant:"td-gray",sortable:!0},{key:"Month",label:"Месяц",variant:"td-blue",sortable:!0},{key:"NumUsers",label:"Пользователей",variant:"td-gray"},{key:"NumPayments",label:"Платежей",variant:"td-gray"},{key:"MonthSum",label:"Сумма",variant:"td-gray"}],_e={class:"tw-w-full"},ve={class:"container"},ye={key:0,class:"section-header"},be={key:2,class:"btn__group"},ke={class:"profile_referral-wrapper"},Ce={class:"profile_referral-col"},ge={class:"profile_referral-item"},De={class:"profile_referral-value"},we={class:"profile_referral-col"},Ue={class:"profile_referral-item"},Se={class:"list-form"},xe={class:"d-block"},Be={key:0},Ne={key:2},Ie={__name:"DependUsers",async setup(H){let l,d;const n=ee(),S=ie(),x=c("RegisterDate"),B=c(!0),L=c("desc"),N=c("Year"),y=c(!0),E=c("desc"),g=te(),D=c(""),R=[{value:"referrals",name:"Партнерская программа"},{value:"stats",name:"Статистика начислений"}],m=c("referrals");[l,d]=b(()=>n.fetchUserData()),await l,d(),[l,d]=b(()=>n.fetchDependUsers()),await l,d(),[l,d]=b(()=>n.fetchDependUsersStatistic()),await l,d(),[l,d]=b(()=>S.fetchContracts()),await l,d();const I=k(()=>Object.keys(n?.dependUsers).map(r=>n?.dependUsers?.[r])),u=k(()=>Object.keys(n?.dependStats).map(r=>n?.dependStats?.[r])),V=k(()=>Object.values(S.contractsList??[]).some(r=>r.TypeID==="NaturalPartner")),A=k(()=>!u.value||u.value.length===0?[]:u.value.slice().sort((r,e)=>r.Year!==e.Year?y.value?e.Year-r.Year:r.Year-e.Year:y.value?e.Month-r.Month:r.Month-e.Month));function P(){g.push("/Contracts")}function j(){navigator.clipboard.writeText(`https://www.host-food.ru/p/${n.userInfo.ID}/`)}function F(){g.push("/profile/DependUsersCreate")}function O(r){n.userSwitch({UserID:r?.item?.ID}).then(e=>{const{result:w}=e;w==="SUCCESS"&&g.push("/Contracts")})}function Z(r){return r.filter(e=>e?.Name.includes(D.value))}return(r,e)=>{const w=ne,z=ae,q=le,M=oe,G=re,J=se,K=ce,T=X,Q=W;return o(),p("div",_e,[f(w),t("div",ve,[f(z,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),tabs:R},null,8,["modelValue"]),m.value==="referrals"?(o(),p("div",ye,e[8]||(e[8]=[t("h1",{class:"section-title"},"Реферальная программа",-1),t("div",{class:"section-text"},[t("p",null," Получайте 5% от суммы оказанных услуг привлечённых пользователей. Вознаграждение можно использовать для оплаты услуг Host-food. ")],-1)]))):v("",!0),m.value==="referrals"?(o(),C(q,{key:1,partition:"Header:/DependUsers",class:"user-referral__clauses"})):v("",!0),m.value==="referrals"&&!V.value?(o(),p("div",be,[f(M,{label:"Стать участником",onClick:e[1]||(e[1]=s=>P())})])):v("",!0),m.value==="referrals"&&V.value?(o(),p(U,{key:3},[e[17]||(e[17]=t("h2",{class:"section-title"},"Добавить реферала",-1)),t("div",ke,[t("div",Ce,[t("div",ge,[e[9]||(e[9]=t("div",{class:"profile_referral-item__name"},"С помощью реферальной ссылки",-1)),e[10]||(e[10]=t("div",{class:"profile_referral-item__text"}," Для каждого вашего реферала доступна информация о дате регистрации, времени последнего входа, потраченных средствах. Однако просмотр дополнительной информации и управление пользователем при этом способе приглашения недоступны. ",-1)),t("div",De,[t("span",{class:"profile-info__item-referral",ref:"message"}," https://www.host-food.ru/p/"+a(_(n).userInfo.ID)+"/ ",513),t("button",{class:"btn profile-info__item-referral_copy",onClick:j},[f(G,{class:"tw-size-5"})])])])]),t("div",we,[t("div",Ue,[e[11]||(e[11]=t("div",{class:"profile_referral-item__name"},"Создать аккаунт реферала",-1)),e[12]||(e[12]=t("div",{class:"profile_referral-item__text"}," У вас будет доступ к управлению сайтами своих клиентов, так как при таком способе приглашения пользователя партнёр получает совместный с ним контроль над его аккаунтом ",-1)),f(M,{label:"Создать реферала",onClick:e[2]||(e[2]=s=>F())})])])]),t("div",Se,[f(J,{modelValue:D.value,"onUpdate:modelValue":e[3]||(e[3]=s=>D.value=s)},null,8,["modelValue"])]),I.value?(o(),C(T,{key:0,class:"basic-table",fields:_(me),items:Z(I.value),"show-empty":!0,"sort-by":x.value,"onUpdate:sortBy":e[4]||(e[4]=s=>x.value=s),"sort-desc":B.value,"onUpdate:sortDesc":e[5]||(e[5]=s=>B.value=s),"sort-direction":L.value,"empty-text":"У Вас нет зарегистрированных пользователей.","empty-filtered-text":"Пользователи не найдены."},{"cell(RegisterDate)":i(s=>[e[13]||(e[13]=t("span",{class:"td-mobile"},"Дата создания",-1)),t("span",xe,a(_($)(_(h)(s.value))),1)]),"cell(Name)":i(s=>[e[14]||(e[14]=t("span",{class:"td-mobile"},"Реферал",-1)),t("span",null,a(s.value),1)]),"cell(aInvoices)":i(s=>[e[15]||(e[15]=t("span",{class:"td-mobile"},"Всего",-1)),t("span",null,a(s.value||0)+" руб",1)]),"cell(EnterDate)":i(s=>[e[16]||(e[16]=t("span",{class:"td-mobile"},"Дата входа",-1)),t("span",null,a(_($)(_(h)(s.value))),1)]),"cell(controls)":i(s=>[f(K,{class:"icon-enter",onClick:Ve=>O(s)},null,8,["onClick"])]),_:1},8,["fields","items","sort-by","sort-desc","sort-direction"])):(o(),C(Q,{key:1,label:"Вы пока не добавили рефералов"}))],64)):v("",!0),m.value==="stats"?(o(),p(U,{key:4},[e[23]||(e[23]=t("h1",{class:"section-title stats"},"Статистика начислений",-1)),u.value.length===1&&u.value[0]==="Ваши рефералы не оплачивали никаких услуг."?(o(),p("p",Be,a(u.value[0]),1)):u.value&&u.value.length>0?(o(),p(U,{key:1},[u.value?(o(),C(T,{key:0,class:"basic-table",fields:_(fe),items:A.value,"show-empty":!0,"empty-text":"Ваши рефералы не оплачивали никаких услуг.","empty-filtered-text":"Ваши рефералы не оплачивали никаких услуг.","sort-by":N.value,"onUpdate:sortBy":e[6]||(e[6]=s=>N.value=s),"sort-desc":y.value,"onUpdate:sortDesc":e[7]||(e[7]=s=>y.value=s),"sort-direction":E.value},{"cell(Year)":i(s=>[e[18]||(e[18]=t("span",{class:"td-mobile"},"Год",-1)),t("span",null,a(s.value),1)]),"cell(Month)":i(s=>[e[19]||(e[19]=t("span",{class:"td-mobile"},"Месяц",-1)),t("span",null,a(s.value),1)]),"cell(NumUsers)":i(s=>[e[20]||(e[20]=t("span",{class:"td-mobile"},"Пользователей",-1)),t("span",null,a(s.value),1)]),"cell(NumPayments)":i(s=>[e[21]||(e[21]=t("span",{class:"td-mobile"},"Платежей",-1)),t("span",null,a(s.value),1)]),"cell(MonthSum)":i(s=>[e[22]||(e[22]=t("span",{class:"td-mobile"},"Сумма",-1)),t("span",null,a(s.value),1)]),_:1},8,["fields","items","sort-by","sort-desc","sort-direction"])):v("",!0)],64)):(o(),p("p",Ne,"Нет данных для отображения."))],64)):v("",!0)])])}}},ze=Y(Ie,[["__scopeId","data-v-b43ad286"]]);export{ze as default};
