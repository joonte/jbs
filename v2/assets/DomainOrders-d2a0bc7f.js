import{_ as J,o as h,c as O,a4 as be,a as i,e as fe,S as _e,r as P,h as we,g as U,j as De,Z as $,a9 as H,b as l,t as D,k as de,n as ve,d as C,w as _,F as me,x as Se,y as X,i as ke}from"./index-3af25d4c.js";import{u as Oe}from"./domain-4c41df09.js";import{u as ye}from"./contracts-4f21f7b6.js";import{f as ue,s as Ve}from"./useTimeFunction-8602dd60.js";import{I as Be}from"./IconSearch-94ee6723.js";import{S as Me}from"./Select2-d425d9a5.js";import{s as Pe}from"./multiselect-eb4b0170.js";import{f as ge,z as xe,k as Le,d as Ne}from"./bootstrap-vue-next.es-79941670.js";import{_ as Ue}from"./OrderIDBadge-7e4423f3.js";import{_ as $e}from"./IconDots-9d28e553.js";import{_ as He}from"./IconCard-816972fe.js";import{S as Re}from"./StatusBadge-b26344fd.js";import{_ as Te}from"./HelperComponent-4ce50874.js";import{_ as he}from"./ClausesKeeper-1519f453.js";import{B as pe}from"./BlockBalanceAgreement-4b67da5f.js";import{u as Ae}from"./globalActions-83829f94.js";import{_ as Ze,B as Ce}from"./IconButtonBack-13767f97.js";import{E as je}from"./EmptyStateBlock-25904ff1.js";import{_ as Ee}from"./FormInputSearch-07638d27.js";import{_ as Fe}from"./ButtonDefault-b95c906d.js";import"./IconArrow-7b47b2f8.js";import"./IconClose-f49a70b0.js";import"./IconPlus-e0a4f3e2.js";const ze={},We={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},qe=be('<g clip-path="url(#clip0_2406_2831)"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.66732 5.83337C6.20708 5.83337 5.83398 6.20647 5.83398 6.66671V9.33337C5.83398 9.79361 6.20708 10.1667 6.66732 10.1667H17.334C17.7942 10.1667 18.1673 9.79361 18.1673 9.33337V6.66671C18.1673 6.20647 17.7942 5.83337 17.334 5.83337H6.66732ZM4.83398 6.66671C4.83398 5.65419 5.6548 4.83337 6.66732 4.83337H17.334C18.3465 4.83337 19.1673 5.65419 19.1673 6.66671V9.33337C19.1673 10.3459 18.3465 11.1667 17.334 11.1667H6.66732C5.6548 11.1667 4.83398 10.3459 4.83398 9.33337V6.66671Z" fill="black"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M6.66732 13.8333C6.20708 13.8333 5.83398 14.2064 5.83398 14.6667V17.3333C5.83398 17.7936 6.20708 18.1667 6.66732 18.1667H17.334C17.7942 18.1667 18.1673 17.7936 18.1673 17.3333V14.6667C18.1673 14.2064 17.7942 13.8333 17.334 13.8333H6.66732ZM4.83398 14.6667C4.83398 13.6542 5.6548 12.8333 6.66732 12.8333H17.334C18.3465 12.8333 19.1673 13.6542 19.1673 14.6667V17.3333C19.1673 18.3459 18.3465 19.1667 17.334 19.1667H6.66732C5.6548 19.1667 4.83398 18.3459 4.83398 17.3333V14.6667Z" fill="black"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 8C7.5 7.72386 7.72386 7.5 8 7.5H8.00583C8.28198 7.5 8.50583 7.72386 8.50583 8C8.50583 8.27614 8.28198 8.5 8.00583 8.5H8C7.72386 8.5 7.5 8.27614 7.5 8Z" fill="black"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 16C7.5 15.7239 7.72386 15.5 8 15.5H8.00583C8.28198 15.5 8.50583 15.7239 8.50583 16C8.50583 16.2761 8.28198 16.5 8.00583 16.5H8C7.72386 16.5 7.5 16.2761 7.5 16Z" fill="black"></path></g><defs><clipPath id="clip0_2406_2831"><rect width="16" height="16" fill="white" transform="translate(4 4)"></rect></clipPath></defs>',2),Ke=[qe];function Ge(a,n){return h(),O("svg",We,Ke)}const Je=J(ze,[["render",Ge]]),Qe={},Xe={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ye=i("g",{"clip-path":"url(#clip0_2406_586)"},[i("path",{d:"M15.0778 12.9407L18.5345 14.5119C19.427 14.9176 20 15.8075 20 16.7878V17.5C20 18.8807 18.8807 20 17.5 20H6.5C5.11929 20 4 18.8807 4 17.5V16.7878C4 15.8075 4.57301 14.9176 5.46549 14.5119L8.92216 12.9407C7.75209 12.0255 7 10.6006 7 9C7 6.23858 9.23858 4 12 4C14.7614 4 17 6.23858 17 9C17 10.6006 16.2479 12.0255 15.0778 12.9407ZM9.96127 13.5668L5.8793 15.4223C5.3438 15.6657 5 16.1996 5 16.7878V17.5C5 18.3284 5.67157 19 6.5 19H17.5C18.3284 19 19 18.3284 19 17.5V16.7878C19 16.1996 18.6562 15.6657 18.1207 15.4223L14.0387 13.5668C13.4161 13.8452 12.7261 14 12 14C11.2739 14 10.5839 13.8452 9.96127 13.5668ZM12 13C14.2091 13 16 11.2091 16 9C16 6.79086 14.2091 5 12 5C9.79086 5 8 6.79086 8 9C8 11.2091 9.79086 13 12 13Z",fill:"black"})],-1),et=i("defs",null,[i("clipPath",{id:"clip0_2406_586"},[i("rect",{width:"24",height:"24",fill:"white"})])],-1),tt=[Ye,et];function nt(a,n){return h(),O("svg",Xe,tt)}const ot=J(Qe,[["render",nt]]);const at={class:"hosting-item"},st={class:"hosting-item__row"},it=["href"],lt={class:"hosting-item__row"},rt={class:"hosting-item__person"},ct={class:"hosting-item__row hosting-flex"},dt={class:"hosting-item__list"},mt={key:0},ut={key:1,class:"bold"},ft={class:"hosting-status__info"},_t={class:"hosting-status__date"},Dt={class:"hosting-item__controls"},vt={class:"btn btn--dots"},gt={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1},isSeveral:{type:Boolean,default:!1},selectedRows:{type:Object,required:!0}},emits:["delete","transfer","designateOwner","manage"],setup(a,{emit:n}){const c=a,t=fe(),v=_e("emitter"),I=P({...c.selectedRows}),b=()=>{n("update-selected-rows",I.value)};we(()=>c.selectedRows,o=>{I.value={...o}},{deep:!0});const w=U(()=>{var e,m;if(!((e=c.itemData)!=null&&e.Domain))return"";const o=(m=c.itemData)==null?void 0:m.Domain;return o.startsWith("http://")||o.startsWith("https://")?o:`https://${o}`});function f(o){if(!o)return ue(new Date);const e=new Date,m=new Date(e.getTime()+o*24*60*60*1e3);return ue(m)}function y(){var o;t.push(`/DomainOrderPay/${(o=c.itemData)==null?void 0:o.OrderID}`)}function x(o){t.push(`/DomainOrders/${o}`)}function R(o){v.emit("open-modal",{component:"StatusHistory",data:{modeID:"DomainOrders",rowID:o}})}function T(){var o;n("delete",(o=c.itemData)==null?void 0:o.ID)}function A(){v.emit("open-modal",{component:"DomainsEdit",data:c.itemData})}function Z(){var o,e,m;v.emit("open-modal",{component:"SendAuthInfo",data:{DomainOrderID:(o=c.itemData)==null?void 0:o.ID,Domain:(e=c.itemData)==null?void 0:e.Domain,AuthInfo:(m=c.itemData)==null?void 0:m.AuthInfo}})}function u(){var o,e;n("transfer",{ServiceOrderID:(o=c.itemData)==null?void 0:o.ID,ServiceID:(e=c.itemData)==null?void 0:e.ServiceID})}function S(){var o;n("designateOwner",{DomainOrderID:(o=c.itemData)==null?void 0:o.ID})}function L(o){if(!o)return"";const e=new Date(parseInt(o)*1e3),N=new Date-e,V=Math.floor(N/1e3),B=Math.floor(V/60),M=Math.floor(B/60),p=Math.floor(M/24);return V<60?`${V} сек. от статуса`:B<60?`${B} мин. от статуса`:M<24?`${M} ч. от статуса`:`${p} дн. от статуса`}return(o,e)=>{var W,q,K,s,r,d,j,E,G,F,Y,ee,te,ne,oe,ae,se,ie,le,re,ce;const m=ge,N=Ue,V=ot,B=Je,M=De("router-link"),p=xe,z=Le,Q=Ne;return h(),O("div",at,[i("div",st,[$(l(m,{id:"checkbox-"+((W=a.itemData)==null?void 0:W.OrderID),modelValue:I.value[(q=a.itemData)==null?void 0:q.OrderID],"onUpdate:modelValue":e[0]||(e[0]=g=>{var k;return I.value[(k=a.itemData)==null?void 0:k.OrderID]=g}),name:"checkbox-"+((K=a.itemData)==null?void 0:K.OrderID),onChange:b},null,8,["id","modelValue","name"]),[[H,a.isSeveral]]),l(N,{orderID:(s=a.itemData)==null?void 0:s.OrderID,onClick:e[1]||(e[1]=g=>{var k;return x((k=a.itemData)==null?void 0:k.OrderID)})},null,8,["orderID"]),i("a",{class:"hosting-item__name",href:w.value,target:"_blank"},D((r=a.itemData)==null?void 0:r.Domain),9,it)]),i("div",lt,[i("div",rt,D(a.userName),1),l(Te,{"user-notice":(d=a.itemData)==null?void 0:d.UserNotice,id:(j=a.itemData)==null?void 0:j.OrderID,position:a.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),i("div",ct,[i("ul",dt,[(E=a.scheme)!=null&&E.PackageID?(h(),O("li",mt,D((G=a.scheme)==null?void 0:G.PackageID),1)):de("",!0),(F=a.scheme)!=null&&F.CostProlong?(h(),O("li",ut,D((Y=a.scheme)==null?void 0:Y.CostProlong)+" ₽",1)):de("",!0)]),i("div",ft,[i("div",{class:ve(["hosting-item__date",{danger:Number((ee=a.itemData)==null?void 0:ee.DaysRemainded)<14}])},D(f((te=a.itemData)==null?void 0:te.DaysRemainded))+" • "+D(((ne=a.itemData)==null?void 0:ne.DaysRemainded)||0)+" дн.",3),l(Re,{class:"status-badge",status:(oe=a.itemData)==null?void 0:oe.StatusID,"status-table":"DomainOrders",onClick:e[2]||(e[2]=g=>{var k;return R((k=a.itemData)==null?void 0:k.ID)})},null,8,["status"]),i("div",_t,D(L((ae=a.itemData)==null?void 0:ae.StatusDate)),1)])]),i("div",Dt,[$(i("button",{class:"btn btn--md btn--bold",onClick:e[3]||(e[3]=g=>S())},[l(V),C("Определить владельца")],512),[[H,((se=a.itemData)==null?void 0:se.StatusID)==="Waiting"||((ie=a.itemData)==null?void 0:ie.StatusID)==="ClaimForRegister"||((le=a.itemData)==null?void 0:le.StatusID)==="ForContractRegister"||((re=a.itemData)==null?void 0:re.StatusID)==="ForRegister"||((ce=a.itemData)==null?void 0:ce.StatusID)==="ForTransfer"]]),i("button",{class:"btn btn--md btn--bold",onClick:e[4]||(e[4]=g=>A())},[l(B),C("Сменить DNS")]),i("button",{class:"btn btn--md btn--bold",onClick:e[5]||(e[5]=g=>y())},[l(He),C("Оплатить")]),l(Q,{class:"dropdown-dots",right:""},{"button-content":_(()=>[i("div",vt,[l($e)])]),default:_(()=>[l(p,null,{default:_(()=>[l(M,{to:a.infoLink},{default:_(()=>[C("Дополнительная информация")]),_:1},8,["to"])]),_:1}),l(p,{onClick:e[6]||(e[6]=g=>y())},{default:_(()=>[C("Оплатить заказ")]),_:1}),l(p,{onClick:e[7]||(e[7]=g=>S())},{default:_(()=>[C("Определить владельца")]),_:1}),l(p,{onClick:e[8]||(e[8]=g=>u())},{default:_(()=>[C("Передать на другой аккаунт")]),_:1}),l(p,{onClick:e[9]||(e[9]=g=>Z())},{default:_(()=>[C("Ввести AuthInfo")]),_:1}),l(z),l(p,{class:"color-red",onClick:e[10]||(e[10]=g=>T())},{default:_(()=>[C("Удалить")]),_:1})]),_:1})])])}}},Ie=J(gt,[["__scopeId","data-v-a50efd0e"]]),ht={class:"section"},pt={class:"container"},Ct={class:"title__icon"},It={class:"btn__group"},bt={class:"group__several"},wt={class:"list-form"},St={class:"list-form_col list-form_col--sm"},kt={class:"list-form_select"},Ot={class:"multiselect-option"},yt={key:0};function Vt(a,n,c,t,v,I){var S,L,o;const b=pe,w=Ze,f=Fe,y=Ce,x=ge,R=he,T=De("Multiselect"),A=Ee,Z=Ie,u=je;return h(),O(me,null,[l(b),i("div",ht,[i("div",pt,[i("div",{class:ve(["section-header",t.isSeveral?"column":""])},[i("div",Ct,[i("h1",{class:"section-title",onClick:n[0]||(n[0]=e=>t.reloadNow())},D(t.isSeveral?"Продление услуг Домена":"Домены"),1),$(l(w,{onClick:n[1]||(n[1]=e=>t.outSeveralOrders())},null,512),[[H,t.isSeveral]])]),$(i("div",It,[$(l(f,{class:"btn-several",label:"Продлить несколько заказов",onClick:n[2]||(n[2]=e=>t.prolongSeveralOrders())},null,512),[[H,t.getDomainsList.length>1]]),l(f,{label:"Заказать",onClick:n[3]||(n[3]=e=>t.navigateToDomainSchemes())}),l(f,{label:"Перенести домен",onClick:n[4]||(n[4]=e=>t.openTransferModal())})],512),[[H,!t.isSeveral]]),$(i("div",bt,[l(y,{class:"contr period",modelValue:t.selectPeriod,"onUpdate:modelValue":n[5]||(n[5]=e=>t.selectPeriod=e)},null,8,["modelValue"]),l(x,{id:"checkbox-balance",modelValue:t.useBalance,"onUpdate:modelValue":n[6]||(n[6]=e=>t.useBalance=e),name:"checkbox-balance"},{default:_(()=>[C("Использовать средства с баланса")]),_:1},8,["modelValue"]),l(f,{label:"Продлить",onClick:n[7]||(n[7]=e=>t.prolongOrders())})],512),[[H,t.isSeveral]])],2),l(R,{partition:"Header:/DomainOrders"}),i("div",wt,[i("div",St,[i("div",kt,[l(T,{modelValue:t.select,"onUpdate:modelValue":n[8]||(n[8]=e=>t.select=e),options:t.getUsers,label:"name",disabled:((S=t.getUsers)==null?void 0:S.length)<=1},{singlelabel:_(({value:e})=>[i("span",null,"# "+D(e.value.padStart(5,"0"))+" / "+D(e.name),1)]),option:_(({option:e})=>[i("div",Ot,"# "+D(e.value.padStart(5,"0"))+" / "+D(e.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l(A,{modelValue:t.search,"onUpdate:modelValue":n[9]||(n[9]=e=>t.search=e)},null,8,["modelValue"])]),t.getDomainsList&&((L=t.getDomainsList)==null?void 0:L.length)>0?(h(),O("div",yt,[t.filterProducts&&((o=t.filterProducts)==null?void 0:o.length)>0?(h(!0),O(me,{key:0},Se(t.filterProducts,(e,m)=>(h(),X(Z,{"item-data":e,"user-name":t.getUserName(e==null?void 0:e.ContractID),scheme:t.filterDomainScheme(e==null?void 0:e.SchemeID),"info-link":`/DomainOrders/${e==null?void 0:e.OrderID}`,"is-last":m===t.filterProducts.length-1,isSeveral:t.isSeveral,"selected-rows":t.selectedRows,onUpdateSelectedRows:t.handleSelectedRowsUpdate,onDelete:t.deleteItem,onTransfer:t.transferItem,onDesignateOwner:N=>t.designateOwner(e==null?void 0:e.ID),onManage:t.orderManage},null,8,["item-data","user-name","scheme","info-link","is-last","isSeveral","selected-rows","onUpdateSelectedRows","onDelete","onTransfer","onDesignateOwner","onManage"]))),256)):(h(),X(u,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(h(),X(u,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}const Bt={components:{IconSearch:Be,DomainItem:Ie,Select2:Me,Multiselect:Pe,ClausesKeeper:he,BlockBalanceAgreement:pe,BlockSelectPeriod:Ce},async setup(){const a=Ae(),n=Oe(),c=ye(),t=fe(),v=_e("emitter");v.on("updateDomainsList",()=>{n.fetchDomains()});const I=P("*"),b=P(null),w=P(!1),f=P([]),y=P(null),x=P(!1),R=s=>{f.value=s};async function T(){console.log(f.value);const s=Object.keys(f.value).filter(d=>f.value[d]),r={ServiceID:"20000",ItemsPay:y.value,OrdersIDs:s,...x.value&&{UseBalance:"yes"}};await a.OrdersPay(r).then(d=>{d==="Basket"?(console.log("Success"),t.push("/Basket")):(d==null?void 0:d.Status)==="Ok"&&(w.value=!1,v.emit("open-modal",{component:"BalanceProlong",data:{Message:d==null?void 0:d.Message,Count:d==null?void 0:d.Count}}))})}function A(){w.value=!0}function Z(){w.value=!1}const u=U(()=>{var s;return(s=Object.keys(n==null?void 0:n.domainsList).map(r=>n==null?void 0:n.domainsList[r]))==null?void 0:s.reverse()}),S=U(()=>n==null?void 0:n.domainSchemes),L=U(()=>c==null?void 0:c.contractsList),o=U(()=>V(N(u.value))),e=U(()=>{let s=[{value:"*",name:"Все договора"}];return u.value!==null?(Object.keys(u.value).forEach(r=>{var d,j,E;s.find(G=>{var F;return G.value===((F=u.value[r])==null?void 0:F.ContractID)})||s.push({value:(d=u.value[r])==null?void 0:d.ContractID,name:(E=L.value[(j=u.value[r])==null?void 0:j.ContractID])==null?void 0:E.Customer})}),s):{value:"*",name:"Все договора"}});ke(()=>{u.value.length<1&&z()});function m(){t.go(0)}function N(s){return I.value!=="*"?s.filter(r=>(r==null?void 0:r.ContractID)===I.value):s}function V(s){return b.value!==null?s.filter(r=>r==null?void 0:r.Domain.toLowerCase().includes(b.value.toLowerCase())):s}function B(s){var r;return(r=S.value)==null?void 0:r[s]}function M(s){var r,d;return(d=(r=c==null?void 0:c.contractsList)==null?void 0:r[s])==null?void 0:d.Customer}function p(s){a.OrderManage(s)}function z(){const s=b.value;t.push({path:"/DomainSchemes",query:{DomainName:s}})}function Q(s){v.emit("open-modal",{component:"DeleteItem",data:{id:s,message:`Вы действительно хотите удалить домен #${s}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function W(s){v.emit("open-modal",{component:"OrdersTransfer",data:s})}function q(){v.emit("open-modal",{component:"DomainTransfer",data:{}})}function K(s){const r={DomainOrderID:s};v.emit("open-modal",{component:"DomainSelectOwner",data:r})}return await n.fetchDomains(),await n.fetchDomainSchemes(),await c.fetchContracts(),await c.fetchProfiles(),{getDomainsList:u,getDomainsSchemes:S,getUsers:e,select:I,search:b,openTransferModal:q,filterProducts:o,getUserName:M,designateOwner:K,deleteItem:Q,orderManage:p,filterDomainScheme:B,navigateToDomainSchemes:z,startFunction:Ve,transferItem:W,reloadNow:m,prolongSeveralOrders:A,isSeveral:w,selectedRows:f,selectPeriod:y,prolongOrders:T,outSeveralOrders:Z,useBalance:x,handleSelectedRowsUpdate:R}}},Yt=J(Bt,[["render",Vt],["__scopeId","data-v-84fe4f32"]]);export{Yt as default};
