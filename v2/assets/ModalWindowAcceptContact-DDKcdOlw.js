import{_ as D}from"./ButtonDefault-B1FApUky.js";import{_ as g}from"./BasicInput-VlbY6GiE.js";import{u as B,f as r,r as s,H as E,s as V,c as M,o as S,a as c,t as p,b as _,W as U}from"./index-C9dBN6m4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./component-D8Pmx5O0.js";const A={class:"modal__body"},R={class:"list-item__subtitle"},q={class:"modal__accept-form"},j={__name:"ModalWindowAcceptContact",props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(f,{emit:v}){const o=f,I=v,l=B(),n=r(()=>l.userInfo),C=r(()=>Object.keys(n.value?.Contacts)?.map(t=>{if(!n.value?.Contacts?.[t]?.IsHidden)return n.value?.Contacts?.[t]})),d=s("");s(o.data.contactId||""),s(o.data.methodId||""),s(o.data.address||"");const y=o.data.sendConfirmRequest,b=t=>C.value.find(e=>e.ID===t),a=r(()=>{const t=b(o.data.contactId);return t?{...o.data,methodId:t.MethodID,address:t.Address}:(console.error("Контакт не найден по ID",o.data.contactId),o.data)}),u=async()=>{const t={Method:a.value.methodId,Value:a.value.address,ContactID:o.data.contactId,Confirm:d.value};try{(await y(`${U}/API/Confirm`,t)).Status==="Ok"?(I("modalClose"),await l.fetchUserData()):console.error("Ошибка подтверждения кода")}catch(e){console.error("Ошибка запроса подтверждения кода",e)}},i=t=>{t.key==="Enter"&&u()};return E(()=>{document.addEventListener("keyup",i)}),V(()=>{document.removeEventListener("keyup",i)}),(t,e)=>{const h=g,k=D;return S(),M("div",A,[e[2]||(e[2]=c("div",{class:"list-item__title"},"Введите код подтверждения",-1)),c("div",R,"Отправили "+p(a.value.methodId)+" на «"+p(a.value.address)+"»",1),c("div",q,[_(h,{label:"Код подтверждения",name:"mailCode",placeholder:"Введите код",modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=m=>d.value=m)},null,8,["modelValue"]),_(k,{class:"modal__button",label:"Подтвердить",onClick:e[1]||(e[1]=m=>u())})])])}}};export{j as default};
