import{_ as A}from"./ButtonDefault-7c216fc6.js";import{f as D}from"./bootstrap-vue-next.es-a19a8b41.js";import{_ as $,f as B,u as F,r as y,g as w,i as U,o as r,c as v,F as M,x as P,t as k,k as N,a,b as u,w as I,d as b,h as O,O as j,y as S,M as g}from"./index-5e313302.js";import{F as L}from"./FormTabs-ead5a058.js";import{f as W,a as Y}from"./useTimeFunction-8602dd60.js";import{s as C}from"./multiselect-bfc29db8.js";const G={class:"edit-settings__types"},H={key:0,class:"edit-settings__label"},K={class:"edit-settings__checkbox"},q={__name:"BlockNotificationsModal",props:["id","method"],setup(E){const c=E,i=B(),T=F(),d=y({}),f=w(()=>{var t,e;return(e=(t=T.ConfigList)==null?void 0:t.Notifies)==null?void 0:e.Types});function p(t){var e;d.value[t]=!((e=d.value)!=null&&e[t])}return i.ContactData(c==null?void 0:c.id).then(t=>{Object.keys(t).forEach(e=>{typeof t[e]=="object"&&Object.keys(t[e]).forEach(_=>{d.value[_]=t[e][_]})})}),U(d.value,()=>{const t=new FormData;Object.keys(d.value).forEach(e=>{d.value[e]&&t.append(`${c.method}[]`,e)}),t.append("MethodID",c.method),t.append("ContactID",c.id),i.userEditContactSettings(t)}),(t,e)=>{const _=D;return r(),v("div",G,[(r(!0),v(M,null,P(f.value,(n,m)=>{var h;return r(),v("div",{class:"edit-settings__group",key:m},[n!=null&&n.Title?(r(),v("div",H,k(n==null?void 0:n.Title),1)):N("",!0),a("div",K,[u(_,{id:m,name:m,checked:(h=d.value)==null?void 0:h[m],onInput:()=>p(m)},{default:I(()=>[b(k(n==null?void 0:n.Name),1)]),_:2},1032,["id","name","checked","onInput"])])])}),128))])}}},z=$(q,[["__scopeId","data-v-63297c68"]]);const J={class:"modal__body"},Q=a("div",{class:"list-item__title"},"Настройки",-1),R={class:"list-item__subtitle"},X={class:"edit-settings"},Z={class:"edit-settings__item"},ee={class:"edit-settings__item"},te={class:"edit-settings__item"},se={class:"edit-settings__item"},ae=a("div",{class:"edit-time"},null,-1),oe=a("div",{class:"edit-time__title"},"Время рассылки",-1),ie={class:"edit-time__wrapper"},ne={class:"edit-time__select-wrapper"},le=a("div",{class:"edit-time__select-label"},"Начало",-1),de={class:"edit-time__select-wrapper"},ce=a("div",{class:"edit-time__select-label"},"Конец",-1),_e={class:"edit-time__last-change"},he={__name:"ModalWindowEditContact",props:["data"],emits:["modalClose"],setup(E,{emit:c}){const i=E,T=B(),d=[{name:"Общие",value:"common"},{name:"Типы уведомлений",value:"notions"}],f=y([]),p=y(!1),t=y("common"),e=y({});e.value={...i.data,TimeBegin:_(i.data.TimeBegin),TimeEnd:_(i.data.TimeEnd)};function _(l){return l>=10?l:"0"+String(l)}function n(){for(let l=0;l<=23;l++){const s=_(l);f.value.push({label:`${s}:00`,name:`${s}:00`,value:String(s)})}}function m(){p.value=!0,T.userEditContact({Address:e.value.Address,MethodID:e.value.MethodID,ContactID:e.value.ID,TimeBegin:e.value.TimeBegin,TimeEnd:e.value.TimeEnd,IsActive:e.value.IsActive?"yes":void 0,IsImmediately:e.value.IsImmediately?"yes":void 0,IsPrimary:e.value.IsPrimary?"yes":void 0,IsSendFiles:e.value.IsSendFiles?"yes":void 0}).then(l=>{p.value=!1,T.fetchUserData(),c("modalClose")})}n();const h=l=>{l.key==="Enter"&&m()};return O(()=>{document.addEventListener("keyup",h)}),j(()=>{document.removeEventListener("keyup",h)}),(l,s)=>{const V=D,x=A;return r(),v("div",J,[Q,a("div",R,k(i.data.MethodID)+" "+k(i.data.Address),1),u(L,{class:"edit-settings__tabs",tabs:d,modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o)},null,8,["modelValue"]),t.value==="common"?(r(),v(M,{key:0},[a("div",X,[a("div",Z,[u(V,{class:"edit-settings__checkbox",id:"use-for-notifications",name:"use-for-notifications",modelValue:e.value.IsActive,"onUpdate:modelValue":s[1]||(s[1]=o=>e.value.IsActive=o)},{default:I(()=>[b("Использовать для уведомлений")]),_:1},8,["modelValue"])]),a("div",ee,[u(V,{class:"edit-settings__checkbox",id:"notify-immediately",name:"notify-immediately",modelValue:e.value.IsImmediately,"onUpdate:modelValue":s[2]||(s[2]=o=>e.value.IsImmediately=o)},{default:I(()=>[b("Уведомлять немедленно")]),_:1},8,["modelValue"])]),a("div",te,[u(V,{class:"edit-settings__checkbox",id:"send-files",name:"send-files",modelValue:e.value.IsSendFiles,"onUpdate:modelValue":s[3]||(s[3]=o=>e.value.IsSendFiles=o)},{default:I(()=>[b("Присылать файлы/картинки")]),_:1},8,["modelValue"])]),a("div",se,[i.data.MethodID==="Email"?(r(),S(V,{key:0,class:"edit-settings__checkbox",id:"use-for-login",name:"use-for-login",modelValue:e.value.IsPrimary,"onUpdate:modelValue":s[4]||(s[4]=o=>e.value.IsPrimary=o)},{default:I(()=>[b("Использовать как логин")]),_:1},8,["modelValue"])):N("",!0)])]),ae,oe,a("div",ie,[a("div",ne,[le,u(g(C),{placeholder:"00:00",options:f.value,modelValue:e.value.TimeBegin,"onUpdate:modelValue":s[5]||(s[5]=o=>e.value.TimeBegin=o),label:"name"},null,8,["options","modelValue"])]),a("div",de,[ce,u(g(C),{modelValue:e.value.TimeEnd,"onUpdate:modelValue":s[6]||(s[6]=o=>e.value.TimeEnd=o),options:f.value,label:"name",placeholder:"00:00"},null,8,["modelValue","options"])])]),a("div",_e,"Адрес подтвержден "+k(g(W)(g(Y)(i.data.Confirmed))),1),u(x,{onClick:s[7]||(s[7]=o=>m()),label:"Сохранить изменения","is-loading":p.value},null,8,["is-loading"])],64)):(r(),S(z,{key:1,id:i.data.ID,method:i.data.MethodID},null,8,["id","method"]))])}}};export{he as default};
