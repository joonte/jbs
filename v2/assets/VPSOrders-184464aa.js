import{j as R,o as D,c as V,a as s,b as i,w as p,d as y,t as C,F as U,v as q,n as $,k as tt,_ as G,r as A,x as N,p as et,l as at,R as ot,g as L}from"./index-e8e4a28d.js";import{I as nt}from"./IconSearch-20ab9363.js";import{u as J}from"./vps-011394b5.js";import{_ as st}from"./HelperComponent-dd8d6ccf.js";import{S as Q}from"./StatusBadge-3b9ca694.js";import{I as W}from"./IconRotate-60f8a9ee.js";import{f as K}from"./useTimeFunction-8602dd60.js";import{v as rt}from"./vpsStatuses-32ffaaf5.js";import{z as it,d as lt}from"./bootstrap-vue-next.es-6aab83a5.js";import{_ as ct}from"./IconDots-ef5e2b5e.js";import{_ as dt}from"./IconCard-49dbdefd.js";import{_ as _t}from"./OrderIDBadge-67a1051d.js";import{S as mt}from"./Select2-242545f3.js";import{s as ut}from"./multiselect-762d23c8.js";import{_ as X}from"./ClausesKeeper-cfc0f758.js";import{u as ft}from"./contracts-f70de43e.js";import{B as Y}from"./BlockBalanceAgreement-00019440.js";import{u as Dt}from"./globalActions-78d58809.js";import{E as gt}from"./EmptyStateBlock-b36abca5.js";import{_ as vt}from"./FormInputSearch-61c2ee8e.js";import"./ButtonDefault-28022e42.js";import"./IconArrow-0cda8946.js";import"./IconClose-c1bee414.js";import"./IconPlus-eed3ce1d.js";const pt={class:"hosting-item"},bt={class:"hosting-item__row"},ht={class:"hosting-item__date"},It={class:"hosting-item__row"},Vt={class:"hosting-item__person"},St={class:"hosting-item__row"},Pt={class:"hosting-item__list"},yt=["innerHTML"],Ct={class:"hosting-item__controls"},Ot={class:"ico"},kt={class:"btn btn--dots"};function wt(a,r,o,e,b,M){var n,t,f,u,g,I,v,w,x;const l=_t,c=R("router-link"),d=Q,m=R("Helper"),O=W,k=dt,S=ct,h=it,P=lt;return D(),V("div",pt,[s("div",bt,[i(l,{orderID:(n=o.itemData)==null?void 0:n.OrderID},null,8,["orderID"]),i(c,{class:"hosting-item__name",to:`/VPSOrders/${o.itemData.OrderID}`},{default:p(()=>[y(C(o.itemData.IP||o.itemData.Domain),1)]),_:1},8,["to"]),i(d,{status:(t=o.itemData)==null?void 0:t.StatusID,DaysRemainded:(f=o.itemData)==null?void 0:f.DaysRemainded,"status-table":"VPSOrders"},null,8,["status","DaysRemainded"]),s("div",ht,"Дата окончания "+C(e.calculateExpirationDate((u=o.itemData)==null?void 0:u.DaysRemainded))+" | "+C(((g=o.itemData)==null?void 0:g.DaysRemainded)||0)+" дн.",1)]),s("div",It,[s("div",Vt,C(o.userName),1),i(m,{"user-notice":(I=o.itemData)==null?void 0:I.UserNotice,id:(v=o.itemData)==null?void 0:v.OrderID,position:o.isLast?"bottom":"top",emit:"updateVPSList"},null,8,["user-notice","id","position"])]),s("div",St,[s("ul",Pt,[(D(!0),V(U,null,q(o.params,_=>(D(),V("li",{innerHTML:_==null?void 0:_.text},null,8,yt))),256))])]),s("div",Ct,[((w=o.itemData)==null?void 0:w.StatusID)==="Active"?(D(),V("div",{key:0,class:$(["btn btn--md btn--border btn--rotate btn--rotate_green button-large",{"btn--rotate_gray":((x=o.itemData)==null?void 0:x.StatusID)!=="Active"||e.isReloading,"btn--rotate_loading":e.isReloading}]),title:"Перезагрузить выделенный сервер",onClick:r[0]||(r[0]=(..._)=>e.reloadItem&&e.reloadItem(..._))},[y("Включен"),s("button",null,[s("div",Ot,[i(O)])])],2)):tt("",!0),s("div",{class:"btn btn--md btn--bold",onClick:r[1]||(r[1]=_=>{var B;return a.$router.push(`/VPSOrderPay/${(B=o.itemData)==null?void 0:B.OrderID}`)})},[i(k),y("Оплатить")]),i(P,{class:"dropdown-dots",right:""},{"button-content":p(()=>[s("div",kt,[i(S)])]),default:p(()=>[i(h,{onClick:r[2]||(r[2]=_=>e.orderManage())},{default:p(()=>[y("Управлять заказом")]),_:1}),i(h,null,{default:p(()=>{var _;return[i(c,{to:`/VPSOrders/${(_=o.itemData)==null?void 0:_.OrderID}/SchemeChange`},{default:p(()=>[y("Изменить тариф")]),_:1},8,["to"])]}),_:1})]),_:1})])])}const xt={components:{StatusBadge:Q,IconRotate:W,Helper:st},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1},userName:{type:String,default:""}},emits:["manage"],setup(a,{emit:r}){const o=J(),e=A(!1);function b(c){if(!c)return K(new Date);const d=new Date,m=new Date(d.getTime()+c*24*60*60*1e3);return K(m)}function M(c){var d;e.value=!0,o.VPSReboot({VPSOrderID:(d=a.itemData)==null?void 0:d.ID}).then(()=>{setTimeout(()=>{e.value=!1},1e3)})}function l(){var c,d,m;r("manage",{ServiceOrderID:(c=a.itemData)==null?void 0:c.ID,ServiceID:(d=a.itemData)==null?void 0:d.ServiceID,OrderID:(m=a.itemData)==null?void 0:m.OrderID})}return{vpsStatuses:rt,reloadItem:M,isReloading:e,orderManage:l,calculateExpirationDate:b}}},Z=G(xt,[["render",wt],["__scopeId","data-v-b0808a67"]]),Bt=a=>(et("data-v-8751ab58"),a=a(),at(),a),Lt={class:"section"},Mt={class:"container"},Rt={class:"section-header"},Nt=Bt(()=>s("h1",{class:"section-title"},"VPS/VDS серверы",-1)),Ut={class:"list-form"},At={class:"list-form_col list-form_col--sm"},Et={class:"list-form_select"},jt={class:"multiselect-option"},Ht={key:0};function Tt(a,r,o,e,b,M){var h,P,n;const l=Y,c=R("router-link"),d=X,m=R("Multiselect"),O=vt,k=Z,S=gt;return D(),V(U,null,[i(l),s("div",Lt,[s("div",Mt,[s("div",Rt,[Nt,i(c,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:p(()=>[y("Заказать")]),_:1})]),i(d),s("div",Ut,[s("div",At,[s("div",Et,[i(m,{modelValue:e.select,"onUpdate:modelValue":r[0]||(r[0]=t=>e.select=t),options:e.getUsers,disabled:((h=e.getUsers)==null?void 0:h.length)<=1,label:"name"},{option:p(({option:t})=>[s("div",jt,"# "+C(t.value.padStart(5,"0"))+" / "+C(t.name),1)]),_:1},8,["modelValue","options","disabled"])])]),i(O,{modelValue:e.search,"onUpdate:modelValue":r[1]||(r[1]=t=>e.search=t)},null,8,["modelValue"])]),e.getVpsOrders&&((P=e.getVpsOrders)==null?void 0:P.length)>0?(D(),V("div",Ht,[e.filterProducts&&((n=e.filterProducts)==null?void 0:n.length)>0?(D(!0),V(U,{key:0},q(e.filterProducts,(t,f)=>{var u;return D(),N(k,{"item-data":t,"is-last":f===e.filterProducts.length-1,"user-name":(u=e.getContracts[t==null?void 0:t.ContractID])==null?void 0:u.Customer,params:e.formItemParamList(t),onManage:e.orderManage},null,8,["item-data","is-last","user-name","params","onManage"])}),256)):(D(),N(S,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(D(),N(S,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])],64)}const zt={components:{IconSearch:nt,Select2:mt,ClausesKeeper:X,Multiselect:ut,VpsItem:Z,BlockBalanceAgreement:Y},async setup(){const a=J(),r=ft(),o=Dt(),e=A(null),b=A("*");ot("emitter").on("updateVPSList",()=>{a.fetchVPS()});const l=L(()=>{var n;return(n=Object.keys(a==null?void 0:a.vpsList).map(t=>a==null?void 0:a.vpsList[t]))==null?void 0:n.reverse()}),c=L(()=>a.vpsSchemes),d=L(()=>S(O(l.value))),m=L(()=>r==null?void 0:r.contractsList);function O(n){return b.value!=="*"?n.filter(t=>(t==null?void 0:t.ContractID)===b.value):n}function k(n){o.OrderManage(n)}function S(n){return e.value!==null?n.filter(t=>t==null?void 0:t.IP.toLowerCase().includes(e.value.toLowerCase())):n}const h=L(()=>{let n=[{value:"*",name:"Все договора"}];return l.value!==null?(Object.keys(l.value).forEach(t=>{var f,u,g;n.find(I=>{var v;return I.value===((v=l.value[t])==null?void 0:v.ContractID)})||n.push({value:(f=l.value[t])==null?void 0:f.ContractID,name:(g=m.value[(u=l.value[t])==null?void 0:u.ContractID])==null?void 0:g.Customer})}),n):{value:"*",name:"Все договора"}});function P(n){var f,u,g,I,v,w,x,_,B,E,j,H,T,z,F;const t=(f=c.value)==null?void 0:f[n.SchemeID];return[{text:`${t==null?void 0:t.Name}`},{text:`${(g=(u=t==null?void 0:t.SchemeParams)==null?void 0:u.hdd_mib)==null?void 0:g.InternalName} ${(v=(I=t==null?void 0:t.SchemeParams)==null?void 0:I.hdd_mib)==null?void 0:v.Value} ${(x=(w=t==null?void 0:t.SchemeParams)==null?void 0:w.hdd_mib)==null?void 0:x.Unit}`},{text:`RAM ${(B=(_=t==null?void 0:t.SchemeParams)==null?void 0:_.ram_mib)==null?void 0:B.Value} ${(j=(E=t==null?void 0:t.SchemeParams)==null?void 0:E.ram_mib)==null?void 0:j.Unit}`},{text:`Канал ${(T=(H=t==null?void 0:t.SchemeParams)==null?void 0:H.net_bandwidth_mbitps)==null?void 0:T.Value} ${(F=(z=t==null?void 0:t.SchemeParams)==null?void 0:z.net_bandwidth_mbitps)==null?void 0:F.Unit}`}]}return await a.fetchVPS(),await a.fetchVPSSchemes(),await r.fetchContracts(),{getVpsOrders:l,search:e,getContracts:m,select:b,orderManage:k,formItemParamList:P,getUsers:h,filterProducts:d}}},ue=G(zt,[["render",Tt],["__scopeId","data-v-8751ab58"]]);export{ue as default};
