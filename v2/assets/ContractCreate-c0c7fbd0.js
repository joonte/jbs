import{j as ke,o as s,c as t,b as p,a as n,w as B,d as L,F as I,x as N,k as f,y as b,t as te,n as A,p as be,l as Ce,_ as Ve,u as ye,f as Ie,e as Te,a7 as Pe,r as _,g as ue,i as xe,h as Ee}from"./index-642cdac5.js";import{u as me}from"./contracts-16ef7000.js";import{s as de}from"./SimpleCheckbox-6ec8859e.js";import{_ as fe}from"./BasicInput-e305f811.js";import{P as pe,T as _e,S as he}from"./PhoneInput-6f9f84ab.js";import{B as ve}from"./BlockBalanceAgreement-ccba2ab2.js";import{u as Re}from"./files-601cfe76.js";import{I as ge}from"./IconFile-1ba22afe.js";import{I as ie}from"./IconClose-f1b85910.js";import{_ as Ue}from"./ButtonDefault-eb076df2.js";import{f as we}from"./bootstrap-vue-next.es-9ff54498.js";import{_ as Fe}from"./IconClip-0dda2b5e.js";import{_ as Se}from"./ClausesKeeper-12bc5d50.js";import"./component-faf9e0c1.js";import"./multiselect-bb2ec7ab.js";import"./IconArrow-c0196cbe.js";const H=g=>(be("data-v-bdfdd9ae"),g=g(),Ce(),g),Ae={class:"section"},De={class:"container"},Me={class:"section-header"},Be=H(()=>n("h1",{class:"section-title"},"Создать профиль",-1)),Le=H(()=>n("div",{class:"section-header"},[n("h2",{class:"section-block_title"},"Шаблон")],-1)),Ne={class:"form"},He={class:"form"},Oe={class:"form-row-wrapper"},je={class:"special-form-row"},qe={key:0,class:"section-header inputs-block"},ze={class:"section-block_title"},Ge={key:0,class:"form width-limit"},Je={key:0,class:"form-field form-field--file form-field--basic"},Ke={class:"chat-files"},Qe={class:"chat-files__item"},We=["onClick"],Xe={class:"form-field form-field--file form-field--basic"},Ye={class:"form-field-input__file-wrapper"},Ze={class:"form-field-input__file"},$e=H(()=>n("span",null,"Прикрепить документ подтверждающий личность",-1)),el=["innerHTML"];function ll(g,c,T,o,O,j){var m,R,U,w,y,F,l;const C=ve,V=ke("router-link"),h=Se,P=de,v=fe,i=pe,x=_e,u=he,d=ge,D=ie,E=Fe,k=we,M=Ue;return s(),t(I,null,[p(C),n("div",Ae,[n("div",De,[n("div",Me,[p(V,{class:"section-label",to:"/Contracts"},{default:B(()=>[L("Мои договора")]),_:1}),Be]),p(h),Le,n("div",Ne,[(s(!0),t(I,null,N((R=(m=o.getConfig)==null?void 0:m.Contracts)==null?void 0:R.Types,e=>(s(),t(I,null,[(e==null?void 0:e.ProfileTemplateID)!==""?(s(),b(P,{key:0,label:e==null?void 0:e.Name,value:e==null?void 0:e.ProfileTemplateID,modelValue:o.templateValue,"onUpdate:modelValue":c[0]||(c[0]=a=>o.templateValue=a)},null,8,["label","value","modelValue"])):f("",!0)],64))),256))]),n("div",He,[(s(!0),t(I,null,N((l=(F=(y=(w=(U=o.getConfig)==null?void 0:U.Profiles)==null?void 0:w.Templates)==null?void 0:y[o.templateValue])==null?void 0:F.Template)==null?void 0:l.Attribs,(e,a)=>(s(),t("div",Oe,[n("div",je,[e!=null&&e.Title?(s(),t("div",qe,[n("h2",ze,te(e==null?void 0:e.Title),1)])):f("",!0),(e==null?void 0:e.Type)==="Input"&&(e==null?void 0:e.Check)!=="Phone"?(s(),b(v,{key:1,class:A({"special-form-input":!0,"form-field-error":o.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:o.form[a].value,"onUpdate:modelValue":r=>o.form[a].value=r,pattern:o.getFieldRegex(e==null?void 0:e.Check)},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue","pattern"])):f("",!0),(e==null?void 0:e.Type)==="Input"&&(e==null?void 0:e.Check)==="Phone"?(s(),b(i,{key:2,class:A({"special-form-input":!0,"form-field-error":o.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:o.form[a].value,"onUpdate:modelValue":r=>o.form[a].value=r,pattern:o.getPhoneRegex()},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue","pattern"])):f("",!0),(e==null?void 0:e.Type)==="TextArea"?(s(),b(x,{key:3,class:A({"special-form-input":!0,"form-field-error":o.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:o.form[a].value,"onUpdate:modelValue":r=>o.form[a].value=r},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):(e==null?void 0:e.Type)==="Select"?(s(),b(u,{key:4,class:A({"special-form-input":!0,"form-field-error":o.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,options:e==null?void 0:e.Options,modelValue:o.form[a].value,"onUpdate:modelValue":r=>o.form[a].value=r},null,8,["class","label","placeholder","necessarily","name","options","modelValue","onUpdate:modelValue"])):f("",!0)])]))),256))]),o.templateValue!==0?(s(),t("div",Ge,[o.fileList.length?(s(),t("div",Je,[n("div",Ke,[(s(!0),t(I,null,N(o.fileList,(e,a)=>(s(),t("div",Qe,[n("span",null,[p(d,{class:"file-icon"})]),n("span",null,te(e==null?void 0:e.name),1),n("button",{class:"close",onClick:r=>o.removeFile(a)},[p(D)],8,We)]))),256))])])):f("",!0),n("label",Xe,[n("div",Ye,[n("input",{ref:"fileInput",type:"file",onChange:c[1]||(c[1]=(...e)=>o.fileUpload&&o.fileUpload(...e))},null,544),n("div",Ze,[p(E),$e])])]),p(k,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:o.agree,"onUpdate:modelValue":c[2]||(c[2]=e=>o.agree=e)},{default:B(()=>[L("Подтверждаю свое согласие на передачу информации в электроной форме (в том числе персональных данных) по открытым каналам связи сети Интернет")]),_:1},8,["modelValue"]),p(k,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:o.agreeHandle,"onUpdate:modelValue":c[3]||(c[3]=e=>o.agreeHandle=e)},{default:B(()=>[L("Я разрешаю передачу своих персональных данных третьим лицам, для выполнения заказанных мною услуг (регистрация доменто и т.п.)")]),_:1},8,["modelValue"])])):f("",!0),o.createProfileErrorMessage?(s(),t("div",{key:1,class:"error-message width-limit",innerHTML:o.formErrorMessage(o.createProfileErrorMessage)},null,8,el)):f("",!0),o.templateValue!==0?(s(),b(M,{key:2,class:"width-limit","is-loading":o.createProfileResult==="pending",label:"Зарегистрировать",onClick:c[4]||(c[4]=e=>o.checkForm())},null,8,["is-loading"])):f("",!0)])])],64)}const ol={components:{TextAreaLine:_e,simpleCheckbox:de,basicInput:fe,SelectLine:he,PhoneInput:pe,IconFile:ge,IconClose:ie,BlockBalanceAgreement:ve},setup(){const g=ye(),c=me(),T=Ie(),o=Re(),O=Te(),j=Pe(),C=_(!1),V=_(!1),h=_({}),P=_(null),v=_([]),i=_(null),x=_(null),u=_(0),d=ue(()=>g.ConfigList),D=ue(()=>{var l;return(l=T==null?void 0:T.userInfo)==null?void 0:l.Email}),E=d.value,k={};for(const l in E.Regulars)k[l]=E.Regulars[l];const M=l=>k[l]||null,m=()=>{const l=d.value;return l&&l.Regulars&&l.Regulars.Phone?new RegExp(l.Regulars.Phone):/^[0-9]{10}$/};function R(l){v.value=v.value.filter((e,a)=>a!==l)}function U(){if(C.value&&V.value){let l=new FormData;Object.keys(h.value).forEach(e=>{var a;l.append(e,(a=h.value[e])==null?void 0:a.value)}),l.append("TemplateID",u.value),l.append("Agree",C.value),l.append("AgreeHandle",V.value),v.value.forEach((e,a)=>{l.append("Document[]",e==null?void 0:e.value)}),i.value="pending",c.createNewContractFormData(l).then(e=>{var a;e.status==="success"?(i.value="success",O.push("/Contracts")):(i.value="error",x.value=(a=e.data)==null?void 0:a.Exception)})}}function w(l){return""+y(l)}function y(l){return l?"<div>"+(l==null?void 0:l.String)+"</div>"+y(l==null?void 0:l.Parent):""}function F(l){var a;let e=((a=l.target.files)==null?void 0:a[0])||null;e&&(P.value.value="",o.sendFile(e).then(r=>{v.value.push({name:e==null?void 0:e.name,value:r.slice(r.lastIndexOf("^")+1,r.length)})}))}return xe(u,()=>{var l,e,a,r,q;h.value={},Object.keys((q=(r=(a=(e=(l=d.value)==null?void 0:l.Profiles)==null?void 0:e.Templates)==null?void 0:a[u.value])==null?void 0:r.Template)==null?void 0:q.Attribs).forEach(S=>{var z,G,J,K,Q,W,X,Y,Z,$,ee,le,oe,ae,ne,se,re,ce;h.value[S]={error:!1,value:(((W=(Q=(K=(J=(G=(z=d.value)==null?void 0:z.Profiles)==null?void 0:G.Templates)==null?void 0:J[u.value])==null?void 0:K.Template)==null?void 0:Q.Attribs[S])==null?void 0:W.Value)==="%Email%"?D.value:(le=(ee=($=(Z=(Y=(X=d.value)==null?void 0:X.Profiles)==null?void 0:Y.Templates)==null?void 0:Z[u.value])==null?void 0:$.Template)==null?void 0:ee.Attribs[S])==null?void 0:le.Value)||null,required:((ce=(re=(se=(ne=(ae=(oe=d.value)==null?void 0:oe.Profiles)==null?void 0:ae.Templates)==null?void 0:ne[u.value])==null?void 0:se.Template)==null?void 0:re.Attribs[S])==null?void 0:ce.IsDuty)==="1"}})}),Ee(()=>{console.log(j)}),{getConfig:d,templateValue:u,agreeHandle:V,agree:C,createProfileResult:i,createProfileErrorMessage:x,checkForm:U,formErrorMessage:w,form:h,fileInput:P,fileList:v,removeFile:R,fileUpload:F,getPhoneRegex:m,getFieldRegex:M,fieldRegexMap:k}}},bl=Ve(ol,[["render",ll],["__scopeId","data-v-bdfdd9ae"]]);export{bl as default};
