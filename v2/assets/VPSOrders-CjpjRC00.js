import{_ as oe}from"./EmptyStateBlock-Dks67PsT.js";import{_ as se}from"./VpsItem-BpzB-rfd.js";import{_ as ae}from"./FormInputSearch-CTZl1IoO.js";import{_ as ne}from"./ClausesKeeper-DtaNhp0a.js";import{m as le}from"./bootstrap-vue-next-9iQSFcL_.js";import{_ as re,a as ce}from"./IconButtonBack-BlkBJTtD.js";import{_ as ue}from"./ButtonDefault-tVMF5ozh.js";import{_ as me}from"./BlockBalanceAgreement-ckI0MbGb.js";import{H as ie,r as i,E as I,x as _e,f as d,c as D,b as n,a as s,D as w,n as de,I as g,t as p,J as V,w as h,G as pe,v as ve,F as M,j as fe,d as Se,o as _,e as j}from"./index-DxPA2ffO.js";import{s as be}from"./multiselect-DxJoM0Ze.js";import{u as ge}from"./contracts-DD2O0C6m.js";import{u as Ve}from"./globalActions-DUlmxNCV.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IconDots-DGe1DF8w.js";import"./Helper-C1WzNFjD.js";import"./IconCard-BQu6YZod.js";import"./IconRotate-D2tnBUTY.js";import"./StatusBadge-DroW9lKR.js";import"./OrderIDBadge-BR_cruJT.js";import"./time-DenPiOX5.js";import"./IconPlus-BzyFfXEL.js";import"./IconClose-Br7S99e8.js";const Pe={class:"section"},ke={class:"container"},Ce={class:"title__icon"},Ie={class:"btn__group"},De={class:"group__several"},we={class:"list-form"},ye={class:"list-form_col list-form_col--sm"},$e={class:"list-form_select"},Be={class:"multiselect-option"},Oe={key:0},xe={__name:"VPSOrders",async setup(Ue){let c,u;const m=ie(),y=ge(),$=Ve(),B=Se(),v=i(null),f=i("*"),l=i(!1),S=i([]),P=i(null),k=i(!1),C=_e("emitter");[c,u]=I(()=>m.fetchVPS()),await c,u(),[c,u]=I(()=>m.fetchVPSSchemes()),await c,u(),[c,u]=I(()=>y.fetchContracts()),await c,u(),C.on("updateVPSList",()=>{m.fetchVPS()});const A=t=>{S.value=t};async function R(){const t=Object.keys(S.value).filter(a=>S.value[a]),e={ServiceID:"30000",ItemsPay:P.value,OrdersIDs:t,...k.value&&{UseBalance:"yes"}};await $.OrdersPay(e).then(a=>{a==="Basket"?(console.log("Success"),B.push("/Basket")):a?.Status==="Ok"&&(l.value=!1,C.emit("open-modal",{component:"BalanceProlong",data:{Message:a?.Message,Count:a?.Count}}))})}function E(){l.value=!0}function F(){l.value=!1}const r=d(()=>Object.keys(m?.vpsList).map(t=>m?.vpsList[t])?.reverse()),z=d(()=>m.vpsSchemes),b=d(()=>q(H(r.value))),O=d(()=>y?.contractsList);function G(){B.go(0)}function H(t){return f.value!=="*"?t.filter(e=>e?.ContractID===f.value):t}function J(t){$.OrderManage(t)}function T(t,e){C.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить виртуальный сервер #${e}?`,tableID:"VPSOrders",successEmit:"updateVPSList"}})}function q(t){return v.value!==null?t.filter(e=>e?.IP.toLowerCase().includes(v.value.toLowerCase())):t}const x=d(()=>{let t=[{value:"*",name:"Все договора"}];return r.value!==null?(Object.keys(r.value).forEach(e=>{t.find(a=>a.value===r.value[e]?.ContractID)||t.push({value:r.value[e]?.ContractID,name:O.value[r.value[e]?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}});function K(t){const e=z.value?.[t.SchemeID];return[{text:`${e?.Name}`},{text:`${e?.SchemeParams?.hdd_mib?.InternalName} ${e?.SchemeParams?.hdd_mib?.Value} ${e?.SchemeParams?.hdd_mib?.Unit}`},{text:`RAM ${e?.SchemeParams?.ram_mib?.Value} ${e?.SchemeParams?.ram_mib?.Unit}`},{text:`Канал ${e?.SchemeParams?.net_bandwidth_mbitps?.Value} ${e?.SchemeParams?.net_bandwidth_mbitps?.Unit}`}]}return(t,e)=>{const a=me,Q=re,U=ue,W=pe("router-link"),X=ce,Y=le,Z=ne,ee=ae,te=se,L=oe;return _(),D(M,null,[n(a),s("section",Pe,[s("div",ke,[s("div",{class:de(["section-header",l.value?"column":""])},[s("div",Ce,[s("h1",{class:"section-title",onClick:e[0]||(e[0]=o=>G())},p(l.value?"Продление услуг виртуальных серверов":"VPS/VDS серверы"),1),g(n(Q,{onClick:e[1]||(e[1]=o=>F())},null,512),[[V,l.value]])]),g(s("div",Ie,[g(n(U,{class:"btn-several",label:"Продлить несколько заказов",onClick:e[2]||(e[2]=o=>E())},null,512),[[V,r.value.length>1]]),n(W,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:h(()=>e[8]||(e[8]=[j("Заказать",-1)])),_:1,__:[8]})],512),[[V,!l.value]]),g(s("div",De,[n(X,{class:"contr period",modelValue:P.value,"onUpdate:modelValue":e[3]||(e[3]=o=>P.value=o)},null,8,["modelValue"]),n(Y,{id:"checkbox-balance",modelValue:k.value,"onUpdate:modelValue":e[4]||(e[4]=o=>k.value=o),name:"checkbox-balance"},{default:h(()=>e[9]||(e[9]=[j(" Использовать средства с баланса ",-1)])),_:1,__:[9]},8,["modelValue"]),n(U,{label:"Продлить",onClick:e[5]||(e[5]=o=>R())})],512),[[V,l.value]])],2),n(Z),s("div",we,[s("div",ye,[s("div",$e,[n(ve(be),{modelValue:f.value,"onUpdate:modelValue":e[6]||(e[6]=o=>f.value=o),options:x.value,disabled:x.value?.length<=1,label:"name"},{singlelabel:h(({value:o})=>[s("span",null," # "+p(o.value.padStart(5,"0"))+" / "+p(o.name),1)]),option:h(({option:o})=>[s("div",Be,"# "+p(o.value.padStart(5,"0"))+" / "+p(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),n(ee,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=o=>v.value=o)},null,8,["modelValue"])]),r.value&&r.value?.length>0?(_(),D("div",Oe,[b.value&&b.value?.length>0?(_(!0),D(M,{key:0},fe(b.value,(o,N)=>(_(),w(te,{key:o.OrderID||N,"item-data":o,"is-last":N===b.value.length-1,"user-name":O.value[o?.ContractID]?.Customer,params:K(o),isSeveral:l.value,"selected-rows":S.value,onUpdateSelectedRows:A,onDelete:T,onManage:J},null,8,["item-data","is-last","user-name","params","isSeveral","selected-rows"]))),128)):(_(),w(L,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(_(),w(L,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])],64)}}},ot=he(xe,[["__scopeId","data-v-2f94bb48"]]);export{ot as default};
