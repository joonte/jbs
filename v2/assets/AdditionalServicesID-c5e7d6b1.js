import{o as y,c as L,b as p,a as r,t as D,x as V,k as B,Y as R,Z as T,F,p as U,l as E,_ as W,a7 as Y,e as Z,R as q,f as z,r as H,g as i,i as J}from"./index-15714261.js";import{u as K}from"./postings-4d84dab6.js";import{u as Q}from"./services-8084fcef.js";import{S as j}from"./StatusBadge-d84388d1.js";import{s as X}from"./servicesStatuses-6293b6ac.js";import{B as G}from"./BlockBalanceAgreement-8319794d.js";import{_ as $}from"./ServicesContractBalanceBlock-43adf8f1.js";import{_ as ee}from"./ClausesKeeper-e7fc0265.js";import{_ as te}from"./ButtonDefault-47f7ce80.js";import"./contracts-f65e198e.js";import"./bootstrap-vue-next.es-a66dab43.js";import"./IconArrow-3252fec2.js";import"./IconProfile-a3b589de.js";import"./IconCard-e28e03f4.js";import"./IconClose-b189ba41.js";const M=m=>(U("data-v-385d36bd"),m=m(),E(),m),oe={class:"section"},se={class:"container"},ne={class:"section-header"},re={class:"section-title"},ae={class:"section-label"},ce={class:"list"},ie={class:"list-col list-col--md"},le={class:"list-item"},de={class:"list-item__row"},me={class:"list-item__title"},ue={class:"list-item__status"},_e={class:"list-item__row"},ve={class:"list-item__ul"},ge={key:0},Se={class:"list-item__row"},Ie={class:"btn btn--border btn--switch"},pe=M(()=>r("span",{class:"btn-switch__text"},"Автопродление",-1)),De=M(()=>r("span",{class:"btn-switch__toggle"},null,-1));function he(m,a,s,o,l,c){var O,v,_,g,I,f,P,b,w,k,C,N,e;const S=G,n=te,A=ee,u=$,h=j;return y(),L(F,null,[p(S),r("div",oe,[r("div",se,[r("div",ne,[r("h1",re,D((O=o.getService)==null?void 0:O.Name),1),r("div",ae,"# "+D((v=o.getOrder)==null?void 0:v.ID),1),((_=o.getOrder)==null?void 0:_.ServiceID)==="52000"?(y(),V(n,{key:0,class:"section-scheme",label:"Изменить тариф",onClick:a[0]||(a[0]=t=>o.changeScheme())})):B("",!0),((g=o.getOrder)==null?void 0:g.ServiceID)==="51000"?(y(),V(n,{key:1,class:"section-scheme",label:"Изменить тариф",onClick:a[1]||(a[1]=t=>o.changeISPScheme())})):B("",!0)]),p(A),r("div",ce,[p(u,{"contract-id":(I=o.getOrder)==null?void 0:I.ContractID,onTransfer:a[2]||(a[2]=t=>o.transferItem())},null,8,["contract-id"]),r("div",ie,[r("div",le,[r("div",de,[r("div",me,D((f=o.getService)==null?void 0:f.Name),1),r("div",ue,[p(h,{status:(P=o.getOrder)==null?void 0:P.StatusID,"status-table":"Orders"},null,8,["status"])])]),r("div",_e,[r("ul",ve,[(b=o.getOrder)!=null&&b.DependOrderID&&((w=o.getOrder)==null?void 0:w.DependOrderID)!=="0"?(y(),L("li",ge,"Относится к заказу "+D((k=o.getOrder)==null?void 0:k.DependOrderID)+"/"+D((C=o.getDependOrderService)==null?void 0:C.Name),1)):B("",!0)])]),r("div",Se,[p(n,{label:((N=o.getOrder)==null?void 0:N.StatusID)==="ClaimForRegister"||((e=o.getOrder)==null?void 0:e.StatusID)==="Waiting"?"Оплатить":"Продлить",onClick:a[3]||(a[3]=t=>o.navigateToProlong())},null,8,["label"]),r("label",Ie,[R(r("input",{type:"checkbox","onUpdate:modelValue":a[4]||(a[4]=t=>o.isAutoProlong=t),onInput:a[5]||(a[5]=t=>o.setProlongValue())},null,544),[[T,o.isAutoProlong]]),pe,De])])])])])])])],64)}const Oe={components:{StatusBadge:j,BlockBalanceAgreement:G},async setup(){const m=Y(),a=Z(),s=Q(),o=q("emitter"),l=K(),c=z(),S=H(!1),n=i(()=>Object.keys(c==null?void 0:c.userOrders).map(e=>c==null?void 0:c.userOrders[e]).find(e=>e.ID===m.params.id)),A=i(()=>{var e,t;return l==null?void 0:l.servicesList[(t=c.userOrders[(e=n.value)==null?void 0:e.DependOrderID])==null?void 0:t.ServiceID]}),u=i(()=>{var e;return l==null?void 0:l.servicesList[(e=n.value)==null?void 0:e.ServiceID]}),h=i(()=>s==null?void 0:s.ISPswOrdersList),O=i(()=>Object.keys(s==null?void 0:s.ISPswOrdersList).map(e=>s==null?void 0:s.ISPswOrdersList[e]).find(e=>{var t;return e.OrderID===((t=n.value)==null?void 0:t.ID)})),v=i(()=>Object.keys(s==null?void 0:s.DNSmanagerOrdersList).map(e=>s==null?void 0:s.DNSmanagerOrdersList[e]).find(e=>{var t;return e.OrderID===((t=n.value)==null?void 0:t.ID)})),_=i(()=>s==null?void 0:s.additionalServicesScheme),g=i(()=>{const e=v.value;return e&&_.value.DNSmanager[e.SchemeID]||null}),I=i(()=>{const e=O.value;return e&&_.value.ISPsw[e.SchemeID]||null});function f(){var e,t;o.emit("open-modal",{component:"OrdersTransfer",data:{ServiceOrderID:(e=n.value)==null?void 0:e.ID,ServiceID:(t=n.value)==null?void 0:t.ServiceID}})}function P(){a.push(`/ServiceOrderPay/${m.params.id}`)}function b(){var e;c.prolongOrder({IsAutoProlong:S.value?0:1,OrderID:(e=n.value)==null?void 0:e.ID})}function w(){k()}function k(){var e,t,d;o.emit("open-modal",{component:"ISPswSchemeChange",data:{ISPswID:(e=n.value)==null?void 0:e.ID,ServerGroup:(t=I.value)==null?void 0:t.ServersGroupID,Code:(d=u.value)==null?void 0:d.Code}})}function C(){N()}function N(){var e,t,d;o.emit("open-modal",{component:"DNSOrderSchemeChange",data:{DNSID:(e=n.value)==null?void 0:e.ID,ServerGroup:(t=g.value)==null?void 0:t.ServersGroupID,Code:(d=u.value)==null?void 0:d.Code}})}return J(async()=>{var e,t,d,x;((e=n.value)==null?void 0:e.ServiceID)==="52000"&&(await s.fetchAdditionalServiceScheme((t=u.value)==null?void 0:t.Code),await s.fetchDNSmanagerOrders(),console.log("DNSOrder - ",n.value),console.log(v),console.log(g)),((d=n.value)==null?void 0:d.ServiceID)==="51000"&&(await s.fetchAdditionalServiceScheme((x=u.value)==null?void 0:x.Code),await s.fetchISPswOrders(),console.log(_.value),console.log(h))}),await c.fetchUserOrders().then(()=>{var e;S.value=(e=n.value)==null?void 0:e.IsAutoProlong}),await l.fetchServices(),{getService:u,getOrder:n,getDependOrderService:A,isAutoProlong:S,servicesStatuses:X,transferItem:f,navigateToProlong:P,setProlongValue:b,getDNSmanagerOrder:v,getAdditionalServiceScheme:_,getDNSmanagerOrderScheme:g,getISPOrderScheme:I,changeScheme:C,ISPswOrders:h,changeISPScheme:w}}},Me=W(Oe,[["render",he],["__scopeId","data-v-385d36bd"]]);export{Me as default};
