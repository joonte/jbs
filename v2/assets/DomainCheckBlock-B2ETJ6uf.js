import{_ as Y}from"./EmptyStateBlock-Ad1AmtSS.js";import{I as G,m as J}from"./bootstrap-vue-next-BglOzul_.js";import{_ as X}from"./IconClose-CgjzG0Yf.js";import{_ as ee}from"./ButtonDefault-B1FApUky.js";import{R as oe,r as i,m as ne,d as ae,g as te,q as se,f as ie,H as C,s as le,Y as P,c as r,o as l,a,h as N,b as h,F as B,C as ce,i as re,n as O,j as de,t as d,w as ue,T as _e}from"./index-C9dBN6m4.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ve={class:"domain-check__wrapper"},fe={class:"domain-block"},pe={class:"domain-field"},ke={key:0,class:"domain__grid"},he=["id","onClick"],ye={class:"domain__item-wrapper"},De={class:"domain__item-info__title"},we={class:"domain__item-info__text"},Ie={class:"domain__info-wrapper"},ge={class:"domain__info-wrapper-vertical"},Ce={class:"domain__info-wrapper"},Ne={class:"domain__info-title"},xe={class:"domain__info-title"},be={class:"domain__package-name"},$e={key:1,class:"domain__loader"},Ee={key:1,class:"tw-flex tw-gap-2 tw-justify-end tw-w-full"},Fe={class:"tw-text-sm tw-space-y-1"},Le={class:"tw-text-right"},Se={class:"tw-text-gray-500 tw-text-right"},Pe={__name:"DomainCheckBlock",props:{search:{type:String,default:""},domainList:{type:Array,default:()=>[]}},emits:["select"],setup(T,{emit:V}){const w=T,q=V,x=oe(),A=i(w.search);ne(()=>w.search,e=>{A.value=e,e&&D()});const U=ae(),b=te(),m=se({}),$=i(!1),c=i(null);b.query.DomainName&&(c.value=b.query.DomainName,D()),i(null);const y=i(null),E=i(!1),k=i(null),Z=i(!1),u=i([]),v=i([]);function j(e){return e.match(/\(([^)]+)\)/)?.[1]||""}function F(e){e.key==="Enter"&&!z.value&&D()}const z=ie(()=>!c.value);C(()=>{document.addEventListener("keyup",F)}),le(()=>{document.removeEventListener("keyup",F)});function R(){U.replace({query:{DomainName:c.value}})}function H(){k.value=null}function M(e,n,t){const f=n.match(/\(([^)]+)\)/)?.[1],_=`${e}-${f}`;Object.keys(m).forEach(s=>{delete m[s]}),m[_]?(k.value=null,delete m[_],$.value=!1):(k.value=e,m[_]=!0,$.value=!0)}function W(e){L(e)}function I(){const e=document.querySelector(".domain__info-title");e&&(Z.value=e.scrollWidth>e.clientWidth)}function D(){R(),x.DomainNameCheck({DomainName:c.value}).then(e=>{const{result:n,resultData:t}=e;if(t?.DomainName&&(c.value=t.DomainName,y.value=t.DomainName),t?.Zones){u.value=w.domainList.filter(s=>t?.Zones?.includes(s?.Name)&&s?.IsActive).sort((s,g)=>t?.Zones.indexOf(s?.Name)-t?.Zones.indexOf(g?.Name)).map(s=>({...s,isFree:null,info:n.Info})),E.value=!0;let f=0;const _=setInterval(()=>{K(f),f++},100);setTimeout(()=>{clearInterval(_)},u.value?.length*100)}else u.value=[]})}async function K(e){try{const n=await x.DomainCheck(y.value,u.value[e]?.Name);u.value[e]={...u.value[e],isFree:n.status==="SUCCESS",info:n.info}}catch(n){console.error("An error occurred:",n)}}function L(e){if(e.isFree){const n=v.value.findIndex(t=>t.ID===e.ID);n===-1?v.value.push(e):v.value.splice(n,1),q("select",v.value.map(t=>({...t,line:c.value})))}}function Q(e){L(e),M(e?.info,e?.PackageID,`domain-item-${e.ID}-${e.PackageID}`)}C(()=>{I(),window.addEventListener("resize",I)}),P(()=>{window.removeEventListener("resize",I)});function S(e){e.key==="Escape"&&(k.value=null)}return C(()=>{window.addEventListener("keydown",S)}),P(()=>{window.removeEventListener("keydown",S)}),(e,n)=>{const t=G,f=ee,_=X,s=J,g=Y;return l(),r("div",ve,[a("div",fe,[n[4]||(n[4]=a("div",{class:"section-title"},[a("h2",{class:"section-block_title"},"Проверить домен")],-1)),a("div",pe,[h(t,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=o=>c.value=o),placeholder:"Например, yourName",type:"text"},null,8,["modelValue"]),h(f,{label:"Подобрать",disabled:!c.value,onClick:n[1]||(n[1]=o=>D())},null,8,["disabled"])]),E.value?(l(),r(B,{key:0},[u.value?.length>0?(l(),r("div",ke,[(l(!0),r(B,null,re(u.value,o=>(l(),r("div",{class:O(["domain__item tw-gap-4",{domain__item_inactive:o?.isFree===!1||o?.isFree===null,domain__item_active:v.value.some(p=>p.ID===o.ID)}]),key:`domain-item-${o.ID}-${o.PackageID}`,id:`domain-item-${o.ID}-${o.PackageID}`,onClick:p=>Q(o)},[o?.info&&k.value===o?.info&&m[`${o.info}-${j(o.PackageID)}`]?(l(),r("div",{key:0,class:"domain__item-info",onClick:n[3]||(n[3]=de(()=>{},["stop"]))},[a("div",ye,[a("div",De,"Данные домена "+d(y.value)+"."+d(o?.Name),1),h(_,{class:"domain__item-icon",onClick:n[2]||(n[2]=p=>H())})]),a("pre",we,d(o?.info),1)])):N("",!0),a("div",Ie,[a("div",ge,[a("div",Ce,[a("div",Ne,d(y.value),1),a("div",xe,"."+d(o?.Name),1)]),a("div",be,d(o?.PackageID),1)]),h(_e,{name:"fade",mode:"out-in"},{default:ue(()=>[o?.isFree!==null?(l(),r("div",{key:0,class:O(["domain__info-status",{available:o?.isFree===!0}])},d(o?.isFree?"Свободен":"Занят"),3)):(l(),r("div",$e))]),_:2},1024)]),o?.isFree?(l(),r("div",Ee,[a("div",Fe,[a("div",Le,d(o?.CostOrder)+" ₽ / год",1),a("div",Se,"Продление: "+d(o?.CostProlong)+" ₽",1)]),h(s,{class:"domain__checkbox",checked:v.value.some(p=>p.ID===o.ID),onChange:p=>W(o)},null,8,["checked","onChange"])])):N("",!0)],10,he))),128))])):(l(),ce(g,{key:1,class:"domain__empty",label:"Неправильное доменное имя"}))],64)):N("",!0)])])}}},Ue=me(Pe,[["__scopeId","data-v-840d5211"]]);export{Ue as _};
