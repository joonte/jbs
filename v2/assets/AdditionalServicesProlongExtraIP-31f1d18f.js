import{E as le}from"./EmptyStateBlock-b0a120e4.js";import{_ as ce}from"./BlockOrderPayBalance-39bb297a.js";import{_ as ne}from"./ClausesKeeper-90c650cc.js";import{_ as re}from"./ButtonDefault-11c4541b.js";import{_ as ie,f as _e,e as de,r as Y,h as E,i as ue,ah as w,o as i,c as _,b as u,a as t,t as r,F as C,y as ve,Z as ee,ab as te,l as pe,p as me,m as he}from"./index-aeb1df1e.js";import{u as be}from"./IconArrow-a6c91ada.js";import{u as ke}from"./services-bb78f548.js";/* empty css                                                                             */import{B as fe}from"./BlockBalanceAgreement-906c1168.js";import"./bootstrap-vue-next.es-c6bcf011.js";import"./IconHelp-66378dff.js";import"./globalActions-3944bebb.js";import"./component-60ac2998.js";import"./IconClose-c7c36336.js";const O=g=>(me("data-v-8fd37874"),g=g(),he(),g),ye={key:0,class:"hosting-sheme"},Ie={class:"section"},De={class:"container"},ge={class:"section-header"},Pe={class:"section-header__wrapper"},Se={class:"section-label"},xe={key:0,class:"section"},Be={class:"container"},Ee=O(()=>t("div",{class:"total-block"},null,-1)),we={class:"total-block__row divider-bottom"},Ce=O(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),Oe={class:"total-block__col"},Fe={class:"total-block__row no-divider"},Ne={class:"total-block__col"},Ae={class:"total-block__col"},Le={class:"total-block__row total-block__row--big economy-line"},Re=O(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),$e={class:"total-block__col flex-col"},Me={class:"red"},Ue={class:"total-block__row total-block__row--big"},Ve={class:"total-block__col"},je={class:"total-block__col"},Te={key:1,class:"section"},qe={class:"container"},ze={key:1,class:"section"},Ze={class:"container"},Ge={__name:"AdditionalServicesProlongExtraIP",async setup(g){let v,p;const F=be(),l=ke(),oe=_e(),N=de(),o=Y(null),h=Y(!1),n=E(()=>Object.keys(l==null?void 0:l.ExtraIPOrdersList).map(s=>l==null?void 0:l.ExtraIPOrdersList[s]).find(s=>s.OrderID===oe.params.id)),P=E(()=>{var s;return(s=l==null?void 0:l.additionalServicesScheme)!=null&&s.ExtraIP?Object.keys(l.additionalServicesScheme.ExtraIP).map(a=>{const e=l.additionalServicesScheme.ExtraIP[a];return{...e,value:e==null?void 0:e.ID,name:e==null?void 0:e.Name,cost:e==null?void 0:e.CostDay,month:e==null?void 0:e.CostMonth}}).filter(a=>{var e;return(a==null?void 0:a.ID)==((e=n.value)==null?void 0:e.SchemeID)}):[]}),x=E(()=>F.contractsList);function ae(){console.log(o.value)}function A(){var k,f,y,I,D;h.value=!0;const s=parseFloat((k=x.value[n.value.ContractID])==null?void 0:k.Balance)>=parseFloat(m(((f=o.value)==null?void 0:f.price)-S())??0),a=((y=P.value[0])==null?void 0:y.cost)==="0.00"&&((I=P.value[0])==null?void 0:I.month)==="0.00",e=s||a,b=!e,B={ExtraIPOrderID:n.value.ID,DaysPay:(D=o.value)==null?void 0:D.actualDays,IsNoBasket:e,IsUseBasket:b,PayMessage:""};l.ExtraIPOrderPay(B).then(d=>{d==="UseBasket"?N.push("/Basket"):d==="NoBasket"?N.push("/AdditionalServices"):console.error("Ошибка оплаты заказа"),h.value=!1}).catch(d=>{console.error("ExtraIPOrderPay error:",d),h.value=!1})}function m(s){return Number(s).toFixed(2)||0}function S(){var a,e;let s=0;return(e=(a=o.value)==null?void 0:a.discounts)==null||e.Bonuses.map(b=>{s+=+b.Economy}),s}function se(s){o.value=s}return ue(()=>{l.fetchAdditionalServiceScheme("ExtraIP")}),[v,p]=w(()=>l.fetchExtraIPOrders()),await v,p(),[v,p]=w(()=>l.fetchAdditionalServiceScheme("ExtraIP")),await v,p(),[v,p]=w(()=>F.fetchContracts()),await v,p(),(s,a)=>{var f,y,I,D,d,L,R,$,M,U,V,j,T,q,z,Z,G,H,J,K,Q,W,X;const e=re,b=ne,B=ce,k=le;return i(),_(C,null,[u(fe),n.value?(i(),_("div",ye,[t("div",Ie,[t("div",De,[t("div",ge,[t("div",Pe,[t("h1",{class:"section-title",onClick:a[0]||(a[0]=c=>ae())},"Оплата заказа IP адреса"),u(e,{class:"btn--wide",label:parseFloat((f=x.value[n.value.ContractID])==null?void 0:f.Balance)>=parseFloat((y=o.value)==null?void 0:y.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:o.value===null||((I=o.value)==null?void 0:I.price)===null,"is-loading":h.value,onClick:a[1]||(a[1]=c=>A())},null,8,["label","disabled","is-loading"])]),t("div",Se,r((D=P.value[0])==null?void 0:D.Name),1)])]),u(b)]),u(B,{contractID:(d=n.value)==null?void 0:d.ContractID,daysRemainded:(L=n.value)==null?void 0:L.DaysRemainded,serviceID:"50000",scheme:P.value[0],orderID:(R=n.value)==null?void 0:R.OrderID,isOrderID:!0,onSelect:se},null,8,["contractID","daysRemainded","scheme","orderID"]),n.value?(i(),_("div",xe,[t("div",Be,[Ee,((U=(M=($=o.value)==null?void 0:$.discounts)==null?void 0:M.Bonuses)==null?void 0:U.length)>0?(i(),_(C,{key:0},[t("div",we,[Ce,t("div",Oe,r(m((V=o.value)==null?void 0:V.price))+" ₽",1)]),(i(!0),_(C,null,ve((T=(j=o.value)==null?void 0:j.discounts)==null?void 0:T.Bonuses,c=>(i(),_("div",Fe,[t("div",Ne,"Скидка "+r(c==null?void 0:c.Discount)+"% на "+r(c==null?void 0:c.Days)+" дней",1),t("div",Ae,"-"+r(m(c==null?void 0:c.Economy))+" ₽",1)]))),256)),ee(t("div",Le,[Re,t("div",$e,[t("span",null,[t("s",null,r(m((q=o.value)==null?void 0:q.price))+" ₽",1)]),t("span",Me,"-"+r(S())+" ₽",1)])],512),[[te,((G=(Z=(z=o.value)==null?void 0:z.discounts)==null?void 0:Z.Bonuses)==null?void 0:G.length)>0]])],64)):pe("",!0),ee(t("div",Ue,[t("div",Ve,"Итого за "+r((H=o.value)==null?void 0:H.label),1),t("div",je,r(m(((J=o.value)==null?void 0:J.price)-S()))+" ₽",1)],512),[[te,(K=o.value)==null?void 0:K.price]]),u(e,{class:"btn--wide",label:parseFloat((Q=x.value[n.value.ContractID])==null?void 0:Q.Balance)>=(m(((W=o.value)==null?void 0:W.price)-S())??0)?"Оплатить c баланса договора":"Добавить в корзину",disabled:o.value===null||((X=o.value)==null?void 0:X.price)===null,"is-loading":h.value,onClick:a[2]||(a[2]=c=>A())},null,8,["label","disabled","is-loading"])])])):(i(),_("div",Te,[t("div",qe,[u(k,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(i(),_("div",ze,[t("div",Ze,[u(k,{label:"не удалось найти заказ хостинга"})])]))],64)}}},nt=ie(Ge,[["__scopeId","data-v-8fd37874"]]);export{nt as default};
