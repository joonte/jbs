import{E as ps}from"./EmptyStateBlock-1861cff5.js";import{_ as hs}from"./BlockOrderPayBalance-74ae5c26.js";import{_ as ms}from"./ClausesKeeper-12bc5d50.js";import{_ as ks}from"./ButtonDefault-eb076df2.js";import{_ as fs,r as is,a7 as ys,e as Ds,S as Is,g as I,ag as g,o as c,c as _,b as p,a as t,t as i,F as f,x as ns,k as gs,Z as _s,ae as rs,y as ds,p as xs,l as ws}from"./index-642cdac5.js";import{u as Bs}from"./dedicatedServer-2accfe16.js";import{u as Cs}from"./contracts-16ef7000.js";import{B as Ps}from"./BlockBalanceAgreement-ccba2ab2.js";import"./bootstrap-vue-next.es-9ff54498.js";import"./IconHelp-41d48e37.js";import"./globalActions-c9fc22a3.js";import"./BasicInput-e305f811.js";import"./component-faf9e0c1.js";import"./IconClose-f1b85910.js";import"./IconArrow-c0196cbe.js";const y=h=>(xs("data-v-3aa6cd3e"),h=h(),ws(),h),Es={key:0,class:"domain-scheme"},Os={class:"section"},Ss={class:"container"},$s={class:"section-header"},Rs={class:"section-header__wrapper"},Fs=y(()=>t("h1",{class:"section-title"},"Оплата заказа выделенного сервера",-1)),Ls={class:"section-label"},As={class:"section"},Ns={class:"container"},Ts={class:"list"},Vs={class:"list-col list-col--xl"},js={class:"list-item"},Us=y(()=>t("div",{class:"list-item__row"},[t("div",{class:"list-item__title"},"Конфигурация")],-1)),Ks={class:"list-item__row list-item__table"},Zs={class:"list-item__table-col"},qs={class:"list-item__label"},zs={class:"list-item__text"},Gs={key:0,class:"section"},Hs={class:"container"},Js={class:"total-block"},Ms={class:"total-block__row divider-bottom"},Qs=y(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),Ws={class:"total-block__col"},Xs={class:"total-block__row no-divider"},Ys={class:"total-block__col"},st={class:"total-block__col"},tt={class:"total-block__row total-block__row--big economy-line"},et=y(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),ot={class:"total-block__col flex-col"},lt={class:"red"},at={class:"total-block__row total-block__row--big"},ct={class:"total-block__col"},it={class:"total-block__col"},nt={key:1,class:"section"},_t={class:"container"},rt={key:1,class:"section"},dt={class:"container"},ut={__name:"DSSchemeProlong",async setup(h){let u,v;const e=is(null),a=Bs(),x=Cs(),us=ys(),w=Ds();Is("emitter");const m=is(!1),n=I(()=>Object.keys(a==null?void 0:a.DSList).map(s=>a==null?void 0:a.DSList[s]).find(s=>s.OrderID===us.params.id)),r=I(()=>{var s,l;return(l=a==null?void 0:a.DSSchemes)==null?void 0:l[(s=n.value)==null?void 0:s.SchemeID]}),B=I(()=>x.contractsList);function C(){var l,d;let s=0;return(d=(l=e.value)==null?void 0:l.discounts)==null||d.Bonuses.map(b=>{s+=+b.Economy}),s}function k(s){return Number(s).toFixed(2)||0}function vs(){const s=r==null?void 0:r.value;return[{label:"Процессор",text:(s==null?void 0:s.CPU)||"-"},{label:"Объём оперативной памяти",text:(s==null?void 0:s.ram)||"-"},{label:"Характеристики жёстких дисков",text:(s==null?void 0:s.disks)||"-"},{label:"Предустановленная ОС",text:(s==null?void 0:s.OS)||"-"},{label:"RAID",text:(s==null?void 0:s.raid)||"-"},{label:"Месячный трафик",text:s!=null&&s.trafflimit?`${s==null?void 0:s.trafflimit} ГБ`:"-"},{label:"Скорость канала",text:s!=null&&s.chrate?`${s==null?void 0:s.chrate} Мбит/с`:"-"}]}function P(){var s,l;m.value=!0,a.DSOrderPay({DSOrderID:(s=n.value)==null?void 0:s.ID,DaysPay:(l=e.value)==null?void 0:l.actualDays,IsChange:!0}).then(d=>{let{result:b,error:E}=d;b==="SUCCESS"?w.push("/DSOrders"):b==="BASKET"&&w.push("/Basket"),m.value=!1})}function bs(s){e.value=s}return[u,v]=g(()=>a.fetchDSOrders()),await u,v(),[u,v]=g(()=>a.fetchDSSchemes()),await u,v(),[u,v]=g(()=>x.fetchContracts()),await u,v(),(s,l)=>{var O,S,$,R,F,L,A,N,T,V,j,U,K,Z,q,z,G,H,J,M,Q,W,X,Y,ss,ts,es,os,ls,as,cs;const d=ks,b=ms,E=hs,D=ps;return c(),_(f,null,[p(Ps),(O=n.value)!=null&&O.ID&&((S=r.value)!=null&&S.ID)?(c(),_("div",Es,[t("div",Os,[t("div",Ss,[t("div",$s,[t("div",Rs,[Fs,p(d,{class:"btn--wide",label:((R=B.value[($=n.value)==null?void 0:$.ContractID])==null?void 0:R.Balance)>((F=e.value)==null?void 0:F.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:e.value===null||((L=e.value)==null?void 0:L.price)===null,"is-loading":m.value,onClick:l[0]||(l[0]=o=>P())},null,8,["label","disabled","is-loading"])]),t("div",Ls,i((A=n.value)!=null&&A.IP?`#${(N=n.value)==null?void 0:N.IP}`:""),1)]),p(b)])]),t("div",As,[t("div",Ns,[t("div",Ts,[t("div",Vs,[t("div",js,[Us,t("div",Ks,[(c(!0),_(f,null,ns(vs(),o=>(c(),_("div",Zs,[t("div",qs,i(o.label),1),t("div",zs,i(o.text),1)]))),256))])])])])])]),p(E,{contractID:(T=n.value)==null?void 0:T.ContractID,scheme:r.value,serviceID:"40000",daysRemainded:(V=n.value)==null?void 0:V.DaysRemainded,isOrderID:!1,onSelect:bs},null,8,["contractID","scheme","daysRemainded"]),(j=r.value)!=null&&j.IsPayed&&((U=r.value)!=null&&U.IsProlong)||!((K=r.value)!=null&&K.IsPayed)?(c(),_("div",Gs,[t("div",Hs,[t("div",Js,[((z=(q=(Z=e.value)==null?void 0:Z.discounts)==null?void 0:q.Bonuses)==null?void 0:z.length)>0?(c(),_(f,{key:0},[t("div",Ms,[Qs,t("div",Ws,i(k((G=e.value)==null?void 0:G.price))+" ₽",1)]),(c(!0),_(f,null,ns((J=(H=e.value)==null?void 0:H.discounts)==null?void 0:J.Bonuses,o=>(c(),_("div",Xs,[t("div",Ys,"Скидка "+i(o==null?void 0:o.Discount)+"% на "+i(o==null?void 0:o.Days)+" дней",1),t("div",st,"-"+i(k(o==null?void 0:o.Economy))+" ₽",1)]))),256))],64)):gs("",!0),_s(t("div",tt,[et,t("div",ot,[t("span",null,[t("s",null,i(k((M=e.value)==null?void 0:M.price))+" ₽",1)]),t("span",lt,"-"+i(C())+" ₽",1)])],512),[[rs,((X=(W=(Q=e.value)==null?void 0:Q.discounts)==null?void 0:W.Bonuses)==null?void 0:X.length)>0]]),_s(t("div",at,[t("div",ct,"Итого за "+i((Y=e.value)==null?void 0:Y.label),1),t("div",it,i(k(((ss=e.value)==null?void 0:ss.price)-C()))+" ₽",1)],512),[[rs,(ts=e.value)==null?void 0:ts.price]])]),p(d,{class:"btn--wide",label:((os=B.value[(es=n.value)==null?void 0:es.ContractID])==null?void 0:os.Balance)>((ls=e.value)==null?void 0:ls.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:e.value===null||((as=e.value)==null?void 0:as.price)===null,"is-loading":m.value,onClick:l[1]||(l[1]=o=>P())},null,8,["label","disabled","is-loading"])])])):(c(),_("div",nt,[t("div",_t,[p(D,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(c(),_("div",rt,[t("div",dt,[(cs=n.value)!=null&&cs.ID?(c(),ds(D,{key:0,label:"Заказ не может быть продлен"})):(c(),ds(D,{key:1,label:"Заказ не найден"}))])]))],64)}}},Pt=fs(ut,[["__scopeId","data-v-3aa6cd3e"]]);export{Pt as default};
