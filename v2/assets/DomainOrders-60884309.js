import{_ as A,j as E,o as u,c as y,a as c,b as a,w as m,d as v,t as L,k as x,F as U,v as H,x as N,p as K,l as q,e as G,R as J,r as j,g as S}from"./index-33bd9cf4.js";import{u as Q}from"./domain-3c4b9975.js";import{u as W}from"./contracts-141debab.js";import{s as X}from"./useTimeFunction-8602dd60.js";import{I as Y}from"./IconSearch-55746ee2.js";import{S as Z}from"./Select2-d10615a4.js";import{s as ee}from"./multiselect-acf9ef65.js";import{z as te,k as oe,d as ne}from"./bootstrap-vue-next.es-6bb0e5cd.js";import{_ as se}from"./OrderIDBadge-24fa2e7f.js";import{_ as ae}from"./IconDots-463e8bba.js";import{_ as re}from"./IconCard-c2e605c3.js";import{S as ie}from"./StatusBadge-b80983a6.js";import{_ as le}from"./HelperComponent-ebb207b6.js";import{_ as M}from"./ClausesKeeper-69d31679.js";import{B as F}from"./BlockBalanceAgreement-5028e9bc.js";import{E as ce}from"./EmptyStateBlock-98549fc8.js";import{_ as me}from"./FormInputSearch-aa64849b.js";import{_ as de}from"./ButtonDefault-34d9e627.js";import"./IconArrow-dadffb08.js";import"./IconClose-d9fbf580.js";import"./IconPlus-5f47af9a.js";const ue={class:"hosting-item"},_e={class:"hosting-item__row"},fe={class:"hosting-item__row"},De={class:"hosting-item__person"},pe={class:"hosting-item__row"},ge={class:"hosting-item__list"},he={key:0},ve={key:1,class:"bold"},Ie={class:"hosting-item__controls"},ke={class:"btn btn--dots"},be={__name:"DomainItem",props:{scheme:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},userName:{type:String,default:""},infoLink:{type:String,default:"/"},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","designateOwner"],setup(e,{emit:r}){const _=e;function o(){var i,l;console.log((i=_.itemData)==null?void 0:i.ID),r("delete",(l=_.itemData)==null?void 0:l.ID)}function I(){var i,l;r("transfer",{ServiceOrderID:(i=_.itemData)==null?void 0:i.ID,ServiceID:(l=_.itemData)==null?void 0:l.ServiceID})}function k(){var i;r("designateOwner",{DomainOrderID:(i=_.itemData)==null?void 0:i.ID})}return(i,l)=>{var p,g,h,s,O,B,P,n;const C=se,D=E("router-link"),d=te,w=oe,b=ne;return u(),y("div",ue,[c("div",_e,[a(C,{orderID:(p=e.itemData)==null?void 0:p.OrderID},null,8,["orderID"]),a(D,{class:"hosting-item__name",to:e.infoLink},{default:m(()=>{var t;return[v(L((t=e.itemData)==null?void 0:t.Domain),1)]}),_:1},8,["to"]),a(ie,{status:(g=e.itemData)==null?void 0:g.StatusID,"status-table":"DomainOrders"},null,8,["status"])]),c("div",fe,[c("div",De,L(e.userName),1),a(le,{"user-notice":(h=e.itemData)==null?void 0:h.UserNotice,id:(s=e.itemData)==null?void 0:s.OrderID,position:e.isLast?"bottom":"top",emit:"updateDomainsList"},null,8,["user-notice","id","position"])]),c("div",pe,[c("ul",ge,[(O=e.scheme)!=null&&O.PackageID?(u(),y("li",he,L((B=e.scheme)==null?void 0:B.PackageID),1)):x("",!0),(P=e.scheme)!=null&&P.CostProlong?(u(),y("li",ve,L((n=e.scheme)==null?void 0:n.CostProlong)+" ₽",1)):x("",!0)])]),c("div",Ie,[c("button",{class:"btn btn--md btn--bold",onClick:l[0]||(l[0]=t=>{var f;return i.$router.push(`/DomainOrderPay/${(f=e.itemData)==null?void 0:f.OrderID}`)})},[a(re),v("Оплатить")]),a(b,{class:"dropdown-dots",right:""},{"button-content":m(()=>[c("div",ke,[a(ae)])]),default:m(()=>[a(d,null,{default:m(()=>[a(D,{to:e.infoLink},{default:m(()=>[v("Дополнительная информация")]),_:1},8,["to"])]),_:1}),a(d,null,{default:m(()=>{var t;return[a(D,{to:`/DomainOrderPay/${(t=e.itemData)==null?void 0:t.OrderID}`},{default:m(()=>[v("Оплатить заказ")]),_:1},8,["to"])]}),_:1}),a(d,{onClick:l[1]||(l[1]=t=>k())},{default:m(()=>[v("Определить владельца")]),_:1}),a(d,{onClick:l[2]||(l[2]=t=>I())},{default:m(()=>[v("Передать на другой аккаунт")]),_:1}),a(w),a(d,{class:"color-red",onClick:l[3]||(l[3]=t=>o())},{default:m(()=>[v("Удалить")]),_:1})]),_:1})])])}}},z=A(be,[["__scopeId","data-v-fcc3037e"]]),Oe=e=>(K("data-v-19aa77f6"),e=e(),q(),e),ye={class:"section"},Ce={class:"container"},we={class:"section-header"},Se=Oe(()=>c("h1",{class:"section-title"},"Домены",-1)),Le={class:"btn__group"},Be={class:"list-form"},Pe={class:"list-form_col list-form_col--sm"},Ne={class:"list-form_select"},Ve={class:"multiselect-option"},$e={key:0};function Te(e,r,_,o,I,k){var p,g,h;const i=F,l=de,C=M,D=E("Multiselect"),d=me,w=z,b=ce;return u(),y(U,null,[a(i),c("div",ye,[c("div",Ce,[c("div",we,[Se,c("div",Le,[a(l,{label:"Заказать",onClick:r[0]||(r[0]=s=>o.navigateToDomainSchemes())}),a(l,{label:"Перенести домен",onClick:r[1]||(r[1]=s=>o.openTransferModal())})])]),a(C,{partition:"Header:/DomainOrders"}),c("div",Be,[c("div",Pe,[c("div",Ne,[a(D,{modelValue:o.select,"onUpdate:modelValue":r[2]||(r[2]=s=>o.select=s),options:o.getUsers,label:"name",disabled:((p=o.getUsers)==null?void 0:p.length)<=1},{option:m(({option:s})=>[c("div",Ve,L(s.name),1)]),_:1},8,["modelValue","options","disabled"])])]),a(d,{modelValue:o.search,"onUpdate:modelValue":r[3]||(r[3]=s=>o.search=s)},null,8,["modelValue"])]),o.getDomainsList&&((g=o.getDomainsList)==null?void 0:g.length)>0?(u(),y("div",$e,[o.filterProducts&&((h=o.filterProducts)==null?void 0:h.length)>0?(u(!0),y(U,{key:0},H(o.filterProducts,(s,O)=>(u(),N(w,{"item-data":s,"user-name":o.getUserName(s==null?void 0:s.ContractID),scheme:o.filterDomainScheme(s==null?void 0:s.SchemeID),"info-link":`/DomainOrders/${s==null?void 0:s.OrderID}`,"is-last":O===o.filterProducts.length-1,onDelete:o.deleteItem,onTransfer:o.transferItem,onDesignateOwner:o.designateOwner},null,8,["item-data","user-name","scheme","info-link","is-last","onDelete","onTransfer","onDesignateOwner"]))),256)):(u(),N(b,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(u(),N(b,{key:1,class:"no-margin",label:" У Вас нет заказов на домены"}))])])],64)}const xe={components:{IconSearch:Y,DomainItem:z,Select2:Z,Multiselect:ee,ClausesKeeper:M,BlockBalanceAgreement:F},async setup(){const e=Q(),r=W(),_=G(),o=J("emitter");o.on("updateDomainsList",()=>{e.fetchDomains()});const I=j("*"),k=j(null),i=S(()=>{var n;return(n=Object.keys(e==null?void 0:e.domainsList).map(t=>e==null?void 0:e.domainsList[t]))==null?void 0:n.reverse()}),l=S(()=>e==null?void 0:e.domainSchemes),C=S(()=>r==null?void 0:r.contractsList),D=S(()=>b(w(i.value))),d=S(()=>{let n=[{value:"*",name:"Все договора"}];return i.value!==null?(Object.keys(i.value).forEach(t=>{var f,V,$;n.find(R=>{var T;return R.value===((T=i.value[t])==null?void 0:T.ContractID)})||n.push({value:(f=i.value[t])==null?void 0:f.ContractID,name:($=C.value[(V=i.value[t])==null?void 0:V.ContractID])==null?void 0:$.Customer})}),n):{value:"*",name:"Все договора"}});function w(n){return I.value!=="*"?n.filter(t=>(t==null?void 0:t.ContractID)===I.value):n}function b(n){return k.value!==null?n.filter(t=>t==null?void 0:t.Domain.toLowerCase().includes(k.value.toLowerCase())):n}function p(n){var t;return(t=l.value)==null?void 0:t[n]}function g(n){var t,f;return(f=(t=r==null?void 0:r.contractsList)==null?void 0:t[n])==null?void 0:f.Customer}function h(){_.push({path:"/DomainSchemes"})}function s(n){o.emit("open-modal",{component:"DeleteItem",data:{id:n,message:`Вы действительно хотите удалить домен #${n}?`,tableID:"DomainOrders",successEmit:"updateDomainsList"}})}function O(n){o.emit("open-modal",{component:"OrdersTransfer",data:n})}function B(){o.emit("open-modal",{component:"DomainTransfer",data:{}})}function P(n){o.emit("open-modal",{component:"DomainSelectOwner",data:n})}return await e.fetchDomains(),await e.fetchDomainSchemes(),await r.fetchContracts(),{getDomainsList:i,getDomainsSchemes:l,getUsers:d,select:I,search:k,openTransferModal:B,filterProducts:D,getUserName:g,designateOwner:P,deleteItem:s,filterDomainScheme:p,navigateToDomainSchemes:h,startFunction:X,transferItem:O}}},nt=A(xe,[["render",Te],["__scopeId","data-v-19aa77f6"]]);export{nt as default};
