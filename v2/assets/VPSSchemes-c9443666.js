import{_ as me}from"./ButtonDefault-a8aacc82.js";import{_ as fe}from"./BlockOrderPayBalance-a68e17cc.js";import{_ as Q,r as f,i as de,o as l,c as r,a as t,m as ce,k as Y,t as _,d as be,F as C,v as w,e as Se,g as j,af as q,b as K,Y as ue,ad as re,x as z,p as ke,l as ge}from"./index-ed1f28f8.js";import{_ as Ve}from"./ClausesKeeper-9aa8ead7.js";import{u as ye}from"./vps-526e1f01.js";import{u as Ie}from"./resetServer-f1402ced.js";import{u as De}from"./contracts-cedf6a91.js";import{_ as Pe}from"./BlockSelectContract-c1497cc9.js";import"./bootstrap-vue-next.es-79226723.js";import"./IconHelp-730981ad.js";import"./globalActions-55d313ae.js";import"./BasicInput-13cf2877.js";import"./component2-08856ab6.js";import"./component-cdbc2d35.js";import"./IconClose-a1e58263.js";import"./multiselect-198a8c51.js";const Be={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},name:{type:String,default:""},type:{type:String,default:"radio"},checked:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(d,{emit:c}){const a=f(null),u=f(!1);function b(){c("update:modelValue",d.data)}function S(){u.value=!0}return de(()=>{a.value=d.modelValue}),{inputValue:a,isIconPressed:u,onMouseEvent:S,updateValue:b}}},Ce={class:"form-input_border"},xe={class:"form-input_border-label"},we=["name","checked"],Oe={class:"form-field__data"},$e={class:"form-field__img"},Ee=["src"],Ge={class:"form-field__name"},Me={class:"form-field__desc"},Ue={class:"form-field__select"};function Fe(d,c,a,u,b,S){return l(),r("div",Ce,[t("label",xe,[t("input",{name:a.name,type:"radio",checked:a.checked,onInput:c[0]||(c[0]=(...k)=>u.updateValue&&u.updateValue(...k))},null,40,we),t("div",Oe,[a.data.img?ce(d.$slots,"default",{key:0},()=>[t("div",$e,[t("img",{src:a.data.img,alt:""},null,8,Ee)])],!0):Y("",!0),t("div",Ge,_(a.data.name),1),t("div",Me,[be(_(a.data.desc)+" ",1),a.data.select?ce(d.$slots,"default",{key:0},()=>[t("div",Ue,[(l(!0),r(C,null,w(a.data.select,(k,n)=>(l(),r("div",{key:n,class:"form-field__select-item"},_(k.text),1))),128))])],!0):Y("",!0)])])])])}const Le=Q(Be,[["render",Fe],["__scopeId","data-v-d43d44d3"]]);const Ne={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},headers:{type:Array,default:()=>[]},name:{type:String,default:""},checkbox:{type:Boolean,default:!1},checked:{type:Boolean,default:!1}},emits:["update:modelValue","input"],setup(d,{emit:c}){const a=f(null),u=f(!1);function b(){c("update:modelValue",d.data),c("input",d.data)}function S(){u.value=!0}return de(()=>{a.value=d.modelValue}),{inputValue:a,isIconPressed:u,onMouseEvent:S,updateValue:b}}},je={class:"form-input_border"},Ae={class:"form-input_border-label"},Te=["name","type","checked"],Re={class:"form-field__data"},He={class:"form-field_header"};function Ke(d,c,a,u,b,S){return l(),r("div",je,[t("label",Ae,[t("input",{name:a.name,type:a.checkbox?"checkbox":"radio",checked:a.checked,onInput:c[0]||(c[0]=(...k)=>u.updateValue&&u.updateValue(...k))},null,40,Te),t("div",Re,[(l(!0),r(C,null,w(a.headers,(k,n)=>(l(),r("div",{key:n,class:"form-field__col"},[t("span",He,_(k),1),t("span",null,_(a.data[n]),1)]))),128))])])])}const Ye=Q(Ne,[["render",Ke],["__scopeId","data-v-a13950e6"]]),qe="/v2/assets/oc-2-8f4c288c.jpg";const E=d=>(ke("data-v-d76ccb60"),d=d(),ge(),d),ze={class:"vps-scheme-page"},Je={class:"section"},Qe={class:"container"},We=E(()=>t("div",{class:"section-header"},[t("h1",{class:"section-title"},"Заказать VPS/VDS сервер")],-1)),Xe={class:"section"},Ze={class:"container"},et=E(()=>t("h2",{class:"section-block_title"},"Конфигурация",-1)),tt={class:"form-column"},st={class:"form-header"},ot={class:"form-header_col"},at={key:0,class:"section"},lt={class:"container"},nt=E(()=>t("h2",{class:"section-block_title"},"Операционная система",-1)),ct={class:"form grid-gorm"},ut={class:"section"},rt={class:"container"},dt=E(()=>t("h2",{class:"section-block_title"},"Регион",-1)),_t={class:"form"},it={class:"section"},vt={class:"container"},pt={class:"total-block"},ht={class:"total-block__row divider-bottom"},mt=E(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),ft={class:"total-block__col"},bt={class:"total-block__row no-divider"},St={class:"total-block__col"},kt={class:"total-block__col"},gt={class:"total-block__row total-block__row--big economy-line"},Vt=E(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),yt={class:"total-block__col flex-col"},It={class:"red"},Dt={class:"total-block__row total-block__row--big"},Pt={class:"total-block__col"},Bt={class:"total-block__col"},J="Moscow",Ct={__name:"VPSSchemes",async setup(d){let c,a;const u=ye(),b=De(),S=Ie(),k=Se(),n=f(null),O=f(null),G=f(null),A=f(!1),v=f(null),_e=f([{img:qe,value:"Moscow",name:"Россия",desc:"Москва"}]),W=f({PackageID:"Тариф",cpu_number:"CPU",ram_mib:"RAM",hdd_mib:"Память",net_in_mbitps:"Канал",CostMonth:"Стоимость"}),T=j(()=>Object.keys(u.vpsSchemes).map(e=>u.vpsSchemes[e])),ie=j(()=>b==null?void 0:b.contractsList),X=j(()=>T.value.find(e=>{var s;return(e==null?void 0:e.ID)===((s=v.value)==null?void 0:s.ID)})),M=j(()=>{var e;return(e=S==null?void 0:S.serverGroupsList)==null?void 0:e.ServersGroups}),$=j(()=>{var e;return(e=X.value)==null?void 0:e.OS.map(s=>({name:s,value:s}))});function R(e){return Number(e).toFixed(2)||0}function Z(){var s,p;let e=0;return(p=(s=n.value)==null?void 0:s.discounts)==null||p.Bonuses.map(i=>{e+=+i.Economy}),e}function ee(e){var s,p,i,V,g,y,h,m;return{ID:e==null?void 0:e.ID,PackageID:e==null?void 0:e.PackageID,ServersGroupID:e==null?void 0:e.ServersGroupID,cpu_number:(p=(s=e==null?void 0:e.SchemeParams)==null?void 0:s.cpu_number)==null?void 0:p.Value,ram_mib:(V=(i=e==null?void 0:e.SchemeParams)==null?void 0:i.ram_mib)==null?void 0:V.Value,hdd_mib:(y=(g=e==null?void 0:e.SchemeParams)==null?void 0:g.hdd_mib)==null?void 0:y.Value,net_in_mbitps:(m=(h=e==null?void 0:e.SchemeParams)==null?void 0:h.net_in_mbitps)==null?void 0:m.Value,CostMonth:e==null?void 0:e.CostMonth}}function ve(){var p,i,V,g,y,h;console.log(v.value);let e=(V=Object.keys((i=M.value)==null?void 0:i[(p=v.value)==null?void 0:p.ServersGroupID]))==null?void 0:V.find(m=>{var I,D,P,B,U,F,L,N;return((B=(P=(D=M.value)==null?void 0:D[(I=v.value)==null?void 0:I.ServersGroupID])==null?void 0:P[m])==null?void 0:B.IsActive)&&((N=(L=(F=M.value)==null?void 0:F[(U=v.value)==null?void 0:U.ServersGroupID])==null?void 0:L[m])==null?void 0:N.IsDefault)}),s=(h=Object.keys((y=M.value)==null?void 0:y[(g=v.value)==null?void 0:g.ServersGroupID]))==null?void 0:h.find(m=>{var I,D,P,B;return(B=(P=(D=M.value)==null?void 0:D[(I=v.value)==null?void 0:I.ServersGroupID])==null?void 0:P[m])==null?void 0:B.IsActive});return e||s}function pe(e){n.value=e}function he(){var e,s;A.value=!0,u.VPSOrder({ContractID:O.value,VPSSchemeID:(e=v.value)==null?void 0:e.ID,ServerID:ve(),DiskTemplate:(s=G.value)==null?void 0:s.value}).then(({result:p,info:i,error:V})=>{var g;p==="SUCCESS"?u.VPSOrderPay({VPSOrderID:i==null?void 0:i.VPSOrderID,DaysPay:(g=n.value)==null?void 0:g.actualDays,IsChange:!0}).then(y=>{let{result:h,error:m}=y;h==="SUCCESS"?k.push("/VPSOrders"):h==="BASKET"&&k.push("/Basket"),A.value=!0}):A.value=!1})}function te(){var e,s;((e=$==null?void 0:$.value)==null?void 0:e.length)>0&&(G.value=(s=$.value)==null?void 0:s[0])}return[c,a]=q(()=>u.fetchVPSSchemes().then(()=>{var e,s;((e=T.value)==null?void 0:e.length)>0&&(v.value=ee((s=T.value)==null?void 0:s[0])),te()})),await c,a(),[c,a]=q(()=>b.fetchContracts()),await c,a(),[c,a]=q(()=>S.fetchServerGroups()),await c,a(),(e,s)=>{var h,m,I,D,P,B,U,F,L,N,se,oe,ae,le,ne;const p=Ve,i=Ye,V=Le,g=fe,y=me;return l(),r("div",ze,[t("div",Je,[t("div",Qe,[We,K(p,{partition:"Header:/VPSSchemes"})])]),t("div",Xe,[t("div",Ze,[et,t("div",tt,[t("div",st,[(l(!0),r(C,null,w(W.value,o=>(l(),r("div",ot,_(o),1))),256))]),(l(!0),r(C,null,w(T.value,o=>{var x;return l(),z(i,{data:ee(o),type:"",modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=H=>v.value=H),name:"config",checked:((x=v.value)==null?void 0:x.ID)===(o==null?void 0:o.ID),headers:W.value,onInput:s[1]||(s[1]=H=>te())},null,8,["data","modelValue","checked","headers"])}),256))])])]),$.value?(l(),r("div",at,[t("div",lt,[nt,t("div",ct,[(l(!0),r(C,null,w($.value,o=>{var x;return l(),z(V,{data:o,modelValue:G.value,"onUpdate:modelValue":s[2]||(s[2]=H=>G.value=H),checked:(o==null?void 0:o.value)===((x=G.value)==null?void 0:x.value),type:"",name:"operating_system"},null,8,["data","modelValue","checked"])}),256))])])])):Y("",!0),t("div",ut,[t("div",rt,[dt,t("div",_t,[(l(!0),r(C,null,w(_e.value,o=>(l(),z(V,{data:o,checked:(o==null?void 0:o.value)===J,modelValue:J,"onUpdate:modelValue":s[3]||(s[3]=x=>J=x),type:"",name:"region"},null,8,["data","checked"]))),256))])])]),K(Pe,{title:"Информация о сервере",modelValue:O.value,"onUpdate:modelValue":s[4]||(s[4]=o=>O.value=o)},null,8,["modelValue"]),K(g,{contractID:O.value,scheme:X.value,serviceID:"30000",isOrderID:!1,onSelect:pe},null,8,["contractID","scheme"]),t("div",it,[t("div",vt,[t("div",pt,[((I=(m=(h=n.value)==null?void 0:h.discounts)==null?void 0:m.Bonuses)==null?void 0:I.length)>0?(l(),r(C,{key:0},[t("div",ht,[mt,t("div",ft,_(R((D=n.value)==null?void 0:D.price))+" ₽",1)]),(l(!0),r(C,null,w((B=(P=n.value)==null?void 0:P.discounts)==null?void 0:B.Bonuses,o=>(l(),r("div",bt,[t("div",St,"Скидка "+_(o==null?void 0:o.Discount)+"% на "+_(o==null?void 0:o.Days)+" дней",1),t("div",kt,"-"+_(R(o==null?void 0:o.Economy))+" ₽",1)]))),256))],64)):Y("",!0),ue(t("div",gt,[Vt,t("div",yt,[t("span",null,[t("s",null,_(R((U=n.value)==null?void 0:U.price))+" ₽",1)]),t("span",It,"-"+_(Z())+" ₽",1)])],512),[[re,((N=(L=(F=n.value)==null?void 0:F.discounts)==null?void 0:L.Bonuses)==null?void 0:N.length)>0]]),ue(t("div",Dt,[t("div",Pt,"Итого за "+_((se=n.value)==null?void 0:se.label),1),t("div",Bt,_(R(((oe=n.value)==null?void 0:oe.price)-Z()))+" ₽",1)],512),[[re,(ae=n.value)==null?void 0:ae.price]])]),K(y,{class:"btn--wide",label:((le=ie.value[O.value])==null?void 0:le.Balance)>((ne=n.value)==null?void 0:ne.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:n.value===null||O.value===null,"is-loading":A.value,onClick:s[5]||(s[5]=o=>he())},null,8,["label","disabled","is-loading"])])])])}}},Kt=Q(Ct,[["__scopeId","data-v-d76ccb60"]]);export{Kt as default};
