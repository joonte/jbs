import{j as M,o as f,c as C,a as s,b as d,w as D,d as B,t as b,F as A,x as J,n as at,k as nt,_ as Q,S as W,r as U,y as N,p as ot,l as st,e as rt,g as L,h as it}from"./index-642cdac5.js";import{I as lt}from"./IconSearch-f354c728.js";import{u as X}from"./vps-a0484b23.js";import{_ as ct}from"./HelperComponent-73967625.js";import{S as Y}from"./StatusBadge-52b4bbab.js";import{I as Z}from"./IconRotate-4f01c174.js";import{f as G}from"./useTimeFunction-8602dd60.js";import{v as dt}from"./vpsStatuses-32ffaaf5.js";import{z as mt,d as _t}from"./bootstrap-vue-next.es-9ff54498.js";import{_ as ut}from"./IconDots-24f2aa45.js";import{_ as ft}from"./IconCard-b302365f.js";import{_ as Dt}from"./OrderIDBadge-d3607d65.js";import{S as gt}from"./Select2-28406c99.js";import{s as vt}from"./multiselect-bb2ec7ab.js";import{_ as $}from"./ClausesKeeper-12bc5d50.js";import{u as pt}from"./contracts-16ef7000.js";import{B as tt}from"./BlockBalanceAgreement-ccba2ab2.js";import{u as ht}from"./globalActions-c9fc22a3.js";import{E as bt}from"./EmptyStateBlock-1861cff5.js";import{_ as It}from"./FormInputSearch-7a23b402.js";import"./ButtonDefault-eb076df2.js";import"./IconArrow-c0196cbe.js";import"./IconClose-f1b85910.js";import"./IconPlus-08c75518.js";const St={class:"hosting-item"},Vt={class:"hosting-item__row"},Pt={class:"hosting-item__date"},yt={class:"hosting-item__row"},Ct={class:"hosting-item__person"},Ot={class:"hosting-item__row"},kt={class:"hosting-item__list"},wt=["innerHTML"],xt={class:"hosting-item__controls"},Bt={class:"ico"},Rt={class:"btn btn--dots"};function Lt(a,r,n,e,I,S){var P,i,o,t,g,v,p,y,h;const O=Dt,m=M("router-link"),l=Y,c=M("Helper"),u=Z,k=ft,w=ut,V=mt,x=_t;return f(),C("div",St,[s("div",Vt,[d(O,{orderID:(P=n.itemData)==null?void 0:P.OrderID},null,8,["orderID"]),d(m,{class:"hosting-item__name",to:`/VPSOrders/${n.itemData.OrderID}`},{default:D(()=>[B(b(n.itemData.IP||n.itemData.Domain),1)]),_:1},8,["to"]),d(l,{status:(i=n.itemData)==null?void 0:i.StatusID,DaysRemainded:(o=n.itemData)==null?void 0:o.DaysRemainded,"status-table":"VPSOrders"},null,8,["status","DaysRemainded"]),s("div",Pt,"Дата окончания "+b(e.calculateExpirationDate((t=n.itemData)==null?void 0:t.DaysRemainded))+" | "+b(((g=n.itemData)==null?void 0:g.DaysRemainded)||0)+" дн.",1)]),s("div",yt,[s("div",Ct,b(n.userName),1),d(c,{"user-notice":(v=n.itemData)==null?void 0:v.UserNotice,id:(p=n.itemData)==null?void 0:p.OrderID,position:n.isLast?"bottom":"top",emit:"updateVPSList"},null,8,["user-notice","id","position"])]),s("div",Ot,[s("ul",kt,[(f(!0),C(A,null,J(n.params,_=>(f(),C("li",{innerHTML:_==null?void 0:_.text},null,8,wt))),256))])]),s("div",xt,[((y=n.itemData)==null?void 0:y.StatusID)==="Active"?(f(),C("div",{key:0,class:at(["btn btn--md btn--border btn--rotate btn--rotate_green button-large",{"btn--rotate_gray":((h=n.itemData)==null?void 0:h.StatusID)!=="Active"||e.isReloading,"btn--rotate_loading":e.isReloading}]),title:"Перезагрузить выделенный сервер",onClick:r[0]||(r[0]=(..._)=>e.reloadItem&&e.reloadItem(..._))},[B("Включен"),s("button",null,[s("div",Bt,[d(u)])])],2)):nt("",!0),s("div",{class:"btn btn--md btn--bold",onClick:r[1]||(r[1]=_=>e.orderManage())},"Управлять заказом"),s("div",{class:"btn btn--md btn--bold",onClick:r[2]||(r[2]=_=>{var R;return a.$router.push(`/VPSOrderPay/${(R=n.itemData)==null?void 0:R.OrderID}`)})},[d(k),B("Оплатить")]),d(x,{class:"dropdown-dots",right:""},{"button-content":D(()=>[s("div",Rt,[d(w)])]),default:D(()=>[d(V,{onClick:r[3]||(r[3]=_=>e.transferAccount())},{default:D(()=>[B("Передать на другой аккаунт")]),_:1}),d(V,null,{default:D(()=>{var _;return[d(m,{to:`/VPSOrders/${(_=n.itemData)==null?void 0:_.OrderID}/SchemeChange`},{default:D(()=>[B("Изменить тариф")]),_:1},8,["to"])]}),_:1})]),_:1})])])}const Mt={components:{StatusBadge:Y,IconRotate:Z,Helper:ct},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1},userName:{type:String,default:""}},emits:["manage","transfer"],setup(a,{emit:r}){X();const n=W("emitter"),e=U(!1);function I(l){if(!l)return G(new Date);const c=new Date,u=new Date(c.getTime()+l*24*60*60*1e3);return G(u)}function S(){var l,c;n.emit("open-modal",{component:"OrdersTransfer",data:{ServiceOrderID:(l=a.itemData)==null?void 0:l.ID,ServiceID:(c=a.itemData)==null?void 0:c.ServiceID}})}function O(){var c;function l(u){e.value=u}n.emit("open-modal",{component:"ReloadVPS",data:{VPSOrderID:(c=a.itemData)==null?void 0:c.ID,isReloading:e.value,onReloadStatusChange:l}})}function m(){var l,c,u;r("manage",{ServiceOrderID:(l=a.itemData)==null?void 0:l.ID,ServiceID:(c=a.itemData)==null?void 0:c.ServiceID,OrderID:(u=a.itemData)==null?void 0:u.OrderID})}return{vpsStatuses:dt,reloadItem:O,isReloading:e,orderManage:m,calculateExpirationDate:I,isReloading:e,transferAccount:S}}},et=Q(Mt,[["render",Lt],["__scopeId","data-v-87cdca58"]]),Nt=a=>(ot("data-v-2ebf1902"),a=a(),st(),a),At={class:"section"},Ut={class:"container"},Et={class:"section-header"},Tt=Nt(()=>s("h1",{class:"section-title"},"VPS/VDS серверы",-1)),jt={class:"list-form"},Ht={class:"list-form_col list-form_col--sm"},zt={class:"list-form_select"},Ft={class:"multiselect-option"},Kt={key:0};function qt(a,r,n,e,I,S){var V,x,P;const O=tt,m=M("router-link"),l=$,c=M("Multiselect"),u=It,k=et,w=bt;return f(),C(A,null,[d(O),s("div",At,[s("div",Ut,[s("div",Et,[Tt,d(m,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:D(()=>[B("Заказать")]),_:1})]),d(l),s("div",jt,[s("div",Ht,[s("div",zt,[d(c,{modelValue:e.select,"onUpdate:modelValue":r[0]||(r[0]=i=>e.select=i),options:e.getUsers,disabled:((V=e.getUsers)==null?void 0:V.length)<=1,label:"name"},{singlelabel:D(({value:i})=>[s("span",null,"# "+b(i.value.padStart(5,"0"))+" / "+b(i.name),1)]),option:D(({option:i})=>[s("div",Ft,"# "+b(i.value.padStart(5,"0"))+" / "+b(i.name),1)]),_:1},8,["modelValue","options","disabled"])])]),d(u,{modelValue:e.search,"onUpdate:modelValue":r[1]||(r[1]=i=>e.search=i)},null,8,["modelValue"])]),e.getVpsOrders&&((x=e.getVpsOrders)==null?void 0:x.length)>0?(f(),C("div",Kt,[e.filterProducts&&((P=e.filterProducts)==null?void 0:P.length)>0?(f(!0),C(A,{key:0},J(e.filterProducts,(i,o)=>{var t;return f(),N(k,{"item-data":i,"is-last":o===e.filterProducts.length-1,"user-name":(t=e.getContracts[i==null?void 0:i.ContractID])==null?void 0:t.Customer,params:e.formItemParamList(i),onManage:e.orderManage},null,8,["item-data","is-last","user-name","params","onManage"])}),256)):(f(),N(w,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(f(),N(w,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])],64)}const Gt={components:{IconSearch:lt,Select2:gt,ClausesKeeper:$,Multiselect:vt,VpsItem:et,BlockBalanceAgreement:tt},async setup(){const a=X(),r=pt(),n=ht(),e=rt(),I=U(null),S=U("*");W("emitter").on("updateVPSList",()=>{a.fetchVPS()});const m=L(()=>{var o;return(o=Object.keys(a==null?void 0:a.vpsList).map(t=>a==null?void 0:a.vpsList[t]))==null?void 0:o.reverse()}),l=L(()=>a.vpsSchemes),c=L(()=>x(w(m.value))),u=L(()=>r==null?void 0:r.contractsList);it(()=>{m.value.length<1&&k()});function k(){e.push({path:"/VPSSchemes"})}function w(o){return S.value!=="*"?o.filter(t=>(t==null?void 0:t.ContractID)===S.value):o}function V(o){n.OrderManage(o)}function x(o){return I.value!==null?o.filter(t=>t==null?void 0:t.IP.toLowerCase().includes(I.value.toLowerCase())):o}const P=L(()=>{let o=[{value:"*",name:"Все договора"}];return m.value!==null?(Object.keys(m.value).forEach(t=>{var g,v,p;o.find(y=>{var h;return y.value===((h=m.value[t])==null?void 0:h.ContractID)})||o.push({value:(g=m.value[t])==null?void 0:g.ContractID,name:(p=u.value[(v=m.value[t])==null?void 0:v.ContractID])==null?void 0:p.Customer})}),o):{value:"*",name:"Все договора"}});function i(o){var g,v,p,y,h,_,R,E,T,j,H,z,F,K,q;const t=(g=l.value)==null?void 0:g[o.SchemeID];return[{text:`${t==null?void 0:t.Name}`},{text:`${(p=(v=t==null?void 0:t.SchemeParams)==null?void 0:v.hdd_mib)==null?void 0:p.InternalName} ${(h=(y=t==null?void 0:t.SchemeParams)==null?void 0:y.hdd_mib)==null?void 0:h.Value} ${(R=(_=t==null?void 0:t.SchemeParams)==null?void 0:_.hdd_mib)==null?void 0:R.Unit}`},{text:`RAM ${(T=(E=t==null?void 0:t.SchemeParams)==null?void 0:E.ram_mib)==null?void 0:T.Value} ${(H=(j=t==null?void 0:t.SchemeParams)==null?void 0:j.ram_mib)==null?void 0:H.Unit}`},{text:`Канал ${(F=(z=t==null?void 0:t.SchemeParams)==null?void 0:z.net_bandwidth_mbitps)==null?void 0:F.Value} ${(q=(K=t==null?void 0:t.SchemeParams)==null?void 0:K.net_bandwidth_mbitps)==null?void 0:q.Unit}`}]}return await a.fetchVPS(),await a.fetchVPSSchemes(),await r.fetchContracts(),{getVpsOrders:m,search:I,getContracts:u,select:S,orderManage:V,formItemParamList:i,getUsers:P,filterProducts:c,navigateToVPSSchemes:k}}},ve=Q(Gt,[["render",qt],["__scopeId","data-v-2ebf1902"]]);export{ve as default};
