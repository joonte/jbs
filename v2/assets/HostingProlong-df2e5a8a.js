import{E as re}from"./EmptyStateBlock-68a1c33e.js";import{_ as _e}from"./BlockOrderPayBalance-6a44874e.js";import{_ as de}from"./ClausesKeeper-55c14b7f.js";import{_ as ue}from"./ButtonDefault-dc248ec6.js";import{_ as me,a7 as ve,e as pe,S as he,r as b,g as B,ag as w,o as r,c as _,b as d,a as e,t as c,F as D,x as be,k as ge,Z as ae,ae as le,p as ye,l as ke}from"./index-83b4b7ba.js";import{u as fe}from"./hosting-b7d822b2.js";import{u as De}from"./contracts-623ec7a8.js";import{_ as Ie}from"./paramsAccordionBlock-50cb3955.js";import{B as Be}from"./BlockBalanceAgreement-c5fad736.js";import"./bootstrap-vue-next.es-8f3ae81a.js";import"./IconHelp-c62d5911.js";import"./globalActions-633eb799.js";import"./BasicInput-3f1e9fd6.js";import"./component-abb1f5a9.js";import"./IconClose-86aafc4e.js";import"./IconArrow-80c72216.js";/* empty css                                                                             */const ne=g=>(ye("data-v-3462b770"),g=g(),ke(),g),we={key:0,class:"hosting-sheme"},Se={class:"section"},Ce={class:"container"},He={class:"section-header"},Pe={class:"section-header__wrapper"},Oe={class:"section-title"},xe={class:"section-label"},Ee={class:"section"},Fe={class:"container"},Ne={class:"total-block"},Le={class:"total-block__row divider-bottom"},Re=ne(()=>e("div",{class:"total-block__col"},"Цена тарифа",-1)),$e={class:"total-block__col"},Ae={class:"total-block__row no-divider"},Te={class:"total-block__col"},Ve={class:"total-block__col"},je={class:"total-block__row total-block__row--big economy-line"},Ke=ne(()=>e("div",{class:"total-block__col red"},"Выгода",-1)),Ue={class:"total-block__col flex-col"},Ze={class:"red"},qe={class:"total-block__row total-block__row--big"},ze={class:"total-block__col"},Ge={class:"total-block__col"},Je={key:1,class:"section"},Me={class:"container"},Qe={key:1,class:"section"},We={class:"container"},Xe={__name:"HostingProlong",async setup(g){let m,v;const a=fe(),S=De(),ce=ve(),C=pe();he("emitter"),b(null),b(null),b("");const s=b(null),y=b(!1),l=B(()=>Object.keys(a==null?void 0:a.hostingList).map(t=>a==null?void 0:a.hostingList[t]).find(t=>t.OrderID===ce.params.id));console.log("getHostingOrderData",l);const u=B(()=>{var t,o;return(o=a==null?void 0:a.hostingSchemes)==null?void 0:o[(t=l.value)==null?void 0:t.SchemeID]});console.log("getHostingScheme",u);const H=B(()=>S.contractsList);function k(t){return Number(t).toFixed(2)||0}function P(){var o,i;let t=0;return(i=(o=s.value)==null?void 0:o.discounts)==null||i.Bonuses.map(p=>{t+=+p.Economy}),t}function O(){var t,o,i;y.value=!0,a.HostingOrderPay({HostingOrderID:(t=l.value)==null?void 0:t.ID,DaysPayFromBallance:((o=s.value)==null?void 0:o.daysFromBalance)||0,DaysPay:(i=s.value)==null?void 0:i.actualDays,IsChange:!0}).then(p=>{var h;let{result:f,error:I}=p;f==="SUCCESS"?C.push(`/HostingOrders/${(h=l.value)==null?void 0:h.ID}`):f==="BASKET"&&C.push("/Basket"),y.value=!1})}function ie(t){s.value=t}return[m,v]=w(()=>a.fetchHostingOrders()),await m,v(),[m,v]=w(()=>a.fetchHostingSchemes()),await m,v(),[m,v]=w(()=>S.fetchContracts()),await m,v(),(t,o)=>{var h,x,E,F,N,L,R,$,A,T,V,j,K,U,Z,q,z,G,J,M,Q,W,X,Y,ee,se,te,oe;const i=ue,p=de,f=_e,I=re;return r(),_(D,null,[d(Be),l.value?(r(),_("div",we,[e("div",Se,[e("div",Ce,[e("div",He,[e("div",Pe,[e("h1",Oe,c((h=l.value)==null?void 0:h.Domain),1),d(i,{class:"btn--wide",label:((x=H.value[l.value.ContractID])==null?void 0:x.Balance)>((E=s.value)==null?void 0:E.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:s.value===null||((F=s.value)==null?void 0:F.price)===null,"is-loading":y.value,onClick:o[0]||(o[0]=n=>O())},null,8,["label","disabled","is-loading"])]),e("div",xe,c((N=u.value)==null?void 0:N.Name),1)]),d(p)])]),d(Ie,{"params-list":(L=u.value)==null?void 0:L.SchemeParams,label:"Общая информация","main-param":"InternalName"},null,8,["params-list"]),(R=u.value)!=null&&R.IsPayed&&(($=u.value)!=null&&$.IsProlong)||!((A=u.value)!=null&&A.IsPayed)?(r(),_(D,{key:0},[d(f,{contractID:(T=l.value)==null?void 0:T.ContractID,daysRemainded:(V=l.value)==null?void 0:V.DaysRemainded,scheme:u.value,orderID:(j=l.value)==null?void 0:j.OrderID,isOrderID:!0,onSelect:ie},null,8,["contractID","daysRemainded","scheme","orderID"]),e("div",Ee,[e("div",Fe,[e("div",Ne,[((Z=(U=(K=s.value)==null?void 0:K.discounts)==null?void 0:U.Bonuses)==null?void 0:Z.length)>0?(r(),_(D,{key:0},[e("div",Le,[Re,e("div",$e,c(k((q=s.value)==null?void 0:q.price))+" ₽",1)]),(r(!0),_(D,null,be((G=(z=s.value)==null?void 0:z.discounts)==null?void 0:G.Bonuses,n=>(r(),_("div",Ae,[e("div",Te,"Скидка "+c(n==null?void 0:n.Discount)+"% на "+c(n==null?void 0:n.Days)+" дней",1),e("div",Ve,"-"+c(k(n==null?void 0:n.Economy))+" ₽",1)]))),256))],64)):ge("",!0),ae(e("div",je,[Ke,e("div",Ue,[e("span",null,[e("s",null,c(k((J=s.value)==null?void 0:J.price))+" ₽",1)]),e("span",Ze,"-"+c(P())+" ₽",1)])],512),[[le,((W=(Q=(M=s.value)==null?void 0:M.discounts)==null?void 0:Q.Bonuses)==null?void 0:W.length)>0]]),ae(e("div",qe,[e("div",ze,"Итого за "+c((X=s.value)==null?void 0:X.label),1),e("div",Ge,c(k(((Y=s.value)==null?void 0:Y.price)-P()))+" ₽",1)],512),[[le,(ee=s.value)==null?void 0:ee.price]])]),d(i,{class:"btn--wide",label:((se=H.value[l.value.ContractID])==null?void 0:se.Balance)>((te=s.value)==null?void 0:te.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:s.value===null||((oe=s.value)==null?void 0:oe.price)===null,"is-loading":y.value,onClick:o[1]||(o[1]=n=>O())},null,8,["label","disabled","is-loading"])])])],64)):(r(),_("div",Je,[e("div",Me,[d(I,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(r(),_("div",Qe,[e("div",We,[d(I,{label:"не удалось найти заказ хостинга"})])]))],64)}}},hs=me(Xe,[["__scopeId","data-v-3462b770"]]);export{hs as default};
