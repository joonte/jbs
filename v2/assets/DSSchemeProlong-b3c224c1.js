import{E as rt}from"./EmptyStateBlock-b9aefc49.js";import{_ as dt}from"./ButtonDefault-626291b9.js";import{_ as ut}from"./BlockOrderPayBalance-22bf5d16.js";import{_ as vt}from"./ClausesKeeper-e7acf2fb.js";import{_ as bt,r as tt,a7 as pt,e as ht,R as mt,g as I,ag as g,o as a,c as n,b as p,a as s,t as i,F as k,v as st,k as kt,Y as ot,ae as et,x as lt,p as ft,l as yt}from"./index-c7c24b76.js";import{u as Dt}from"./dedicatedServer-edad8775.js";import{u as It}from"./contracts-397b53fe.js";import{B as gt}from"./BlockBalanceAgreement-f11c65ba.js";import"./bootstrap-vue-next.es-3f66213d.js";import"./IconHelp-ade5ebb4.js";import"./globalActions-306d29c7.js";import"./BasicInput-0178c2f2.js";import"./component2-1c15eb55.js";import"./component-d5bd2a45.js";import"./IconClose-447d7f82.js";import"./IconArrow-dfacb3d4.js";const f=h=>(ft("data-v-2342688e"),h=h(),yt(),h),xt={key:0,class:"domain-scheme"},wt={class:"section"},Bt={class:"container"},Ct={class:"section-header"},Pt=f(()=>s("h1",{class:"section-title"},"Оплата заказа выделенного сервера",-1)),Et={class:"section-label"},Ot={class:"section"},St={class:"container"},$t={class:"list"},Ft={class:"list-col list-col--xl"},Lt={class:"list-item"},At=f(()=>s("div",{class:"list-item__row"},[s("div",{class:"list-item__title"},"Конфигурация")],-1)),Nt={class:"list-item__row list-item__table"},Rt={class:"list-item__table-col"},Tt={class:"list-item__label"},Vt={class:"list-item__text"},jt={key:0,class:"section"},Ut={class:"container"},Kt={class:"total-block"},Yt={class:"total-block__row divider-bottom"},qt=f(()=>s("div",{class:"total-block__col"},"Цена тарифа",-1)),zt={class:"total-block__col"},Gt={class:"total-block__row no-divider"},Ht={class:"total-block__col"},Jt={class:"total-block__col"},Mt={class:"total-block__row total-block__row--big economy-line"},Qt=f(()=>s("div",{class:"total-block__col red"},"Выгода",-1)),Wt={class:"total-block__col flex-col"},Xt={class:"red"},Zt={class:"total-block__row total-block__row--big"},ts={class:"total-block__col"},ss={class:"total-block__col"},os={key:1,class:"section"},es={class:"container"},ls={key:1,class:"section"},as={class:"container"},cs={__name:"DSSchemeProlong",async setup(h){let d,u;const o=tt(null),l=Dt(),x=It(),at=pt(),w=ht();mt("emitter");const y=tt(!1),_=I(()=>Object.keys(l==null?void 0:l.DSList).map(t=>l==null?void 0:l.DSList[t]).find(t=>t.OrderID===at.params.id)),r=I(()=>{var t,c;return(c=l==null?void 0:l.DSSchemes)==null?void 0:c[(t=_.value)==null?void 0:t.SchemeID]}),ct=I(()=>x.contractsList);function B(){var c,v;let t=0;return(v=(c=o.value)==null?void 0:c.discounts)==null||v.Bonuses.map(b=>{t+=+b.Economy}),t}function m(t){return Number(t).toFixed(2)||0}function it(){const t=r==null?void 0:r.value;return[{label:"Процессор",text:(t==null?void 0:t.CPU)||"-"},{label:"Объём оперативной памяти",text:(t==null?void 0:t.ram)||"-"},{label:"Характеристики жёстких дисков",text:(t==null?void 0:t.disks)||"-"},{label:"Предустановленная ОС",text:(t==null?void 0:t.OS)||"-"},{label:"RAID",text:(t==null?void 0:t.raid)||"-"},{label:"Месячный трафик",text:t!=null&&t.trafflimit?`${t==null?void 0:t.trafflimit} ГБ`:"-"},{label:"Скорость канала",text:t!=null&&t.chrate?`${t==null?void 0:t.chrate} Мбит/с`:"-"}]}function nt(){var t,c;y.value=!0,l.DSOrderPay({DSOrderID:(t=_.value)==null?void 0:t.ID,DaysPay:(c=o.value)==null?void 0:c.actualDays,IsChange:!0}).then(v=>{let{result:b,error:C}=v;b==="SUCCESS"?w.push("/DSOrders"):b==="BASKET"&&w.push("/Basket"),y.value=!1})}function _t(t){o.value=t}return[d,u]=g(()=>l.fetchDSOrders()),await d,u(),[d,u]=g(()=>l.fetchDSSchemes()),await d,u(),[d,u]=g(()=>x.fetchContracts()),await d,u(),(t,c)=>{var P,E,O,S,$,F,L,A,N,R,T,V,j,U,K,Y,q,z,G,H,J,M,Q,W,X,Z;const v=vt,b=ut,C=dt,D=rt;return a(),n(k,null,[p(gt),(P=_.value)!=null&&P.ID&&((E=r.value)!=null&&E.ID)?(a(),n("div",xt,[s("div",wt,[s("div",Bt,[s("div",Ct,[Pt,s("div",Et,i((O=_.value)!=null&&O.IP?`#${(S=_.value)==null?void 0:S.IP}`:""),1)]),p(v)])]),s("div",Ot,[s("div",St,[s("div",$t,[s("div",Ft,[s("div",Lt,[At,s("div",Nt,[(a(!0),n(k,null,st(it(),e=>(a(),n("div",Rt,[s("div",Tt,i(e.label),1),s("div",Vt,i(e.text),1)]))),256))])])])])])]),p(b,{contractID:($=_.value)==null?void 0:$.ContractID,scheme:r.value,serviceID:"40000",isOrderID:!1,onSelect:_t},null,8,["contractID","scheme"]),(F=r.value)!=null&&F.IsPayed&&((L=r.value)!=null&&L.IsProlong)||!((A=r.value)!=null&&A.IsPayed)?(a(),n("div",jt,[s("div",Ut,[s("div",Kt,[((T=(R=(N=o.value)==null?void 0:N.discounts)==null?void 0:R.Bonuses)==null?void 0:T.length)>0?(a(),n(k,{key:0},[s("div",Yt,[qt,s("div",zt,i(m((V=o.value)==null?void 0:V.price))+" ₽",1)]),(a(!0),n(k,null,st((U=(j=o.value)==null?void 0:j.discounts)==null?void 0:U.Bonuses,e=>(a(),n("div",Gt,[s("div",Ht,"Скидка "+i(e==null?void 0:e.Discount)+"% на "+i(e==null?void 0:e.Days)+" дней",1),s("div",Jt,"-"+i(m(e==null?void 0:e.Economy))+" ₽",1)]))),256))],64)):kt("",!0),ot(s("div",Mt,[Qt,s("div",Wt,[s("span",null,[s("s",null,i(m((K=o.value)==null?void 0:K.price))+" ₽",1)]),s("span",Xt,"-"+i(B())+" ₽",1)])],512),[[et,((z=(q=(Y=o.value)==null?void 0:Y.discounts)==null?void 0:q.Bonuses)==null?void 0:z.length)>0]]),ot(s("div",Zt,[s("div",ts,"Итого за "+i((G=o.value)==null?void 0:G.label),1),s("div",ss,i(m(((H=o.value)==null?void 0:H.price)-B()))+" ₽",1)],512),[[et,(J=o.value)==null?void 0:J.price]])]),p(C,{class:"btn--wide",label:((Q=ct.value[(M=_.value)==null?void 0:M.ContractID])==null?void 0:Q.Balance)>((W=o.value)==null?void 0:W.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:o.value===null||((X=o.value)==null?void 0:X.price)===null,"is-loading":y.value,onClick:c[0]||(c[0]=e=>nt())},null,8,["label","disabled","is-loading"])])])):(a(),n("div",os,[s("div",es,[p(D,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(a(),n("div",ls,[s("div",as,[(Z=_.value)!=null&&Z.ID?(a(),lt(D,{key:0,label:"Заказ не может быть продлен"})):(a(),lt(D,{key:1,label:"Заказ не найден"}))])]))],64)}}},gs=bt(cs,[["__scopeId","data-v-2342688e"]]);export{gs as default};
