import{j as M,o as f,c as k,a as r,b as d,w as D,d as R,t as h,F as A,x as J,n as at,k as nt,_ as Q,S as W,r as U,y as N,p as ot,l as st,e as rt,g as L,h as it}from"./index-83b4b7ba.js";import{I as lt}from"./IconSearch-30270af1.js";import{u as X}from"./vps-0d37158a.js";import{_ as ct}from"./HelperComponent-df0c894c.js";import{S as Y}from"./StatusBadge-0d170ac0.js";import{I as Z}from"./IconRotate-e7e6c8d6.js";import{f as G}from"./useTimeFunction-8602dd60.js";import{v as dt}from"./vpsStatuses-32ffaaf5.js";import{z as mt,d as _t}from"./bootstrap-vue-next.es-8f3ae81a.js";import{_ as ut}from"./IconDots-a66f045d.js";import{_ as ft}from"./IconCard-2cc17a6b.js";import{_ as Dt}from"./OrderIDBadge-d89298b0.js";import{S as gt}from"./Select2-963d28df.js";import{s as vt}from"./multiselect-f2568231.js";import{_ as $}from"./ClausesKeeper-55c14b7f.js";import{u as pt}from"./contracts-623ec7a8.js";import{B as tt}from"./BlockBalanceAgreement-c5fad736.js";import{u as It}from"./globalActions-633eb799.js";import{E as bt}from"./EmptyStateBlock-68a1c33e.js";import{_ as ht}from"./FormInputSearch-48364fb5.js";import"./ButtonDefault-dc248ec6.js";import"./IconArrow-80c72216.js";import"./IconClose-86aafc4e.js";import"./IconPlus-07b0a078.js";const St={class:"hosting-item"},Vt={class:"hosting-item__row"},Pt={class:"hosting-item__row"},yt={class:"hosting-item__person"},Ct={class:"hosting-item__date"},Ot={class:"hosting-item__row"},kt={class:"hosting-item__list"},wt=["innerHTML"],xt={class:"hosting-item__controls"},Bt={class:"ico"},Rt={class:"btn btn--dots"};function Lt(n,o,a,e,S,V){var C,i,s,t,g,v,p,O,I;const w=Dt,m=M("router-link"),P=Y,l=M("Helper"),c=Z,u=ft,x=ut,y=mt,B=_t;return f(),k("div",St,[r("div",Vt,[d(w,{orderID:(C=a.itemData)==null?void 0:C.OrderID},null,8,["orderID"]),d(m,{class:"hosting-item__name",to:`/VPSOrders/${a.itemData.OrderID}`},{default:D(()=>[R(h(a.itemData.IP||a.itemData.Domain),1)]),_:1},8,["to"]),d(P,{status:(i=a.itemData)==null?void 0:i.StatusID,DaysRemainded:(s=a.itemData)==null?void 0:s.DaysRemainded,"status-table":"VPSOrders",onClick:o[0]||(o[0]=_=>{var b;return e.openHistoryStatuses((b=a.itemData)==null?void 0:b.ID)})},null,8,["status","DaysRemainded"])]),r("div",Pt,[r("div",yt,h(a.userName),1),r("div",Ct,"Дата окончания "+h(e.calculateExpirationDate((t=a.itemData)==null?void 0:t.DaysRemainded))+" | "+h(((g=a.itemData)==null?void 0:g.DaysRemainded)||0)+" дн.",1),d(l,{"user-notice":(v=a.itemData)==null?void 0:v.UserNotice,id:(p=a.itemData)==null?void 0:p.OrderID,position:a.isLast?"bottom":"top",emit:"updateVPSList"},null,8,["user-notice","id","position"])]),r("div",Ot,[r("ul",kt,[(f(!0),k(A,null,J(a.params,_=>(f(),k("li",{innerHTML:_==null?void 0:_.text},null,8,wt))),256)),r("div",{class:"btn btn--md btn--bold btn-manage",onClick:o[1]||(o[1]=_=>e.orderManage())},"Управлять заказом")])]),r("div",xt,[((O=a.itemData)==null?void 0:O.StatusID)==="Active"?(f(),k("div",{key:0,class:at(["btn btn--md btn--border btn--rotate btn--rotate_green button-large",{"btn--rotate_gray":((I=a.itemData)==null?void 0:I.StatusID)!=="Active"||e.isReloading,"btn--rotate_loading":e.isReloading}]),title:"Перезагрузить выделенный сервер",onClick:o[2]||(o[2]=(..._)=>e.reloadItem&&e.reloadItem(..._))},[R("Включен"),r("button",null,[r("div",Bt,[d(c)])])],2)):nt("",!0),r("div",{class:"btn btn--md btn--bold",onClick:o[3]||(o[3]=_=>{var b;return n.$router.push(`/VPSOrderPay/${(b=a.itemData)==null?void 0:b.OrderID}`)})},[d(u),R("Оплатить")]),d(B,{class:"dropdown-dots",right:""},{"button-content":D(()=>[r("div",Rt,[d(x)])]),default:D(()=>[d(y,{onClick:o[4]||(o[4]=_=>e.transferAccount())},{default:D(()=>[R("Передать на другой аккаунт")]),_:1}),d(y,null,{default:D(()=>{var _;return[d(m,{to:`/VPSOrders/${(_=a.itemData)==null?void 0:_.OrderID}/SchemeChange`},{default:D(()=>[R("Изменить тариф")]),_:1},8,["to"])]}),_:1})]),_:1})])])}const Mt={components:{StatusBadge:Y,IconRotate:Z,Helper:ct},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1},userName:{type:String,default:""}},emits:["manage","transfer"],setup(n,{emit:o}){X();const a=W("emitter"),e=U(!1);function S(l){if(!l)return G(new Date);const c=new Date,u=new Date(c.getTime()+l*24*60*60*1e3);return G(u)}function V(){var l,c;a.emit("open-modal",{component:"OrdersTransfer",data:{ServiceOrderID:(l=n.itemData)==null?void 0:l.ID,ServiceID:(c=n.itemData)==null?void 0:c.ServiceID}})}function w(l){a.emit("open-modal",{component:"StatusHistory",data:{modeID:"VPSOrders",rowID:l}})}function m(){var c;function l(u){e.value=u}a.emit("open-modal",{component:"ReloadVPS",data:{VPSOrderID:(c=n.itemData)==null?void 0:c.ID,isReloading:e.value,onReloadStatusChange:l}})}function P(){var l,c,u;o("manage",{ServiceOrderID:(l=n.itemData)==null?void 0:l.ID,ServiceID:(c=n.itemData)==null?void 0:c.ServiceID,OrderID:(u=n.itemData)==null?void 0:u.OrderID})}return{vpsStatuses:dt,reloadItem:m,isReloading:e,orderManage:P,calculateExpirationDate:S,isReloading:e,transferAccount:V,openHistoryStatuses:w}}},et=Q(Mt,[["render",Lt],["__scopeId","data-v-ceefec80"]]),Nt=n=>(ot("data-v-2ebf1902"),n=n(),st(),n),At={class:"section"},Ut={class:"container"},Ht={class:"section-header"},Et=Nt(()=>r("h1",{class:"section-title"},"VPS/VDS серверы",-1)),Tt={class:"list-form"},jt={class:"list-form_col list-form_col--sm"},zt={class:"list-form_select"},Ft={class:"multiselect-option"},Kt={key:0};function qt(n,o,a,e,S,V){var y,B,C;const w=tt,m=M("router-link"),P=$,l=M("Multiselect"),c=ht,u=et,x=bt;return f(),k(A,null,[d(w),r("div",At,[r("div",Ut,[r("div",Ht,[Et,d(m,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:D(()=>[R("Заказать")]),_:1})]),d(P),r("div",Tt,[r("div",jt,[r("div",zt,[d(l,{modelValue:e.select,"onUpdate:modelValue":o[0]||(o[0]=i=>e.select=i),options:e.getUsers,disabled:((y=e.getUsers)==null?void 0:y.length)<=1,label:"name"},{singlelabel:D(({value:i})=>[r("span",null,"# "+h(i.value.padStart(5,"0"))+" / "+h(i.name),1)]),option:D(({option:i})=>[r("div",Ft,"# "+h(i.value.padStart(5,"0"))+" / "+h(i.name),1)]),_:1},8,["modelValue","options","disabled"])])]),d(c,{modelValue:e.search,"onUpdate:modelValue":o[1]||(o[1]=i=>e.search=i)},null,8,["modelValue"])]),e.getVpsOrders&&((B=e.getVpsOrders)==null?void 0:B.length)>0?(f(),k("div",Kt,[e.filterProducts&&((C=e.filterProducts)==null?void 0:C.length)>0?(f(!0),k(A,{key:0},J(e.filterProducts,(i,s)=>{var t;return f(),N(u,{"item-data":i,"is-last":s===e.filterProducts.length-1,"user-name":(t=e.getContracts[i==null?void 0:i.ContractID])==null?void 0:t.Customer,params:e.formItemParamList(i),onManage:e.orderManage},null,8,["item-data","is-last","user-name","params","onManage"])}),256)):(f(),N(x,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(f(),N(x,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])],64)}const Gt={components:{IconSearch:lt,Select2:gt,ClausesKeeper:$,Multiselect:vt,VpsItem:et,BlockBalanceAgreement:tt},async setup(){const n=X(),o=pt(),a=It(),e=rt(),S=U(null),V=U("*");W("emitter").on("updateVPSList",()=>{n.fetchVPS()});const m=L(()=>{var s;return(s=Object.keys(n==null?void 0:n.vpsList).map(t=>n==null?void 0:n.vpsList[t]))==null?void 0:s.reverse()}),P=L(()=>n.vpsSchemes),l=L(()=>B(x(m.value))),c=L(()=>o==null?void 0:o.contractsList);it(()=>{m.value.length<1&&u()});function u(){e.push({path:"/VPSSchemes"})}function x(s){return V.value!=="*"?s.filter(t=>(t==null?void 0:t.ContractID)===V.value):s}function y(s){a.OrderManage(s)}function B(s){return S.value!==null?s.filter(t=>t==null?void 0:t.IP.toLowerCase().includes(S.value.toLowerCase())):s}const C=L(()=>{let s=[{value:"*",name:"Все договора"}];return m.value!==null?(Object.keys(m.value).forEach(t=>{var g,v,p;s.find(O=>{var I;return O.value===((I=m.value[t])==null?void 0:I.ContractID)})||s.push({value:(g=m.value[t])==null?void 0:g.ContractID,name:(p=c.value[(v=m.value[t])==null?void 0:v.ContractID])==null?void 0:p.Customer})}),s):{value:"*",name:"Все договора"}});function i(s){var g,v,p,O,I,_,b,H,E,T,j,z,F,K,q;const t=(g=P.value)==null?void 0:g[s.SchemeID];return[{text:`${t==null?void 0:t.Name}`},{text:`${(p=(v=t==null?void 0:t.SchemeParams)==null?void 0:v.hdd_mib)==null?void 0:p.InternalName} ${(I=(O=t==null?void 0:t.SchemeParams)==null?void 0:O.hdd_mib)==null?void 0:I.Value} ${(b=(_=t==null?void 0:t.SchemeParams)==null?void 0:_.hdd_mib)==null?void 0:b.Unit}`},{text:`RAM ${(E=(H=t==null?void 0:t.SchemeParams)==null?void 0:H.ram_mib)==null?void 0:E.Value} ${(j=(T=t==null?void 0:t.SchemeParams)==null?void 0:T.ram_mib)==null?void 0:j.Unit}`},{text:`Канал ${(F=(z=t==null?void 0:t.SchemeParams)==null?void 0:z.net_bandwidth_mbitps)==null?void 0:F.Value} ${(q=(K=t==null?void 0:t.SchemeParams)==null?void 0:K.net_bandwidth_mbitps)==null?void 0:q.Unit}`}]}return await n.fetchVPS(),await n.fetchVPSSchemes(),await o.fetchContracts(),{getVpsOrders:m,search:S,getContracts:c,select:V,orderManage:y,formItemParamList:i,getUsers:C,filterProducts:l,navigateToVPSSchemes:u}}},ve=Q(Gt,[["render",qt],["__scopeId","data-v-2ebf1902"]]);export{ve as default};
