import{j as V,o as D,c as C,a as c,b as r,w as f,d as h,t as L,F as A,v as T,k as q,_ as H,x as U,p as J,l as K,r as N,R as Q,g as O}from"./index-58c913f0.js";import{u as W}from"./dedicatedServer-952a0bdd.js";import{u as X}from"./contracts-5c545170.js";import{I as Y}from"./IconSearch-7497d374.js";import{_ as Z}from"./HelperComponent-8d748301.js";import{S as j}from"./StatusBadge-cd8ad979.js";import{I as $}from"./IconRotate-53e3b019.js";import{f as R}from"./useTimeFunction-8602dd60.js";import"./resetServer-f032e468.js";import{z as ee,k as te,d as oe}from"./bootstrap-vue-next.es-9015192b.js";import{_ as ae}from"./IconDots-1997c758.js";import{_ as ne}from"./IconCard-94a8b1b0.js";import{_ as se}from"./OrderIDBadge-064a04dd.js";import{S as re}from"./Select2-ab5fff9c.js";import{s as le}from"./multiselect-1db9a63f.js";import{_ as F}from"./FormInputSearch-c75e4536.js";import{B as z}from"./BlockBalanceAgreement-59500b1f.js";import{u as ce}from"./globalActions-45df61a2.js";import{E as de}from"./EmptyStateBlock-e5319013.js";import{_ as ie}from"./ClausesKeeper-7b7ef561.js";import"./ButtonDefault-7a589010.js";import"./IconArrow-bff54646.js";import"./IconPlus-6b01bd5d.js";import"./IconClose-3552080e.js";const _e={class:"hosting-item"},ue={class:"hosting-item__row"},me={class:"hosting-item__date"},fe={class:"hosting-item__row"},De={class:"hosting-item__person"},pe={key:0,class:"hosting-item__row"},ve={class:"hosting-item__list"},Ie=["innerHTML"],ge={class:"hosting-item__controls"},he={class:"btn btn--dots"};function Ce(l,a,s,t,v,I){var g,i,w,B,o,e,_,P;const n=se,d=V("router-link"),u=j,k=V("Helper"),y=ne,M=ae,p=ee,S=te,b=oe;return D(),C("div",_e,[c("div",ue,[r(n,{orderID:(g=s.itemData)==null?void 0:g.OrderID},null,8,["orderID"]),r(d,{class:"hosting-item__name",to:`/DSOrders/${s.itemData.OrderID}`},{default:f(()=>[h(L(s.itemData.IP),1)]),_:1},8,["to"]),r(u,{status:(i=s.itemData)==null?void 0:i.StatusID,DaysRemainded:(w=s.itemData)==null?void 0:w.DaysRemainded,"status-table":"DSOrders"},null,8,["status","DaysRemainded"]),c("div",me,"Дата окончания "+L(t.calculateExpirationDate((B=s.itemData)==null?void 0:B.DaysRemainded))+" | "+L(((o=s.itemData)==null?void 0:o.DaysRemainded)||0)+" дн.",1)]),c("div",fe,[c("div",De,L((e=s.itemData)==null?void 0:e.Customer),1),r(k,{"user-notice":(_=s.itemData)==null?void 0:_.UserNotice,id:(P=s.itemData)==null?void 0:P.OrderID,position:s.isLast?"bottom":"top",emit:"updateDSOrdersList"},null,8,["user-notice","id","position"])]),s.params.length?(D(),C("div",pe,[c("ul",ve,[(D(!0),C(A,null,T(s.params,m=>(D(),C("li",{innerHTML:m},null,8,Ie))),256))])])):q("",!0),c("div",ge,[c("div",{class:"btn btn--md btn--bold",onClick:a[0]||(a[0]=m=>{var x;return l.$router.push(`/DSOrderPay/${(x=s.itemData)==null?void 0:x.OrderID}`)})},[r(y),h("Оплатить")]),r(b,{class:"dropdown-dots",right:""},{"button-content":f(()=>[c("div",he,[r(M)])]),default:f(()=>[r(p,null,{default:f(()=>{var m;return[r(d,{to:`DSOrders/${(m=s.itemData)==null?void 0:m.OrderID}`},{default:f(()=>[h("Дополнительная информация")]),_:1},8,["to"])]}),_:1}),r(p,{onClick:a[1]||(a[1]=m=>t.transferAccount())},{default:f(()=>[h("Передать на другой аккаунт")]),_:1}),r(p,{onClick:a[2]||(a[2]=m=>t.orderManage())},{default:f(()=>[h("Управлять заказом")]),_:1}),r(S),r(p,{class:"color-red",onClick:a[3]||(a[3]=m=>t.deleteItem())},{default:f(()=>[h("Удалить")]),_:1})]),_:1})])])}const Se={components:{StatusBadge:j,IconRotate:$,Helper:Z},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1}},emits:["delete","transfer","manage"],setup(l,{emit:a}){function s(n){if(!n)return R(new Date);const d=new Date,u=new Date(d.getTime()+n*24*60*60*1e3);return R(u)}function t(){var n;a("delete",(n=l.itemData)==null?void 0:n.ID)}function v(){var n,d;a("transfer",{ServiceOrderID:(n=l.itemData)==null?void 0:n.ID,ServiceID:(d=l.itemData)==null?void 0:d.ServiceID})}function I(){var n,d,u;a("manage",{ServiceOrderID:(n=l.itemData)==null?void 0:n.ID,ServiceID:(d=l.itemData)==null?void 0:d.ServiceID,OrderID:(u=l.itemData)==null?void 0:u.OrderID})}return{deleteItem:t,orderManage:I,transferAccount:v,calculateExpirationDate:s}}},G=H(Se,[["render",Ce],["__scopeId","data-v-674a35e8"]]),be=l=>(J("data-v-7aab6eaf"),l=l(),K(),l),we={class:"section"},Oe={class:"container"},Le={class:"section-header"},ke={class:"section-title__nowrap"},ye=be(()=>c("h1",{class:"section-title"},"Выделенные серверы",-1)),Me={class:"list-form"},Pe={class:"list-form_col list-form_col--sm"},Be={class:"list-form_select"},xe={class:"multiselect-option"},Ve={key:0};function Ue(l,a,s,t,v,I){var S,b,g;const n=z,d=V("router-link"),u=ie,k=V("Multiselect"),y=F,M=G,p=de;return D(),C(A,null,[r(n),c("div",we,[c("div",Oe,[c("div",Le,[c("div",ke,[ye,r(d,{class:"btn btn--blue btn-default",to:"DSSchemes"},{default:f(()=>[h("Заказать")]),_:1})])]),r(u,{partition:"Header:/DSOrders"}),c("div",Me,[c("div",Pe,[c("div",Be,[r(k,{modelValue:t.select,"onUpdate:modelValue":a[0]||(a[0]=i=>t.select=i),options:t.getUsers,disabled:((S=t.getUsers)==null?void 0:S.length)<=1,label:"name"},{option:f(({option:i})=>[c("div",xe,"# "+L(i.value.padStart(5,"0"))+" / "+L(i.name),1)]),_:1},8,["modelValue","options","disabled"])])]),r(y,{modelValue:t.search,"onUpdate:modelValue":a[1]||(a[1]=i=>t.search=i)},null,8,["modelValue"])]),t.getDSList&&((b=t.getDSList)==null?void 0:b.length)>0?(D(),C("div",Ve,[t.filterProducts&&((g=t.filterProducts)==null?void 0:g.length)>0?(D(!0),C(A,{key:0},T(t.filterProducts,(i,w)=>(D(),U(M,{params:t.getDSItemParam(i),"is-last":w===t.filterProducts.length-1,"item-data":i,onDelete:t.deleteItem,onTransfer:t.transferItem,onManage:t.orderManage},null,8,["params","is-last","item-data","onDelete","onTransfer","onManage"]))),256)):(D(),U(p,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(D(),U(p,{key:1,class:"no-margin",label:"У Вас нет заказов на выделенные серверы"}))])])],64)}const Ae={components:{FormInputSearch:F,IconSearch:Y,Select2:re,Multiselect:le,DSItem:G,BlockBalanceAgreement:z},async setup(){const l=N("*"),a=N(null),s=ce(),t=W(),v=X(),I=Q("emitter");I.on("updateDSOrdersList",()=>{t.fetchDSOrders()});const n=O(()=>{var o;return(o=Object.keys(t==null?void 0:t.DSList).map(e=>t==null?void 0:t.DSList[e]))==null?void 0:o.reverse()}),d=O(()=>t==null?void 0:t.DSSchemes),u=O(()=>v==null?void 0:v.contractsList),k=O(()=>t==null?void 0:t.DSOrderIPMI),y=O(()=>p(M(n.value)));function M(o){return l.value!=="*"?o.filter(e=>(e==null?void 0:e.ContractID)===l.value):o}function p(o){return a.value!==null?o.filter(e=>(e==null?void 0:e.Customer.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.OrderID.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.Scheme.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.IP.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.disks.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.CPU.toLowerCase().includes(a.value.toLowerCase()))||(e==null?void 0:e.ram.toLowerCase().includes(a.value.toLowerCase()))):o}function S(o){s.OrderManage(o)}const b=O(()=>{let o=[{value:"*",name:"Все договора"}];return n.value!==null&&u.value!==null?(Object.keys(n.value).forEach(e=>{var _,P,m;o.find(x=>{var E;return x.value===((E=n.value[e])==null?void 0:E.ContractID)})||o.push({value:(_=n.value[e])==null?void 0:_.ContractID,name:(m=u.value[(P=n.value[e])==null?void 0:P.ContractID])==null?void 0:m.Customer})}),o):{value:"*",name:"Все договора"}});function g(o){let e=i(o==null?void 0:o.SchemeID);e===void 0&&(e=o);let _=[];return o!=null&&o.Scheme&&_.push(o==null?void 0:o.Scheme),o!=null&&o.CPU&&_.push(o==null?void 0:o.CPU),e!=null&&e.ram&&_.push("RAM "+(e==null?void 0:e.ram)+" GB"),e!=null&&e.disks&&_.push(e==null?void 0:e.disks),e!=null&&e.CostMonth&&_.push("<b>"+(e==null?void 0:e.CostMonth)+"/ месяц</b>"),_}function i(o){var e;return(e=d.value)==null?void 0:e[o]}function w(o){I.emit("open-modal",{component:"DeleteItem",data:{id:o,message:"Вы действительно хотите удалить этот сервер?",tableID:"DSOrders",successEmit:"updateDSOrdersList"}})}function B(o){I.emit("open-modal",{component:"OrdersTransfer",data:o})}return await t.fetchDSOrders(),await t.fetchDSSchemes(),await t.fetchDSOrderIPMI(),await v.fetchContracts(),{getDSList:n,filterProducts:y,select:l,search:a,getUsers:b,getDSSchemes:d,getDSItemParam:g,getDSOrderIPMI:k,orderManage:S,deleteItem:w,transferItem:B}}},rt=H(Ae,[["render",Ue],["__scopeId","data-v-7aab6eaf"]]);export{rt as default};
