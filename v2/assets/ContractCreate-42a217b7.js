import{j as ie,o as r,c as u,b as _,a as s,w as M,d as N,F as I,v as H,k as p,x as b,t as ce,n as D,p as ke,l as be,_ as Ce,u as Ve,f as ye,e as Ie,r as h,g as te,h as Te}from"./index-b105c350.js";import{u as Pe}from"./contracts-b62777f8.js";import{s as ue}from"./SimpleCheckbox-02e53c66.js";import{_ as de}from"./BasicInput-5575d2ee.js";import{P as fe,T as pe,S as _e}from"./PhoneInput-184f7563.js";import{B as he}from"./BlockBalanceAgreement-19657f3d.js";import{u as xe}from"./files-6b4c4511.js";import{I as ve}from"./IconFile-48c417e6.js";import{I as ge}from"./IconClose-0ba84d64.js";import{_ as Ee}from"./ButtonDefault-d83beda7.js";import{f as me}from"./bootstrap-vue-next.es-31cfcab6.js";import{_ as Ue}from"./IconClip-dbe4aea5.js";import{_ as we}from"./ClausesKeeper-d7dcbabd.js";import"./component-8d6481d0.js";import"./multiselect-34394f38.js";import"./IconArrow-27665727.js";const O=i=>(ke("data-v-b229a83f"),i=i(),be(),i),Fe={class:"section"},Re={class:"container"},Se={class:"section-header"},Ae=O(()=>s("h1",{class:"section-title"},"Создать профиль",-1)),De=O(()=>s("div",{class:"section-header"},[s("h2",{class:"section-block_title"},"Шаблон")],-1)),Be={class:"form"},Le={class:"form"},Me={class:"form-row-wrapper"},Ne={class:"special-form-row"},He={key:0,class:"section-header inputs-block"},Oe={class:"section-block_title"},je={key:0,class:"form width-limit"},qe={key:0,class:"form-field form-field--file form-field--basic"},ze={class:"chat-files"},Ge={class:"chat-files__item"},Je=["onClick"],Ke={class:"form-field form-field--file form-field--basic"},Qe={class:"form-field-input__file-wrapper"},We={class:"form-field-input__file"},Xe=O(()=>s("span",null,"Прикрепить документ подтверждающий личность",-1)),Ye=["innerHTML"];function Ze(i,c,T,o,j,P){var w,F,R,y,S,l,n;const C=he,v=ie("router-link"),x=we,g=ue,k=de,E=fe,d=pe,f=_e,B=ve,m=ge,V=Ue,U=me,L=Ee;return r(),u(I,null,[_(C),s("div",Fe,[s("div",Re,[s("div",Se,[_(v,{class:"section-label",to:"/Contracts"},{default:M(()=>[N("Мои договора")]),_:1}),Ae]),_(x),De,s("div",Be,[(r(!0),u(I,null,H((F=(w=o.getConfig)==null?void 0:w.Contracts)==null?void 0:F.Types,e=>(r(),u(I,null,[(e==null?void 0:e.ProfileTemplateID)!==""?(r(),b(g,{key:0,label:e==null?void 0:e.Name,value:e==null?void 0:e.ProfileTemplateID,modelValue:o.templateValue,"onUpdate:modelValue":c[0]||(c[0]=a=>o.templateValue=a)},null,8,["label","value","modelValue"])):p("",!0)],64))),256))]),s("div",Le,[(r(!0),u(I,null,H((n=(l=(S=(y=(R=o.getConfig)==null?void 0:R.Profiles)==null?void 0:y.Templates)==null?void 0:S[o.templateValue])==null?void 0:l.Template)==null?void 0:n.Attribs,(e,a)=>(r(),u("div",Me,[s("div",Ne,[e!=null&&e.Title?(r(),u("div",He,[s("h2",Oe,ce(e==null?void 0:e.Title),1)])):p("",!0),(e==null?void 0:e.Type)==="Input"&&(e==null?void 0:e.Check)!=="Phone"?(r(),b(k,{key:1,class:D({"special-form-input":!0,"form-field-error":o.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:o.form[a].value,"onUpdate:modelValue":t=>o.form[a].value=t,pattern:o.getFieldRegex(e==null?void 0:e.Check)},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue","pattern"])):p("",!0),(e==null?void 0:e.Type)==="Input"&&(e==null?void 0:e.Check)==="Phone"?(r(),b(E,{key:2,class:D({"special-form-input":!0,"form-field-error":o.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:o.form[a].value,"onUpdate:modelValue":t=>o.form[a].value=t,pattern:o.getPhoneRegex()},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue","pattern"])):p("",!0),(e==null?void 0:e.Type)==="TextArea"?(r(),b(d,{key:3,class:D({"special-form-input":!0,"form-field-error":o.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,modelValue:o.form[a].value,"onUpdate:modelValue":t=>o.form[a].value=t},null,8,["class","label","placeholder","necessarily","name","modelValue","onUpdate:modelValue"])):(e==null?void 0:e.Type)==="Select"?(r(),b(f,{key:4,class:D({"special-form-input":!0,"form-field-error":o.form[a].error}),label:e==null?void 0:e.Comment,placeholder:e==null?void 0:e.Example,necessarily:(e==null?void 0:e.IsDuty)==="1",name:e==null?void 0:e.Check,options:e==null?void 0:e.Options,modelValue:o.form[a].value,"onUpdate:modelValue":t=>o.form[a].value=t},null,8,["class","label","placeholder","necessarily","name","options","modelValue","onUpdate:modelValue"])):p("",!0)])]))),256))]),o.templateValue!==0?(r(),u("div",je,[o.fileList.length?(r(),u("div",qe,[s("div",ze,[(r(!0),u(I,null,H(o.fileList,(e,a)=>(r(),u("div",Ge,[s("span",null,[_(B,{class:"file-icon"})]),s("span",null,ce(e==null?void 0:e.name),1),s("button",{class:"close",onClick:t=>o.removeFile(a)},[_(m)],8,Je)]))),256))])])):p("",!0),s("label",Ke,[s("div",Qe,[s("input",{ref:"fileInput",type:"file",onChange:c[1]||(c[1]=(...e)=>o.fileUpload&&o.fileUpload(...e))},null,544),s("div",We,[_(V),Xe])])]),_(U,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:o.agree,"onUpdate:modelValue":c[2]||(c[2]=e=>o.agree=e)},{default:M(()=>[N("Подтверждаю свое согласие на передачу информации в электроной форме (в том числе персональных данных) по открытым каналам связи сети Интернет")]),_:1},8,["modelValue"]),_(U,{class:"rule-checkbox",name:"checkbox",checked:"",modelValue:o.agreeHandle,"onUpdate:modelValue":c[3]||(c[3]=e=>o.agreeHandle=e)},{default:M(()=>[N("Я разрешаю передачу своих персональных данных третьим лицам, для выполнения заказанных мною услуг (регистрация доменто и т.п.)")]),_:1},8,["modelValue"])])):p("",!0),o.createProfileErrorMessage?(r(),u("div",{key:1,class:"error-message width-limit",innerHTML:o.formErrorMessage(o.createProfileErrorMessage)},null,8,Ye)):p("",!0),o.templateValue!==0?(r(),b(L,{key:2,class:"width-limit","is-loading":o.createProfileResult==="pending",label:"Зарегистрировать",onClick:c[4]||(c[4]=e=>o.checkForm())},null,8,["is-loading"])):p("",!0)])])],64)}const $e={components:{TextAreaLine:pe,simpleCheckbox:ue,basicInput:de,SelectLine:_e,PhoneInput:fe,IconFile:ve,IconClose:ge,BlockBalanceAgreement:he},setup(){const i=Ve(),c=Pe(),T=ye(),o=xe(),j=Ie(),P=h(!1),C=h(!1),v=h({}),x=h(null),g=h([]),k=h(null),E=h(null),d=h(0),f=te(()=>i.ConfigList),B=te(()=>{var l;return(l=T==null?void 0:T.userInfo)==null?void 0:l.Email}),m=f.value,V={};for(const l in m.Regulars)V[l]=m.Regulars[l];const U=l=>V[l]||null,L=()=>{const l=f.value;return l&&l.Regulars&&l.Regulars.Phone?new RegExp(l.Regulars.Phone):/^[0-9]{10}$/};function w(l){g.value=g.value.filter((n,e)=>e!==l)}function F(){if(P.value&&C.value){let l=new FormData;Object.keys(v.value).forEach(n=>{var e;l.append(n,(e=v.value[n])==null?void 0:e.value)}),l.append("TemplateID",d.value),l.append("Agree",P.value),l.append("AgreeHandle",C.value),g.value.forEach((n,e)=>{l.append("Document[]",n==null?void 0:n.value)}),k.value="pending",c.createNewContractFormData(l).then(n=>{var e;n.status==="success"?(k.value="success",j.push("/Contracts")):(k.value="error",E.value=(e=n.data)==null?void 0:e.Exception)})}}function R(l){return""+y(l)}function y(l){return l?"<div>"+(l==null?void 0:l.String)+"</div>"+y(l==null?void 0:l.Parent):""}function S(l){var e;let n=((e=l.target.files)==null?void 0:e[0])||null;n&&(x.value.value="",o.sendFile(n).then(a=>{g.value.push({name:n==null?void 0:n.name,value:a.slice(a.lastIndexOf("^")+1,a.length)})}))}return Te(d,()=>{var l,n,e,a,t;v.value={},Object.keys((t=(a=(e=(n=(l=f.value)==null?void 0:l.Profiles)==null?void 0:n.Templates)==null?void 0:e[d.value])==null?void 0:a.Template)==null?void 0:t.Attribs).forEach(A=>{var q,z,G,J,K,Q,W,X,Y,Z,$,ee,le,oe,ae,ne,se,re;v.value[A]={error:!1,value:(((Q=(K=(J=(G=(z=(q=f.value)==null?void 0:q.Profiles)==null?void 0:z.Templates)==null?void 0:G[d.value])==null?void 0:J.Template)==null?void 0:K.Attribs[A])==null?void 0:Q.Value)==="%Email%"?B.value:(ee=($=(Z=(Y=(X=(W=f.value)==null?void 0:W.Profiles)==null?void 0:X.Templates)==null?void 0:Y[d.value])==null?void 0:Z.Template)==null?void 0:$.Attribs[A])==null?void 0:ee.Value)||null,required:((re=(se=(ne=(ae=(oe=(le=f.value)==null?void 0:le.Profiles)==null?void 0:oe.Templates)==null?void 0:ae[d.value])==null?void 0:ne.Template)==null?void 0:se.Attribs[A])==null?void 0:re.IsDuty)==="1"}})}),{getConfig:f,templateValue:d,agreeHandle:C,agree:P,createProfileResult:k,createProfileErrorMessage:E,checkForm:F,formErrorMessage:R,form:v,fileInput:x,fileList:g,removeFile:w,fileUpload:S,getPhoneRegex:L,getFieldRegex:U,fieldRegexMap:V}}},gl=Ce($e,[["render",Ze],["__scopeId","data-v-b229a83f"]]);export{gl as default};
