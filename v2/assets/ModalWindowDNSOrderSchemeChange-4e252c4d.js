import{j as O,o as y,c as k,a as o,t as i,b,w as v,p as M,l as j,_ as w,r as C,R as x,g as p,i as V}from"./index-b105c350.js";import{u as B}from"./services-6cdcdb30.js";import{s as L}from"./multiselect-34394f38.js";import{_ as P}from"./ButtonDefault-d83beda7.js";const h=c=>(M("data-v-40c435b3"),c=c(),j(),c),E={class:"modal__body"},G=h(()=>o("div",{class:"list-item__title"},"Смена тарифного плана",-1)),H=h(()=>o("div",{class:"list-item__subtitle"},"Текущий тарифный план ",-1)),U=h(()=>o("div",{class:"modal__input-row"},null,-1)),W=h(()=>o("div",{class:"modal__input-label"},"Новый тарифный план",-1)),A={class:"list-form_col list-form_col--xl"},R=h(()=>o("div",{class:"search-field form-field"},null,-1)),q={class:"multiselect-multiple-label"},z={class:"multiselect-option"};function F(c,d,a,t,g,f){var r,D;const m=O("Multiselect"),S=P;return y(),k("div",E,[G,H,o("span",null,i((r=t.getDNSScheme[0])==null?void 0:r.name)+"/"+i((D=t.getDNSScheme[0])==null?void 0:D.cost),1),U,W,o("div",A,[R,b(m,{class:"multiselect--white",options:t.getDNSSchemes,type:"text",modelValue:t.selectedPackage,"onUpdate:modelValue":d[0]||(d[0]=e=>t.selectedPackage=e),placeholder:"Поиск"},{singlelabel:v(({value:e})=>[o("div",q,[o("span",null,i(e==null?void 0:e.Name)+"/"+i(e==null?void 0:e.CostMonth),1)])]),option:v(({option:e})=>[o("div",z,i(e==null?void 0:e.Name)+"/"+i(e==null?void 0:e.CostMonth),1)]),_:1},8,["options","modelValue"])]),b(S,{class:"modal__button",label:"Сменить","is-loading":t.isLoading,onClick:d[1]||(d[1]=e=>t.changeScheme())},null,8,["is-loading"])])}const J={components:{Multiselect:L},props:{data:{type:Object,default:()=>{}}},emits:["modalClose"],setup(c,{emit:d}){const a=B(),t=C(!1),g=C(null);x("emitter");const f=p(()=>a==null?void 0:a.DNSmanagerOrdersList),m=p(()=>{const e=f.value;if(!(!e||typeof e!="object"))return Object.keys(e).map(n=>e[n]).find(n=>{var s;return n.OrderID===((s=c.data)==null?void 0:s.DNSID)})}),S=p(()=>Object.keys(a==null?void 0:a.additionalServicesScheme.DNSmanager).map(e=>{var n,s,_;return{...a==null?void 0:a.additionalServicesScheme.DNSmanager[e],value:(n=a==null?void 0:a.additionalServicesScheme.DNSmanager[e])==null?void 0:n.ID,name:(s=a==null?void 0:a.additionalServicesScheme.DNSmanager[e])==null?void 0:s.Name,cost:(_=a==null?void 0:a.additionalServicesScheme.DNSmanager[e])==null?void 0:_.CostMonth}}).filter(e=>{var n;return(e==null?void 0:e.ID)==((n=m.value)==null?void 0:n.SchemeID)})),r=p(()=>{var _;const e=S.value[0],n=(_=Object.keys(a==null?void 0:a.additionalServicesScheme.DNSmanager).map(l=>{var u;return{...a==null?void 0:a.additionalServicesScheme.DNSmanager[l],value:(u=a==null?void 0:a.additionalServicesScheme.DNSmanager[l])==null?void 0:u.ID}}))==null?void 0:_.filter(l=>{var u,N,I;return((u=l==null?void 0:l.value)==null?void 0:u.HardServerID)===(e==null?void 0:e.HardServerID)&&(l==null?void 0:l.IsSchemeChangeable)&&(l==null?void 0:l.ID)!==((N=m.value)==null?void 0:N.SchemeID)&&(l==null?void 0:l.ServersGroupID)===((I=c.data)==null?void 0:I.ServerGroup)});return[e,...n].map(l=>({...l,disabled:l.ID===e.ID}))});function D(){var e;t.value=!0,a.DNSmanagerOrderSchemeChange({NewSchemeID:g.value,DNSmanagerOrderID:(e=m.value)==null?void 0:e.ID}).then(n=>{let{result:s,error:_}=n;s==="SUCCESS"&&d("modalClose"),t.value=!1})}return V(()=>{var e,n,s;a.fetchAdditionalServiceScheme((e=c.data)==null?void 0:e.Code),a.fetchDNSmanagerOrders(),g.value=(s=(n=r.value)==null?void 0:n[1])==null?void 0:s.value,console.log(S.value[0]),console.log(r.value)}),{isLoading:t,getDNSSchemes:r,changeScheme:D,selectedPackage:g,getDNSScheme:S}}},Y=w(J,[["render",F],["__scopeId","data-v-40c435b3"]]);export{Y as default};
