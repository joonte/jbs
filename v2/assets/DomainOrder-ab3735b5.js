import{k as tt,o as v,c as w,b as c,a as e,t as l,w as K,d as Q,z as et,l as U,Z as ot,$ as st,F as it,p as nt,m as at,_ as rt,f as lt,g as ct,e as _t,U as mt,r as W,h as R,i as dt}from"./index-aeb1df1e.js";import{u as ut}from"./domain-0f1019af.js";import{u as Dt}from"./IconArrow-a6c91ada.js";import{f as V,a as vt}from"./useTimeFunction-8602dd60.js";import{_ as gt}from"./IconCard-47752060.js";import{I as ht}from"./IconProfile-efaeb789.js";import{I as ft}from"./IconSettings-09f9f59f.js";import{_ as pt,a as It}from"./ServicesContractBalanceBlock-a08c9c9b.js";import{S as Y}from"./StatusBadge-ca078fa4.js";import{B as $}from"./BlockBalanceAgreement-906c1168.js";import{E as bt}from"./EmptyStateBlock-b0a120e4.js";import{_ as wt}from"./ButtonDefault-11c4541b.js";import{_ as St}from"./ClausesKeeper-90c650cc.js";import"./bootstrap-vue-next.es-c6bcf011.js";import"./IconClose-c7c36336.js";const kt={Waiting:{id:1,label:"Ожидание оплаты",color:"#459FD1",background:"#ADC1F04C"},ClaimForRegister:{id:2,label:"Заявка на регистрацию",color:"#FFC107",background:"#FFC10733"},ForContractRegister:{id:3,label:"Для регистрации договора",color:"#FFC107",background:"#FFC10733"},OnContractRegister:{id:4,label:"На регистрации договора",color:"#FFC107",background:"#FFC10733"}},_=d=>(nt("data-v-576cdbf8"),d=d(),at(),d),Ct={key:0,class:"section"},yt={class:"container"},Ot={class:"section-header"},xt={class:"section-title"},Ft=["href"],Nt={class:"section-label"},Pt={class:"section-nav"},Et={class:"list"},Bt={class:"list-col list-col--md"},Rt={class:"list-item"},Tt={class:"list-item__row"},At={class:"list-item__title"},Ut={class:"list-item__status"},Wt={class:"list-item__row"},Vt={class:"list-item__ul"},Ht={key:0},Mt={class:"list-item__row list-item__row--column"},Lt={key:0,class:"list-item__text"},jt={class:"list-item__text"},qt={class:"list-item__text"},zt={class:"list-item__row"},Xt={class:"btn btn--border btn--switch"},Zt=_(()=>e("span",{class:"btn-switch__text"},"Автопродление",-1)),Gt=_(()=>e("span",{class:"btn-switch__toggle"},null,-1)),Jt={class:"list-col list-col--md"},Kt={class:"list-item"},Qt={class:"list-item__row list-item__row--nowrap"},Yt=_(()=>e("div",{class:"list-item__title"},"Именные сервера",-1)),$t={class:"list-item__row list-item__row--table"},te=_(()=>e("div",{class:"list-item__item"},"Первичный сервер",-1)),ee={class:"list-item__item"},oe={class:"list-item__row list-item__row--table"},se=_(()=>e("div",{class:"list-item__item"},"Вторичный сервер",-1)),ie={class:"list-item__item"},ne={class:"list-col list-col--md"},ae={class:"list-item"},re=_(()=>e("div",{class:"list-item__row"},[e("div",{class:"list-item__title"},"Контактные данные")],-1)),le={class:"list-item__row list-item__row--table"},ce=_(()=>e("div",{class:"list-item__item"},"Скрыть данные в WhoIs",-1)),_e={class:"btn btn--switch"},me=["checked"],de=_(()=>e("span",{class:"btn-switch__toggle"},null,-1)),ue={class:"list-item__row list-item__row--table"},De=_(()=>e("div",{class:"list-item__item"},"Последнее обновление адрес",-1)),ve={class:"list-item__item"},ge={key:1,class:"section"},he={class:"container"};function fe(d,n,a,o,H,u){var C,i,p,y,O,x,F,N,P,E,B,t,s,r,D,I,b,M,L,j,q,z,X,Z,G;const g=$,h=tt("router-link"),S=St,f=wt,T=pt,k=Y,A=bt;return v(),w(it,null,[c(g),(C=o.getDomain)!=null&&C.ID?(v(),w("div",Ct,[e("div",yt,[e("div",Ot,[e("h1",xt,[e("a",{href:o.fullDomainUrl,target:"_blank"},l((i=o.getDomain)==null?void 0:i.Domain),9,Ft)]),e("div",Nt,"Домен # "+l((p=o.getDomain)==null?void 0:p.OrderID),1),e("div",Pt,[c(h,{class:"section-nav__item",to:`/DomainOrders/${(y=o.getDomain)==null?void 0:y.OrderID}`},{default:K(()=>[Q("Домен")]),_:1},8,["to"]),c(h,{class:"section-nav__item",to:`/DomainServices/${(O=o.getDomain)==null?void 0:O.OrderID}`},{default:K(()=>[Q("Услуги")]),_:1},8,["to"])])]),c(S),((x=o.getDomain)==null?void 0:x.StatusID)==="Waiting"||((F=o.getDomain)==null?void 0:F.StatusID)==="ClaimForRegister"||((N=o.getDomain)==null?void 0:N.StatusID)==="ForContractRegister"||((P=o.getDomain)==null?void 0:P.StatusID)==="ForRegister"||((E=o.getDomain)==null?void 0:E.StatusID)==="ForTransfer"?(v(),et(f,{key:0,class:"btn-mn__bot",label:"Определить владельца",onClick:n[0]||(n[0]=m=>o.designateOwner())})):U("",!0),e("div",Et,[c(T,{"contract-id":(B=o.getDomain)==null?void 0:B.ContractID,onTransfer:n[1]||(n[1]=m=>o.transferItem())},null,8,["contract-id"]),e("div",Bt,[e("div",Rt,[e("div",Tt,[e("div",At,l((t=o.getDomain)==null?void 0:t.Domain),1),e("div",Ut,[c(k,{status:(s=o.getDomain)==null?void 0:s.StatusID,"status-table":"DomainOrders",onClick:n[2]||(n[2]=m=>{var J;return o.openHistoryStatuses((J=o.getDomain)==null?void 0:J.ID)})},null,8,["status"])])]),e("div",Wt,[e("ul",Vt,[(r=o.getDomainScheme)!=null&&r.PackageID?(v(),w("li",Ht,l((D=o.getDomainScheme)==null?void 0:D.PackageID),1)):U("",!0)])]),e("div",Mt,[(I=o.getDomainScheme)!=null&&I.CostProlong?(v(),w("div",Lt,l((b=o.getDomainScheme)==null?void 0:b.CostProlong)+" ₽ продлить на 12 месяцев",1)):U("",!0),e("div",jt,"Дней осталось "+l(((M=o.getDomain)==null?void 0:M.DaysRemainded)||0),1),e("div",qt,"Дата окончания "+l(o.calculateExpirationDate((L=o.getDomain)==null?void 0:L.DaysRemainded)),1)]),e("div",zt,[c(f,{label:((j=o.getDomain)==null?void 0:j.StatusID)==="ClaimForRegister"||((q=o.getDomain)==null?void 0:q.StatusID)==="Waiting"?"Оплатить":"Продлить",onClick:n[3]||(n[3]=m=>o.navigateToProlong())},null,8,["label"]),e("label",Xt,[ot(e("input",{type:"checkbox","onUpdate:modelValue":n[4]||(n[4]=m=>o.isAutoProlong=m),onInput:n[5]||(n[5]=m=>o.setProlongValue())},null,544),[[st,o.isAutoProlong]]),Zt,Gt])])])]),e("div",Jt,[e("div",Kt,[e("div",Qt,[Yt,c(f,{class:"ml-auto",label:"Редактировать",onClick:n[6]||(n[6]=m=>o.toggleDomainsEdit())})]),e("div",$t,[te,e("div",ee,l((z=o.getDomain)==null?void 0:z.Ns1Name),1)]),e("div",oe,[se,e("div",ie,l((X=o.getDomain)==null?void 0:X.Ns2Name),1)])])]),e("div",ne,[e("div",ae,[re,e("div",le,[ce,e("label",_e,[e("input",{type:"checkbox",checked:(Z=o.getDomain)==null?void 0:Z.IsPrivateWhoIs,disabled:""},null,8,me),de])]),e("div",ue,[De,e("div",ve,l(o.lastUpdate((G=o.getDomain)==null?void 0:G.StatusDate)),1)])])])])])])):(v(),w("div",ge,[e("div",he,[c(A,{label:"Заказ не найден"})])]))],64)}const pe={components:{IconCard:gt,IconProfile:ht,IconSettings:ft,IconEye:It,StatusBadge:Y,BlockBalanceAgreement:$},async setup(){const d=lt(),n=ct(),a=ut(),o=Dt(),H=_t(),u=mt("emitter"),g=W(null),h=W(!1),S=W({});function f(){u.emit("open-modal",{component:"DomainsEdit",data:i.value})}function T(){var r;if(!((r=i.value)!=null&&r.ExpirationDate))return!1;const t=parseInt(i.value.ExpirationDate,10);return Math.floor(Date.now()/1e3)>=t}function k(){var D,I,b;const t=T(),s=Number((D=p.value)==null?void 0:D.DaysBeforeTransfer)??0;return(Number((I=i.value)==null?void 0:I.DaysRemainded)??0)>s||t&&((b=i.value)==null?void 0:b.IsPayed)}function A(){var t;a.DomainOrderNsChange({DomainOrderID:Number((t=i.value)==null?void 0:t.ID),XMLHttpRequest:"yes"}).then(s=>{let{result:r,error:D}=s;r==="SUCCESS"&&(h.value=!1,a.fetchDomains())})}function C(t){u.emit("open-modal",{component:"StatusHistory",data:{modeID:"DomainOrders",rowID:t}})}const i=R(()=>Object.keys(a==null?void 0:a.domainsList).map(t=>a==null?void 0:a.domainsList[t]).find(t=>t.OrderID===d.params.id)),p=R(()=>{var t,s;return(s=a==null?void 0:a.domainSchemes)==null?void 0:s[(t=i.value)==null?void 0:t.SchemeID]}),y=R(()=>{var t,s;return(s=n==null?void 0:n.userOrders)==null?void 0:s[(t=i.value)==null?void 0:t.OrderID]}),O=R(()=>{var s;if(!((s=i.value)!=null&&s.Domain))return"";const t=i.value.Domain;return t.startsWith("http://")||t.startsWith("https://")?t:`https://${t}`});function x(t){if(!t)return V(new Date);const s=new Date,r=new Date(s.getTime()+t*24*60*60*1e3);return V(r)}function F(t){return t?V(vt(t)):""}function N(){try{const t={DomainOrderID:i==null?void 0:i.value.ID,Domain:i==null?void 0:i.value.Domain};u.emit("open-modal",{component:"DomainSelectOwner",data:t})}catch(t){console.error(t)}}function P(){var t,s;u.emit("open-modal",{component:"OrdersTransfer",data:{ServiceOrderID:(t=i.value)==null?void 0:t.ID,ServiceID:(s=i.value)==null?void 0:s.ServiceID}})}function E(){var t;n.prolongOrder({IsAutoProlong:g.value?0:1,OrderID:(t=i.value)==null?void 0:t.OrderID})}function B(){var s;k()===!0?u.emit("open-modal",{component:"ExclusionWindow",data:{msg:"Заказ домена не может быть оплачен"}}):H.push(`/DomainOrderPay/${(s=i.value)==null?void 0:s.OrderID}`)}return dt(()=>{var t,s;S.value={Ns1Name:(t=i.value)==null?void 0:t.Ns1Name,Ns2Name:(s=i.value)==null?void 0:s.Ns2Name}}),await a.fetchDomains(),await a.fetchDomainSchemes(),await o.fetchProfiles(),await n.fetchUserOrders().then(()=>{var t;g.value=(t=y.value)==null?void 0:t.IsAutoProlong}),{getDomain:i,getDomainScheme:p,isAutoProlong:g,setProlongValue:E,navigateToProlong:B,domainStatuses:kt,transferItem:P,lastUpdate:F,designateOwner:N,calculateExpirationDate:x,domainsEdit:h,domainNames:S,saveDomains:A,toggleDomainsEdit:f,fullDomainUrl:O,openHistoryStatuses:C,isProlong:k}}},Te=rt(pe,[["render",fe],["__scopeId","data-v-576cdbf8"]]);export{Te as default};
