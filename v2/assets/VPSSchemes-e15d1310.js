import{_ as ke}from"./ButtonDefault-b95c906d.js";import{_ as ge}from"./BlockOrderPayBalance-b06eeb59.js";import{_ as W,r as k,i as X,o as l,c as d,a as t,m as re,k as K,t as p,d as ye,F as V,x as $,e as Ie,g as O,O as Ve,h as De,ag as Z,b as j,Z as de,a9 as _e,y as z,w as Pe,p as Be,l as Ce,J as we}from"./index-3af25d4c.js";import{_ as xe}from"./ClausesKeeper-1519f453.js";import{u as Oe}from"./vps-59361479.js";import{u as $e}from"./resetServer-70a43a67.js";import{u as Ee}from"./contracts-4f21f7b6.js";import{_ as Ne}from"./BlockSelectContract-bbfe1748.js";import{B as Ue}from"./BlockBalanceAgreement-4b67da5f.js";import"./bootstrap-vue-next.es-79941670.js";import"./IconHelp-f5d462d2.js";import"./globalActions-83829f94.js";import"./BasicInput-ee6974cd.js";import"./component-17343301.js";import"./IconClose-f49a70b0.js";import"./multiselect-eb4b0170.js";import"./IconArrow-7b47b2f8.js";const Ge={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},name:{type:String,default:""},type:{type:String,default:"radio"},checked:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(v,{emit:_}){const a=k(null),i=k(!1);function g(){_("update:modelValue",v.data)}function y(){i.value=!0}return X(()=>{a.value=v.modelValue}),{inputValue:a,isIconPressed:i,onMouseEvent:y,updateValue:g}}},Le={class:"form-input_border"},Me={class:"form-input_border-label"},Ae=["name","checked"],Fe={class:"form-field__data"},Te={key:0,class:"form-field__img"},je=["src"],Ke={class:"form-field__name"},Re={class:"form-field__desc"},qe={class:"form-field__select"};function He(v,_,a,i,g,y){return l(),d("div",Le,[t("label",Me,[t("input",{name:a.name,type:"radio",checked:a.checked,onInput:_[0]||(_[0]=(...I)=>i.updateValue&&i.updateValue(...I))},null,40,Ae),t("div",Fe,[re(v.$slots,"default",{},()=>[a.data.img?(l(),d("div",Te,[t("img",{src:a.data.img,alt:""},null,8,je)])):K("",!0)],!0),t("div",Ke,p(a.data.name),1),t("div",Re,[ye(p(a.data.desc)+" ",1),a.data.select?re(v.$slots,"default",{key:0},()=>[t("div",qe,[(l(!0),d(V,null,$(a.data.select,(I,n)=>(l(),d("div",{key:n,class:"form-field__select-item"},p(I.text),1))),128))])],!0):K("",!0)])])])])}const Je=W(Ge,[["render",He],["__scopeId","data-v-6ee6abfb"]]);const Ze={props:{modelValue:[String,Number],data:{type:Object,default:()=>{}},headers:{type:Array,default:()=>[]},name:{type:String,default:""},checkbox:{type:Boolean,default:!1},checked:{type:Boolean,default:!1}},emits:["update:modelValue","input"],setup(v,{emit:_}){const a=k(null),i=k(!1);function g(){_("update:modelValue",v.data),_("input",v.data)}function y(){i.value=!0}return X(()=>{a.value=v.modelValue}),{inputValue:a,isIconPressed:i,onMouseEvent:y,updateValue:g}}},ze={class:"form-input_border"},Qe={class:"form-input_border-label"},We=["name","type","checked"],Xe={class:"form-field__data"},Ye={class:"form-field_header"};function et(v,_,a,i,g,y){return l(),d("div",ze,[t("label",Qe,[t("input",{name:a.name,type:a.checkbox?"checkbox":"radio",checked:a.checked,onInput:_[0]||(_[0]=(...I)=>i.updateValue&&i.updateValue(...I))},null,40,We),t("div",Xe,[(l(!0),d(V,null,$(a.headers,(I,n)=>(l(),d("div",{key:n,class:"form-field__col"},[t("span",Ye,p(I),1),t("span",null,p(a.data[n]),1)]))),128))])])])}const tt=W(Ze,[["render",et],["__scopeId","data-v-a13950e6"]]),st="/v2/assets/oc-2-8f4c288c.jpg";const U=v=>(Be("data-v-fea42833"),v=v(),Ce(),v),ot={class:"vps-scheme-page"},at={class:"section"},lt={class:"container"},nt=U(()=>t("div",{class:"section-header"},[t("h1",{class:"section-title"},"Заказать VPS/VDS сервер")],-1)),ct={class:"section"},ut={class:"container"},rt=U(()=>t("h2",{class:"section-block_title"},"Конфигурация",-1)),dt={class:"form-column"},_t={class:"form-header"},it={class:"form-header_col"},vt={key:0,class:"section"},pt={class:"container"},mt=U(()=>t("h2",{class:"section-block_title"},"Операционная система",-1)),ht={class:"form grid-gorm"},ft=["src","alt"],bt={class:"section"},St={class:"container"},kt=U(()=>t("h2",{class:"section-block_title"},"Регион",-1)),gt={class:"form"},yt={class:"section"},It={class:"container"},Vt={class:"total-block"},Dt={class:"total-block__row divider-bottom"},Pt=U(()=>t("div",{class:"total-block__col"},"Цена тарифа",-1)),Bt={class:"total-block__col"},Ct={class:"total-block__row no-divider"},wt={class:"total-block__col"},xt={class:"total-block__col"},Ot={class:"total-block__row total-block__row--big economy-line"},$t=U(()=>t("div",{class:"total-block__col red"},"Выгода",-1)),Et={class:"total-block__col flex-col"},Nt={class:"red"},Ut={class:"total-block__row total-block__row--big"},Gt={class:"total-block__col"},Lt={class:"total-block__col"},Q="Moscow",Mt={__name:"VPSSchemes",async setup(v){let _,a;const i=Oe(),g=Ee(),y=$e(),I=Ie(),n=k(null),w=k(null),G=k(null),R=k(!1),h=k(null),ie=k([{img:st,value:"Moscow",name:"Россия",desc:"Москва"}]),Y=k({PackageID:"Тариф",cpu_number:"CPU",ram_mib:"RAM",hdd_mib:"Память",net_in_mbitps:"Канал",CostMonth:"Стоимость"}),q=O(()=>Object.keys(i.vpsSchemes).map(e=>i.vpsSchemes[e])),ve=O(()=>q.value.sort((s,u)=>{const c=Number(s.SortID),r=Number(u.SortID);return c-r})),pe=O(()=>g==null?void 0:g.contractsList),E=O(()=>q.value.find(e=>{var s;return(e==null?void 0:e.ID)===((s=h.value)==null?void 0:s.ID)})),L=O(()=>{var e;return(e=y==null?void 0:y.serverGroupsList)==null?void 0:e.ServersGroups}),N=O(()=>{var u,c;const e=((u=E.value)==null?void 0:u.OS)||[],s=((c=E.value)==null?void 0:c.OSs)||[];return e.map(r=>{const m=s.find(f=>f.Name===r);return{name:r,value:r,imageUrl:m?m.Image:""}})}),ee=e=>{e.key==="Enter"&&e.ctrlKey&&!me.value&&oe()},me=O(()=>n.value===null||w.value===null);X(()=>{console.log(E),document.addEventListener("keyup",ee)}),Ve(()=>{document.removeEventListener("keyup",ee)});function H(e){var r;const s=Number((r=E.value)==null?void 0:r.CostInstall)||0,u=Number(e)||0,c=(s+u).toFixed(2);return Number(c)}function te(){var s,u;let e=0;return(u=(s=n.value)==null?void 0:s.discounts)==null||u.Bonuses.map(c=>{e+=+c.Economy}),e}De(h,e=>{n.value=e,console.log(E)});function se(e){var s,u,c,r,m,f,b,S;return{ID:e==null?void 0:e.ID,PackageID:e==null?void 0:e.PackageID,ServersGroupID:e==null?void 0:e.ServersGroupID,cpu_number:(u=(s=e==null?void 0:e.SchemeParams)==null?void 0:s.cpu_number)==null?void 0:u.Value,ram_mib:(r=(c=e==null?void 0:e.SchemeParams)==null?void 0:c.ram_mib)==null?void 0:r.Value,hdd_mib:(f=(m=e==null?void 0:e.SchemeParams)==null?void 0:m.hdd_mib)==null?void 0:f.Value,net_in_mbitps:(S=(b=e==null?void 0:e.SchemeParams)==null?void 0:b.net_in_mbitps)==null?void 0:S.Value,CostMonth:e==null?void 0:e.CostMonth}}function he(){var u,c,r,m,f,b;let e=(r=Object.keys((c=L.value)==null?void 0:c[(u=h.value)==null?void 0:u.ServersGroupID]))==null?void 0:r.find(S=>{var D,P,B,C,M,A,F,T;return((C=(B=(P=L.value)==null?void 0:P[(D=h.value)==null?void 0:D.ServersGroupID])==null?void 0:B[S])==null?void 0:C.IsActive)&&((T=(F=(A=L.value)==null?void 0:A[(M=h.value)==null?void 0:M.ServersGroupID])==null?void 0:F[S])==null?void 0:T.IsDefault)}),s=(b=Object.keys((f=L.value)==null?void 0:f[(m=h.value)==null?void 0:m.ServersGroupID]))==null?void 0:b.find(S=>{var D,P,B,C;return(C=(B=(P=L.value)==null?void 0:P[(D=h.value)==null?void 0:D.ServersGroupID])==null?void 0:B[S])==null?void 0:C.IsActive});return e||s}function fe(e){n.value=e}function oe(){var e,s;R.value=!0,i.VPSOrder({ContractID:w.value,VPSSchemeID:(e=h.value)==null?void 0:e.ID,ServerID:he(),DiskTemplate:(s=G.value)==null?void 0:s.value}).then(({result:u,info:c,error:r})=>{var m;u==="SUCCESS"?i.VPSOrderPay({VPSOrderID:c==null?void 0:c.VPSOrderID,DaysPay:(m=n.value)==null?void 0:m.actualDays,IsChange:!0}).then(f=>{let{result:b,error:S}=f;b==="SUCCESS"?I.push("/VPSOrders"):b==="BASKET"&&I.push("/Basket"),R.value=!0}):R.value=!1})}const be=e=>{we(()=>{const s=document.querySelector(".form-input_border-label input:checked~.form-field__content");s&&s.click()})};function Se(){var e,s;((e=N==null?void 0:N.value)==null?void 0:e.length)>0&&(G.value=(s=N.value)==null?void 0:s[0])}return[_,a]=Z(()=>i.fetchVPSSchemes().then(()=>{var e,s;((e=q.value)==null?void 0:e.length)>0&&(h.value=se((s=q.value)==null?void 0:s[0])),Se()})),await _,a(),[_,a]=Z(()=>g.fetchContracts()),await _,a(),[_,a]=Z(()=>y.fetchServerGroups()),await _,a(),(e,s)=>{var b,S,D,P,B,C,M,A,F,T,ae,le,ne,ce,ue;const u=xe,c=tt,r=Je,m=ge,f=ke;return l(),d(V,null,[j(Ue),t("div",ot,[t("div",at,[t("div",lt,[nt,j(u)])]),t("div",ct,[t("div",ut,[rt,t("div",dt,[t("div",_t,[(l(!0),d(V,null,$(Y.value,o=>(l(),d("div",it,p(o),1))),256))]),(l(!0),d(V,null,$(ve.value,o=>{var x;return l(),z(c,{data:se(o),type:"",modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=J=>h.value=J),name:"config",checked:((x=h.value)==null?void 0:x.ID)===(o==null?void 0:o.ID),headers:Y.value,onInput:be},null,8,["data","modelValue","checked","headers"])}),256))])])]),N.value?(l(),d("div",vt,[t("div",pt,[mt,t("div",ht,[(l(!0),d(V,null,$(N.value,o=>{var x;return l(),z(r,{data:o,modelValue:G.value,"onUpdate:modelValue":s[1]||(s[1]=J=>G.value=J),checked:(o==null?void 0:o.value)===((x=G.value)==null?void 0:x.value),type:"",name:"operating_system"},{default:Pe(()=>[o.imageUrl?(l(),d("img",{key:0,src:o.imageUrl,alt:o.name},null,8,ft)):K("",!0)]),_:2},1032,["data","modelValue","checked"])}),256))])])])):K("",!0),t("div",bt,[t("div",St,[kt,t("div",gt,[(l(!0),d(V,null,$(ie.value,o=>(l(),z(r,{data:o,checked:(o==null?void 0:o.value)===Q,modelValue:Q,"onUpdate:modelValue":s[2]||(s[2]=x=>Q=x),type:"",name:"region"},null,8,["data","checked"]))),256))])])]),j(Ne,{title:"Информация о сервере",modelValue:w.value,"onUpdate:modelValue":s[3]||(s[3]=o=>w.value=o)},null,8,["modelValue"]),j(m,{contractID:w.value,scheme:E.value,serviceID:"30000",isOrderID:!1,onSelect:fe},null,8,["contractID","scheme"]),t("div",yt,[t("div",It,[t("div",Vt,[((D=(S=(b=n.value)==null?void 0:b.discounts)==null?void 0:S.Bonuses)==null?void 0:D.length)>0?(l(),d(V,{key:0},[t("div",Dt,[Pt,t("div",Bt,p(H((P=n.value)==null?void 0:P.price))+" ₽",1)]),(l(!0),d(V,null,$((C=(B=n.value)==null?void 0:B.discounts)==null?void 0:C.Bonuses,o=>(l(),d("div",Ct,[t("div",wt,"Скидка "+p(o==null?void 0:o.Discount)+"% на "+p(o==null?void 0:o.Days)+" дней",1),t("div",xt,"-"+p(H(o==null?void 0:o.Economy))+" ₽",1)]))),256))],64)):K("",!0),de(t("div",Ot,[$t,t("div",Et,[t("span",null,[t("s",null,p(H((M=n.value)==null?void 0:M.price))+" ₽",1)]),t("span",Nt,"-"+p(te())+" ₽",1)])],512),[[_e,((T=(F=(A=n.value)==null?void 0:A.discounts)==null?void 0:F.Bonuses)==null?void 0:T.length)>0]]),de(t("div",Ut,[t("div",Gt,"Итого за "+p((ae=n.value)==null?void 0:ae.label),1),t("div",Lt,p(H(((le=n.value)==null?void 0:le.price)-te()))+" ₽",1)],512),[[_e,(ne=n.value)==null?void 0:ne.price]])]),j(f,{class:"btn--wide",label:((ce=pe.value[w.value])==null?void 0:ce.Balance)>((ue=n.value)==null?void 0:ue.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:n.value===null||w.value===null,"is-loading":R.value,onClick:s[4]||(s[4]=o=>oe())},null,8,["label","disabled","is-loading"])])])])],64)}}},ss=W(Mt,[["__scopeId","data-v-fea42833"]]);export{ss as default};
