import{_ as Q}from"./FormInputSearch-d1c13d60.js";import{_ as W}from"./ClausesKeeper-9aa8ead7.js";import{_ as X}from"./ButtonDefault-a8aacc82.js";import{_ as P,o as D,c as x,a as e,m as U,b as c,r as g,h as R,w as n,t as v,L as k,k as Y,p as O,l as A,e as M,g as L,j as Z,ao as z,d as S,u as ee,R as te,a6 as se,af as q,x as G}from"./index-ed1f28f8.js";import{u as j}from"./contracts-cedf6a91.js";import{F as oe}from"./FormTabs-5c38953b.js";import{F as ae,z as ne,d as le,C as H}from"./bootstrap-vue-next.es-79226723.js";import{_ as re}from"./IconDots-296f1d69.js";import{f as ce,a as _e}from"./useTimeFunction-8602dd60.js";import{_ as ie}from"./IconCard-ec16e358.js";import{s as ue}from"./multiselect-198a8c51.js";import{S as pe}from"./StatusBadge-2304b071.js";import"./IconPlus-56dc71c7.js";import"./IconSearch-518c61a1.js";import"./IconClose-a1e58263.js";const de={},me={class:"page-title"},ve={class:"page-title__title"},fe={class:"page-title__buttons"};function be(r,d){return D(),x("div",me,[e("div",ve,[U(r.$slots,"title",{},void 0,!0)]),e("div",fe,[U(r.$slots,"buttons",{},void 0,!0)])])}const ge=P(de,[["render",be],["__scopeId","data-v-b876c21b"]]),ye=[{key:"ID",label:"Номер",variant:"td-gray td-order",sortable:!0},{key:"CreateDate",label:"Дата Создания",variant:"td-gray td-order",sortable:!0},{key:"Customer",label:"Договор"},{key:"Orders",label:"Количество подключенных услуг",sortable:!0,variant:"td-gray td-order"},{key:"Balance",label:"Баланс",sortable:!0,variant:"td-gray td-order"},{key:"controls",label:"",variant:"td-controls"}];const he={class:"button-payment"},Ce={class:"button-payment__text"},Ie={__name:"FormButtonPayment",setup(r){return(d,u)=>(D(),x("button",he,[c(ie,{class:"button-payment__icon"}),e("span",Ce,[U(d.$slots,"default",{},void 0,!0)])]))}},De=P(Ie,[["__scopeId","data-v-fcb8fa3c"]]);const J=r=>(O("data-v-64d83888"),r=r(),A(),r),$e={key:0,class:"table-controls"},ke=J(()=>e("span",{class:"text-success"},"First",-1)),Te=J(()=>e("span",{class:"text-info"},"Last",-1)),we={class:"multiselect-multiple-label"},Le={class:"multiselect-option"},Pe={__name:"PaginationBlock",props:["modelValue","total_rows"],emits:["update:modelValue","updatePage"],setup(r,{emit:d}){const u=r,i=[10,25,50,100],_=g({current_page:1,per_page:10});return R(_.value,()=>{d("updatePage",_.value)}),(h,f)=>{const C=ae;return u.total_rows>0?(D(),x("div",$e,[c(C,{modelValue:_.value.current_page,"onUpdate:modelValue":f[0]||(f[0]=a=>_.value.current_page=a),"total-rows":u.total_rows,"per-page":_.value.per_page,"first-number":"","last-number":""},{"first-text":n(()=>[ke]),"last-text":n(()=>[Te]),page:n(({page:a,active:y})=>[e("span",null,v((a-1)*_.value.per_page+1)+"-"+v(a*_.value.per_page),1)]),_:1},8,["modelValue","total-rows","per-page"]),c(k(ue),{class:"multiselect--white",modelValue:_.value.per_page,"onUpdate:modelValue":f[1]||(f[1]=a=>_.value.per_page=a),options:i,label:"name",openDirection:"top",onInput:f[2]||(f[2]=a=>_.value.current_page=1)},{singlelabel:n(({value:a})=>[e("div",we,[e("span",null,"Отображать "+v(a.value)+" строк",1)])]),option:n(({option:a})=>[e("div",Le,"Отображать "+v(a.name)+" строк",1)]),_:1},8,["modelValue"])])):Y("",!0)}}},K=P(Pe,[["__scopeId","data-v-64d83888"]]);const B=r=>(O("data-v-3eda493e"),r=r(),A(),r),xe={class:"contracts-list"},Se=B(()=>e("span",{class:"td-mobile"},"Номер",-1)),Be={class:"td-column-heavy"},Ve={class:"table-td-gray"},Fe=B(()=>e("span",{class:"td-mobile"},"Дата Создания",-1)),Ne={class:"d-block"},Ee=B(()=>e("span",{class:"td-mobile"},"Договор",-1)),Ue={class:"td-column-heavy"},Re={class:"table-td-blue"},Oe=B(()=>e("span",{class:"td-mobile"},"Баланс",-1)),Ae=B(()=>e("span",{class:"td-mobile"},"Количество подключенных услуг",-1)),Me={class:"btn__group"},je={class:"dropdown-button"},qe={class:"btn btn--dots"},Ge={__name:"ContractsList",props:{search:{type:String,default:""}},setup(r){const d=r,u=M(),i=j(),_=g("CreateDate"),h=g(!0),f=g("desc"),C=g(10),a=g(1),y=L(()=>{var l,b;return(b=(l=Object.keys(i==null?void 0:i.contractsList))==null?void 0:l.map(o=>i==null?void 0:i.contractsList[o]))==null?void 0:b.reverse()}),T=L(()=>{var l;return(l=y.value.filter(b=>{var o;return b.Customer.toLowerCase().includes(((o=d.search)==null?void 0:o.toLowerCase())||"")}))==null?void 0:l.length});function $(l){u.push(`/Balance/${l}`)}function w(l={}){C.value=l==null?void 0:l.per_page,a.value=l==null?void 0:l.current_page}function F(l){i==null||i.contractDownload({ContractID:l})}return R(()=>d,()=>{console.log("123"),a.value=1}),(l,b)=>{const o=re,p=Z("router-link"),m=ne,N=le,E=H;return D(),x("div",xe,[c(E,{class:"basic-table",items:y.value,fields:k(ye),"show-empty":!0,filterable:[],filter:d.search,"per-page":C.value,"sort-desc":h.value,"onUpdate:sortDesc":b[0]||(b[0]=s=>h.value=s),"sort-by":_.value,"onUpdate:sortBy":b[1]||(b[1]=s=>_.value=s),"sort-direction":f.value,"current-page":a.value,"empty-text":"У вас пока нет договоров.","empty-filtered-text":"Договора не найдены."},{"cell(ID)":n(s=>{var t;return[Se,e("div",Be,[e("div",Ve,v(k(z).transformContractNumber((t=s.item)==null?void 0:t.ID)),1)])]}),"cell(CreateDate)":n(s=>{var t;return[Fe,e("span",Ne,v(k(ce)(k(_e)((t=s.item)==null?void 0:t.CreateDate))),1)]}),"cell(Customer)":n(s=>{var t;return[Ee,e("div",Ue,[e("div",Re,v((t=s.item)==null?void 0:t.Customer),1)])]}),"cell(Balance)":n(s=>{var t;return[Oe,e("span",null,v((t=s.item)==null?void 0:t.Balance)+" ₽",1)]}),"cell(Orders)":n(s=>{var t;return[Ae,e("span",null,v((t=s.item)==null?void 0:t.Orders),1)]}),"cell(controls)":n(s=>[e("div",Me,[c(De,{onClick:t=>{var I;return $((I=s.item)==null?void 0:I.ID)}},{default:n(()=>[S("Пополнить баланс")]),_:2},1032,["onClick"]),e("div",je,[c(N,{class:"dropdown-dots",right:""},{"button-content":n(()=>[e("div",qe,[c(o)])]),default:n(()=>[c(m,null,{default:n(()=>{var t;return[c(p,{to:`/ContractScheme/${(t=s.item)==null?void 0:t.ID}`},{default:n(()=>[S("Открыть")]),_:2},1032,["to"])]}),_:2},1024),c(m,null,{default:n(()=>{var t;return[c(p,{to:`/ContractSettings/${(t=s.item)==null?void 0:t.ID}`},{default:n(()=>[S("Изменить тип учёта")]),_:2},1032,["to"])]}),_:2},1024),c(m,{onClick:t=>{var I;return F((I=s.item)==null?void 0:I.ID)}},{default:n(()=>[S("Загрузить договор")]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["items","fields","filter","per-page","sort-desc","sort-by","sort-direction","current-page"]),c(K,{total_rows:T.value,onUpdatePage:w},null,8,["total_rows"])])}}},ze=P(Ge,[["__scopeId","data-v-3eda493e"]]),He=[{key:"ID",label:"Номер",variant:"td-gray td-order",sortable:!0},{key:"Name",label:"Профиль",variant:"td-blue"},{key:"TemplateID",label:"Тип",variant:"td-gray td-order"},{key:"StatusID",label:"Статус",sortable:!0,variant:"td-gray td-order"},{key:"StatusDate",label:"От статуса",sortable:!0,variant:"td-default td-order"}];const V=r=>(O("data-v-aab722c9"),r=r(),A(),r),Je={class:"contracts-profile-list"},Ke=V(()=>e("span",{class:"td-mobile"},"Номер",-1)),Qe={class:"d-block"},We=V(()=>e("span",{class:"td-mobile"},"Номер",-1)),Xe=V(()=>e("span",{class:"td-mobile"},"От статуса",-1)),Ye={class:"d-block"},Ze=V(()=>e("span",{class:"td-mobile"},"Тип",-1)),et=V(()=>e("span",{class:"td-mobile"},"Статус",-1)),tt={__name:"ContractsProfileList",props:["search"],setup(r){const d=r;M();const u=j(),i=ee(),_=te("emitter"),h=g("ID"),f=g(!0),C=g("desc"),a=g(10),y=g(1),T=L(()=>{var o,p;return(p=(o=Object==null?void 0:Object.keys(u==null?void 0:u.profileList))==null?void 0:o.map(m=>u==null?void 0:u.profileList[m]))==null?void 0:p.reverse()}),$=L(()=>{var o,p;return(p=(o=i.ConfigList)==null?void 0:o.Profiles)==null?void 0:p.Templates}),w=L(()=>{var o;return(o=T.value.filter(p=>{var m;return p.Name.toLowerCase().includes(((m=d.search)==null?void 0:m.toLowerCase())||"")}))==null?void 0:o.length});function F(o={}){a.value=o==null?void 0:o.per_page,y.value=o==null?void 0:o.current_page}function l(o){_.emit("open-modal",{component:"ProfileInfo",data:{data:o,template:$.value[o.TemplateID]}})}function b(o){return Math.floor((new Date().getTime()-o*1e3)/(1e3*60*60*24))}return(o,p)=>{const m=pe,N=H,E=K;return D(),x("div",Je,[c(N,{class:"basic-table",items:T.value,fields:k(He),"show-empty":!0,filterable:[],filter:d.search,"per-page":a.value,"sort-desc":f.value,"onUpdate:sortDesc":p[0]||(p[0]=s=>f.value=s),"sort-by":h.value,"onUpdate:sortBy":p[1]||(p[1]=s=>h.value=s),"sort-direction":C.value,"current-page":y.value,"empty-text":"У вас пока нет профилей.","empty-filtered-text":"Профили не найдены.",onRowClicked:l},{"cell(ID)":n(s=>{var t;return[Ke,e("span",Qe,v(k(z).transformContractNumber((t=s.item)==null?void 0:t.ID)),1)]}),"cell(Name)":n(s=>{var t;return[We,e("span",null,v((t=s.item)==null?void 0:t.Name),1)]}),"cell(StatusDate)":n(s=>{var t;return[Xe,e("span",Ye,v(b((t=s.item)==null?void 0:t.StatusDate))+" дн.",1)]}),"cell(TemplateID)":n(s=>{var t,I;return[Ze,e("span",null,v((I=$.value[(t=s.item)==null?void 0:t.TemplateID])==null?void 0:I.Name),1)]}),"cell(StatusID)":n(s=>[et,c(m,{status:s.value,"status-table":"Profiles"},null,8,["status"])]),_:1},8,["items","fields","filter","per-page","sort-desc","sort-by","sort-direction","current-page"]),c(E,{total_rows:w.value,onUpdatePage:F},null,8,["total_rows"])])}}},st=P(tt,[["__scopeId","data-v-aab722c9"]]);const ot={class:"section"},at={class:"container"},nt={class:"list-form"},lt={class:"contracts__page"},rt={__name:"Contracts",async setup(r){var $,w;let d,u;const i=se(),_=M(),h=j(),f=[{value:"Contracts",name:"Договора"},{value:"Profiles",name:"Профили"}],C=L(()=>a.value==="Contracts"?"Договора":"Профили"),a=g("Contracts"),y=g("");function T(){a.value==="Contracts"?_.push({path:"/ContractMake"}):_.push({path:"/ProfileMake"})}return($=i==null?void 0:i.query)!=null&&$.section?a.value=(w=i.query)==null?void 0:w.section:_.replace({query:{section:"Contracts"}}),R(a,()=>{_.replace({query:{section:a.value}})}),[d,u]=q(()=>h.fetchContracts()),await d,u(),[d,u]=q(()=>h.fetchProfiles()),await d,u(),(F,l)=>{const b=X,o=W,p=Q;return D(),x("div",ot,[e("div",at,[c(oe,{tabs:f,modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=m=>a.value=m)},null,8,["modelValue"]),c(ge,null,{title:n(()=>[S(v(C.value),1)]),buttons:n(()=>[c(b,{label:a.value==="Contracts"?"Создать договор":"Создать профиль",onClick:T},null,8,["label"])]),_:1}),c(o),e("div",nt,[c(p,{modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=m=>y.value=m)},null,8,["modelValue"])]),e("div",lt,[a.value==="Contracts"?(D(),G(ze,{key:0,search:y.value},null,8,["search"])):(D(),G(st,{key:1,search:y.value},null,8,["search"]))])])])}}},Dt=P(rt,[["__scopeId","data-v-f4444efa"]]);export{Dt as default};
