import{_ as B}from"./ButtonDefault-CMw2aBy6.js";import{m as T}from"./bootstrap-vue-next-W16P-SAV.js";import{u as h}from"./index-BO2gwtUe.js";import{s as j}from"./multiselect-DElL0Rlw.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as v,f as D,I as O,m as U,o as w,c as k,t as c,h as M,a as s,e as P,b as f,w as V,v as A,S as F,x as R,s as W}from"./index-Codq73aV.js";const J={key:0,class:"section-block_title"},K={class:"form-field form-field--basic"},q={class:"form-field-input__wrapper"},z={class:"multiselect-option"},G={__name:"BlockSelectProfile",props:["modelValue","title","items","domainOwner"],emits:["update:modelValue","buttonClicked"],setup(i,{emit:b}){const d=i,I=b,o=h(),r=v(null),u=D(()=>{const n=Object.keys(o.profileList).map(l=>{const e=o.profileList[l].TemplateID;if(e==="Natural"||e==="Juridical"||e==="Individual"||e==="NaturalPartner")return{value:o.profileList[l].ID,name:o.profileList[l].Name,contractID:o.profileList[l].ContractID}}).filter(Boolean);return d.domainOwner?n.filter(l=>{const e=o.profileList[l.value].TemplateID;return e==="Natural"||e==="Juridical"}):n});function p(n){I("update:modelValue",n)}return O(()=>{o.profileList&&(r.value=Object.keys(o.profileList)?.[0])}),U(d,()=>{r.value=d.modelValue}),(n,l)=>(w(),k("section",null,[i.title?(w(),k("h2",J,c(i.title),1)):M("",!0),s("div",K,[l[1]||(l[1]=s("div",{class:"form-field__label"},[P(" Выбрать профиль "),s("span",null,"*")],-1)),s("div",q,[f(A(j),{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=e=>r.value=e),class:"multiselect--white",placeholder:"Выбрать профиль",label:"name",options:i.items||u.value,disabled:i.items?.length<=1&&u.value?.length<=1,onChange:p},{singlelabel:V(({value:e})=>[s("span",null,"# "+c(String(e.value).padStart(5,"0"))+" / "+c(e.name),1)]),option:V(({option:e})=>[s("div",z," # "+c(String(e.value).padStart(5,"0"))+" / "+c(e.name),1)]),_:1},8,["modelValue","options","disabled"])])])]))}},H=N(G,[["__scopeId","data-v-0f66eebc"]]),Q={class:"modal__body"},X={class:"list-item__title"},Y={class:"modal__input-row"},Z={class:"modal__input-row"},ee={class:"modal__buttons-wrap"},te={__name:"ModalWindowDomainSelectOwner",props:["data"],emits:["modalClose","buttonClicked"],setup(i,{emit:b}){const d=F(),I=h(),o=v(null),r=v(!1),u=v(!1),p=R("emitter"),n=i,l=b,e=D(()=>{const a=Object.values(d.domainsList);return n.data.OrderID!==void 0&&n.data.OrderID!==null?a.filter(t=>t.OrderID===n.data.OrderID):null}),_=D(()=>I?.profileList),E=D(()=>Object.keys(_?.value).map(a=>({value:_.value?.[a]?.ID,name:_.value?.[a]?.Name})));O(()=>{E?.value.length<1&&p.emit("open-modal",{component:"NewProfile"})});function g(){l("modalClose")}function x(){p.emit("open-modal",{component:"AcceptCreateProfile"})}function L(){u.value=!0;let a;e.value&&e.value!==void 0?a=e.value[0].ID:a=n.data.DomainOrderID;const t={DomainOrderID:a,OwnerTypeID:"Profile",ProfileID:_.value[o.value]?.ID,Agree:r.value?"yes":"no"};d.DomainSelectOwner(t).then(({result:S,resultData:y})=>{S==="SUCCESS"&&g(),u.value=!1})}const C=a=>{a.key==="Enter"&&L()};return O(()=>{document.addEventListener("keyup",C),d.fetchDomainOrders()}),W(()=>{document.removeEventListener("keyup",C)}),(a,t)=>{const S=H,y=T,$=B;return w(),k("div",Q,[s("div",X," Владелец домена "+c(i.data?.Domain?i.data?.Domain:e.value?.[0]?.Domain),1),s("div",Y,[f(S,{title:"",modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=m=>o.value=m),domainOwner:!0,onButtonClicked:t[1]||(t[1]=m=>g())},null,8,["modelValue"])]),s("div",Z,[f(y,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=m=>r.value=m)},{default:V(()=>t[5]||(t[5]=[P(" Согласен на передачу моих персональных данных регистратору ",-1)])),_:1,__:[5]},8,["modelValue"])]),s("div",ee,[f($,{class:"select-contract__button modal__button",label:"Создать новый профиль",onClick:t[3]||(t[3]=m=>x())}),f($,{class:"modal__button",label:"Сохранить",disabled:!r.value||o.value===null,"is-loading":u.value,onClick:t[4]||(t[4]=m=>L())},null,8,["disabled","is-loading"])])])}}},re=N(te,[["__scopeId","data-v-7e7d11bf"]]);export{re as default};
