import{_ as Q}from"./EmptyStateBlock-D6U_EDq6.js";import{L as W,a as X}from"./bootstrap-vue-next-3DpAa4tb.js";import{_ as Y}from"./StatusBadge-B65ys1I-.js";import{_ as Z}from"./FormInputSearch-D7D7Vqhf.js";import{_ as ee}from"./ClausesKeeper-DVJgfLR3.js";import{_ as te}from"./BlockBalanceAgreement-2iQbaweR.js";import{u as se}from"./edesks-DIBbT3px.js";import{ao as oe,r as a,f as k,D as le,m as T,c as E,b as n,a as s,C as ae,w as l,E as ne,v as d,F as B,d as re,x as ie,o as g,e as ue,t as r}from"./index-CipWZKo_.js";import{s as C}from"./multiselect-DWCHRlfT.js";import{f as me,s as pe}from"./time-DenPiOX5.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./IconPlus-bAw7b_ly.js";import"./IconClose-ChC2G6HM.js";import"./contracts-CILh9uSu.js";import"./ButtonDefault-CghIUDY0.js";const de={class:"tw-px-4 md:tw-px-8"},ve={class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-2 tw-mb-4"},_e={class:"list-form"},fe={class:"list-form_col list-form_col--sm"},be={class:"list-form_select"},ke={class:"multiselect-option"},ge={class:"d-block"},De={class:"cell__theme"},we={class:"table-controls"},ye={class:"multiselect-multiple-label"},xe={class:"multiselect-option"},Se={__name:"Tickets",async setup(Ve){let D,w;const U=[{key:"ID",label:"Номер"},{key:"UpdateDate",label:"Дата и время",sortable:!0,variant:"td-gray td-order"},{key:"Theme",label:"Тема"},{key:"Messages",label:"Количество сообщений"},{key:"StatusID",label:"Статус",sortable:!0,variant:"td-gray td-order"}],y=se(),N=oe(),$=ie("emitter"),x=re(),u=a("*"),m=a(""),p=a(1),i=a(10),v=a(0),j=a([10,25,50,100]),_=a([]),S=a("UpdateDate"),V=a(!0),F=a("desc"),I=k(()=>y?.eDesksList),f=k(()=>N.data),c=k(()=>Object.keys(I.value)?.map(o=>I.value?.[o])?.reverse());[D,w]=le(()=>y.fetchEDesks().then(()=>{v.value=c.value.length,f.value?.Statuses?.Edesks&&(_.value=Object.keys(f.value?.Statuses?.Edesks)?.map(o=>({value:o,name:f.value?.Statuses?.Edesks?.[o]?.Name}))),_.value.push({value:"*",name:"Все тикеты"})})),await D,w();function L(){x.go(0)}function H(o){$.emit("open-modal",{component:"StatusHistory",data:{modeID:"Edesks",rowID:o}})}function O(o){return o?.filter(e=>u.value==="*"?!0:e?.StatusID===u?.value)?.filter(e=>String(e?.ID).includes(m.value)||e?.Theme.includes(m.value))}function R(o){return v.value=o.length>0?o.length:1,o}function A(o,e,b){b.target.closest("button, a, .clickable-element")||x.push({path:`Ticket/${o?.ID}`})}return T(m,()=>{p.value=1}),T(u,()=>{p.value=1}),(o,e)=>{const b=te,M=ne("router-link"),P=ee,h=Z,q=Y,z=W,G=X,J=Q;return g(),E(B,null,[n(b),s("div",de,[s("div",ve,[s("h1",{class:"tw-text-xl sm:tw-text-4xl tw-cursor-pointer",onClick:e[0]||(e[0]=t=>L())},"Служба поддержки"),n(M,{class:"btn btn--blue btn-default",to:"/NewTicket"},{default:l(()=>e[7]||(e[7]=[ue("Создать тикет",-1)])),_:1,__:[7]})]),n(P,{partition:"Header:/Tickets"}),s("div",_e,[s("div",fe,[s("div",be,[n(d(C),{options:_.value,label:"name",modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t)},{option:l(({option:t})=>[s("div",ke,r(t.name),1)]),_:1},8,["options","modelValue"])])]),n(h,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t)},null,8,["modelValue"])]),c.value&&c.value.length?(g(),E(B,{key:0},[n(z,{class:"basic-table",items:R(O(c.value)),"per-page":i.value,"current-page":p.value,fields:U,"show-empty":"","sort-by":S.value,"onUpdate:sortBy":e[3]||(e[3]=t=>S.value=t),"sort-desc":V.value,"onUpdate:sortDesc":e[4]||(e[4]=t=>V.value=t),"sort-direction":F.value,onRowClicked:A},{"cell(ID)":l(t=>[e[8]||(e[8]=s("span",{class:"td-mobile"},"Номер",-1)),s("span",ge,r(t.value),1)]),"cell(UpdateDate)":l(t=>[e[9]||(e[9]=s("span",{class:"td-mobile"},"Дата и время",-1)),s("span",null,r(d(me)(d(pe)(t.value))),1)]),"cell(Theme)":l(t=>[e[10]||(e[10]=s("span",{class:"td-mobile"},"Тема",-1)),s("span",De,r(t.value),1)]),"cell(MessageID)":l(t=>[e[11]||(e[11]=s("span",{class:"td-mobile"},"Количество сообщений",-1)),s("span",null,r(t.value),1)]),"cell(StatusID)":l(t=>[n(q,{class:"clickable-element",status:t.value,"status-table":"Edesks",onClick:K=>H(t.item?.ID)},null,8,["status","onClick"])]),empty:l(()=>e[12]||(e[12]=[s("span",null,"Ничего не найдено",-1)])),emptyfiltered:l(()=>e[13]||(e[13]=[s("span",null,"Ничего не найдено",-1)])),_:1},8,["items","per-page","current-page","sort-by","sort-desc","sort-direction"]),s("div",we,[n(G,{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=t=>p.value=t),"total-rows":v.value,"per-page":i.value,"first-number":"","last-number":""},{"first-text":l(()=>e[14]||(e[14]=[s("span",{class:"text-success"},"First",-1)])),"last-text":l(()=>e[15]||(e[15]=[s("span",{class:"text-info"},"Last",-1)])),page:l(({page:t,active:K})=>[s("span",null,r((t-1)*i.value+1)+"-"+r(t*i.value),1)]),_:1},8,["modelValue","total-rows","per-page"]),n(d(C),{class:"multiselect--white",modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=t=>i.value=t),options:j.value,label:"name",openDirection:"top"},{singlelabel:l(({value:t})=>[s("div",ye,[s("span",null,"Отображать "+r(t.value)+" строк",1)])]),option:l(({option:t})=>[s("div",xe,"Отображать "+r(t.name)+" строк",1)]),_:1},8,["modelValue","options"])])],64)):(g(),ae(J,{key:1,class:"no-margin",label:"Вы пока не обращались в тех. поддержку "}))])],64)}}},Me=ce(Se,[["__scopeId","data-v-3b42fb68"]]);export{Me as default};
