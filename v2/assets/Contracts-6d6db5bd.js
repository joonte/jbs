import{_ as Z}from"./FormInputSearch-29c276f6.js";import{_ as ee}from"./ClausesKeeper-68df7f35.js";import{_ as te}from"./ButtonDefault-f91c301e.js";import{_ as F,o as k,c as E,b as l,a as t,m as oe,r as g,h as M,w as a,t as v,L,k as Y,p as j,l as q,e as G,u as J,g as P,i as se,j as ae,ao as K,x as A,d as V,R as ne,a7 as le,ag as H,F as re}from"./index-4434f005.js";import{u as z}from"./contracts-d017d511.js";import{S as ce}from"./SlotPageTitle-bcac22a0.js";import{F as _e}from"./FormTabs-858a9d91.js";import{F as ie,z as ue,d as pe,C as Q}from"./bootstrap-vue-next.es-5d8af788.js";import{_ as de}from"./IconDots-a0319d0c.js";import{f as me,a as ve}from"./useTimeFunction-8602dd60.js";import{_ as fe}from"./IconCard-285cc6ac.js";import{s as be}from"./multiselect-eb561fe9.js";import{S as ge}from"./StatusBadge-129e5649.js";import{B as ye}from"./BlockBalanceAgreement-4e844242.js";import"./IconPlus-6c2cbbce.js";import"./IconSearch-d168a9f9.js";import"./IconClose-0cfbf563.js";import"./IconArrow-6847c901.js";const Ce=[{key:"ID",label:"Номер",variant:"td-gray td-order",sortable:!0},{key:"CreateDate",label:"Дата Создания",variant:"td-gray td-order",sortable:!0},{key:"Customer",label:"Договор"},{key:"TypeID",label:"Тип",variant:"td-gray td-order"},{key:"Orders",label:"Количество подключенных услуг",sortable:!0,variant:"td-gray td-order"},{key:"Balance",label:"Баланс",sortable:!0,variant:"td-gray td-order"},{key:"controls",label:"",variant:"td-controls"}];const he={class:"button-payment"},De={class:"button-payment__text"},Ie={__name:"FormButtonPayment",setup(c){return(d,u)=>(k(),E("button",he,[l(fe,{class:"button-payment__icon"}),t("span",De,[oe(d.$slots,"default",{},void 0,!0)])]))}},ke=F(Ie,[["__scopeId","data-v-fcb8fa3c"]]);const W=c=>(j("data-v-64d83888"),c=c(),q(),c),Te={key:0,class:"table-controls"},$e=W(()=>t("span",{class:"text-success"},"First",-1)),Le=W(()=>t("span",{class:"text-info"},"Last",-1)),Pe={class:"multiselect-multiple-label"},we={class:"multiselect-option"},Se={__name:"PaginationBlock",props:["modelValue","total_rows"],emits:["update:modelValue","updatePage"],setup(c,{emit:d}){const u=c,i=[10,25,50,100],_=g({current_page:1,per_page:10});return M(_.value,()=>{d("updatePage",_.value)}),(h,f)=>{const T=ie;return u.total_rows>0?(k(),E("div",Te,[l(T,{modelValue:_.value.current_page,"onUpdate:modelValue":f[0]||(f[0]=o=>_.value.current_page=o),"total-rows":u.total_rows,"per-page":_.value.per_page,"first-number":"","last-number":""},{"first-text":a(()=>[$e]),"last-text":a(()=>[Le]),page:a(({page:o,active:y})=>[t("span",null,v((o-1)*_.value.per_page+1)+"-"+v(o*_.value.per_page),1)]),_:1},8,["modelValue","total-rows","per-page"]),l(L(be),{class:"multiselect--white",modelValue:_.value.per_page,"onUpdate:modelValue":f[1]||(f[1]=o=>_.value.per_page=o),options:i,label:"name",openDirection:"top",onInput:f[2]||(f[2]=o=>_.value.current_page=1)},{singlelabel:a(({value:o})=>[t("div",Pe,[t("span",null,"Отображать "+v(o.value)+" строк",1)])]),option:a(({option:o})=>[t("div",we,"Отображать "+v(o.name)+" строк",1)]),_:1},8,["modelValue"])])):Y("",!0)}}},X=F(Se,[["__scopeId","data-v-64d83888"]]);const S=c=>(j("data-v-68776163"),c=c(),q(),c),xe={class:"contracts-list"},Be=S(()=>t("span",{class:"td-mobile"},"Номер",-1)),Ne={class:"td-column-heavy"},Ve={class:"table-td-gray"},Fe=S(()=>t("span",{class:"td-mobile"},"Дата Создания",-1)),Ee={class:"d-block"},Re=S(()=>t("span",{class:"td-mobile"},"Договор",-1)),Ue={class:"td-column-heavy"},Oe={class:"table-td-blue"},Ae=S(()=>t("span",{class:"td-mobile"},"Тип договора",-1)),Me=S(()=>t("span",{class:"td-mobile"},"Баланс",-1)),je=S(()=>t("span",{class:"td-mobile"},"Количество подключенных услуг",-1)),qe={class:"btn__group"},Ge={class:"dropdown-button"},ze={class:"btn btn--dots"},He={__name:"ContractsList",props:{search:{type:String,default:""}},setup(c){const d=c,u=G(),i=z(),_=J(),h=g("CreateDate"),f=g(!0),T=g("desc"),o=g(10),y=g(1),D=P(()=>{var e,s;return(s=(e=Object.keys(i==null?void 0:i.contractsList))==null?void 0:e.map(p=>i==null?void 0:i.contractsList[p]))==null?void 0:s.reverse()}),$=P(()=>{var e,s;return(s=(e=_.ConfigList)==null?void 0:e.Contracts)==null?void 0:s.Types}),w=P(()=>{var e;return(e=D.value.filter(s=>{var p;return s.Customer.toLowerCase().includes(((p=d.search)==null?void 0:p.toLowerCase())||"")}))==null?void 0:e.length});function U(e){u.push(`/Balance/${e}`)}se(()=>{console.log(D)});function I(e={}){o.value=e==null?void 0:e.per_page,y.value=e==null?void 0:e.current_page}function x(e){i==null||i.contractDownload({ContractID:e})}return M(()=>d,()=>{console.log("123"),y.value=1}),(e,s)=>{const p=de,O=ae("router-link"),B=ue,m=pe,b=Q;return k(),E("div",xe,[l(b,{class:"basic-table",items:D.value,fields:L(Ce),"show-empty":!0,filterable:[],filter:d.search,"per-page":o.value,"sort-desc":f.value,"onUpdate:sortDesc":s[0]||(s[0]=n=>f.value=n),"sort-by":h.value,"onUpdate:sortBy":s[1]||(s[1]=n=>h.value=n),"sort-direction":T.value,"current-page":y.value,"empty-text":"У вас пока нет договоров.","empty-filtered-text":"Договора не найдены."},{"cell(ID)":a(n=>{var r;return[Be,t("div",Ne,[t("div",Ve,v(L(K).transformContractNumber((r=n.item)==null?void 0:r.ID)),1)])]}),"cell(CreateDate)":a(n=>{var r;return[Fe,t("span",Ee,v(L(me)(L(ve)((r=n.item)==null?void 0:r.CreateDate))),1)]}),"cell(Customer)":a(n=>{var r;return[Re,t("div",Ue,[t("div",Oe,v((r=n.item)==null?void 0:r.Customer),1)])]}),"cell(TypeID)":a(n=>{var r,C;return[Ae,t("span",null,v((C=$.value[(r=n.item)==null?void 0:r.TypeID])==null?void 0:C.Name),1)]}),"cell(Balance)":a(n=>{var r;return[Me,t("span",null,v((r=n.item)==null?void 0:r.Balance)+" ₽",1)]}),"cell(Orders)":a(n=>{var r;return[je,t("span",null,v((r=n.item)==null?void 0:r.Orders),1)]}),"cell(controls)":a(n=>{var r;return[t("div",qe,[((r=n.item)==null?void 0:r.TypeID)!="NaturalPartner"?(k(),A(ke,{key:0,onClick:C=>{var N;return U((N=n.item)==null?void 0:N.ID)}},{default:a(()=>[V("Пополнить баланс")]),_:2},1032,["onClick"])):Y("",!0),t("div",Ge,[l(m,{class:"dropdown-dots",right:""},{"button-content":a(()=>[t("div",ze,[l(p)])]),default:a(()=>[l(B,null,{default:a(()=>{var C;return[l(O,{to:`/ContractScheme/${(C=n.item)==null?void 0:C.ID}`},{default:a(()=>[V("Открыть")]),_:2},1032,["to"])]}),_:2},1024),l(B,null,{default:a(()=>{var C;return[l(O,{to:`/ContractSettings/${(C=n.item)==null?void 0:C.ID}`},{default:a(()=>[V("Изменить тип учёта")]),_:2},1032,["to"])]}),_:2},1024),l(B,{onClick:C=>{var N;return x((N=n.item)==null?void 0:N.ID)}},{default:a(()=>[V("Загрузить договор")]),_:2},1032,["onClick"])]),_:2},1024)])])]}),_:1},8,["items","fields","filter","per-page","sort-desc","sort-by","sort-direction","current-page"]),l(X,{total_rows:w.value,onUpdatePage:I},null,8,["total_rows"])])}}},Ye=F(He,[["__scopeId","data-v-68776163"]]),Je=[{key:"ID",label:"Номер",variant:"td-gray td-order",sortable:!0},{key:"Name",label:"Профиль",variant:"td-blue"},{key:"TemplateID",label:"Тип",variant:"td-gray td-order"},{key:"StatusID",label:"Статус",sortable:!0,variant:"td-gray td-order"},{key:"StatusDate",label:"От статуса",sortable:!0,variant:"td-default td-order"}];const R=c=>(j("data-v-aab722c9"),c=c(),q(),c),Ke={class:"contracts-profile-list"},Qe=R(()=>t("span",{class:"td-mobile"},"Номер",-1)),We={class:"d-block"},Xe=R(()=>t("span",{class:"td-mobile"},"Номер",-1)),Ze=R(()=>t("span",{class:"td-mobile"},"От статуса",-1)),et={class:"d-block"},tt=R(()=>t("span",{class:"td-mobile"},"Тип",-1)),ot=R(()=>t("span",{class:"td-mobile"},"Статус",-1)),st={__name:"ContractsProfileList",props:["search"],setup(c){const d=c;G();const u=z(),i=J(),_=ne("emitter"),h=g("ID"),f=g(!0),T=g("desc"),o=g(10),y=g(1),D=P(()=>{var e,s;return(s=(e=Object==null?void 0:Object.keys(u==null?void 0:u.profileList))==null?void 0:e.map(p=>u==null?void 0:u.profileList[p]))==null?void 0:s.reverse()}),$=P(()=>{var e,s;return(s=(e=i.ConfigList)==null?void 0:e.Profiles)==null?void 0:s.Templates}),w=P(()=>{var e;return(e=D.value.filter(s=>{var p;return s.Name.toLowerCase().includes(((p=d.search)==null?void 0:p.toLowerCase())||"")}))==null?void 0:e.length});function U(e={}){o.value=e==null?void 0:e.per_page,y.value=e==null?void 0:e.current_page}function I(e){_.emit("open-modal",{component:"ProfileInfo",data:{data:e,template:$.value[e.TemplateID]}})}function x(e){return Math.floor((new Date().getTime()-e*1e3)/(1e3*60*60*24))}return(e,s)=>{const p=ge,O=Q,B=X;return k(),E("div",Ke,[l(O,{class:"basic-table",items:D.value,fields:L(Je),"show-empty":!0,filterable:[],filter:d.search,"per-page":o.value,"sort-desc":f.value,"onUpdate:sortDesc":s[0]||(s[0]=m=>f.value=m),"sort-by":h.value,"onUpdate:sortBy":s[1]||(s[1]=m=>h.value=m),"sort-direction":T.value,"current-page":y.value,"empty-text":"У вас пока нет профилей.","empty-filtered-text":"Профили не найдены.",onRowClicked:I},{"cell(ID)":a(m=>{var b;return[Qe,t("span",We,v(L(K).transformContractNumber((b=m.item)==null?void 0:b.ID)),1)]}),"cell(Name)":a(m=>{var b;return[Xe,t("span",null,v((b=m.item)==null?void 0:b.Name),1)]}),"cell(StatusDate)":a(m=>{var b;return[Ze,t("span",et,v(x((b=m.item)==null?void 0:b.StatusDate))+" дн.",1)]}),"cell(TemplateID)":a(m=>{var b,n;return[tt,t("span",null,v((n=$.value[(b=m.item)==null?void 0:b.TemplateID])==null?void 0:n.Name),1)]}),"cell(StatusID)":a(m=>[ot,l(p,{status:m.value,"status-table":"Profiles"},null,8,["status"])]),_:1},8,["items","fields","filter","per-page","sort-desc","sort-by","sort-direction","current-page"]),l(B,{total_rows:w.value,onUpdatePage:U},null,8,["total_rows"])])}}},at=F(st,[["__scopeId","data-v-aab722c9"]]);const nt={class:"section"},lt={class:"container"},rt={class:"list-form"},ct={class:"contracts__page"},_t={__name:"Contracts",async setup(c){var $,w;let d,u;const i=le(),_=G(),h=z(),f=[{value:"Contracts",name:"Договора"},{value:"Profiles",name:"Профили"}],T=P(()=>o.value==="Contracts"?"Договора":"Профили"),o=g("Contracts"),y=g("");function D(){o.value==="Contracts"?_.push({path:"/ContractMake"}):_.push({path:"/ProfileMake"})}return($=i==null?void 0:i.query)!=null&&$.section?o.value=(w=i.query)==null?void 0:w.section:_.replace({query:{section:"Contracts"}}),M(o,()=>{_.replace({query:{section:o.value}})}),[d,u]=H(()=>h.fetchContracts()),await d,u(),[d,u]=H(()=>h.fetchProfiles()),await d,u(),(U,I)=>{const x=te,e=ee,s=Z;return k(),E(re,null,[l(ye),t("div",nt,[t("div",lt,[l(_e,{tabs:f,modelValue:o.value,"onUpdate:modelValue":I[0]||(I[0]=p=>o.value=p)},null,8,["modelValue"]),l(ce,null,{title:a(()=>[V(v(T.value),1)]),buttons:a(()=>[l(x,{label:o.value==="Contracts"?"Создать договор":"Создать профиль",onClick:D},null,8,["label"])]),_:1}),l(e),t("div",rt,[l(s,{modelValue:y.value,"onUpdate:modelValue":I[1]||(I[1]=p=>y.value=p)},null,8,["modelValue"])]),t("div",ct,[o.value==="Contracts"?(k(),A(Ye,{key:0,search:y.value},null,8,["search"])):(k(),A(at,{key:1,search:y.value},null,8,["search"]))])])])],64)}}},Pt=F(_t,[["__scopeId","data-v-2a04373f"]]);export{Pt as default};
