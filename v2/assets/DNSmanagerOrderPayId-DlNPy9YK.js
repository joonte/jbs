import{_ as E}from"./EmptyStateBlock-DA3-0YDi.js";import{_ as k}from"./ButtonDefault-CMw2aBy6.js";import{_ as V}from"./TotalAmount.vue_vue_type_script_setup_true_lang-Dg-09YER.js";import{_ as U}from"./BlockOrderPayBalance-DG_N_8bZ.js";import{_ as F}from"./ClausesKeeper-iUM0yapS.js";import{_ as L}from"./BlockBalanceAgreement-v_bWuiVT.js";import{r as B,f,I as M,E as S,o as c,c as b,b as _,a as i,F as I,t as R,C as D,h as w,d as T,i as j}from"./index-Codq73aV.js";import{u as q}from"./index-BO2gwtUe.js";import{u as z}from"./services-DyPBvbVy.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./common-DyknwSqv.js";import"./bootstrap-vue-next-W16P-SAV.js";import"./component-DqcwA9JN.js";import"./global-CdY51QQZ.js";import"./IconCross-DYjIbZqx.js";import"./IconClose-Dia1noy8.js";const H={class:"tw-px-4 md:tw-px-8 tw-mb-6"},J={class:"section-header"},K={class:"section-header__wrapper"},Q={class:"section-label"},W={__name:"DNSmanagerOrderPayId",async setup(X){let s,n;const y=q(),o=z(),C=j(),N=T(),a=B(null),u=B(!1),r=f(()=>Object.values(o.DNSmanagerOrdersList).find(t=>t.OrderID==C.params.id)),l=f(()=>y.contractsList[r.value.ContractID]),m=f(()=>o?.additionalServicesScheme?.DNSmanager?Object.keys(o.additionalServicesScheme.DNSmanager).map(t=>{const e=o.additionalServicesScheme.DNSmanager[t];return{...e,value:e?.ID,name:e?.Name,cost:e?.CostDay,month:e?.CostMonth}}).filter(t=>t?.ID==r.value?.SchemeID):[]);function g(){u.value=!0;const t=l.value.Balance>=a.value?.price-h()||m.value[0]?.cost==="0.00"&&m.value[0]?.month==="0.00",e=!t,p={DNSmanagerOrderID:r.value.ID,DaysPay:a.value?.actualDays,IsNoBasket:t,IsUseBasket:e,PayMessage:""};o.DNSOrderPay(p).then(d=>{d==="UseBasket"?N.push("/Basket"):d==="NoBasket"?N.push("/AdditionalServices?ServiceID=52000"):console.error("Ошибка оплаты заказа"),u.value=!0})}function h(){let t=0;return a.value?.discounts?.Bonuses.map(e=>{t+=Number(e.Economy)}),t}return M(()=>{o.fetchAdditionalServiceScheme("DNSmanager")}),[s,n]=S(()=>o.fetchDNSmanagerOrders()),await s,n(),[s,n]=S(()=>o.fetchAdditionalServiceScheme("DNSmanager")),await s,n(),[s,n]=S(()=>y.fetchContracts()),await s,n(),(t,e)=>{const p=L,d=k,O=F,P=U,$=V,x=k,A=E;return c(),b(I,null,[_(p),i("div",H,[r.value?(c(),b(I,{key:0},[i("div",J,[i("div",K,[e[3]||(e[3]=i("h1",{class:"section-title"},"Оплата заказа вторичного DNS",-1)),_(d,{class:"btn--wide",label:Number(l.value.Balance)>=a.value?.price?"Оплатить c баланса договора":"Добавить в корзину",disabled:a.value===null||a.value?.price===null,"is-loading":u.value,onClick:e[0]||(e[0]=v=>g())},null,8,["label","disabled","is-loading"])]),i("div",Q,R(m.value[0]?.Name),1)]),_(O),l.value?(c(),D(P,{key:0,modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=v=>a.value=v),contract:l.value,"days-remainded":r.value?.DaysRemainded,"service-id":52e3,scheme:m.value[0],order:r.value},null,8,["modelValue","contract","days-remainded","scheme","order"])):w("",!0),a.value?(c(),D($,{key:1,tariff:a.value},null,8,["tariff"])):w("",!0),_(x,{class:"btn--wide",label:Number(l.value.Balance)>=a.value?.price-h()?"Оплатить c баланса договора":"Добавить в корзину",disabled:a.value===null||a.value?.price===null,"is-loading":u.value,onClick:e[2]||(e[2]=v=>g())},null,8,["label","disabled","is-loading"])],64)):(c(),D(A,{key:1,label:"Заказ нельзя продлить"}))])],64)}}},pe=G(W,[["__scopeId","data-v-ad5380c3"]]);export{pe as default};
