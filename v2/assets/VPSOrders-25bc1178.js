import{j as M,o as g,c as y,a as r,b as l,w as D,d as P,t as b,F as A,v as q,n as tt,k as et,_ as G,R as J,r as U,x as N,p as at,l as ot,g as R}from"./index-b105c350.js";import{I as nt}from"./IconSearch-3b738ce1.js";import{u as Q}from"./vps-186a0cdf.js";import{_ as st}from"./HelperComponent-4c4a503a.js";import{S as W}from"./StatusBadge-137b1c8f.js";import{I as X}from"./IconRotate-c2c38a20.js";import{f as K}from"./useTimeFunction-8602dd60.js";import{v as rt}from"./vpsStatuses-32ffaaf5.js";import{z as it,d as lt}from"./bootstrap-vue-next.es-31cfcab6.js";import{_ as ct}from"./IconDots-71cfee45.js";import{_ as dt}from"./IconCard-f1b3f450.js";import{_ as mt}from"./OrderIDBadge-87b3acf9.js";import{S as _t}from"./Select2-7e3e51ce.js";import{s as ut}from"./multiselect-34394f38.js";import{_ as Y}from"./ClausesKeeper-d7dcbabd.js";import{u as ft}from"./contracts-b62777f8.js";import{B as Z}from"./BlockBalanceAgreement-19657f3d.js";import{u as Dt}from"./globalActions-38f815a9.js";import{E as gt}from"./EmptyStateBlock-197e75e2.js";import{_ as vt}from"./FormInputSearch-15711181.js";import"./ButtonDefault-d83beda7.js";import"./IconArrow-27665727.js";import"./IconClose-0ba84d64.js";import"./IconPlus-745c2bd0.js";const pt={class:"hosting-item"},It={class:"hosting-item__row"},ht={class:"hosting-item__date"},bt={class:"hosting-item__row"},St={class:"hosting-item__person"},Vt={class:"hosting-item__row"},Pt={class:"hosting-item__list"},yt=["innerHTML"],Ct={class:"hosting-item__controls"},Ot={class:"ico"},kt={class:"btn btn--dots"};function wt(a,s,o,e,S,L){var n,t,f,u,I,V,h,w,x;const m=mt,v=M("router-link"),c=W,i=M("Helper"),_=X,k=dt,C=ct,p=it,O=lt;return g(),y("div",pt,[r("div",It,[l(m,{orderID:(n=o.itemData)==null?void 0:n.OrderID},null,8,["orderID"]),l(v,{class:"hosting-item__name",to:`/VPSOrders/${o.itemData.OrderID}`},{default:D(()=>[P(b(o.itemData.IP||o.itemData.Domain),1)]),_:1},8,["to"]),l(c,{status:(t=o.itemData)==null?void 0:t.StatusID,DaysRemainded:(f=o.itemData)==null?void 0:f.DaysRemainded,"status-table":"VPSOrders"},null,8,["status","DaysRemainded"]),r("div",ht,"Дата окончания "+b(e.calculateExpirationDate((u=o.itemData)==null?void 0:u.DaysRemainded))+" | "+b(((I=o.itemData)==null?void 0:I.DaysRemainded)||0)+" дн.",1)]),r("div",bt,[r("div",St,b(o.userName),1),l(i,{"user-notice":(V=o.itemData)==null?void 0:V.UserNotice,id:(h=o.itemData)==null?void 0:h.OrderID,position:o.isLast?"bottom":"top",emit:"updateVPSList"},null,8,["user-notice","id","position"])]),r("div",Vt,[r("ul",Pt,[(g(!0),y(A,null,q(o.params,d=>(g(),y("li",{innerHTML:d==null?void 0:d.text},null,8,yt))),256))])]),r("div",Ct,[((w=o.itemData)==null?void 0:w.StatusID)==="Active"?(g(),y("div",{key:0,class:tt(["btn btn--md btn--border btn--rotate btn--rotate_green button-large",{"btn--rotate_gray":((x=o.itemData)==null?void 0:x.StatusID)!=="Active"||e.isReloading,"btn--rotate_loading":e.isReloading}]),title:"Перезагрузить выделенный сервер",onClick:s[0]||(s[0]=(...d)=>e.reloadItem&&e.reloadItem(...d))},[P("Включен"),r("button",null,[r("div",Ot,[l(_)])])],2)):et("",!0),r("div",{class:"btn btn--md btn--bold",onClick:s[1]||(s[1]=d=>{var B;return a.$router.push(`/VPSOrderPay/${(B=o.itemData)==null?void 0:B.OrderID}`)})},[l(k),P("Оплатить")]),l(O,{class:"dropdown-dots",right:""},{"button-content":D(()=>[r("div",kt,[l(C)])]),default:D(()=>[l(p,{onClick:s[2]||(s[2]=d=>e.orderManage())},{default:D(()=>[P("Управлять заказом")]),_:1}),l(p,{onClick:s[3]||(s[3]=d=>e.transferAccount())},{default:D(()=>[P("Передать на другой аккаунт")]),_:1}),l(p,null,{default:D(()=>{var d;return[l(v,{to:`/VPSOrders/${(d=o.itemData)==null?void 0:d.OrderID}/SchemeChange`},{default:D(()=>[P("Изменить тариф")]),_:1},8,["to"])]}),_:1})]),_:1})])])}const xt={components:{StatusBadge:W,IconRotate:X,Helper:st},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1},userName:{type:String,default:""}},emits:["manage","transfer"],setup(a,{emit:s}){Q();const o=J("emitter"),e=U(!1);function S(c){if(!c)return K(new Date);const i=new Date,_=new Date(i.getTime()+c*24*60*60*1e3);return K(_)}function L(){var c,i;o.emit("open-modal",{component:"OrdersTransfer",data:{ServiceOrderID:(c=a.itemData)==null?void 0:c.ID,ServiceID:(i=a.itemData)==null?void 0:i.ServiceID}})}function m(){var i;function c(_){e.value=_}o.emit("open-modal",{component:"ReloadVPS",data:{VPSOrderID:(i=a.itemData)==null?void 0:i.ID,isReloading:e.value,onReloadStatusChange:c}})}function v(){var c,i,_;s("manage",{ServiceOrderID:(c=a.itemData)==null?void 0:c.ID,ServiceID:(i=a.itemData)==null?void 0:i.ServiceID,OrderID:(_=a.itemData)==null?void 0:_.OrderID})}return{vpsStatuses:rt,reloadItem:m,isReloading:e,orderManage:v,calculateExpirationDate:S,isReloading:e,transferAccount:L}}},$=G(xt,[["render",wt],["__scopeId","data-v-9c071480"]]),Bt=a=>(at("data-v-f3e118c2"),a=a(),ot(),a),Rt={class:"section"},Lt={class:"container"},Mt={class:"section-header"},Nt=Bt(()=>r("h1",{class:"section-title"},"VPS/VDS серверы",-1)),At={class:"list-form"},Ut={class:"list-form_col list-form_col--sm"},Et={class:"list-form_select"},jt={class:"multiselect-option"},Ht={key:0};function Tt(a,s,o,e,S,L){var p,O,n;const m=Z,v=M("router-link"),c=Y,i=M("Multiselect"),_=vt,k=$,C=gt;return g(),y(A,null,[l(m),r("div",Rt,[r("div",Lt,[r("div",Mt,[Nt,l(v,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:D(()=>[P("Заказать")]),_:1})]),l(c),r("div",At,[r("div",Ut,[r("div",Et,[l(i,{modelValue:e.select,"onUpdate:modelValue":s[0]||(s[0]=t=>e.select=t),options:e.getUsers,disabled:((p=e.getUsers)==null?void 0:p.length)<=1,label:"name"},{singlelabel:D(({value:t})=>[r("span",null,"# "+b(t.value.padStart(5,"0"))+" / "+b(t.name),1)]),option:D(({option:t})=>[r("div",jt,"# "+b(t.value.padStart(5,"0"))+" / "+b(t.name),1)]),_:1},8,["modelValue","options","disabled"])])]),l(_,{modelValue:e.search,"onUpdate:modelValue":s[1]||(s[1]=t=>e.search=t)},null,8,["modelValue"])]),e.getVpsOrders&&((O=e.getVpsOrders)==null?void 0:O.length)>0?(g(),y("div",Ht,[e.filterProducts&&((n=e.filterProducts)==null?void 0:n.length)>0?(g(!0),y(A,{key:0},q(e.filterProducts,(t,f)=>{var u;return g(),N(k,{"item-data":t,"is-last":f===e.filterProducts.length-1,"user-name":(u=e.getContracts[t==null?void 0:t.ContractID])==null?void 0:u.Customer,params:e.formItemParamList(t),onManage:e.orderManage},null,8,["item-data","is-last","user-name","params","onManage"])}),256)):(g(),N(C,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(g(),N(C,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])],64)}const zt={components:{IconSearch:nt,Select2:_t,ClausesKeeper:Y,Multiselect:ut,VpsItem:$,BlockBalanceAgreement:Z},async setup(){const a=Q(),s=ft(),o=Dt(),e=U(null),S=U("*");J("emitter").on("updateVPSList",()=>{a.fetchVPS()});const m=R(()=>{var n;return(n=Object.keys(a==null?void 0:a.vpsList).map(t=>a==null?void 0:a.vpsList[t]))==null?void 0:n.reverse()}),v=R(()=>a.vpsSchemes),c=R(()=>C(_(m.value))),i=R(()=>s==null?void 0:s.contractsList);function _(n){return S.value!=="*"?n.filter(t=>(t==null?void 0:t.ContractID)===S.value):n}function k(n){o.OrderManage(n)}function C(n){return e.value!==null?n.filter(t=>t==null?void 0:t.IP.toLowerCase().includes(e.value.toLowerCase())):n}const p=R(()=>{let n=[{value:"*",name:"Все договора"}];return m.value!==null?(Object.keys(m.value).forEach(t=>{var f,u,I;n.find(V=>{var h;return V.value===((h=m.value[t])==null?void 0:h.ContractID)})||n.push({value:(f=m.value[t])==null?void 0:f.ContractID,name:(I=i.value[(u=m.value[t])==null?void 0:u.ContractID])==null?void 0:I.Customer})}),n):{value:"*",name:"Все договора"}});function O(n){var f,u,I,V,h,w,x,d,B,E,j,H,T,z,F;const t=(f=v.value)==null?void 0:f[n.SchemeID];return[{text:`${t==null?void 0:t.Name}`},{text:`${(I=(u=t==null?void 0:t.SchemeParams)==null?void 0:u.hdd_mib)==null?void 0:I.InternalName} ${(h=(V=t==null?void 0:t.SchemeParams)==null?void 0:V.hdd_mib)==null?void 0:h.Value} ${(x=(w=t==null?void 0:t.SchemeParams)==null?void 0:w.hdd_mib)==null?void 0:x.Unit}`},{text:`RAM ${(B=(d=t==null?void 0:t.SchemeParams)==null?void 0:d.ram_mib)==null?void 0:B.Value} ${(j=(E=t==null?void 0:t.SchemeParams)==null?void 0:E.ram_mib)==null?void 0:j.Unit}`},{text:`Канал ${(T=(H=t==null?void 0:t.SchemeParams)==null?void 0:H.net_bandwidth_mbitps)==null?void 0:T.Value} ${(F=(z=t==null?void 0:t.SchemeParams)==null?void 0:z.net_bandwidth_mbitps)==null?void 0:F.Unit}`}]}return await a.fetchVPS(),await a.fetchVPSSchemes(),await s.fetchContracts(),{getVpsOrders:m,search:e,getContracts:i,select:S,orderManage:k,formItemParamList:O,getUsers:p,filterProducts:c}}},ue=G(zt,[["render",Tt],["__scopeId","data-v-f3e118c2"]]);export{ue as default};
