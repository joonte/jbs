import{_ as te}from"./EmptyStateBlock-Ad1AmtSS.js";import{_ as oe}from"./VPSCard-CRGsAWO5.js";import{_ as se}from"./FormInputSearch-B6VLZUqq.js";import{_ as ae}from"./ClausesKeeper-gPyacQ05.js";import{m as ne}from"./bootstrap-vue-next-BglOzul_.js";import{_ as re,a as le}from"./IconButtonBack-CCfO1LXm.js";import{_ as me}from"./ButtonDefault-B1FApUky.js";import{_ as ue}from"./BlockBalanceAgreement-DSLTUOoQ.js";import{s as ce}from"./multiselect-B6DlyfA6.js";import{G as ie,r as u,D as de,x as pe,f as i,c as d,b as m,a as n,C as p,h as b,t as _,w as g,E as _e,v as ve,F as N,i as fe,d as Se,o as a,e as j}from"./index-C9dBN6m4.js";import{u as we}from"./contracts-BEc0DZS2.js";import{u as be}from"./global-DiPSuX9n.js";import{u as ge}from"./orders-D_JLVTov.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./StatusBadge-DZmmWv0G.js";import"./IconLink-kGICMNL4.js";import"./OrderIDBadge-Cc01CaG4.js";import"./ServerStatusBadge.vue_vue_type_script_setup_true_lang-DbXnhqPA.js";import"./IconDots-Mp79qN9u.js";import"./UserNote-Cq01thJ0.js";import"./IconCard-CjQefsRP.js";import"./CardButton-Y2h0wZDl.js";import"./IconRotate-Bg9kJJlu.js";import"./time-DenPiOX5.js";import"./IconPlus-aXPVPivX.js";import"./IconClose-CgjzG0Yf.js";import"./index-D0iqQ1zq.js";const he={class:"tw-px-4 md:tw-px-8"},Pe={class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-2 tw-mb-4"},ke={class:"tw-flex tw-items-center tw-gap-2"},xe={key:0,class:"tw-flex tw-items-center tw-gap-2"},ye={key:1,class:"tw-flex tw-flex-wrap tw-items-center tw-justify-between tw-gap-4 tw-my-4"},Ce={class:"list-form"},Ie={class:"list-form_col list-form_col--sm"},De={class:"list-form_select"},Oe={class:"multiselect-option"},Be={key:0,class:"tw-space-y-4 tw-mb-6"},$e={__name:"VPSOrders",async setup(Ue){let k,x;const c=ie(),y=we(),C=be(),I=ge(),D=Se(),v=u(null),f=u("*"),r=u(!1),S=u([]),V=u(null),h=u(!1),P=pe("emitter");[k,x]=de(()=>Promise.all([c.fetchVPS(),I.fetchAllOrders(),c.fetchVPSSchemes(),y.fetchContracts()])),await k,x(),P.on("updateVPSList",()=>{c.fetchVPS()});const M=t=>{S.value=t};async function A(){const t=Object.keys(S.value).filter(s=>S.value[s]),e={ServiceID:"30000",ItemsPay:V.value,OrdersIDs:t,...h.value&&{UseBalance:"yes"}};await C.OrdersPay(e).then(s=>{s==="Basket"?D.push("/Basket"):s?.Status==="Ok"&&(r.value=!1,P.emit("open-modal",{component:"BalanceProlong",data:{Message:s?.Message,Count:s?.Count}}))})}function E(){r.value=!0}function R(){r.value=!1}const l=i(()=>Object.values(c.vpsList).reverse().map(t=>({...t,Stat:I.orders[t.OrderID]?.Stat||[]}))),F=i(()=>c.vpsSchemes),w=i(()=>H(T(l.value))),O=i(()=>y?.contractsList);function G(){D.go(0)}function T(t){return f.value!=="*"?t.filter(e=>e?.ContractID==f.value):t}function q(t){C.OrderManage(t)}function z(t,e){P.emit("open-modal",{component:"DeleteItem",data:{id:t,message:`Вы действительно хотите удалить виртуальный сервер #${e}?`,tableID:"VPSOrders",successEmit:"updateVPSList"}})}function H(t){return v.value!==null?t.filter(e=>e?.IP.toLowerCase().includes(v.value.toLowerCase())):t}const B=i(()=>{let t=[{value:"*",name:"Все договора"}];return l.value!==null?(Object.keys(l.value).forEach(e=>{t.find(s=>s.value===l.value[e]?.ContractID)||t.push({value:l.value[e]?.ContractID,name:O.value[l.value[e]?.ContractID]?.Customer})}),t):{value:"*",name:"Все договора"}});function J(t){const e=F.value?.[t.SchemeID];return[{text:`${e?.Name}`},{text:`${e?.SchemeParams?.hdd_mib?.InternalName} ${e?.SchemeParams?.hdd_mib?.Value} ${e?.SchemeParams?.hdd_mib?.Unit}`},{text:`RAM ${e?.SchemeParams?.ram_mib?.Value} ${e?.SchemeParams?.ram_mib?.Unit}`},{text:`Канал ${e?.SchemeParams?.net_bandwidth_mbitps?.Value} ${e?.SchemeParams?.net_bandwidth_mbitps?.Unit}`}]}return(t,e)=>{const s=ue,K=re,$=me,Q=_e("router-link"),W=le,X=ne,Y=ae,Z=se,ee=oe,U=te;return a(),d(N,null,[m(s),n("div",he,[n("div",Pe,[n("div",ke,[r.value?(a(),p(K,{key:0,onClick:e[0]||(e[0]=o=>R())})):b("",!0),n("h1",{class:"tw-text-xl sm:tw-text-4xl tw-cursor-pointer",onClick:e[1]||(e[1]=o=>G())},_(r.value?"Продление услуг виртуальных серверов":"VPS/VDS серверы"),1)]),r.value?b("",!0):(a(),d("div",xe,[l.value.length>1?(a(),p($,{key:0,class:"btn-several",label:"Продлить несколько заказов",onClick:e[2]||(e[2]=o=>E())})):b("",!0),m(Q,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:g(()=>e[8]||(e[8]=[j("Заказать",-1)])),_:1,__:[8]})])),r.value?(a(),d("div",ye,[m(W,{class:"contr period",modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=o=>V.value=o)},null,8,["modelValue"]),m(X,{id:"checkbox-balance",modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=o=>h.value=o),name:"checkbox-balance"},{default:g(()=>e[9]||(e[9]=[j(" Использовать средства с баланса ",-1)])),_:1,__:[9]},8,["modelValue"]),m($,{label:"Продлить",onClick:e[5]||(e[5]=o=>A())})])):b("",!0)]),m(Y),n("div",Ce,[n("div",Ie,[n("div",De,[m(ve(ce),{modelValue:f.value,"onUpdate:modelValue":e[6]||(e[6]=o=>f.value=o),options:B.value,disabled:B.value?.length<=1,label:"name"},{singlelabel:g(({value:o})=>[n("span",null," # "+_(String(o.value).padStart(5,"0"))+" / "+_(o.name),1)]),option:g(({option:o})=>[n("div",Oe,"# "+_(String(o.value).padStart(5,"0"))+" / "+_(o.name),1)]),_:1},8,["modelValue","options","disabled"])])]),m(Z,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=o=>v.value=o)},null,8,["modelValue"])]),l.value?.length?(a(),d("div",Be,[w.value&&w.value?.length>0?(a(!0),d(N,{key:0},fe(w.value,(o,L)=>(a(),p(ee,{key:o.OrderID||L,vps:o,"is-last":L===w.value.length-1,"user-name":O.value[o?.ContractID]?.Customer,params:J(o),isSeveral:r.value,"selected-rows":S.value,onUpdateSelectedRows:M,onDelete:z,onManage:q},null,8,["vps","is-last","user-name","params","isSeveral","selected-rows"]))),128)):(a(),p(U,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(a(),p(U,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])],64)}}},lt=Ve($e,[["__scopeId","data-v-bf8d87a1"]]);export{lt as default};
