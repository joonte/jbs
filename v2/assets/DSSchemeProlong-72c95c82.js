import{E as kt}from"./EmptyStateBlock-c1b0587e.js";import{_ as yt}from"./BlockOrderPayBalance-756afe5c.js";import{_ as ft}from"./ClausesKeeper-3ae27028.js";import{_ as Dt}from"./ButtonDefault-40efcd87.js";import{_ as It,r as _t,a7 as gt,e as xt,S as wt,g as y,i as Bt,O as Ct,ag as x,o as c,c as _,b as p,a as s,t as i,F as f,x as rt,k as Et,Z as dt,a9 as ut,y as vt,p as Pt,l as Ot}from"./index-6f846e0d.js";import{u as St}from"./dedicatedServer-6e120d8e.js";import{u as Lt}from"./contracts-b643bcd5.js";import{B as Rt}from"./BlockBalanceAgreement-4579706c.js";import"./bootstrap-vue-next.es-6bf04585.js";import"./IconHelp-ddbfd315.js";import"./globalActions-d40367d6.js";import"./component-32b750ca.js";import"./IconClose-12869131.js";import"./IconArrow-37547b0b.js";const D=m=>(Pt("data-v-926263cc"),m=m(),Ot(),m),$t={key:0,class:"domain-scheme"},Ft={class:"section"},At={class:"container"},Nt={class:"section-header"},Kt={class:"section-header__wrapper"},Tt=D(()=>s("h1",{class:"section-title"},"Оплата заказа выделенного сервера",-1)),Ut={class:"section-label"},Vt={class:"section"},jt={class:"container"},Mt={class:"list"},Zt={class:"list-col list-col--xl"},qt={class:"list-item"},zt=D(()=>s("div",{class:"list-item__row"},[s("div",{class:"list-item__title"},"Конфигурация")],-1)),Gt={class:"list-item__row list-item__table"},Ht={class:"list-item__table-col"},Jt={class:"list-item__label"},Qt={class:"list-item__text"},Wt={key:0,class:"section"},Xt={class:"container"},Yt={class:"total-block"},ts={class:"total-block__row divider-bottom"},ss=D(()=>s("div",{class:"total-block__col"},"Цена тарифа",-1)),es={class:"total-block__col"},os={class:"total-block__row no-divider"},ls={class:"total-block__col"},as={class:"total-block__col"},cs={class:"total-block__row total-block__row--big economy-line"},ns=D(()=>s("div",{class:"total-block__col red"},"Выгода",-1)),is={class:"total-block__col flex-col"},_s={class:"red"},rs={class:"total-block__row total-block__row--big"},ds={class:"total-block__col"},us={class:"total-block__col"},vs={key:1,class:"section"},bs={class:"container"},ps={key:1,class:"section"},ms={class:"container"},hs={__name:"DSSchemeProlong",async setup(m){let u,v;const e=_t(null),a=St(),w=Lt(),bt=gt(),B=xt();wt("emitter");const h=_t(!1),n=y(()=>Object.keys(a==null?void 0:a.DSList).map(t=>a==null?void 0:a.DSList[t]).find(t=>t.OrderID===bt.params.id)),r=y(()=>{var t,l;return(l=a==null?void 0:a.DSSchemes)==null?void 0:l[(t=n.value)==null?void 0:t.SchemeID]}),C=y(()=>w.contractsList),E=t=>{t.key==="Enter"&&t.ctrlKey&&!pt.value&&I()},pt=y(()=>{var t;return e.value===null||((t=e.value)==null?void 0:t.price)===null});Bt(()=>{document.addEventListener("keyup",E)}),Ct(()=>{document.removeEventListener("keyup",E)});function P(){var l,d;let t=0;return(d=(l=e.value)==null?void 0:l.discounts)==null||d.Bonuses.map(b=>{t+=+b.Economy}),t}function k(t){return Number(t).toFixed(2)||0}function mt(){const t=r==null?void 0:r.value;return[{label:"Процессор",text:(t==null?void 0:t.CPU)||"-"},{label:"Объём оперативной памяти",text:(t==null?void 0:t.ram)||"-"},{label:"Характеристики жёстких дисков",text:(t==null?void 0:t.disks)||"-"},{label:"Предустановленная ОС",text:(t==null?void 0:t.OS)||"-"},{label:"RAID",text:(t==null?void 0:t.raid)||"-"},{label:"Месячный трафик",text:t!=null&&t.trafflimit?`${t==null?void 0:t.trafflimit} ГБ`:"-"},{label:"Скорость канала",text:t!=null&&t.chrate?`${t==null?void 0:t.chrate} Мбит/с`:"-"}]}function I(){var t,l;h.value=!0,a.DSOrderPay({DSOrderID:(t=n.value)==null?void 0:t.ID,DaysPay:(l=e.value)==null?void 0:l.actualDays,IsChange:!0}).then(d=>{let{result:b,error:O}=d;b==="SUCCESS"?B.push("/DSOrders"):b==="BASKET"&&B.push("/Basket"),h.value=!1})}function ht(t){e.value=t}return[u,v]=x(()=>a.fetchDSOrders()),await u,v(),[u,v]=x(()=>a.fetchDSSchemes()),await u,v(),[u,v]=x(()=>w.fetchContracts()),await u,v(),(t,l)=>{var S,L,R,$,F,A,N,K,T,U,V,j,M,Z,q,z,G,H,J,Q,W,X,Y,tt,st,et,ot,lt,at,ct,nt,it;const d=Dt,b=ft,O=yt,g=kt;return c(),_(f,null,[p(Rt),(S=n.value)!=null&&S.ID&&((L=r.value)!=null&&L.ID)?(c(),_("div",$t,[s("div",Ft,[s("div",At,[s("div",Nt,[s("div",Kt,[Tt,p(d,{class:"btn--wide",label:(($=C.value[(R=n.value)==null?void 0:R.ContractID])==null?void 0:$.Balance)>((F=e.value)==null?void 0:F.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:e.value===null||((A=e.value)==null?void 0:A.price)===null,"is-loading":h.value,onClick:l[0]||(l[0]=o=>I())},null,8,["label","disabled","is-loading"])]),s("div",Ut,i((N=n.value)!=null&&N.IP?`#${(K=n.value)==null?void 0:K.IP}`:""),1)]),p(b)])]),s("div",Vt,[s("div",jt,[s("div",Mt,[s("div",Zt,[s("div",qt,[zt,s("div",Gt,[(c(!0),_(f,null,rt(mt(),o=>(c(),_("div",Ht,[s("div",Jt,i(o.label),1),s("div",Qt,i(o.text),1)]))),256))])])])])])]),p(O,{contractID:(T=n.value)==null?void 0:T.ContractID,scheme:r.value,serviceID:"40000",daysRemainded:(U=n.value)==null?void 0:U.DaysRemainded,isOrderID:!0,orderID:(V=n.value)==null?void 0:V.OrderID,onSelect:ht},null,8,["contractID","scheme","daysRemainded","orderID"]),(j=r.value)!=null&&j.IsPayed&&((M=r.value)!=null&&M.IsProlong)||!((Z=r.value)!=null&&Z.IsPayed)?(c(),_("div",Wt,[s("div",Xt,[s("div",Yt,[((G=(z=(q=e.value)==null?void 0:q.discounts)==null?void 0:z.Bonuses)==null?void 0:G.length)>0?(c(),_(f,{key:0},[s("div",ts,[ss,s("div",es,i(k((H=e.value)==null?void 0:H.price))+" ₽",1)]),(c(!0),_(f,null,rt((Q=(J=e.value)==null?void 0:J.discounts)==null?void 0:Q.Bonuses,o=>(c(),_("div",os,[s("div",ls,"Скидка "+i(o==null?void 0:o.Discount)+"% на "+i(o==null?void 0:o.Days)+" дней",1),s("div",as,"-"+i(k(o==null?void 0:o.Economy))+" ₽",1)]))),256))],64)):Et("",!0),dt(s("div",cs,[ns,s("div",is,[s("span",null,[s("s",null,i(k((W=e.value)==null?void 0:W.price))+" ₽",1)]),s("span",_s,"-"+i(P())+" ₽",1)])],512),[[ut,((tt=(Y=(X=e.value)==null?void 0:X.discounts)==null?void 0:Y.Bonuses)==null?void 0:tt.length)>0]]),dt(s("div",rs,[s("div",ds,"Итого за "+i((st=e.value)==null?void 0:st.label),1),s("div",us,i(k(((et=e.value)==null?void 0:et.price)-P()))+" ₽",1)],512),[[ut,(ot=e.value)==null?void 0:ot.price]])]),p(d,{class:"btn--wide",label:((at=C.value[(lt=n.value)==null?void 0:lt.ContractID])==null?void 0:at.Balance)>((ct=e.value)==null?void 0:ct.price)?"Оплатить c баланса договора":"Добавить в корзину",disabled:e.value===null||((nt=e.value)==null?void 0:nt.price)===null,"is-loading":h.value,onClick:l[1]||(l[1]=o=>I())},null,8,["label","disabled","is-loading"])])])):(c(),_("div",vs,[s("div",bs,[p(g,{class:"no-margin",label:"Заказ нельзя продлить"})])]))])):(c(),_("div",ps,[s("div",ms,[(it=n.value)!=null&&it.ID?(c(),vt(g,{key:0,label:"Заказ не может быть продлен"})):(c(),vt(g,{key:1,label:"Заказ не найден"}))])]))],64)}}},Ls=It(hs,[["__scopeId","data-v-926263cc"]]);export{Ls as default};
