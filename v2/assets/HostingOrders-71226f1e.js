import{j as V,o as a,c as L,b as f,a as r,w,d as E,x as D,am as M,t as j,F as O,v as F,_ as K,f as q,r as U,R,g as i}from"./index-33bd9cf4.js";import{I as S}from"./IconSearch-55746ee2.js";import{H as N}from"./HostingItem-fd6eee07.js";import{_ as T}from"./ClausesKeeper-69d31679.js";import{s as z}from"./multiselect-acf9ef65.js";import{u as G}from"./hosting-61dcf5ca.js";import{u as J}from"./contracts-141debab.js";import{B as A}from"./BlockBalanceAgreement-5028e9bc.js";import{u as Q}from"./testTransforms-eec373ee.js";import{E as W}from"./EmptyStateBlock-98549fc8.js";import{_ as X}from"./FormInputSearch-aa64849b.js";import"./IconDots-463e8bba.js";import"./IconCard-c2e605c3.js";import"./StatusBadge-b80983a6.js";import"./hostStatuses-94d00f20.js";import"./HelperComponent-ebb207b6.js";import"./ButtonDefault-34d9e627.js";import"./IconArrow-dadffb08.js";import"./bootstrap-vue-next.es-6bb0e5cd.js";import"./OrderIDBadge-24fa2e7f.js";import"./IconClose-d9fbf580.js";import"./IconPlus-5f47af9a.js";const Y={class:"section"},Z={class:"container"},$={class:"section-header"},tt=r("h1",{class:"section-title"},"Хостинг",-1),et={class:"list-form"},ot={class:"list-form_col list-form_col--sm"},st={class:"list-form_select"},nt={class:"multiselect-option"},rt={key:0};function at(n,l,m,o,_,g){var H,I,C;const u=A,y=V("router-link"),x=T,c=V("Multiselect"),p=X,h=N,v=W;return a(),L(O,null,[f(u),r("div",Y,[r("div",Z,[r("div",$,[tt,f(y,{class:"btn btn--blue btn-default",to:"/HostingSchemes"},{default:w(()=>[E("Заказать")]),_:1})]),(a(),D(M,null,[f(x)],1024)),r("div",et,[r("div",ot,[r("div",st,[f(c,{modelValue:o.select,"onUpdate:modelValue":l[0]||(l[0]=s=>o.select=s),options:o.getUsers,disabled:((H=o.getUsers)==null?void 0:H.length)<=1,label:"name"},{option:w(({option:s})=>[r("div",nt,j(s.name),1)]),_:1},8,["modelValue","options","disabled"])])]),f(p,{modelValue:o.search,"onUpdate:modelValue":l[1]||(l[1]=s=>o.search=s)},null,8,["modelValue"])]),o.getHostingList&&((I=o.getHostingList)==null?void 0:I.length)>0?(a(),L("div",rt,[o.filterProducts&&((C=o.filterProducts)==null?void 0:C.length)>0?(a(!0),L(O,{key:0},F(o.filterProducts,(s,B)=>{var k,e;return a(),D(h,{"item-data":s,"user-name":`${(k=o.getUser)==null?void 0:k.Name} - ${(e=o.getContracts[s==null?void 0:s.ContractID])==null?void 0:e.Customer}`,params:o.getHostingItemParam(s),"info-link":`/HostingOrders/${s==null?void 0:s.OrderID}`,"is-last":B===o.filterProducts.length-1,onDelete:o.deleteItem,onTransfer:o.transferItem},null,8,["item-data","user-name","params","info-link","is-last","onDelete","onTransfer"])}),256)):(a(),D(v,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(a(),D(v,{key:1,class:"no-margin",label:"У Вас нет заказов на хостинг"}))])])],64)}const lt={components:{IconSearch:S,Multiselect:z,ClausesKeeper:T,HostingItem:N,BlockBalanceAgreement:A},async setup(){const n=G(),l=q(),m=J(),{formDescriptionLine:o}=Q(),_=U("*"),g=U(null),u=R("emitter");u.on("updateHostingList",()=>{n.fetchHostingOrders()});function y(e){u.emit("open-modal",{component:"DeleteItem",data:{id:e,message:"Вы действительно хотите удалить хостинг?",tableID:"HostingOrders",successEmit:"updateHostingList"}})}function x(e){u.emit("open-modal",{component:"OrdersTransfer",data:e})}const c=i(()=>{var e;return(e=Object.keys(n==null?void 0:n.hostingList).map(t=>n==null?void 0:n.hostingList[t]))==null?void 0:e.reverse()}),p=i(()=>n==null?void 0:n.hostingSchemes),h=i(()=>m==null?void 0:m.contractsList),v=i(()=>{let e=[{value:"*",name:"Все договора"}];return c.value!==null?(c.value.forEach(t=>{var d;e.find(b=>b.value===t.ContractID)||e.push({value:t.ContractID,name:(d=h.value[t==null?void 0:t.ContractID])==null?void 0:d.Customer})}),e):{value:"*",name:"Все договора"}}),H=i(()=>l.userInfo),I=i(()=>s(C(c.value)));function C(e){return _.value!=="*"?e.filter(t=>(t==null?void 0:t.ContractID)===_.value):e}function s(e){return g.value!==null?e.filter(t=>t==null?void 0:t.Domain.toLowerCase().includes(g.value.toLowerCase())):e}function B(e){var d,b,P;const t=k(e==null?void 0:e.SchemeID);return[{text:t==null?void 0:t.Name},{text:o((d=t==null?void 0:t.SchemeParams)==null?void 0:d.limit_webdomains)},{text:o((b=t==null?void 0:t.SchemeParams)==null?void 0:b.limit_quota)},{text:o((P=t==null?void 0:t.SchemeParams)==null?void 0:P.limit_emails)},{text:`${t==null?void 0:t.CostMonth} ₽ в месяц`,bold:!0}]}function k(e){var t;return(t=p.value)==null?void 0:t[e]}return await n.fetchHostingOrders(),await n.fetchHostingSchemes(),await m.fetchContracts(),{getHostingList:c,getHostingSchemes:p,filterProducts:I,getUsers:v,getUser:H,select:_,search:g,getContracts:h,deleteItem:y,transferItem:x,getHostingItemParam:B}}},Vt=K(lt,[["render",at]]);export{Vt as default};
