import{j as M,o as g,c as V,a as s,b as i,w as v,d as y,t as C,F as U,v as q,n as tt,k as et,_ as G,R as J,r as A,x as N,p as at,l as ot,g as R}from"./index-58c913f0.js";import{I as nt}from"./IconSearch-7497d374.js";import{u as Q}from"./vps-5e51a184.js";import{_ as st}from"./HelperComponent-8d748301.js";import{S as W}from"./StatusBadge-cd8ad979.js";import{I as X}from"./IconRotate-53e3b019.js";import{f as K}from"./useTimeFunction-8602dd60.js";import{v as rt}from"./vpsStatuses-32ffaaf5.js";import{z as it,d as lt}from"./bootstrap-vue-next.es-9015192b.js";import{_ as ct}from"./IconDots-1997c758.js";import{_ as dt}from"./IconCard-94a8b1b0.js";import{_ as _t}from"./OrderIDBadge-064a04dd.js";import{S as mt}from"./Select2-ab5fff9c.js";import{s as ut}from"./multiselect-1db9a63f.js";import{_ as Y}from"./ClausesKeeper-7b7ef561.js";import{u as ft}from"./contracts-5c545170.js";import{B as Z}from"./BlockBalanceAgreement-59500b1f.js";import{u as gt}from"./globalActions-45df61a2.js";import{E as Dt}from"./EmptyStateBlock-e5319013.js";import{_ as pt}from"./FormInputSearch-c75e4536.js";import"./ButtonDefault-7a589010.js";import"./IconArrow-bff54646.js";import"./IconClose-3552080e.js";import"./IconPlus-6b01bd5d.js";const vt={class:"hosting-item"},bt={class:"hosting-item__row"},ht={class:"hosting-item__date"},It={class:"hosting-item__row"},Vt={class:"hosting-item__person"},St={class:"hosting-item__row"},Pt={class:"hosting-item__list"},yt=["innerHTML"],Ct={class:"hosting-item__controls"},Ot={class:"ico"},kt={class:"btn btn--dots"};function wt(a,r,o,e,b,L){var n,t,f,u,D,I,p,w,x;const c=_t,l=M("router-link"),d=W,_=M("Helper"),O=X,k=dt,S=ct,h=it,P=lt;return g(),V("div",vt,[s("div",bt,[i(c,{orderID:(n=o.itemData)==null?void 0:n.OrderID},null,8,["orderID"]),i(l,{class:"hosting-item__name",to:`/VPSOrders/${o.itemData.OrderID}`},{default:v(()=>[y(C(o.itemData.IP||o.itemData.Domain),1)]),_:1},8,["to"]),i(d,{status:(t=o.itemData)==null?void 0:t.StatusID,DaysRemainded:(f=o.itemData)==null?void 0:f.DaysRemainded,"status-table":"VPSOrders"},null,8,["status","DaysRemainded"]),s("div",ht,"Дата окончания "+C(e.calculateExpirationDate((u=o.itemData)==null?void 0:u.DaysRemainded))+" | "+C(((D=o.itemData)==null?void 0:D.DaysRemainded)||0)+" дн.",1)]),s("div",It,[s("div",Vt,C(o.userName),1),i(_,{"user-notice":(I=o.itemData)==null?void 0:I.UserNotice,id:(p=o.itemData)==null?void 0:p.OrderID,position:o.isLast?"bottom":"top",emit:"updateVPSList"},null,8,["user-notice","id","position"])]),s("div",St,[s("ul",Pt,[(g(!0),V(U,null,q(o.params,m=>(g(),V("li",{innerHTML:m==null?void 0:m.text},null,8,yt))),256))])]),s("div",Ct,[((w=o.itemData)==null?void 0:w.StatusID)==="Active"?(g(),V("div",{key:0,class:tt(["btn btn--md btn--border btn--rotate btn--rotate_green button-large",{"btn--rotate_gray":((x=o.itemData)==null?void 0:x.StatusID)!=="Active"||e.isReloading,"btn--rotate_loading":e.isReloading}]),title:"Перезагрузить выделенный сервер",onClick:r[0]||(r[0]=(...m)=>e.reloadItem&&e.reloadItem(...m))},[y("Включен"),s("button",null,[s("div",Ot,[i(O)])])],2)):et("",!0),s("div",{class:"btn btn--md btn--bold",onClick:r[1]||(r[1]=m=>{var B;return a.$router.push(`/VPSOrderPay/${(B=o.itemData)==null?void 0:B.OrderID}`)})},[i(k),y("Оплатить")]),i(P,{class:"dropdown-dots",right:""},{"button-content":v(()=>[s("div",kt,[i(S)])]),default:v(()=>[i(h,{onClick:r[2]||(r[2]=m=>e.orderManage())},{default:v(()=>[y("Управлять заказом")]),_:1}),i(h,null,{default:v(()=>{var m;return[i(l,{to:`/VPSOrders/${(m=o.itemData)==null?void 0:m.OrderID}/SchemeChange`},{default:v(()=>[y("Изменить тариф")]),_:1},8,["to"])]}),_:1})]),_:1})])])}const xt={components:{StatusBadge:W,IconRotate:X,Helper:st},props:{params:{type:Array,default:()=>[]},itemData:{type:Object,default:()=>{}},isLast:{type:Boolean,default:!1},userName:{type:String,default:""}},emits:["manage"],setup(a,{emit:r}){Q();const o=J("emitter"),e=A(!1);function b(l){if(!l)return K(new Date);const d=new Date,_=new Date(d.getTime()+l*24*60*60*1e3);return K(_)}function L(){var d;function l(_){e.value=_}o.emit("open-modal",{component:"ReloadVPS",data:{VPSOrderID:(d=a.itemData)==null?void 0:d.ID,isReloading:e.value,onReloadStatusChange:l}})}function c(){var l,d,_;r("manage",{ServiceOrderID:(l=a.itemData)==null?void 0:l.ID,ServiceID:(d=a.itemData)==null?void 0:d.ServiceID,OrderID:(_=a.itemData)==null?void 0:_.OrderID})}return{vpsStatuses:rt,reloadItem:L,isReloading:e,orderManage:c,calculateExpirationDate:b,isReloading:e}}},$=G(xt,[["render",wt],["__scopeId","data-v-77efc87b"]]),Bt=a=>(at("data-v-8751ab58"),a=a(),ot(),a),Rt={class:"section"},Lt={class:"container"},Mt={class:"section-header"},Nt=Bt(()=>s("h1",{class:"section-title"},"VPS/VDS серверы",-1)),Ut={class:"list-form"},At={class:"list-form_col list-form_col--sm"},Et={class:"list-form_select"},jt={class:"multiselect-option"},Ht={key:0};function Tt(a,r,o,e,b,L){var h,P,n;const c=Z,l=M("router-link"),d=Y,_=M("Multiselect"),O=pt,k=$,S=Dt;return g(),V(U,null,[i(c),s("div",Rt,[s("div",Lt,[s("div",Mt,[Nt,i(l,{class:"btn btn--blue btn-default",to:"/VPSSchemes"},{default:v(()=>[y("Заказать")]),_:1})]),i(d),s("div",Ut,[s("div",At,[s("div",Et,[i(_,{modelValue:e.select,"onUpdate:modelValue":r[0]||(r[0]=t=>e.select=t),options:e.getUsers,disabled:((h=e.getUsers)==null?void 0:h.length)<=1,label:"name"},{option:v(({option:t})=>[s("div",jt,"# "+C(t.value.padStart(5,"0"))+" / "+C(t.name),1)]),_:1},8,["modelValue","options","disabled"])])]),i(O,{modelValue:e.search,"onUpdate:modelValue":r[1]||(r[1]=t=>e.search=t)},null,8,["modelValue"])]),e.getVpsOrders&&((P=e.getVpsOrders)==null?void 0:P.length)>0?(g(),V("div",Ht,[e.filterProducts&&((n=e.filterProducts)==null?void 0:n.length)>0?(g(!0),V(U,{key:0},q(e.filterProducts,(t,f)=>{var u;return g(),N(k,{"item-data":t,"is-last":f===e.filterProducts.length-1,"user-name":(u=e.getContracts[t==null?void 0:t.ContractID])==null?void 0:u.Customer,params:e.formItemParamList(t),onManage:e.orderManage},null,8,["item-data","is-last","user-name","params","onManage"])}),256)):(g(),N(S,{key:1,class:"no-margin",label:"Заказы не найдены"}))])):(g(),N(S,{key:1,class:"no-margin",label:"У вас нет заказов на VPS/VDS серверы"}))])])],64)}const zt={components:{IconSearch:nt,Select2:mt,ClausesKeeper:Y,Multiselect:ut,VpsItem:$,BlockBalanceAgreement:Z},async setup(){const a=Q(),r=ft(),o=gt(),e=A(null),b=A("*");J("emitter").on("updateVPSList",()=>{a.fetchVPS()});const c=R(()=>{var n;return(n=Object.keys(a==null?void 0:a.vpsList).map(t=>a==null?void 0:a.vpsList[t]))==null?void 0:n.reverse()}),l=R(()=>a.vpsSchemes),d=R(()=>S(O(c.value))),_=R(()=>r==null?void 0:r.contractsList);function O(n){return b.value!=="*"?n.filter(t=>(t==null?void 0:t.ContractID)===b.value):n}function k(n){o.OrderManage(n)}function S(n){return e.value!==null?n.filter(t=>t==null?void 0:t.IP.toLowerCase().includes(e.value.toLowerCase())):n}const h=R(()=>{let n=[{value:"*",name:"Все договора"}];return c.value!==null?(Object.keys(c.value).forEach(t=>{var f,u,D;n.find(I=>{var p;return I.value===((p=c.value[t])==null?void 0:p.ContractID)})||n.push({value:(f=c.value[t])==null?void 0:f.ContractID,name:(D=_.value[(u=c.value[t])==null?void 0:u.ContractID])==null?void 0:D.Customer})}),n):{value:"*",name:"Все договора"}});function P(n){var f,u,D,I,p,w,x,m,B,E,j,H,T,z,F;const t=(f=l.value)==null?void 0:f[n.SchemeID];return[{text:`${t==null?void 0:t.Name}`},{text:`${(D=(u=t==null?void 0:t.SchemeParams)==null?void 0:u.hdd_mib)==null?void 0:D.InternalName} ${(p=(I=t==null?void 0:t.SchemeParams)==null?void 0:I.hdd_mib)==null?void 0:p.Value} ${(x=(w=t==null?void 0:t.SchemeParams)==null?void 0:w.hdd_mib)==null?void 0:x.Unit}`},{text:`RAM ${(B=(m=t==null?void 0:t.SchemeParams)==null?void 0:m.ram_mib)==null?void 0:B.Value} ${(j=(E=t==null?void 0:t.SchemeParams)==null?void 0:E.ram_mib)==null?void 0:j.Unit}`},{text:`Канал ${(T=(H=t==null?void 0:t.SchemeParams)==null?void 0:H.net_bandwidth_mbitps)==null?void 0:T.Value} ${(F=(z=t==null?void 0:t.SchemeParams)==null?void 0:z.net_bandwidth_mbitps)==null?void 0:F.Unit}`}]}return await a.fetchVPS(),await a.fetchVPSSchemes(),await r.fetchContracts(),{getVpsOrders:c,search:e,getContracts:_,select:b,orderManage:k,formItemParamList:P,getUsers:h,filterProducts:d}}},ue=G(zt,[["render",Tt],["__scopeId","data-v-8751ab58"]]);export{ue as default};
