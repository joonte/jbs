import{j as H,o as B,c as O,b as p,a as o,w as r,d as J,t as i,F as R,a5 as Q,y as X,p as Y,l as Z,_ as $,u as ee,S as te,e as oe,r as d,g as P,i as j}from"./index-5e313302.js";import{u as se}from"./edesks-38ed672b.js";import{_ as L}from"./ClausesKeeper-eb954229.js";import{s as ae}from"./multiselect-bfc29db8.js";import{E as z}from"./EmptyStateBlock-9f752916.js";import{B as K}from"./BlockBalanceAgreement-bb87adc1.js";import{a as ne,f as le}from"./useTimeFunction-8602dd60.js";import{C as re,F as ce}from"./bootstrap-vue-next.es-a19a8b41.js";import{S as ie}from"./StatusBadge-98696de1.js";import{_ as de}from"./FormInputSearch-4c769092.js";import"./IconClose-1f889a2e.js";import"./contracts-3351d68f.js";import"./ButtonDefault-7c216fc6.js";import"./IconArrow-555f9d45.js";import"./IconPlus-856cd9b9.js";import"./IconSearch-5f35739d.js";const ue=[{key:"ID",label:"Номер"},{key:"UpdateDate",label:"Дата и время",sortable:!0,variant:"td-gray td-order"},{key:"PriorityID",label:"Приоритет",sortable:!0,variant:"td-gray td-order"},{key:"Theme",label:"Тема"},{key:"MessageID",label:"Количество сообщений"},{key:"StatusID",label:"Статус",sortable:!0,variant:"td-gray td-order"}],pe={Newest:{color:"#459FD1",background:"#ADC1F04C"},Opened:{color:"#FFC107",background:"#FFC10733"},Working:{color:"#28A745",background:"#EAF7ED"},Closed:{color:"#838383",background:"#57699B19"}},_e={Low:{background:"#8FD658"},Middle:{background:"#FFC700"},Hight:{background:"#DF5747"}},c=u=>(Y("data-v-6b75a21b"),u=u(),Z(),u),me={class:"section"},be={class:"container"},ge={class:"section-header"},ke=c(()=>o("h1",{class:"section-title"},"Служба поддержки",-1)),fe={class:"btn__group"},ve={class:"list-form"},De={class:"list-form_col list-form_col--sm"},ye={class:"list-form_select"},he={class:"multiselect-option"},Ie=c(()=>o("span",{class:"td-mobile"},"Номер",-1)),Fe={class:"d-block"},Se=c(()=>o("span",{class:"td-mobile"},"Дата и время",-1)),Te=c(()=>o("span",{class:"td-mobile"},"Приоритет",-1)),Ce=c(()=>o("span",{class:"td-mobile"},"Тема",-1)),Ee={class:"cell__theme"},Be=c(()=>o("span",{class:"td-mobile"},"Количество сообщений",-1)),Pe=c(()=>o("span",{class:"td-mobile"},"Статус",-1)),Ve=c(()=>o("span",null,"Ничего не найдено",-1)),we=c(()=>o("span",null,"Ничего не найдено",-1)),xe={class:"table-controls"},Ue=c(()=>o("span",{class:"text-success"},"First",-1)),Ne=c(()=>o("span",{class:"text-info"},"Last",-1)),Me={class:"multiselect-multiple-label"},Ae={class:"multiselect-option"};function He(u,n,V,t,m,f){const v=K,S=H("router-link"),D=L,h=H("Multiselect"),k=de,T=ie,C=re,E=ce,y=z;return B(),O(R,null,[p(v),o("div",me,[o("div",be,[o("div",ge,[ke,o("div",fe,[p(S,{class:"btn btn--blue btn-default",to:"/NewTicket"},{default:r(()=>[J("Создать тикет")]),_:1})])]),p(D,{partition:"Header:/Tickets"}),o("div",ve,[o("div",De,[o("div",ye,[p(h,{options:t.options,label:"name",modelValue:t.select,"onUpdate:modelValue":n[0]||(n[0]=e=>t.select=e)},{option:r(({option:e})=>[o("div",he,i(e.name),1)]),_:1},8,["options","modelValue"])])]),p(k,{modelValue:t.filter,"onUpdate:modelValue":n[1]||(n[1]=e=>t.filter=e)},null,8,["modelValue"])]),t.getEDeskItems&&t.getEDeskItems.length?(B(),O(R,{key:0},[p(C,{class:"basic-table",items:t.onFiltered(t.filterTableItems(t.getEDeskItems)),"per-page":t.perPage,"current-page":t.currentPage,fields:t.ticketsTable,"show-empty":"","sort-by":t.sortBy,"onUpdate:sortBy":n[2]||(n[2]=e=>t.sortBy=e),"sort-desc":t.sortDesc,"onUpdate:sortDesc":n[3]||(n[3]=e=>t.sortDesc=e),"sort-direction":t.sortDirection,onRowClicked:t.navigateToTicket},{"cell(ID)":r(e=>[Ie,o("span",Fe,i(e.value),1)]),"cell(UpdateDate)":r(e=>[Se,o("span",null,i(t.formNormalDate(t.secondToDate(e.value))),1)]),"cell(PriorityID)":r(e=>{var b,g,I,F;return[Te,o("span",{class:"status-tag",style:Q(`color: #FFF; background-color: ${(g=(b=t.priorities)==null?void 0:b[e.value])==null?void 0:g.background}; border-color: ${(F=(I=t.priorities)==null?void 0:I[e.value])==null?void 0:F.background}`)},i(t.findPriority(e.value)),5)]}),"cell(Theme)":r(e=>[Ce,o("span",Ee,i(e.value),1)]),"cell(MessageID)":r(e=>[Be,o("span",null,i(e.value),1)]),"cell(StatusID)":r(e=>[Pe,p(T,{class:"clickable-element",status:e.value,"status-table":"Edesks",onClick:b=>{var g;return t.openHistoryStatuses((g=e.item)==null?void 0:g.ID)}},null,8,["status","onClick"])]),empty:r(e=>[Ve]),emptyfiltered:r(e=>[we]),_:1},8,["items","per-page","current-page","fields","sort-by","sort-desc","sort-direction","onRowClicked"]),o("div",xe,[p(E,{modelValue:t.currentPage,"onUpdate:modelValue":n[4]||(n[4]=e=>t.currentPage=e),"total-rows":t.totalRows,"per-page":t.perPage,"first-number":"","last-number":""},{"first-text":r(()=>[Ue]),"last-text":r(()=>[Ne]),page:r(({page:e,active:b})=>[o("span",null,i((e-1)*t.perPage+1)+"-"+i(e*t.perPage),1)]),_:1},8,["modelValue","total-rows","per-page"]),p(h,{class:"multiselect--white",modelValue:t.perPage,"onUpdate:modelValue":n[5]||(n[5]=e=>t.perPage=e),options:t.pageOptions,label:"name",openDirection:"top"},{singlelabel:r(({value:e})=>[o("div",Me,[o("span",null,"Отображать "+i(e.value)+" строк",1)])]),option:r(({option:e})=>[o("div",Ae,"Отображать "+i(e.name)+" строк",1)]),_:1},8,["modelValue","options"])])],64)):(B(),X(y,{key:1,class:"no-margin",label:"Вы пока не обращались в тех. поддержку "}))])])],64)}const Oe={components:{ClausesKeeper:L,Multiselect:ae,EmptyStateBlock:z,BlockBalanceAgreement:K},async setup(){const u=se(),n=ee(),V=te("emitter"),t=oe(),m=d("*"),f=d(""),v=d(1),S=d(10),D=d(0),h=d([10,25,50,100]),k=d([]),T=d("UpdateDate"),C=d(!0),E=d("desc"),y=P(()=>u==null?void 0:u.eDesksList),e=P(()=>n==null?void 0:n.ConfigList),b=P(()=>{var a,l;return(l=(a=Object.keys(y.value))==null?void 0:a.map(s=>{var _;return(_=y.value)==null?void 0:_[s]}))==null?void 0:l.reverse()});await u.fetchEDesks().then(()=>{var a,l,s,_,w;D.value=b.value.length,(l=(a=e.value)==null?void 0:a.Statuses)!=null&&l.Edesks&&(k.value=(w=Object.keys((_=(s=e.value)==null?void 0:s.Statuses)==null?void 0:_.Edesks))==null?void 0:w.map(x=>{var U,N,M,A;return{value:x,name:(A=(M=(N=(U=e.value)==null?void 0:U.Statuses)==null?void 0:N.Edesks)==null?void 0:M[x])==null?void 0:A.Name}})),k.value.push({value:"*",name:"Все тикеты"})});function g(a){V.emit("open-modal",{component:"StatusHistory",data:{modeID:"Edesks",rowID:a}})}function I(a){var l;return(l=a==null?void 0:a.filter(s=>m.value==="*"?!0:(s==null?void 0:s.StatusID)===(m==null?void 0:m.value)))==null?void 0:l.filter(s=>(s==null?void 0:s.ID.includes(f.value))||(s==null?void 0:s.Theme.includes(f.value)))}function F(a){return D.value=a.length>0?a.length:1,a}function W(a){var l;return(l=k.value.find(s=>(s==null?void 0:s.value)===a))==null?void 0:l.name}function q(a){var l,s,_;return(_=(s=(l=e.value)==null?void 0:l.Edesks)==null?void 0:s.Priorities)==null?void 0:_[a]}function G(a,l,s){s.target.closest("button, a, .clickable-element")||t.push({path:`Ticket/${a==null?void 0:a.ID}`})}return j(f,()=>{v.value=1}),j(m,()=>{v.value=1}),{getEDesks:y,getEDeskItems:b,select:m,filter:f,currentPage:v,perPage:S,options:k,totalRows:D,pageOptions:h,sortBy:T,sortDesc:C,sortDirection:E,ticketsTable:ue,statuses:pe,priorities:_e,findStatus:W,findPriority:q,onFiltered:F,filterTableItems:I,secondToDate:ne,formNormalDate:le,navigateToTicket:G,openHistoryStatuses:g}}},ot=$(Oe,[["render",He],["__scopeId","data-v-6b75a21b"]]);export{ot as default};
